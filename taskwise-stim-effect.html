<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 13 taskwise stim effect | 52_ROI TTL1</title>
<meta name="author" content="Heejung Jung">
<meta name="description" content="roi_list &lt;- c('rINS', 'TPJ', 'dACC', 'PHG', 'V1', 'SM', 'MT', 'RSC', 'LOC', 'FFC', 'PIT', 'pSTS', 'AIP', 'premotor') run_types &lt;- c(&quot;pain&quot;, &quot;vicarious&quot;, &quot;cognitive&quot;)  plot_list &lt;- list() ...">
<meta name="generator" content="bookdown 0.37 with bs4_book()">
<meta property="og:title" content="Chapter 13 taskwise stim effect | 52_ROI TTL1">
<meta property="og:type" content="book">
<meta property="og:description" content="roi_list &lt;- c('rINS', 'TPJ', 'dACC', 'PHG', 'V1', 'SM', 'MT', 'RSC', 'LOC', 'FFC', 'PIT', 'pSTS', 'AIP', 'premotor') run_types &lt;- c(&quot;pain&quot;, &quot;vicarious&quot;, &quot;cognitive&quot;)  plot_list &lt;- list() ...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 13 taskwise stim effect | 52_ROI TTL1">
<meta name="twitter:description" content="roi_list &lt;- c('rINS', 'TPJ', 'dACC', 'PHG', 'V1', 'SM', 'MT', 'RSC', 'LOC', 'FFC', 'PIT', 'pSTS', 'AIP', 'premotor') run_types &lt;- c(&quot;pain&quot;, &quot;vicarious&quot;, &quot;cognitive&quot;)  plot_list &lt;- list() ...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.6.1/transition.js"></script><script src="libs/bs3compat-0.6.1/tabs.js"></script><script src="libs/bs3compat-0.6.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/htmlwidgets-1.6.4/htmlwidgets.js"></script><script src="libs/plotly-binding-4.10.3/plotly.js"></script><script src="libs/typedarray-0.1/typedarray.min.js"></script><link href="libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet">
<script src="libs/crosstalk-1.2.1/js/crosstalk.min.js"></script><link href="libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="libs/plotly-main-2.11.1/plotly-latest.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<link rel="stylesheet" href="docute.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">52_ROI TTL1</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html"><span class="header-section-number">1</span> About</a></li>
<li class="book-part">Behavioral</li>
<li><a class="" href="action-intro.html">Behavioral Rating analysis</a></li>
<li><a class="" href="beh_expect_cue.html"><span class="header-section-number">2</span> beh :: expectation ~ cue</a></li>
<li><a class="" href="beh_outcome_cue.html"><span class="header-section-number">3</span> beh :: outcome ~ cue</a></li>
<li><a class="" href="ch04_outcome-stim.html"><span class="header-section-number">4</span> [beh] outcome ~ stimulus_intensity</a></li>
<li><a class="" href="beh_outcome-cueXstim.html"><span class="header-section-number">5</span> beh :: outcome ~ cue * stim</a></li>
<li><a class="" href="ch06_Jepma.html"><span class="header-section-number">6</span> expect-actual ~ cue * trial</a></li>
<li><a class="" href="demean_per_sub_n1.html"><span class="header-section-number">7</span> beh :: outcome_demean ~ cue * stim * expect * n-1outcome</a></li>
<li><a class="" href="ch17_mediation.html"><span class="header-section-number">8</span> [beh] Mediation outcome ~ cue * stim * expectrating * n-1outcomerating</a></li>
<li><a class="" href="ch18_simulation.html"><span class="header-section-number">9</span> [beh] RL simulation</a></li>
<li><a class="" href="ch18_simulation_aryan.html"><span class="header-section-number">10</span> [beh] RL simulation Aryan</a></li>
<li><a class="" href="ch20_npssimulation.html"><span class="header-section-number">11</span> [model] NPSsimulation</a></li>
<li class="book-part">fMRI timeseries</li>
<li><a class="" href="fmri_time.html">fMRI timeseries</a></li>
<li><a class="" href="ch51_fir_glasserTPJttl2.html"><span class="header-section-number">12</span> [fMRI] FIR ~ task</a></li>
<li><a class="active" href="taskwise-stim-effect.html"><span class="header-section-number">13</span> taskwise stim effect</a></li>
<li><a class="" href="taskwise-6-cond-effect.html"><span class="header-section-number">14</span> taskwise 6 cond effect</a></li>
<li><a class="" href="ch52_timeseries.html"><span class="header-section-number">15</span> [fMRI] FIR ~ task TTL1</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/jungheejung/cue_expectancy">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="taskwise-stim-effect" class="section level1" number="13">
<h1>
<span class="header-section-number">13</span> taskwise stim effect<a class="anchor" aria-label="anchor" href="#taskwise-stim-effect"><i class="fas fa-link"></i></a>
</h1>
<div class="sourceCode" id="cb331"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">roi_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'rINS'</span>, <span class="st">'TPJ'</span>, <span class="st">'dACC'</span>, <span class="st">'PHG'</span>, <span class="st">'V1'</span>, <span class="st">'SM'</span>, <span class="st">'MT'</span>, <span class="st">'RSC'</span>, <span class="st">'LOC'</span>, <span class="st">'FFC'</span>, <span class="st">'PIT'</span>, <span class="st">'pSTS'</span>, <span class="st">'AIP'</span>, <span class="st">'premotor'</span><span class="op">)</span></span>
<span><span class="va">run_types</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"pain"</span>, <span class="st">"vicarious"</span>, <span class="st">"cognitive"</span><span class="op">)</span></span>
<span>  <span class="va">plot_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="va">TR_length</span> <span class="op">&lt;-</span> <span class="fl">42</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">ROI</span> <span class="kw">in</span> <span class="va">roi_list</span><span class="op">)</span> <span class="op">{</span></span>
<span>    </span>
<span>    <span class="va">datadir</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">main_dir</span>, <span class="st">"analysis/fmri/spm/fir/ttl2par"</span><span class="op">)</span></span>
<span> <span class="va">taskname</span> <span class="op">=</span> <span class="st">'pain'</span></span>
<span><span class="va">exclude</span> <span class="op">&lt;-</span> <span class="st">"sub-0001"</span></span>
<span><span class="va">filename</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"sub-*"</span>,  <span class="st">"*roi-"</span>, <span class="va">ROI</span>, <span class="st">"_tr-42.csv"</span><span class="op">)</span></span>
<span>  <span class="va">common_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.glob.html">Sys.glob</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">datadir</span>, <span class="st">"sub-*"</span>,  <span class="va">filename</span></span>
<span>  <span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">filter_path</span> <span class="op">&lt;-</span> <span class="va">common_path</span><span class="op">[</span><span class="op">!</span><span class="fu">str_detect</span><span class="op">(</span><span class="va">common_path</span>, pattern <span class="op">=</span> <span class="va">exclude</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html">do.call</a></span><span class="op">(</span><span class="st">"rbind.fill"</span>, <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">filter_path</span>, FUN <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">files</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.table</a></span><span class="op">(</span><span class="va">files</span>, header <span class="op">=</span> <span class="cn">TRUE</span>, sep <span class="op">=</span> <span class="st">","</span><span class="op">)</span></span>
<span>    <span class="op">}</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">run_type</span> <span class="kw">in</span> <span class="va">run_types</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">run_type</span><span class="op">)</span></span>
<span>  <span class="va">filtered_df</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="op">!</span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">condition</span> <span class="op">==</span> <span class="st">"rating"</span> <span class="op">|</span> <span class="va">df</span><span class="op">$</span><span class="va">condition</span> <span class="op">==</span> <span class="st">"cue"</span> <span class="op">|</span> <span class="va">df</span><span class="op">$</span><span class="va">runtype</span> <span class="op">!=</span> <span class="va">run_type</span><span class="op">)</span>, <span class="op">]</span></span>
<span></span>
<span>  <span class="va">parsed_df</span> <span class="op">&lt;-</span> <span class="va">filtered_df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu">separate</span><span class="op">(</span><span class="va">condition</span>, into <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"cue"</span>, <span class="st">"stim"</span><span class="op">)</span>, sep <span class="op">=</span> <span class="st">"_"</span>, remove <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span>  <span class="co"># --------------------- subset regions based on ROI ----------------------------</span></span>
<span>  <span class="va">df_long</span> <span class="op">&lt;-</span> <span class="fu">pivot_longer</span><span class="op">(</span><span class="va">parsed_df</span>, cols <span class="op">=</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html">starts_with</a></span><span class="op">(</span><span class="st">"tr"</span><span class="op">)</span>, names_to <span class="op">=</span> <span class="st">"tr_num"</span>, values_to <span class="op">=</span> <span class="st">"tr_value"</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># ----------------------------- clean factor -----------------------------------</span></span>
<span>  <span class="va">df_long</span><span class="op">$</span><span class="va">tr_ordered</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span></span>
<span>          <span class="va">df_long</span><span class="op">$</span><span class="va">tr_num</span>,</span>
<span>          levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"tr"</span>, <span class="fl">1</span><span class="op">:</span><span class="va">TR_length</span><span class="op">)</span><span class="op">)</span></span>
<span>      <span class="op">)</span></span>
<span>  <span class="va">df_long</span><span class="op">$</span><span class="va">stim_ordered</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span></span>
<span>          <span class="va">df_long</span><span class="op">$</span><span class="va">stim</span>,</span>
<span>          levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"stimH"</span>, <span class="st">"stimM"</span>, <span class="st">"stimL"</span><span class="op">)</span></span>
<span>      <span class="op">)</span></span>
<span></span>
<span>  <span class="co"># --------------------------- summary statistics -------------------------------</span></span>
<span>  <span class="va">subjectwise</span> <span class="op">&lt;-</span> <span class="fu">meanSummary</span><span class="op">(</span><span class="va">df_long</span>,</span>
<span>                                        <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"sub"</span>,<span class="st">"tr_ordered"</span>, <span class="st">"stim_ordered"</span><span class="op">)</span>, <span class="st">"tr_value"</span><span class="op">)</span></span>
<span>  <span class="va">groupwise</span> <span class="op">&lt;-</span> <span class="fu">summarySEwithin</span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">subjectwise</span>,</span>
<span>    measurevar <span class="op">=</span> <span class="st">"mean_per_sub"</span>,</span>
<span>    withinvars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span> <span class="st">"stim_ordered"</span>, <span class="st">"tr_ordered"</span><span class="op">)</span>,</span>
<span>    idvar <span class="op">=</span> <span class="st">"sub"</span></span>
<span>  <span class="op">)</span></span>
<span>  <span class="va">groupwise</span><span class="op">$</span><span class="va">task</span> <span class="op">&lt;-</span> <span class="va">run_type</span></span>
<span>  <span class="co"># https://stackoverflow.com/questions/29402528/append-data-frames-together-in-a-for-loop/29419402</span></span>
<span></span>
<span>  <span class="co"># ... Rest of your data processing code ...</span></span>
<span>  </span>
<span>  <span class="co"># subset &lt;- groupwise[groupwise$runtype == run_type, ]</span></span>
<span>  <span class="va">LINEIV1</span> <span class="op">=</span> <span class="st">"tr_ordered"</span></span>
<span>  <span class="va">LINEIV2</span> <span class="op">=</span> <span class="st">"stim_ordered"</span></span>
<span>  <span class="va">MEAN</span> <span class="op">=</span> <span class="st">"mean_per_sub_norm_mean"</span></span>
<span>  <span class="va">ERROR</span> <span class="op">=</span> <span class="st">"se"</span></span>
<span>  <span class="va">dv_keyword</span> <span class="op">=</span> <span class="st">"actual"</span></span>
<span>  <span class="va">sorted_indices</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/order.html">order</a></span><span class="op">(</span><span class="va">groupwise</span><span class="op">$</span><span class="va">tr_ordered</span><span class="op">)</span></span>
<span>  <span class="va">groupwise_sorted</span> <span class="op">&lt;-</span> <span class="va">groupwise</span><span class="op">[</span><span class="va">sorted_indices</span>, <span class="op">]</span></span>
<span>  <span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu">plot_timeseries_bar</span><span class="op">(</span><span class="va">groupwise_sorted</span>, </span>
<span>                            <span class="va">LINEIV1</span>, <span class="va">LINEIV2</span>, <span class="va">MEAN</span>, <span class="va">ERROR</span>,  </span>
<span>                            xlab <span class="op">=</span> <span class="st">"TRs"</span>, </span>
<span>                            ylab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">ROI</span>, <span class="st">" activation (A.U.)"</span><span class="op">)</span>, </span>
<span>                            ggtitle <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">ROI</span>, <span class="st">": "</span>,<span class="va">run_type</span>, <span class="st">" (N = "</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">subjectwise</span><span class="op">$</span><span class="va">sub</span><span class="op">)</span><span class="op">)</span>,<span class="st">") time series, Epoch - stimulus"</span><span class="op">)</span>, </span>
<span>                            color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"#5f0f40"</span>,<span class="st">"#ae2012"</span>, <span class="st">"#fcbf49"</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">time_points</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0.46</span> <span class="op">*</span> <span class="va">TR_length</span>, <span class="fl">0.46</span><span class="op">)</span></span>
<span>  <span class="co">#p1 &lt;- p1 + scale_x_discrete(labels = setNames(time_points, colnames(df_long)[7:(7 + TR_length)])) + theme_classic()</span></span>
<span>  </span>
<span>  <span class="va">plot_list</span><span class="op">[[</span><span class="va">run_type</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">p1</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_classic</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span>  </span>
<span>  <span class="co"># --------------------------- plot three tasks -------------------------------</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">gridExtra</span><span class="op">)</span></span>
<span><span class="va">plot_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">plot_list</span>, <span class="kw">function</span><span class="op">(</span><span class="va">plot</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">plot</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>plot.margin <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">margin</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">5</span>, <span class="fl">5</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span>  <span class="co"># Adjust plot margins if needed</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span><span class="va">combined_plot</span> <span class="op">&lt;-</span> <span class="fu">ggpubr</span><span class="fu">::</span><span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/ggarrange.html">ggarrange</a></span><span class="op">(</span><span class="va">plot_list</span><span class="op">[[</span><span class="st">"pain"</span><span class="op">]</span><span class="op">]</span>,<span class="va">plot_list</span><span class="op">[[</span><span class="st">"vicarious"</span><span class="op">]</span><span class="op">]</span>,<span class="va">plot_list</span><span class="op">[[</span><span class="st">"cognitive"</span><span class="op">]</span><span class="op">]</span>,</span>
<span>                  common.legend <span class="op">=</span> <span class="cn">TRUE</span>,legend <span class="op">=</span> <span class="st">"bottom"</span>, ncol <span class="op">=</span> <span class="fl">3</span>, nrow <span class="op">=</span> <span class="fl">1</span>, </span>
<span>                  widths <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">3</span>, <span class="fl">3</span><span class="op">)</span>, heights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">.5</span>,<span class="fl">.5</span>,<span class="fl">.5</span><span class="op">)</span>, align <span class="op">=</span> <span class="st">"v"</span><span class="op">)</span></span>
<span><span class="va">combined_plot</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html">ggsave</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">save_dir</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"roi-"</span>, <span class="va">ROI</span>,<span class="st">"_epoch-stim_desc-highstimGTlowstim.png"</span><span class="op">)</span><span class="op">)</span>, <span class="va">combined_plot</span>, width <span class="op">=</span> <span class="fl">12</span>, height <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span></span>
<span><span class="op">}</span></span></code></pre></div>
<pre><code>## [1] "pain"</code></pre>
<pre><code>## 
## Attaching package: 'raincloudplots'</code></pre>
<pre><code>## The following object is masked _by_ '.GlobalEnv':
## 
##     GeomFlatViolin</code></pre>
<pre><code>## [1] "vicarious"
## [1] "cognitive"</code></pre>
<pre><code>## 
## Attaching package: 'gridExtra'</code></pre>
<pre><code>## The following object is masked from 'package:dplyr':
## 
##     combine</code></pre>
<pre><code>## [1] "pain"
## [1] "vicarious"
## [1] "cognitive"</code></pre>
<pre><code>## [1] "pain"
## [1] "vicarious"
## [1] "cognitive"</code></pre>
<pre><code>## [1] "pain"
## [1] "vicarious"
## [1] "cognitive"</code></pre>
<pre><code>## [1] "pain"
## [1] "vicarious"
## [1] "cognitive"</code></pre>
<pre><code>## [1] "pain"
## [1] "vicarious"
## [1] "cognitive"</code></pre>
<pre><code>## [1] "pain"
## [1] "vicarious"
## [1] "cognitive"</code></pre>
<pre><code>## [1] "pain"
## [1] "vicarious"
## [1] "cognitive"</code></pre>
<pre><code>## [1] "pain"
## [1] "vicarious"
## [1] "cognitive"</code></pre>
<pre><code>## [1] "pain"
## [1] "vicarious"
## [1] "cognitive"</code></pre>
<pre><code>## [1] "pain"
## [1] "vicarious"
## [1] "cognitive"</code></pre>
<pre><code>## [1] "pain"
## [1] "vicarious"
## [1] "cognitive"</code></pre>
<pre><code>## [1] "pain"
## [1] "vicarious"
## [1] "cognitive"</code></pre>
<pre><code>## [1] "pain"
## [1] "vicarious"
## [1] "cognitive"</code></pre>
<div id="pca-subjectwise" class="section level3" number="13.0.1">
<h3>
<span class="header-section-number">13.0.1</span> PCA subjectwise<a class="anchor" aria-label="anchor" href="#pca-subjectwise"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb351"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("ggplot2")    # Install ggplot2 if you haven't already</span></span>
<span><span class="co"># install.packages("FactoMineR") # Install FactoMineR if you haven't already</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://factominer.free.fr">FactoMineR</a></span><span class="op">)</span></span>
<span><span class="va">run_types</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"pain"</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">run_type</span> <span class="kw">in</span> <span class="va">run_types</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">run_type</span><span class="op">)</span></span>
<span>  <span class="va">filtered_df</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="op">!</span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">condition</span> <span class="op">==</span> <span class="st">"rating"</span> <span class="op">|</span> <span class="va">df</span><span class="op">$</span><span class="va">condition</span> <span class="op">==</span> <span class="st">"cue"</span> <span class="op">|</span> <span class="va">df</span><span class="op">$</span><span class="va">runtype</span> <span class="op">!=</span> <span class="va">run_type</span><span class="op">)</span>, <span class="op">]</span></span>
<span></span>
<span>  <span class="va">parsed_df</span> <span class="op">&lt;-</span> <span class="va">filtered_df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu">separate</span><span class="op">(</span><span class="va">condition</span>, into <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"cue"</span>, <span class="st">"stim"</span><span class="op">)</span>, sep <span class="op">=</span> <span class="st">"_"</span>, remove <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span>  <span class="co"># --------------------- subset regions based on ROI ----------------------------</span></span>
<span>  <span class="va">df_long</span> <span class="op">&lt;-</span> <span class="fu">pivot_longer</span><span class="op">(</span><span class="va">parsed_df</span>, cols <span class="op">=</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html">starts_with</a></span><span class="op">(</span><span class="st">"tr"</span><span class="op">)</span>, names_to <span class="op">=</span> <span class="st">"tr_num"</span>, values_to <span class="op">=</span> <span class="st">"tr_value"</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># ----------------------------- clean factor -----------------------------------</span></span>
<span>  <span class="va">df_long</span><span class="op">$</span><span class="va">tr_ordered</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span></span>
<span>          <span class="va">df_long</span><span class="op">$</span><span class="va">tr_num</span>,</span>
<span>          levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"tr"</span>, <span class="fl">1</span><span class="op">:</span><span class="va">TR_length</span><span class="op">)</span><span class="op">)</span></span>
<span>      <span class="op">)</span></span>
<span>  <span class="va">df_long</span><span class="op">$</span><span class="va">stim_ordered</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span></span>
<span>          <span class="va">df_long</span><span class="op">$</span><span class="va">stim</span>,</span>
<span>          levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"stimH"</span>, <span class="st">"stimM"</span>, <span class="st">"stimL"</span><span class="op">)</span></span>
<span>      <span class="op">)</span></span>
<span></span>
<span>  <span class="co"># --------------------------- summary statistics -------------------------------</span></span>
<span>  <span class="va">subjectwise</span> <span class="op">&lt;-</span> <span class="fu">meanSummary</span><span class="op">(</span><span class="va">df_long</span>,</span>
<span>                                        <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"sub"</span>,<span class="st">"tr_ordered"</span>, <span class="st">"stim_ordered"</span><span class="op">)</span>, <span class="st">"tr_value"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Assuming your original dataframe is named 'df'</span></span>
<span></span>
<span><span class="co"># Convert the dataframe to wide format</span></span>
<span><span class="va">df_wide</span> <span class="op">&lt;-</span> <span class="fu">pivot_wider</span><span class="op">(</span><span class="va">subjectwise</span>, </span>
<span>                       id_cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"tr_ordered"</span>, <span class="st">"stim_ordered"</span><span class="op">)</span>, </span>
<span>                       names_from <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"sub"</span><span class="op">)</span>, </span>
<span>                       values_from <span class="op">=</span> <span class="st">"mean_per_sub"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># df_wide &lt;- pivot_wider(subjectwise, </span></span>
<span><span class="co">#                        id_cols = c("sub", "ROIindex","stim_ordered"), </span></span>
<span><span class="co">#                        names_from = "tr_ordered", </span></span>
<span><span class="co">#                        values_from = "mean_per_sub")</span></span>
<span><span class="va">stim_high.df</span> <span class="op">&lt;-</span> <span class="va">df_wide</span><span class="op">[</span><span class="va">df_wide</span><span class="op">$</span><span class="va">stim_ordered</span> <span class="op">==</span> <span class="st">"stimH"</span>,<span class="op">]</span></span>
<span><span class="va">stim_med.df</span> <span class="op">&lt;-</span> <span class="va">df_wide</span><span class="op">[</span><span class="va">df_wide</span><span class="op">$</span><span class="va">stim_ordered</span> <span class="op">==</span> <span class="st">"stimM"</span>,<span class="op">]</span></span>
<span><span class="va">stim_low.df</span> <span class="op">&lt;-</span> <span class="va">df_wide</span><span class="op">[</span><span class="va">df_wide</span><span class="op">$</span><span class="va">stim_ordered</span> <span class="op">==</span> <span class="st">"stimL"</span>,<span class="op">]</span></span>
<span><span class="co"># selected_columns &lt;- subset(stim_high.df, select = 2:(ncol(stim_high.df) - 1))</span></span>
<span><span class="va">meanhighdf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">stim_high.df</span>, select <span class="op">=</span> <span class="fl">3</span><span class="op">:</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">stim_high.df</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">high.pca_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/prcomp.html">prcomp</a></span><span class="op">(</span><span class="va">meanhighdf</span><span class="op">)</span></span>
<span><span class="va">high.pca_scores</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="va">high.pca_result</span><span class="op">$</span><span class="va">x</span><span class="op">)</span></span>
<span><span class="co"># Access the proportion of variance explained by each principal component</span></span>
<span><span class="va">high.variance_explained</span> <span class="op">&lt;-</span> <span class="va">high.pca_result</span><span class="op">$</span><span class="va">sdev</span><span class="op">^</span><span class="fl">2</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">high.pca_result</span><span class="op">$</span><span class="va">sdev</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">high.variance_explained</span><span class="op">)</span></span>
<span><span class="co"># Access the standard deviations of each principal component</span></span>
<span><span class="va">high.stdev</span> <span class="op">&lt;-</span> <span class="va">high.pca_result</span><span class="op">$</span><span class="va">sdev</span></span>
<span></span>
<span><span class="va">meanmeddf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">stim_med.df</span>, select <span class="op">=</span> <span class="fl">3</span><span class="op">:</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">stim_med.df</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">med.pca</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/prcomp.html">prcomp</a></span><span class="op">(</span><span class="va">meanmeddf</span><span class="op">)</span></span>
<span><span class="va">med.pca_scores</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="va">med.pca</span><span class="op">$</span><span class="va">x</span><span class="op">)</span></span>
<span></span>
<span><span class="va">meanlowdf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">stim_low.df</span>, select <span class="op">=</span> <span class="fl">3</span><span class="op">:</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">stim_low.df</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">low.pca</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/prcomp.html">prcomp</a></span><span class="op">(</span><span class="va">meanlowdf</span><span class="op">)</span></span>
<span><span class="va">low.pca_scores</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="va">low.pca</span><span class="op">$</span><span class="va">x</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://plotly-r.com">plotly</a></span><span class="op">)</span>  <span class="co"># You can use plotly to create an interactive 3D plot</span></span>
<span><span class="co"># plot_ly(high.pca_scores, x = ~PC1, y = ~PC2, z = ~PC3, type = "scatter3d", mode = "markers")</span></span>
<span><span class="co"># plot_ly(low.pca_scores, x = ~PC1, y = ~PC2, z = ~PC3, type = "scatter3d", mode = "markers")</span></span>
<span><span class="va">combined_pca_scores</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="va">high.pca_scores</span>, <span class="va">med.pca_scores</span>, <span class="va">low.pca_scores</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Add a new column to indicate the stim_ordered category (high_stim or low_stim)</span></span>
<span><span class="va">combined_pca_scores</span><span class="op">$</span><span class="va">stim_ordered</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"high_stim"</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">high.pca_scores</span><span class="op">)</span><span class="op">)</span>, </span>
<span>                                      <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"med_stim"</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">med.pca_scores</span><span class="op">)</span><span class="op">)</span>, </span>
<span>                                      <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"low_stim"</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">low.pca_scores</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create the 3D PCA plot</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/plotly/man/plot_ly.html">plot_ly</a></span><span class="op">(</span><span class="va">combined_pca_scores</span>, x <span class="op">=</span> <span class="op">~</span><span class="va">PC1</span>, y <span class="op">=</span> <span class="op">~</span><span class="va">PC2</span>, z <span class="op">=</span> <span class="op">~</span><span class="va">PC3</span>, type <span class="op">=</span> <span class="st">"scatter3d"</span>, mode <span class="op">=</span> <span class="st">"markers"</span>,</span>
<span>        color <span class="op">=</span> <span class="op">~</span><span class="va">stim_ordered</span><span class="op">)</span></span>
<span><span class="co"># data_matrix &lt;- groupwise[groupwise$stim_ordered == "high_stim",c("tr_ordered", "mean_per_sub_norm_mean")]</span></span>
<span><span class="co"># sorted_indices &lt;- order(data_matrix$tr_ordered)</span></span>
<span><span class="co"># df_ordered &lt;- data_matrix[sorted_indices, ]</span></span>
<span><span class="co"># pca_result &lt;- PCA(data_matrix$mean_per_sub_norm_mean)</span></span>
<span><span class="co"># datapoints &lt;- df$datapoints</span></span>
<span><span class="op">}</span></span></code></pre></div>
<pre><code>## [1] "pain"</code></pre>
<pre><code>## 
## Attaching package: 'plotly'</code></pre>
<pre><code>## The following object is masked from 'package:ggplot2':
## 
##     last_plot</code></pre>
<pre><code>## The following objects are masked from 'package:plyr':
## 
##     arrange, mutate, rename, summarise</code></pre>
<pre><code>## The following object is masked from 'package:reshape':
## 
##     rename</code></pre>
<pre><code>## The following object is masked from 'package:stats':
## 
##     filter</code></pre>
<pre><code>## The following object is masked from 'package:graphics':
## 
##     layout</code></pre>
<div class="inline-figure"><img src="51_iv-6cond_dv-firglasserSPM_ttl2_rois_files/figure-html/unnamed-chunk-4-1.png" width="672"></div>
<div class="sourceCode" id="cb359"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/plotly/man/plot_ly.html">plot_ly</a></span><span class="op">(</span><span class="va">combined_pca_scores</span>, x <span class="op">=</span> <span class="op">~</span><span class="va">PC1</span>, y <span class="op">=</span> <span class="op">~</span><span class="va">PC2</span>, z <span class="op">=</span> <span class="op">~</span><span class="va">PC3</span>, type <span class="op">=</span> <span class="st">"scatter3d"</span>, mode <span class="op">=</span> <span class="st">"markers"</span>,</span>
<span>        color <span class="op">=</span> <span class="op">~</span><span class="va">stim_ordered</span><span class="op">)</span></span></code></pre></div>
<div class="plotly html-widget html-fill-item" id="htmlwidget-9af6124457c46ec72fa3" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-9af6124457c46ec72fa3">{"x":{"visdat":{"f0b36b7d338":["function () ","plotlyVisDat"]},"cur_data":"f0b36b7d338","attrs":{"f0b36b7d338":{"x":{},"y":{},"z":{},"mode":"markers","color":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter3d"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"scene":{"xaxis":{"title":"PC1"},"yaxis":{"title":"PC2"},"zaxis":{"title":"PC3"}},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[-3.5788109233784819,-2.0533347388596508,-6.5336218647865598,-2.7083216152222849,-0.8237495447086165,1.0655748176928745,3.5832988818958524,5.5563725928506917,12.885062337428746,17.164931474166693,26.318430905717509,22.124327309718247,35.004207885933894,40.558945380024475,58.529141037493446,64.663134539960524,75.574527605961364,80.504681380370528,88.853870004454848,88.474313313103664,90.870391787896637,92.487071169826365,91.578581425689961,80.506727557836783,79.630063963028817,71.482883358234119,66.461675896748062,51.86721571890569,31.162107340353895,10.660676316876559,-15.439539064936159,-31.490238750398635,-63.430947755775946,-80.61203482905448,-100.8353665232453,-116.34121468973694,-128.03202901695411,-140.62301423580092,-150.52905134311825,-151.59358717604783,-145.81099929470383,-147.13235263544212],"y":[-35.799086995981995,-40.762489650462321,-51.943208835590674,-52.21806866486066,-60.020978980189966,-59.713727196356842,-63.765093576372969,-63.012208382804147,-68.154743793542835,-58.743133103019048,-48.555550398250006,-54.69018356241196,-46.069270743051106,-42.045770006073873,-27.797390325514606,-26.995409904715338,-13.916191815317477,-7.4124700487557558,11.429275355703664,17.121117406962117,26.327938273260436,42.321370478231955,42.977995658382234,56.459525411413459,63.498300398301872,71.960100980349338,64.470761099784852,49.35218716039622,51.538679580944525,40.852807250062995,38.356454462271962,36.088401666324643,38.02882853099203,34.601746501051309,36.528602437331429,31.113200797482548,26.389499705204546,18.696845742053558,10.977683013121531,12.863126172777573,1.9568677900900378,-2.2963398892233036],"z":[-20.368503983741295,-21.888162194383774,-25.968037199696546,-25.101881294833703,-23.885738856181103,-21.158121479978981,-20.622217996634834,-13.953720977137348,-13.096391751480825,-8.8966820595222647,0.34077690684816997,0.61485990703649906,14.755912745603011,21.629297858872029,27.496511515079202,34.504693974335716,33.136603233913021,38.151524374152295,35.179539959984886,27.822283474719885,20.044042082498962,18.156917899465654,14.268748250323528,11.186305471004029,2.0557724533876449,-7.3188258482323256,-18.236587362937126,-35.527744846727138,-32.706286932286204,-36.624545340348376,-40.854960187380833,-36.401260869286794,-30.051021786625803,-20.495095826176584,-3.3876880999761529,2.4659565243325599,12.892098280121754,19.634708309930531,28.388527367522538,28.101953981149173,30.437012729858221,35.279427593428707],"mode":"markers","type":"scatter3d","name":"high_stim","marker":{"color":"rgba(102,194,165,1)","line":{"color":"rgba(102,194,165,1)"}},"textfont":{"color":"rgba(102,194,165,1)"},"error_y":{"color":"rgba(102,194,165,1)"},"error_x":{"color":"rgba(102,194,165,1)"},"line":{"color":"rgba(102,194,165,1)"},"frame":null},{"x":[-27.632028230350532,-25.731525601711713,-25.299975170275072,-25.186809037560455,-23.190695001267848,-18.714852981660076,-16.55342686097643,-5.0427579982985167,-2.5890864976130286,7.1557849615622384,10.083579323217338,15.069773962025495,21.351099134012422,26.730591023251005,37.556582097691994,44.78142377883664,51.198376881716577,52.96024834403034,56.867843328561669,61.16685274269507,55.114354917589452,53.990358400640709,54.749928352466256,49.77035747808231,40.04583021963915,39.359048989428693,38.173043512008789,27.826457484642887,23.86870039769709,18.288836395540034,-2.5735371544542152,-13.433993856144752,-24.054673094068445,-39.580455144127626,-44.622157733759749,-63.459942825754887,-63.510197460095149,-70.010374365201471,-71.899606526203698,-75.272211756018677,-75.798648291621902,-71.952116138171846],"y":[-37.102745040665155,-41.340295373177149,-42.336580300145776,-39.804649201559208,-47.352420897833923,-39.330599410608592,-44.698058781433666,-45.02332243567173,-37.243082738739574,-41.662043127370012,-39.628405295853455,-41.120345561609426,-31.559728676254196,-33.969592054887684,-34.48795962747387,-36.470004295599473,-25.368378853670052,-14.531406919543105,0.70553831635619491,7.4019566042573892,18.441679983069232,31.063225606071413,33.655743143016096,32.744628795618539,33.427484144797027,33.49654443767718,35.889854547859436,42.247560240578565,43.734744530717862,43.994528304917473,47.92128378432264,43.725371341232766,37.149976316356117,34.429599696987211,29.827582968062544,24.053173425286673,18.310636228456655,21.644152022919471,18.352394324321754,15.700065016024539,16.416793762640186,8.6951010505489492],"z":[12.944966892698959,24.228006333311228,22.226845407650163,27.988087566390607,17.796756595861737,20.889840850123164,13.972857024967388,9.0928043277548305,6.6988219346300033,1.2435680706410839,-7.1896146780466461,-3.2260773933458826,-13.272562029074438,-14.122783303383567,-18.187305562670325,-22.555863326985712,-17.918953623211195,-19.312581921894708,-15.538754071029466,-15.253948888685114,-10.052919062076107,-17.038299687496391,-8.8265517205285757,-3.9878522169802624,4.6343921578681888,13.106450940197163,18.530075732600633,25.725376690627176,30.496485197553167,17.043818902974721,18.908667534385472,18.61709280667732,7.3346358511762553,4.8279529169838638,-3.159348423902379,-4.9592606700033661,-13.789468144083251,-23.349364250258592,-22.078398554948791,-29.842803707948537,-20.445587879324211,-12.199204619195617],"mode":"markers","type":"scatter3d","name":"low_stim","marker":{"color":"rgba(252,141,98,1)","line":{"color":"rgba(252,141,98,1)"}},"textfont":{"color":"rgba(252,141,98,1)"},"error_y":{"color":"rgba(252,141,98,1)"},"error_x":{"color":"rgba(252,141,98,1)"},"line":{"color":"rgba(252,141,98,1)"},"frame":null},{"x":[-22.572817516108412,-22.171528797928978,-17.733962648674268,-21.667777499678383,-14.752657832200196,-18.186987462937548,-9.4109152518257169,-7.4817355752711512,-11.412613512158412,0.58843919147860335,5.8333607041739972,17.10472007670807,26.998767315430527,40.357636826826138,53.468859105262503,59.535903257677923,67.626804272407711,80.584641846019423,80.202720619935661,85.096036532619678,87.060030350298831,82.000839271200562,71.533836552662024,73.912659740620384,71.783583044393453,60.863580729147216,61.334492988222593,59.343511875210211,41.881054007010086,24.694885328027393,-3.0284188020669331,-19.907332582962042,-49.10616018409592,-69.257938788566108,-93.783894549422087,-93.021380448889417,-100.04904639031912,-112.66269524071932,-118.91132427851494,-121.25557696091575,-116.42887632593813,-109.0027229861401],"y":[-40.35301484899211,-40.903875118265994,-47.796362915935674,-44.029778049751428,-50.528894185296139,-54.058728268569787,-49.30906013220136,-52.905864331945565,-51.553105222815439,-46.976772247944538,-41.312146478011989,-47.923003665257383,-42.870421753912439,-34.826216184513022,-30.048235203847632,-22.157647455666854,-8.483848927786072,-8.0545911367992655,0.68533110647278184,7.538624140663968,15.328212113987567,24.562984529331647,24.132304725546927,36.805423068875285,36.862356204132865,43.035487897747309,50.174379981963277,44.008096476464779,51.117731966268835,47.776767457461261,51.544021514064887,43.627911216505176,43.925397826766869,40.415043528706164,36.11846508664987,29.608543200591534,25.529470899405265,23.321048514401703,17.936521235668273,6.7010637427867294,8.1204004571408497,5.2159792359088373],"z":[-22.930393323846037,-25.769046967938152,-23.300906197190464,-28.734337300773628,-27.108961058629934,-26.565628989981306,-18.704874337325379,-17.501344638383308,-12.240090499975649,-4.742777452278613,-0.85187279232867597,6.6360924823896799,16.281255300129011,25.148355523211034,25.662871267643439,26.327945481442224,26.165235527681517,29.485027447616066,26.17706934838607,19.054385220131067,23.037592141643398,25.679860259186341,11.134785059992685,7.6799621536568541,-9.4757232491520398,-15.970738295852819,-23.408235115326637,-23.808293226827892,-27.87523257694318,-26.230153978951524,-29.114105185194735,-21.181092932002507,-23.754048725172687,-13.265289434056603,-3.6556052623843778,2.4878780937361382,21.446309979704367,21.617508744478066,26.838412956964,33.499003617514227,27.306281743390361,24.522919191619572],"mode":"markers","type":"scatter3d","name":"med_stim","marker":{"color":"rgba(141,160,203,1)","line":{"color":"rgba(141,160,203,1)"}},"textfont":{"color":"rgba(141,160,203,1)"},"error_y":{"color":"rgba(141,160,203,1)"},"error_x":{"color":"rgba(141,160,203,1)"},"line":{"color":"rgba(141,160,203,1)"},"frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
<div id="pca-groupwise" class="section level3" number="13.0.2">
<h3>
<span class="header-section-number">13.0.2</span> PCA groupwise<a class="anchor" aria-label="anchor" href="#pca-groupwise"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb360"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("ggplot2")    # Install ggplot2 if you haven't already</span></span>
<span><span class="co"># install.packages("FactoMineR") # Install FactoMineR if you haven't already</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://factominer.free.fr">FactoMineR</a></span><span class="op">)</span></span>
<span></span>
<span></span>
<span></span>
<span><span class="co"># Assuming your original dataframe is named 'df'</span></span>
<span></span>
<span><span class="co"># Convert the dataframe to wide format</span></span>
<span><span class="va">df_wide.group</span> <span class="op">&lt;-</span> <span class="fu">pivot_wider</span><span class="op">(</span><span class="va">subjectwise</span>,</span>
<span>                       id_cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"tr_ordered"</span>, <span class="st">"stim_ordered"</span><span class="op">)</span>,</span>
<span>                       names_from <span class="op">=</span> <span class="st">"sub"</span>,</span>
<span>                       values_from <span class="op">=</span> <span class="st">"mean_per_sub"</span><span class="op">)</span></span>
<span><span class="co"># ------</span></span>
<span><span class="co"># data_matrix &lt;- groupwise[groupwise$stim_ordered == "high_stim",c("tr_ordered", "mean_per_sub_norm_mean")]</span></span>
<span><span class="co"># sorted_indices &lt;- order(data_matrix$tr_ordered)</span></span>
<span><span class="co"># df_ordered &lt;- data_matrix[sorted_indices, ]</span></span>
<span><span class="co"># datapoints &lt;- df_ordered$mean_per_sub_norm_mean</span></span>
<span><span class="co"># data_df &lt;- data.frame(Dim1 = datapoints, Dim2 = datapoints, Dim3 = datapoints)</span></span>
<span><span class="co"># pca &lt;- prcomp(data_df)</span></span>
<span><span class="co"># pca_scores &lt;- as.data.frame(pca$x)</span></span>
<span><span class="co"># plot_ly(pca_scores, x = ~PC1, y = ~PC2, z = ~PC3, type = "scatter3d", mode = "markers")</span></span>
<span><span class="co"># -------</span></span>
<span><span class="va">stim_high.df</span> <span class="op">&lt;-</span> <span class="va">df_wide</span><span class="op">[</span><span class="va">df_wide</span><span class="op">$</span><span class="va">stim_ordered</span> <span class="op">==</span> <span class="st">"stimH"</span>,<span class="op">]</span></span>
<span><span class="va">stim_low.df</span> <span class="op">&lt;-</span> <span class="va">df_wide</span><span class="op">[</span><span class="va">df_wide</span><span class="op">$</span><span class="va">stim_ordered</span> <span class="op">==</span> <span class="st">"stimL"</span>,<span class="op">]</span></span>
<span><span class="co"># selected_columns &lt;- subset(stim_high.df, select = 2:(ncol(stim_high.df) - 1))</span></span>
<span><span class="va">meanhighdf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">stim_high.df</span>, select <span class="op">=</span> <span class="fl">3</span><span class="op">:</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">stim_high.df</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">high.pca</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/prcomp.html">prcomp</a></span><span class="op">(</span><span class="va">meanhighdf</span><span class="op">)</span></span>
<span><span class="va">high.pca_scores</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="va">high.pca</span><span class="op">$</span><span class="va">x</span><span class="op">)</span></span>
<span></span>
<span><span class="va">meanlowdf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">stim_low.df</span>, select <span class="op">=</span> <span class="fl">3</span><span class="op">:</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">stim_low.df</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">low.pca</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/prcomp.html">prcomp</a></span><span class="op">(</span><span class="va">meanlowdf</span><span class="op">)</span></span>
<span><span class="va">low.pca_scores</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="va">low.pca</span><span class="op">$</span><span class="va">x</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://plotly-r.com">plotly</a></span><span class="op">)</span>  <span class="co"># You can use plotly to create an interactive 3D plot</span></span>
<span><span class="co"># plot_ly(high.pca_scores, x = ~PC1, y = ~PC2, z = ~PC3, type = "scatter3d", mode = "markers")</span></span>
<span><span class="co"># plot_ly(low.pca_scores, x = ~PC1, y = ~PC2, z = ~PC3, type = "scatter3d", mode = "markers")</span></span>
<span><span class="va">combined_pca_scores</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="va">high.pca_scores</span>, <span class="va">low.pca_scores</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Add a new column to indicate the stim_ordered category (high_stim or low_stim)</span></span>
<span><span class="va">combined_pca_scores</span><span class="op">$</span><span class="va">stim_ordered</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"high_stim"</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">high.pca_scores</span><span class="op">)</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"low_stim"</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">low.pca_scores</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create the 3D PCA plot</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/plotly/man/plot_ly.html">plot_ly</a></span><span class="op">(</span><span class="va">combined_pca_scores</span>, x <span class="op">=</span> <span class="op">~</span><span class="va">PC1</span>, y <span class="op">=</span> <span class="op">~</span><span class="va">PC2</span>, z <span class="op">=</span> <span class="op">~</span><span class="va">PC3</span>, type <span class="op">=</span> <span class="st">"scatter3d"</span>, mode <span class="op">=</span> <span class="st">"markers"</span>,</span>
<span>        color <span class="op">=</span> <span class="op">~</span><span class="va">stim_ordered</span><span class="op">)</span></span></code></pre></div>
<pre><code>## Warning in RColorBrewer::brewer.pal(N, "Set2"): minimal value for n is 3, returning requested palette with 3 different levels

## Warning in RColorBrewer::brewer.pal(N, "Set2"): minimal value for n is 3, returning requested palette with 3 different levels</code></pre>
<div class="plotly html-widget html-fill-item" id="htmlwidget-0facc382d4c9e287addd" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-0facc382d4c9e287addd">{"x":{"visdat":{"f0b40eb16a6":["function () ","plotlyVisDat"]},"cur_data":"f0b40eb16a6","attrs":{"f0b40eb16a6":{"x":{},"y":{},"z":{},"mode":"markers","color":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter3d"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"scene":{"xaxis":{"title":"PC1"},"yaxis":{"title":"PC2"},"zaxis":{"title":"PC3"}},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[-3.5788109233784819,-2.0533347388596508,-6.5336218647865598,-2.7083216152222849,-0.8237495447086165,1.0655748176928745,3.5832988818958524,5.5563725928506917,12.885062337428746,17.164931474166693,26.318430905717509,22.124327309718247,35.004207885933894,40.558945380024475,58.529141037493446,64.663134539960524,75.574527605961364,80.504681380370528,88.853870004454848,88.474313313103664,90.870391787896637,92.487071169826365,91.578581425689961,80.506727557836783,79.630063963028817,71.482883358234119,66.461675896748062,51.86721571890569,31.162107340353895,10.660676316876559,-15.439539064936159,-31.490238750398635,-63.430947755775946,-80.61203482905448,-100.8353665232453,-116.34121468973694,-128.03202901695411,-140.62301423580092,-150.52905134311825,-151.59358717604783,-145.81099929470383,-147.13235263544212],"y":[-35.799086995981995,-40.762489650462321,-51.943208835590674,-52.21806866486066,-60.020978980189966,-59.713727196356842,-63.765093576372969,-63.012208382804147,-68.154743793542835,-58.743133103019048,-48.555550398250006,-54.69018356241196,-46.069270743051106,-42.045770006073873,-27.797390325514606,-26.995409904715338,-13.916191815317477,-7.4124700487557558,11.429275355703664,17.121117406962117,26.327938273260436,42.321370478231955,42.977995658382234,56.459525411413459,63.498300398301872,71.960100980349338,64.470761099784852,49.35218716039622,51.538679580944525,40.852807250062995,38.356454462271962,36.088401666324643,38.02882853099203,34.601746501051309,36.528602437331429,31.113200797482548,26.389499705204546,18.696845742053558,10.977683013121531,12.863126172777573,1.9568677900900378,-2.2963398892233036],"z":[-20.368503983741295,-21.888162194383774,-25.968037199696546,-25.101881294833703,-23.885738856181103,-21.158121479978981,-20.622217996634834,-13.953720977137348,-13.096391751480825,-8.8966820595222647,0.34077690684816997,0.61485990703649906,14.755912745603011,21.629297858872029,27.496511515079202,34.504693974335716,33.136603233913021,38.151524374152295,35.179539959984886,27.822283474719885,20.044042082498962,18.156917899465654,14.268748250323528,11.186305471004029,2.0557724533876449,-7.3188258482323256,-18.236587362937126,-35.527744846727138,-32.706286932286204,-36.624545340348376,-40.854960187380833,-36.401260869286794,-30.051021786625803,-20.495095826176584,-3.3876880999761529,2.4659565243325599,12.892098280121754,19.634708309930531,28.388527367522538,28.101953981149173,30.437012729858221,35.279427593428707],"mode":"markers","type":"scatter3d","name":"high_stim","marker":{"color":"rgba(102,194,165,1)","line":{"color":"rgba(102,194,165,1)"}},"textfont":{"color":"rgba(102,194,165,1)"},"error_y":{"color":"rgba(102,194,165,1)"},"error_x":{"color":"rgba(102,194,165,1)"},"line":{"color":"rgba(102,194,165,1)"},"frame":null},{"x":[-27.632028230350532,-25.731525601711713,-25.299975170275072,-25.186809037560455,-23.190695001267848,-18.714852981660076,-16.55342686097643,-5.0427579982985167,-2.5890864976130286,7.1557849615622384,10.083579323217338,15.069773962025495,21.351099134012422,26.730591023251005,37.556582097691994,44.78142377883664,51.198376881716577,52.96024834403034,56.867843328561669,61.16685274269507,55.114354917589452,53.990358400640709,54.749928352466256,49.77035747808231,40.04583021963915,39.359048989428693,38.173043512008789,27.826457484642887,23.86870039769709,18.288836395540034,-2.5735371544542152,-13.433993856144752,-24.054673094068445,-39.580455144127626,-44.622157733759749,-63.459942825754887,-63.510197460095149,-70.010374365201471,-71.899606526203698,-75.272211756018677,-75.798648291621902,-71.952116138171846],"y":[-37.102745040665155,-41.340295373177149,-42.336580300145776,-39.804649201559208,-47.352420897833923,-39.330599410608592,-44.698058781433666,-45.02332243567173,-37.243082738739574,-41.662043127370012,-39.628405295853455,-41.120345561609426,-31.559728676254196,-33.969592054887684,-34.48795962747387,-36.470004295599473,-25.368378853670052,-14.531406919543105,0.70553831635619491,7.4019566042573892,18.441679983069232,31.063225606071413,33.655743143016096,32.744628795618539,33.427484144797027,33.49654443767718,35.889854547859436,42.247560240578565,43.734744530717862,43.994528304917473,47.92128378432264,43.725371341232766,37.149976316356117,34.429599696987211,29.827582968062544,24.053173425286673,18.310636228456655,21.644152022919471,18.352394324321754,15.700065016024539,16.416793762640186,8.6951010505489492],"z":[12.944966892698959,24.228006333311228,22.226845407650163,27.988087566390607,17.796756595861737,20.889840850123164,13.972857024967388,9.0928043277548305,6.6988219346300033,1.2435680706410839,-7.1896146780466461,-3.2260773933458826,-13.272562029074438,-14.122783303383567,-18.187305562670325,-22.555863326985712,-17.918953623211195,-19.312581921894708,-15.538754071029466,-15.253948888685114,-10.052919062076107,-17.038299687496391,-8.8265517205285757,-3.9878522169802624,4.6343921578681888,13.106450940197163,18.530075732600633,25.725376690627176,30.496485197553167,17.043818902974721,18.908667534385472,18.61709280667732,7.3346358511762553,4.8279529169838638,-3.159348423902379,-4.9592606700033661,-13.789468144083251,-23.349364250258592,-22.078398554948791,-29.842803707948537,-20.445587879324211,-12.199204619195617],"mode":"markers","type":"scatter3d","name":"low_stim","marker":{"color":"rgba(141,160,203,1)","line":{"color":"rgba(141,160,203,1)"}},"textfont":{"color":"rgba(141,160,203,1)"},"error_y":{"color":"rgba(141,160,203,1)"},"error_x":{"color":"rgba(141,160,203,1)"},"line":{"color":"rgba(141,160,203,1)"},"frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script><div class="sourceCode" id="cb362"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># data_matrix &lt;- groupwise[groupwise$stim_ordered == "high_stim",c("tr_ordered", "mean_per_sub_norm_mean")]</span></span>
<span><span class="co"># sorted_indices &lt;- order(data_matrix$tr_ordered)</span></span>
<span><span class="co"># df_ordered &lt;- data_matrix[sorted_indices, ]</span></span>
<span><span class="co"># pca_result &lt;- PCA(data_matrix$mean_per_sub_norm_mean)</span></span>
<span><span class="co"># datapoints &lt;- df$datapoints</span></span>
<span></span>
<span><span class="co"># Assuming you have a dataframe named 'data' containing the 20 data points, 'x' and 'y' values, and corresponding standard deviations 'sd'</span></span>
<span></span>
<span><span class="co"># Load the ggplot2 library</span></span>
<span><span class="co"># install.packages("ggplot2")</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create the plot</span></span>
<span><span class="co"># y = "mean_per_sub_mean"z</span></span>
<span><span class="co"># combined_pca &lt;- combined_pca_scores %&gt;%</span></span>
<span>  <span class="co"># mutate(group_index = group_indices(., stim_ordered))</span></span>
<span></span>
<span><span class="va">combined_pca</span> <span class="op">&lt;-</span> <span class="va">combined_pca_scores</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">stim_ordered</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>group_index <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/row_number.html">row_number</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">combined_pca</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">group_index</span>,y<span class="op">=</span><span class="va">PC1</span>, group <span class="op">=</span> <span class="va">stim_ordered</span>, colour<span class="op">=</span><span class="va">stim_ordered</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">stat_smooth</a></span><span class="op">(</span>method<span class="op">=</span><span class="st">"loess"</span>, span<span class="op">=</span><span class="fl">0.25</span>, se<span class="op">=</span><span class="cn">TRUE</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>color<span class="op">=</span><span class="va">stim_ordered</span><span class="op">)</span>, alpha<span class="op">=</span><span class="fl">0.3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code>## `geom_smooth()` using formula = 'y ~ x'</code></pre>
<div class="inline-figure"><img src="51_iv-6cond_dv-firglasserSPM_ttl2_rois_files/figure-html/unnamed-chunk-6-2.png" width="672"></div>
<div class="sourceCode" id="cb364"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Assuming you have a dataframe named 'data' containing the 20 data points, 'x' and 'y' values, and corresponding standard deviations 'sd'</span></span>
<span></span>
<span><span class="co"># Load the ggplot2 library</span></span>
<span><span class="co"># install.packages("ggplot2")</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create the plot</span></span>
<span><span class="co"># y = "mean_per_sub_mean"z</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">groupwise</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">tr_ordered</span>,y<span class="op">=</span><span class="va">mean_per_sub_mean</span>, group <span class="op">=</span> <span class="va">stim_ordered</span>, colour<span class="op">=</span><span class="va">stim_ordered</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">stat_smooth</a></span><span class="op">(</span>method<span class="op">=</span><span class="st">"loess"</span>, span<span class="op">=</span><span class="fl">0.25</span>, se<span class="op">=</span><span class="cn">TRUE</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>color<span class="op">=</span><span class="va">stim_ordered</span><span class="op">)</span>, alpha<span class="op">=</span><span class="fl">0.3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code>## `geom_smooth()` using formula = 'y ~ x'</code></pre>
<div class="inline-figure"><img src="51_iv-6cond_dv-firglasserSPM_ttl2_rois_files/figure-html/unnamed-chunk-7-1.png" width="672"></div>
<div class="sourceCode" id="cb366"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># ggplot(data=groupwise, aes(x=tr_ordered, y=mean_per_sub_mean, ymin=se, ymax=se, fill=stim_ordered, linetype=stim_ordered)) + </span></span>
<span><span class="co">#  geom_line() + </span></span>
<span><span class="co">#  geom_ribbon(alpha=0.5)  </span></span>
<span><span class="co"># Assuming you have a dataframe named 'data' containing the 20 mean data points and corresponding standard errors</span></span>
<span><span class="co"># 'x' represents the x-values (e.g., time points)</span></span>
<span><span class="co"># 'mean_y' represents the mean y-values</span></span>
<span><span class="co"># 'se_y' represents the standard errors of the mean y-values</span></span>
<span></span>
<span><span class="co"># Load the ggplot2 library</span></span>
<span><span class="co"># install.packages("ggplot2")</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span></span>
<span><span class="co"># groupwise$x &lt;- as.numeric(groupwise$x)</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># # Sort the dataframe by the 'x' variable (if it's not already sorted)</span></span>
<span><span class="co"># data &lt;- data[order(data$x), ]</span></span>
<span></span>
<span><span class="co"># Create the plot</span></span>
<span><span class="co"># Create the plot with custom span and smoothing method</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">groupwise</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">tr_ordered</span>,y<span class="op">=</span><span class="va">mean_per_sub_mean</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>                                   <span class="co"># Plot the smooth line for the mean</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html">geom_ribbon</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>ymin <span class="op">=</span> <span class="va">mean_per_sub_mean</span> <span class="op">-</span> <span class="va">se</span>, ymax <span class="op">=</span> <span class="va">mean_per_sub_mean</span> <span class="op">+</span> <span class="va">se</span><span class="op">)</span>, alpha <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span> <span class="op">+</span> <span class="co"># Add the ribbon for standard error</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"loess"</span>, span <span class="op">=</span> <span class="fl">0.1</span>, se <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span>       <span class="co"># Add the loess smoothing curve</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"X-axis Label"</span>, y <span class="op">=</span> <span class="st">"Y-axis Label"</span>, title <span class="op">=</span> <span class="st">"Smooth Line with Standard Error Ribbon"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code>## `geom_smooth()` using formula = 'y ~ x'</code></pre>
<div class="inline-figure"><img src="51_iv-6cond_dv-firglasserSPM_ttl2_rois_files/figure-html/unnamed-chunk-8-1.png" width="672"></div>
</div>
<div id="dep-epoch-stim-high-cue-vs-low-cue" class="section level2" number="13.1">
<h2>
<span class="header-section-number">13.1</span> DEP: epoch: stim, high cue vs low cue<a class="anchor" aria-label="anchor" href="#dep-epoch-stim-high-cue-vs-low-cue"><i class="fas fa-link"></i></a>
</h2>
<div class="sourceCode" id="cb368"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># filtered_df &lt;- subset(df, condition != "rating")</span></span>
<span><span class="va">filtered_df</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="op">!</span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">condition</span> <span class="op">==</span> <span class="st">"rating"</span> <span class="op">|</span> <span class="va">df</span><span class="op">$</span><span class="va">condition</span> <span class="op">==</span> <span class="st">"cue"</span><span class="op">)</span>, <span class="op">]</span></span>
<span></span>
<span><span class="va">parsed_df</span> <span class="op">&lt;-</span> <span class="va">filtered_df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">separate</span><span class="op">(</span><span class="va">condition</span>, into <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"cue"</span>, <span class="st">"stim"</span><span class="op">)</span>, sep <span class="op">=</span> <span class="st">"_"</span>, remove <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">TR_length</span> <span class="op">&lt;-</span> <span class="fl">42</span></span>
<span><span class="co"># --------------------- subset regions based on ROI ----------------------------</span></span>
<span><span class="va">df_long</span> <span class="op">&lt;-</span> <span class="fu">pivot_longer</span><span class="op">(</span><span class="va">parsed_df</span>, cols <span class="op">=</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html">starts_with</a></span><span class="op">(</span><span class="st">"tr"</span><span class="op">)</span>, names_to <span class="op">=</span> <span class="st">"tr_num"</span>, values_to <span class="op">=</span> <span class="st">"tr_value"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># ----------------------------- clean factor -----------------------------------</span></span>
<span><span class="va">df_long</span><span class="op">$</span><span class="va">tr_ordered</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span></span>
<span>        <span class="va">df_long</span><span class="op">$</span><span class="va">tr_num</span>,</span>
<span>        levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"tr"</span>, <span class="fl">1</span><span class="op">:</span><span class="va">TR_length</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span><span class="va">df_long</span><span class="op">$</span><span class="va">cue_ordered</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span></span>
<span>        <span class="va">df_long</span><span class="op">$</span><span class="va">cue</span>,</span>
<span>        levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"cueH"</span>,<span class="st">"cueL"</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span></span>
<span><span class="co"># --------------------------- summary statistics -------------------------------</span></span>
<span><span class="va">subjectwise</span> <span class="op">&lt;-</span> <span class="fu">meanSummary</span><span class="op">(</span><span class="va">df_long</span>,</span>
<span>                                      <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"sub"</span>, <span class="st">"tr_ordered"</span>, <span class="st">"cue_ordered"</span><span class="op">)</span>, <span class="st">"tr_value"</span><span class="op">)</span></span>
<span><span class="va">groupwise</span> <span class="op">&lt;-</span> <span class="fu">summarySEwithin</span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">subjectwise</span>,</span>
<span>  measurevar <span class="op">=</span> <span class="st">"mean_per_sub"</span>,</span>
<span>  withinvars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"cue_ordered"</span>, <span class="st">"tr_ordered"</span><span class="op">)</span>,</span>
<span>  idvar <span class="op">=</span> <span class="st">"sub"</span></span>
<span><span class="op">)</span></span>
<span><span class="va">groupwise</span><span class="op">$</span><span class="va">task</span> <span class="op">&lt;-</span> <span class="va">taskname</span></span>
<span><span class="co"># https://stackoverflow.com/questions/29402528/append-data-frames-together-in-a-for-loop/29419402</span></span>
<span></span>
<span><span class="co"># --------------------------------- plot ---------------------------------------</span></span>
<span><span class="va">LINEIV1</span> <span class="op">=</span> <span class="st">"tr_ordered"</span></span>
<span><span class="va">LINEIV2</span> <span class="op">=</span> <span class="st">"cue_ordered"</span></span>
<span><span class="va">MEAN</span> <span class="op">=</span> <span class="st">"mean_per_sub_norm_mean"</span></span>
<span><span class="va">ERROR</span> <span class="op">=</span> <span class="st">"se"</span></span>
<span><span class="va">dv_keyword</span> <span class="op">=</span> <span class="st">"actual"</span></span>
<span><span class="va">sorted_indices</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/order.html">order</a></span><span class="op">(</span><span class="va">groupwise</span><span class="op">$</span><span class="va">tr_ordered</span><span class="op">)</span></span>
<span><span class="va">groupwise_sorted</span> <span class="op">&lt;-</span> <span class="va">groupwise</span><span class="op">[</span><span class="va">sorted_indices</span>, <span class="op">]</span></span>
<span><span class="va">p1</span> <span class="op">=</span> <span class="fu">plot_timeseries_bar</span><span class="op">(</span><span class="va">groupwise</span>, </span>
<span>               <span class="va">LINEIV1</span>, <span class="va">LINEIV2</span>, <span class="va">MEAN</span>, <span class="va">ERROR</span>,  xlab <span class="op">=</span> <span class="st">"Runs"</span> , ylab<span class="op">=</span> <span class="st">"Epoch: stimulus, High cue vs. Low cue"</span>, ggtitle<span class="op">=</span><span class="st">"time_series"</span>, color<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"red"</span>, <span class="st">"blue"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">time_points</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0.46</span> <span class="op">*</span> <span class="va">TR_length</span>, <span class="fl">0.46</span><span class="op">)</span></span>
<span><span class="va">p1</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_discrete.html">scale_x_discrete</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/setNames.html">setNames</a></span><span class="op">(</span><span class="va">time_points</span>, <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">df_long</span><span class="op">)</span><span class="op">[</span><span class="fl">7</span><span class="op">:</span><span class="fl">7</span><span class="op">+</span><span class="va">TR_length</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_classic</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="51_iv-6cond_dv-firglasserSPM_ttl2_rois_files/figure-html/unnamed-chunk-9-1.png" width="672"></div>
</div>
<div id="taskwise-cue-effect" class="section level2" number="13.2">
<h2>
<span class="header-section-number">13.2</span> taskwise cue effect<a class="anchor" aria-label="anchor" href="#taskwise-cue-effect"><i class="fas fa-link"></i></a>
</h2>
<div class="sourceCode" id="cb369"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">roi_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'rINS'</span>, <span class="st">'TPJ'</span>, <span class="st">'dACC'</span>, <span class="st">'PHG'</span>, <span class="st">'V1'</span>, <span class="st">'SM'</span>, <span class="st">'MT'</span>, <span class="st">'RSC'</span>, <span class="st">'LOC'</span>, <span class="st">'FFC'</span>, <span class="st">'PIT'</span>, <span class="st">'pSTS'</span>, <span class="st">'AIP'</span>, <span class="st">'premotor'</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">ROI</span> <span class="kw">in</span> <span class="va">roi_list</span><span class="op">)</span> <span class="op">{</span></span>
<span>    </span>
<span>    <span class="va">datadir</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">main_dir</span>, <span class="st">"analysis/fmri/spm/fir/ttl2par"</span><span class="op">)</span></span>
<span><span class="co"># taskname = 'pain'</span></span>
<span><span class="va">exclude</span> <span class="op">&lt;-</span> <span class="st">"sub-0001"</span></span>
<span><span class="va">filename</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"sub-*"</span>,  <span class="st">"*roi-"</span>, <span class="va">ROI</span>, <span class="st">"_tr-42.csv"</span><span class="op">)</span></span>
<span>  <span class="va">common_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.glob.html">Sys.glob</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">datadir</span>, <span class="st">"sub-*"</span>,  <span class="va">filename</span></span>
<span>  <span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">filter_path</span> <span class="op">&lt;-</span> <span class="va">common_path</span><span class="op">[</span><span class="op">!</span><span class="fu">str_detect</span><span class="op">(</span><span class="va">common_path</span>, pattern <span class="op">=</span> <span class="va">exclude</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html">do.call</a></span><span class="op">(</span><span class="st">"rbind.fill"</span>, <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">filter_path</span>, FUN <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">files</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.table</a></span><span class="op">(</span><span class="va">files</span>, header <span class="op">=</span> <span class="cn">TRUE</span>, sep <span class="op">=</span> <span class="st">","</span><span class="op">)</span></span>
<span>    <span class="op">}</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">run_types</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"pain"</span>, <span class="st">"vicarious"</span>, <span class="st">"cognitive"</span><span class="op">)</span></span>
<span>  <span class="va">plot_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="va">TR_length</span> <span class="op">&lt;-</span> <span class="fl">42</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">run_type</span> <span class="kw">in</span> <span class="va">run_types</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">filtered_df</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="op">!</span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">condition</span> <span class="op">==</span> <span class="st">"rating"</span> <span class="op">|</span> <span class="va">df</span><span class="op">$</span><span class="va">condition</span> <span class="op">==</span> <span class="st">"cue"</span> <span class="op">|</span> <span class="va">df</span><span class="op">$</span><span class="va">runtype</span> <span class="op">!=</span> <span class="va">run_type</span><span class="op">)</span>, <span class="op">]</span></span>
<span></span>
<span>  <span class="va">parsed_df</span> <span class="op">&lt;-</span> <span class="va">filtered_df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu">separate</span><span class="op">(</span><span class="va">condition</span>, into <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"cue"</span>, <span class="st">"stim"</span><span class="op">)</span>, sep <span class="op">=</span> <span class="st">"_"</span>, remove <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span>  <span class="co"># --------------------- subset regions based on ROI ----------------------------</span></span>
<span>  <span class="va">df_long</span> <span class="op">&lt;-</span> <span class="fu">pivot_longer</span><span class="op">(</span><span class="va">parsed_df</span>, cols <span class="op">=</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html">starts_with</a></span><span class="op">(</span><span class="st">"tr"</span><span class="op">)</span>, names_to <span class="op">=</span> <span class="st">"tr_num"</span>, values_to <span class="op">=</span> <span class="st">"tr_value"</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># ----------------------------- clean factor -----------------------------------</span></span>
<span>  <span class="va">df_long</span><span class="op">$</span><span class="va">tr_ordered</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span></span>
<span>          <span class="va">df_long</span><span class="op">$</span><span class="va">tr_num</span>,</span>
<span>          levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"tr"</span>, <span class="fl">1</span><span class="op">:</span><span class="va">TR_length</span><span class="op">)</span><span class="op">)</span></span>
<span>      <span class="op">)</span></span>
<span><span class="va">df_long</span><span class="op">$</span><span class="va">cue_ordered</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span></span>
<span>        <span class="va">df_long</span><span class="op">$</span><span class="va">cue</span>,</span>
<span>        levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"cueH"</span>,<span class="st">"cueL"</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span></span>
<span>  <span class="co"># --------------------------- summary statistics -------------------------------</span></span>
<span>  <span class="va">subjectwise</span> <span class="op">&lt;-</span> <span class="fu">meanSummary</span><span class="op">(</span><span class="va">df_long</span>,</span>
<span>                                        <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"sub"</span>,<span class="st">"tr_ordered"</span>, <span class="st">"cue_ordered"</span><span class="op">)</span>, <span class="st">"tr_value"</span><span class="op">)</span></span>
<span>  <span class="va">groupwise</span> <span class="op">&lt;-</span> <span class="fu">summarySEwithin</span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">subjectwise</span>,</span>
<span>    measurevar <span class="op">=</span> <span class="st">"mean_per_sub"</span>,</span>
<span>    withinvars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span> <span class="st">"cue_ordered"</span>, <span class="st">"tr_ordered"</span><span class="op">)</span>,</span>
<span>    idvar <span class="op">=</span> <span class="st">"sub"</span></span>
<span>  <span class="op">)</span></span>
<span>  <span class="va">groupwise</span><span class="op">$</span><span class="va">task</span> <span class="op">&lt;-</span> <span class="va">run_type</span></span>
<span>  <span class="co"># https://stackoverflow.com/questions/29402528/append-data-frames-together-in-a-for-loop/29419402</span></span>
<span></span>
<span>  <span class="co"># ... Rest of your data processing code ...</span></span>
<span>  </span>
<span>  <span class="co"># subset &lt;- groupwise[groupwise$runtype == run_type, ]</span></span>
<span>  <span class="va">LINEIV1</span> <span class="op">=</span> <span class="st">"tr_ordered"</span></span>
<span>  <span class="va">LINEIV2</span> <span class="op">=</span> <span class="st">"cue_ordered"</span></span>
<span>  <span class="va">MEAN</span> <span class="op">=</span> <span class="st">"mean_per_sub_norm_mean"</span></span>
<span>  <span class="va">ERROR</span> <span class="op">=</span> <span class="st">"se"</span></span>
<span>  <span class="va">dv_keyword</span> <span class="op">=</span> <span class="st">"actual"</span></span>
<span>  <span class="va">sorted_indices</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/order.html">order</a></span><span class="op">(</span><span class="va">groupwise</span><span class="op">$</span><span class="va">tr_ordered</span><span class="op">)</span></span>
<span>  <span class="va">groupwise_sorted</span> <span class="op">&lt;-</span> <span class="va">groupwise</span><span class="op">[</span><span class="va">sorted_indices</span>, <span class="op">]</span></span>
<span>  <span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu">plot_timeseries_bar</span><span class="op">(</span><span class="va">groupwise_sorted</span>, </span>
<span>                            <span class="va">LINEIV1</span>, <span class="va">LINEIV2</span>, <span class="va">MEAN</span>, <span class="va">ERROR</span>,  </span>
<span>                            xlab <span class="op">=</span> <span class="st">"TRs"</span>, </span>
<span>                            ylab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">ROI</span>, <span class="st">" activation (A.U.)"</span><span class="op">)</span>, </span>
<span>                            ggtitle <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">run_type</span>, <span class="st">" time series, Epoch - stimulus"</span><span class="op">)</span>, </span>
<span>                            color <span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"red"</span>, <span class="st">"blue"</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">time_points</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0.46</span> <span class="op">*</span> <span class="va">TR_length</span>, <span class="fl">0.46</span><span class="op">)</span></span>
<span>  <span class="co">#p1 &lt;- p1 + scale_x_discrete(labels = setNames(time_points, colnames(df_long)[7:(7 + TR_length)])) + theme_classic()</span></span>
<span>  </span>
<span>  <span class="va">plot_list</span><span class="op">[[</span><span class="va">run_type</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">p1</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_classic</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span>  </span>
<span>  <span class="co"># --------------------------- plot three tasks -------------------------------</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">gridExtra</span><span class="op">)</span></span>
<span><span class="va">plot_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">plot_list</span>, <span class="kw">function</span><span class="op">(</span><span class="va">plot</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">plot</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>plot.margin <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">margin</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">5</span>, <span class="fl">5</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span>  <span class="co"># Adjust plot margins if needed</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span><span class="va">combined_plot</span> <span class="op">&lt;-</span> <span class="fu">ggpubr</span><span class="fu">::</span><span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/ggarrange.html">ggarrange</a></span><span class="op">(</span><span class="va">plot_list</span><span class="op">[[</span><span class="st">"pain"</span><span class="op">]</span><span class="op">]</span>,<span class="va">plot_list</span><span class="op">[[</span><span class="st">"vicarious"</span><span class="op">]</span><span class="op">]</span>,<span class="va">plot_list</span><span class="op">[[</span><span class="st">"cognitive"</span><span class="op">]</span><span class="op">]</span>,</span>
<span>                  common.legend <span class="op">=</span> <span class="cn">TRUE</span>,legend <span class="op">=</span> <span class="st">"bottom"</span>, ncol <span class="op">=</span> <span class="fl">3</span>, nrow <span class="op">=</span> <span class="fl">1</span>, </span>
<span>                  widths <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">3</span>, <span class="fl">3</span><span class="op">)</span>, heights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">.5</span>,<span class="fl">.5</span>,<span class="fl">.5</span><span class="op">)</span>, align <span class="op">=</span> <span class="st">"v"</span><span class="op">)</span></span>
<span><span class="va">combined_plot</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html">ggsave</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">save_dir</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"roi-"</span>, <span class="va">ROI</span>, <span class="st">"_epoch-stim_desc-highcueGTlowcue.png"</span><span class="op">)</span><span class="op">)</span>, <span class="va">combined_plot</span>, width <span class="op">=</span> <span class="fl">12</span>, height <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<div id="epoch-stim-rating" class="section level2" number="13.3">
<h2>
<span class="header-section-number">13.3</span> epoch: stim, rating<a class="anchor" aria-label="anchor" href="#epoch-stim-rating"><i class="fas fa-link"></i></a>
</h2>
</div>
<div id="epoch-6-cond" class="section level2" number="13.4">
<h2>
<span class="header-section-number">13.4</span> epoch: 6 cond<a class="anchor" aria-label="anchor" href="#epoch-6-cond"><i class="fas fa-link"></i></a>
</h2>
<div class="sourceCode" id="cb370"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># ------------------------------------------------------------------------------</span></span>
<span><span class="co">#                       epoch stim, high cue vs low cue</span></span>
<span><span class="co"># ------------------------------------------------------------------------------</span></span>
<span><span class="co"># --------------------- subset regions based on ROI ----------------------------</span></span>
<span></span>
<span><span class="co"># ----------------------------- clean factor -----------------------------------</span></span>
<span><span class="va">df_long</span><span class="op">$</span><span class="va">tr_ordered</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span></span>
<span>        <span class="va">df_long</span><span class="op">$</span><span class="va">tr_num</span>,</span>
<span>        levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"tr"</span>, <span class="fl">1</span><span class="op">:</span><span class="va">TR_length</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span><span class="va">df_long</span><span class="op">$</span><span class="va">cue_ordered</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span></span>
<span>        <span class="va">df_long</span><span class="op">$</span><span class="va">cue</span>,</span>
<span>        levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"cueH"</span>, <span class="st">"cueL"</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span><span class="va">df_long</span><span class="op">$</span><span class="va">stim_ordered</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span></span>
<span>        <span class="va">df_long</span><span class="op">$</span><span class="va">stim</span>,</span>
<span>        levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"stimH"</span>, <span class="st">"stimM"</span>, <span class="st">"stimL"</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span></span>
<span><span class="va">df_long</span><span class="op">$</span><span class="va">sixcond</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span></span>
<span>        <span class="va">df_long</span><span class="op">$</span><span class="va">condition</span>,</span>
<span>        levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"cueH_stimH"</span>, <span class="st">"cueL_stimH"</span>, </span>
<span>                   <span class="st">"cueH_stimM"</span>, <span class="st">"cueL_stimM"</span>,</span>
<span>                   <span class="st">"cueH_stimL"</span>, <span class="st">"cueL_stimL"</span><span class="op">)</span></span>
<span><span class="op">)</span> </span>
<span><span class="co"># --------------------------- summary statistics -------------------------------</span></span>
<span><span class="va">subjectwise</span> <span class="op">&lt;-</span> <span class="fu">meanSummary</span><span class="op">(</span><span class="va">df_long</span>,</span>
<span>                                      <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"sub"</span>, <span class="st">"tr_ordered"</span>, <span class="st">"sixcond"</span><span class="op">)</span>, <span class="st">"tr_value"</span><span class="op">)</span></span>
<span><span class="va">groupwise</span> <span class="op">&lt;-</span> <span class="fu">summarySEwithin</span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">subjectwise</span>,</span>
<span>  measurevar <span class="op">=</span> <span class="st">"mean_per_sub"</span>,</span>
<span>  withinvars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"sixcond"</span>, <span class="st">"tr_ordered"</span><span class="op">)</span>,</span>
<span>  idvar <span class="op">=</span> <span class="st">"sub"</span></span>
<span><span class="op">)</span></span>
<span><span class="va">groupwise</span><span class="op">$</span><span class="va">task</span> <span class="op">&lt;-</span> <span class="va">taskname</span></span>
<span><span class="co"># https://stackoverflow.com/questions/29402528/append-data-frames-together-in-a-for-loop/29419402</span></span>
<span></span>
<span><span class="co"># --------------------------------- plot ---------------------------------------</span></span>
<span><span class="va">LINEIV1</span> <span class="op">=</span> <span class="st">"tr_ordered"</span></span>
<span><span class="va">LINEIV2</span> <span class="op">=</span> <span class="st">"sixcond"</span></span>
<span><span class="va">MEAN</span> <span class="op">=</span> <span class="st">"mean_per_sub_norm_mean"</span></span>
<span><span class="va">ERROR</span> <span class="op">=</span> <span class="st">"se"</span></span>
<span><span class="va">dv_keyword</span> <span class="op">=</span> <span class="st">"actual"</span></span>
<span><span class="va">sorted_indices</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/order.html">order</a></span><span class="op">(</span><span class="va">groupwise</span><span class="op">$</span><span class="va">tr_ordered</span><span class="op">)</span></span>
<span><span class="va">groupwise_sorted</span> <span class="op">&lt;-</span> <span class="va">groupwise</span><span class="op">[</span><span class="va">sorted_indices</span>, <span class="op">]</span></span>
<span><span class="va">p3H</span> <span class="op">=</span> <span class="fu">plot_timeseries_bar</span><span class="op">(</span><span class="va">groupwise</span>, </span>
<span>               <span class="va">LINEIV1</span>, <span class="va">LINEIV2</span>, <span class="va">MEAN</span>, <span class="va">ERROR</span>,  xlab <span class="op">=</span> <span class="st">"Runs"</span> , ylab<span class="op">=</span> <span class="st">"Epoch: stimulus, High cue vs. Low cue"</span>, ggtitle<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"High intensity - Low cue vs. High cue (N = "</span>, <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">groupwise</span><span class="op">$</span><span class="va">N</span><span class="op">)</span>, <span class="st">")"</span> <span class="op">)</span>, color<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"red"</span>,<span class="st">"#5f0f40"</span>,<span class="st">"gray"</span>, <span class="st">"gray"</span>, <span class="st">"gray"</span>, <span class="st">"gray"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">time_points</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0.46</span> <span class="op">*</span> <span class="va">TR_length</span>, <span class="fl">0.46</span><span class="op">)</span></span>
<span><span class="va">p3H</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_discrete.html">scale_x_discrete</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/setNames.html">setNames</a></span><span class="op">(</span><span class="va">time_points</span>, <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">df_long</span><span class="op">)</span><span class="op">[</span><span class="fl">7</span><span class="op">:</span><span class="fl">7</span><span class="op">+</span><span class="va">TR_length</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_classic</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="51_iv-6cond_dv-firglasserSPM_ttl2_rois_files/figure-html/unnamed-chunk-12-1.png" width="672"></div>
<div class="sourceCode" id="cb371"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p3H</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_classic</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="51_iv-6cond_dv-firglasserSPM_ttl2_rois_files/figure-html/unnamed-chunk-12-2.png" width="672"></div>
<div class="sourceCode" id="cb372"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p3M</span> <span class="op">=</span> <span class="fu">plot_timeseries_bar</span><span class="op">(</span><span class="va">groupwise</span>, </span>
<span>               <span class="va">LINEIV1</span>, <span class="va">LINEIV2</span>, <span class="va">MEAN</span>, <span class="va">ERROR</span>,  xlab <span class="op">=</span> <span class="st">"Runs"</span> , ylab<span class="op">=</span> <span class="st">"Epoch: stimulus, High cue vs. Low cue"</span>, ggtitle<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"Medium intensity - Low cue vs. High cue (N = "</span>, <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">groupwise</span><span class="op">$</span><span class="va">N</span><span class="op">)</span>, <span class="st">")"</span><span class="op">)</span>, color<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"#d6d6d6"</span>,<span class="st">"#d6d6d6"</span>,<span class="st">"#bc3908"</span>, <span class="st">"#f6aa1c"</span>, <span class="st">"gray"</span>, <span class="st">"gray"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">time_points</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0.46</span> <span class="op">*</span> <span class="va">TR_length</span>, <span class="fl">0.46</span><span class="op">)</span></span>
<span><span class="va">p3M</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_discrete.html">scale_x_discrete</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/setNames.html">setNames</a></span><span class="op">(</span><span class="va">time_points</span>, <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">df_long</span><span class="op">)</span><span class="op">[</span><span class="fl">7</span><span class="op">:</span><span class="fl">7</span><span class="op">+</span><span class="va">TR_length</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_classic</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="51_iv-6cond_dv-firglasserSPM_ttl2_rois_files/figure-html/unnamed-chunk-13-1.png" width="672"></div>
<div class="sourceCode" id="cb373"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p3M</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_classic</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="51_iv-6cond_dv-firglasserSPM_ttl2_rois_files/figure-html/unnamed-chunk-13-2.png" width="672"></div>
<div class="sourceCode" id="cb374"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p3L</span> <span class="op">=</span> <span class="fu">plot_timeseries_bar</span><span class="op">(</span><span class="va">groupwise</span>, </span>
<span>               <span class="va">LINEIV1</span>, <span class="va">LINEIV2</span>, <span class="va">MEAN</span>, <span class="va">ERROR</span>,  xlab <span class="op">=</span> <span class="st">"Runs"</span> , ylab<span class="op">=</span> <span class="st">"Epoch: stimulus, High cue vs. Low cue"</span>, ggtitle<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"Low intensity - Low cue vs. High cue (N = "</span>, <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">groupwise</span><span class="op">$</span><span class="va">N</span><span class="op">)</span>, <span class="st">")"</span><span class="op">)</span>, color<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"gray"</span>,<span class="st">"gray"</span>,<span class="st">"gray"</span>, <span class="st">"gray"</span>, <span class="st">"#2541b2"</span>, <span class="st">"#00a6fb"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">time_points</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0.46</span> <span class="op">*</span> <span class="va">TR_length</span>, <span class="fl">0.46</span><span class="op">)</span></span>
<span><span class="va">p3L</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_discrete.html">scale_x_discrete</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/setNames.html">setNames</a></span><span class="op">(</span><span class="va">time_points</span>, <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">df_long</span><span class="op">)</span><span class="op">[</span><span class="fl">7</span><span class="op">:</span><span class="fl">7</span><span class="op">+</span><span class="va">TR_length</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_classic</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="51_iv-6cond_dv-firglasserSPM_ttl2_rois_files/figure-html/unnamed-chunk-14-1.png" width="672"></div>
<div class="sourceCode" id="cb375"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p3L</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_classic</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="51_iv-6cond_dv-firglasserSPM_ttl2_rois_files/figure-html/unnamed-chunk-14-2.png" width="672"></div>
</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="ch51_fir_glasserTPJttl2.html"><span class="header-section-number">12</span> [fMRI] FIR ~ task</a></div>
<div class="next"><a href="taskwise-6-cond-effect.html"><span class="header-section-number">14</span> taskwise 6 cond effect</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li>
<a class="nav-link" href="#taskwise-stim-effect"><span class="header-section-number">13</span> taskwise stim effect</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#pca-subjectwise"><span class="header-section-number">13.0.1</span> PCA subjectwise</a></li>
<li><a class="nav-link" href="#pca-groupwise"><span class="header-section-number">13.0.2</span> PCA groupwise</a></li>
</ul>
</li>
<li><a class="nav-link" href="#dep-epoch-stim-high-cue-vs-low-cue"><span class="header-section-number">13.1</span> DEP: epoch: stim, high cue vs low cue</a></li>
<li><a class="nav-link" href="#taskwise-cue-effect"><span class="header-section-number">13.2</span> taskwise cue effect</a></li>
<li><a class="nav-link" href="#epoch-stim-rating"><span class="header-section-number">13.3</span> epoch: stim, rating</a></li>
<li><a class="nav-link" href="#epoch-6-cond"><span class="header-section-number">13.4</span> epoch: 6 cond</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/jungheejung/cue_expectancy/blob/master/51_iv-6cond_dv-firglasserSPM_ttl2_rois.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/jungheejung/cue_expectancy/edit/master/51_iv-6cond_dv-firglasserSPM_ttl2_rois.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>52_ROI TTL1</strong>" was written by Heejung Jung. It was last built on 2023-08-14.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer>
</body>
</html>
