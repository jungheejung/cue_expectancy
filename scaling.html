<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 7 within / between subject effect and Scaling | Your Document Title</title>
<meta name="author" content="Your Name">
<meta name="description" content="What is the purpose of this notebook?  Here, we want to examine the between and within subject effects of subjective ratings. There are scale usage differences across individuals. It’s evident in...">
<meta name="generator" content="bookdown 0.37 with bs4_book()">
<meta property="og:title" content="Chapter 7 within / between subject effect and Scaling | Your Document Title">
<meta property="og:type" content="book">
<meta property="og:description" content="What is the purpose of this notebook?  Here, we want to examine the between and within subject effects of subjective ratings. There are scale usage differences across individuals. It’s evident in...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 7 within / between subject effect and Scaling | Your Document Title">
<meta name="twitter:description" content="What is the purpose of this notebook?  Here, we want to examine the between and within subject effects of subjective ratings. There are scale usage differences across individuals. It’s evident in...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.6.1/transition.js"></script><script src="libs/bs3compat-0.6.1/tabs.js"></script><script src="libs/bs3compat-0.6.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/htmlwidgets-1.6.4/htmlwidgets.js"></script><script src="libs/plotly-binding-4.10.4/plotly.js"></script><script src="libs/typedarray-0.1/typedarray.min.js"></script><link href="libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet">
<script src="libs/crosstalk-1.2.1/js/crosstalk.min.js"></script><link href="libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="libs/plotly-main-2.11.1/plotly-latest.min.js"></script><link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="libs/datatables-binding-0.31/datatables.js"></script><link href="libs/dt-core-1.13.6/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="libs/dt-core-1.13.6/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="libs/dt-core-1.13.6/js/jquery.dataTables.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<link rel="stylesheet" href="docute.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Your Document Title</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html"><span class="header-section-number">1</span> About</a></li>
<li class="book-part">Behavioral</li>
<li><a class="" href="beh-intro.html">Behavioral Rating analysis</a></li>
<li><a class="" href="beh-expect-cue.html"><span class="header-section-number">2</span> beh :: expectation ~ cue</a></li>
<li><a class="" href="beh-outcome-cue.html"><span class="header-section-number">3</span> beh :: outcome ~ cue</a></li>
<li><a class="" href="beh-outcome-stim.html"><span class="header-section-number">4</span> beh :: outcome ~ stim</a></li>
<li><a class="" href="beh-outcome-cueXstim.html"><span class="header-section-number">5</span> beh :: outcome ~ cue * stim</a></li>
<li><a class="" href="jepma.html"><span class="header-section-number">6</span> beh :: expect-outcome ~ cue * trial</a></li>
<li><a class="active" href="scaling.html"><span class="header-section-number">7</span> within / between subject effect and Scaling</a></li>
<li><a class="" href="variability.html"><span class="header-section-number">8</span> beh :: rating variability</a></li>
<li><a class="" href="cueeffects.html"><span class="header-section-number">9</span> beh :: Different scaling methods ~ Cue effects</a></li>
<li><a class="" href="demean-per-sub-n1.html"><span class="header-section-number">10</span> beh :: outcome_demean ~ cue * stim * expect * n-1outcome</a></li>
<li><a class="" href="mediation.html"><span class="header-section-number">11</span> beh :: Mediation</a></li>
<li><a class="" href="simulation.html"><span class="header-section-number">12</span> RL :: simulation</a></li>
<li><a class="" href="simulation_aryan.html"><span class="header-section-number">13</span> RL :: simulation Aryan</a></li>
<li><a class="" href="ch20_npssimulation.html"><span class="header-section-number">14</span> [model] NPSsimulation</a></li>
<li class="book-part">fMRI timeseries</li>
<li><a class="" href="fmri_time.html">fMRI timeseries</a></li>
<li><a class="" href="fir_ttl2.html"><span class="header-section-number">15</span> fMRI :: FIR ~ task</a></li>
<li><a class="" href="taskwise-stim-effect.html"><span class="header-section-number">16</span> taskwise stim effect</a></li>
<li><a class="" href="taskwise-6-cond-effect.html"><span class="header-section-number">17</span> taskwise 6 cond effect</a></li>
<li><a class="" href="fmritimeseries_tt1.html"><span class="header-section-number">18</span> fMRI :: FIR ~ task TTL1</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/jungheejung/cue_expectancy">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="scaling" class="section level1" number="7">
<h1>
<span class="header-section-number">7</span> within / between subject effect and Scaling<a class="anchor" aria-label="anchor" href="#scaling"><i class="fas fa-link"></i></a>
</h1>
<div id="what-is-the-purpose-of-this-notebook-4" class="section level2 unlisted unnumbered">
<h2>What is the purpose of this notebook?<a class="anchor" aria-label="anchor" href="#what-is-the-purpose-of-this-notebook-4"><i class="fas fa-link"></i></a>
</h2>
<blockquote>
<p>Here, we want to examine the between and within subject effects of subjective ratings.
There are scale usage differences across individuals. It’s evident in our behavioral data.
These scale usage differences do not really reflecting the underlying experience, but compresses the scale.
This is one of the reasons why including the between-subject term improves the performance of the mediation model.
It’s also in line with Enders and Tofighi’s illustration of centering in multilevel models.
The logic is that there are multiple components that go into subjective ratings
the way that an individual uses a scale (“between-subject effect”)
and the fact that the rating does reflect the subjective experience (“within-subject effect”)
We want to rid of the between subject effect and focus on the subjective experience.
One way to resolve this is by z-scoring.
Hypothesis: After z-scoring, if we see a high correlation across tasks in terms of their cue effects, then we can safely conclude that the way that people think of expectations are highly domain general
The cue effect from raw scores can be conflated with scale artifact and also common domain general expectation mechanisms.
Q. what about task-specific components?
Some thoughts:
* if scaling artifact is a big driving factor, that pain to brain is going to lead to a weak signal.
* within person pain effects. only weakly tracks individual differences.
/n
* Main model: <code>lmer( OUTCOME ~ EXPECT)</code> vs. <code>lmer( OUTCOME ~ zscoreEXPECT)</code>
* Main question: Does Z-scoring lead to an improvement in predicting pain? Does the effect shrink, indicating that most pain ratings are a byproduct of participants using the scale differently?
* {{ HYPOTHESES/EXPECTED OUTCOME }}
* If slopes increase after z-scoring, effects
* IV:
- {{ Zscore }} ( {{ LEVELS}} )
* DV: {{ Outcome }}</p>
</blockquote>
<div class="refbox">
<ul>
<li><a href="https://doi.org/10.1037/1082-989X.12.2.121">Enders, C. K., &amp; Tofighi, D. (2007). Centering predictor variables in cross-sectional multilevel models: A new look at an old issue. Psychological Methods, 12(2), 121–138.</a></li>
<li><a href="https://philippmasur.de/2018/05/23/how-to-center-in-multilevel-models/" class="uri">https://philippmasur.de/2018/05/23/how-to-center-in-multilevel-models/</a></li>
<li>displaying lmer in html tables: <a href="https://strengejacke.github.io/sjPlot/articles/tab_mixed.html" class="uri">https://strengejacke.github.io/sjPlot/articles/tab_mixed.html</a>
</li>
</ul>
</div>
</div>
<div id="todo-1" class="section level2" number="7.1">
<h2>
<span class="header-section-number">7.1</span> TODO:<a class="anchor" aria-label="anchor" href="#todo-1"><i class="fas fa-link"></i></a>
</h2>
<pre><code>- [x] zscore the ratings (ignore sessions)
- [x] predict outcome ratings
- [x] model compare zscore vs just raw score
- [x] include between subject level scores as covariates. AS ALWAYS
- [ ]identify why model doesn't converge for OUTCOME ~ EXPECT + (EXPECT|SUB)
It might be the zero ratings 
- [ ] Drop trials with ratings of 0. 
- [ ] raw cue effect, raw stim effect, raw cue/stimeffect, raw cue/stim + 1 effect</code></pre>
<div id="load-libraries" class="section level3 unlisted unnumbered">
<h3>load libraries<a class="anchor" aria-label="anchor" href="#load-libraries"><i class="fas fa-link"></i></a>
</h3>
</div>
</div>
<div id="computed_enderstofighi" class="section level2" number="7.2">
<h2>
<span class="header-section-number">7.2</span> computed_enderstofighi<a class="anchor" aria-label="anchor" href="#computed_enderstofighi"><i class="fas fa-link"></i></a>
</h2>
<div class="sourceCode" id="cb191"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">compute_enderstofighi</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span>, <span class="va">sub</span>, <span class="va">outcome</span>, <span class="va">expect</span>, <span class="va">ses</span>, <span class="va">run</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">maindata</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="op">!</span><span class="op">!</span><span class="fu"><a href="https://rlang.r-lib.org/reference/sym.html">sym</a></span><span class="op">(</span><span class="va">sub</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>OUTCOME <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="op">!</span><span class="op">!</span><span class="fu"><a href="https://rlang.r-lib.org/reference/sym.html">sym</a></span><span class="op">(</span><span class="va">outcome</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>EXPECT <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="op">!</span><span class="op">!</span><span class="fu"><a href="https://rlang.r-lib.org/reference/sym.html">sym</a></span><span class="op">(</span><span class="va">expect</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>OUTCOME_cm <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">OUTCOME</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>OUTCOME_demean <span class="op">=</span> <span class="va">OUTCOME</span> <span class="op">-</span> <span class="va">OUTCOME_cm</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>EXPECT_cm <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">EXPECT</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>EXPECT_demean <span class="op">=</span> <span class="va">EXPECT</span> <span class="op">-</span> <span class="va">EXPECT_cm</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="co">#mutate(OUTCOME_zscore = as.numeric(scale(OUTCOME, center = TRUE, scale = TRUE)[, 1])) %&gt;%</span></span>
<span>    <span class="co">#mutate(EXPECT_zscore = as.numeric(scale(EXPECT, center = TRUE, scale = TRUE)[, 1])) </span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>OUTCOME_zscore <span class="op">=</span> <span class="op">(</span><span class="va">OUTCOME</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">OUTCOME</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">OUTCOME</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="co">#as.numeric(scale(OUTCOME, center = TRUE, scale = TRUE)[, 1])) %&gt;%</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>EXPECT_zscore <span class="op">=</span> <span class="op">(</span><span class="va">EXPECT</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">EXPECT</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">EXPECT</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="co">#as.numeric(scale(EXPECT, center = TRUE, scale = TRUE)[, 1])) </span></span>
<span>  </span>
<span>  <span class="va">data_p2</span> <span class="op">&lt;-</span> <span class="va">maindata</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu">arrange</span><span class="op">(</span><span class="op">!</span><span class="op">!</span><span class="fu"><a href="https://rlang.r-lib.org/reference/sym.html">sym</a></span><span class="op">(</span><span class="va">sub</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="op">!</span><span class="op">!</span><span class="fu"><a href="https://rlang.r-lib.org/reference/sym.html">sym</a></span><span class="op">(</span><span class="va">sub</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>trial_index <span class="op">=</span> <span class="fu">row_number</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">data_a3</span> <span class="op">&lt;-</span> <span class="va">data_p2</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="op">!</span><span class="op">!</span><span class="fu"><a href="https://rlang.r-lib.org/reference/sym.html">sym</a></span><span class="op">(</span><span class="va">sub</span><span class="op">)</span>, <span class="op">!</span><span class="op">!</span><span class="fu"><a href="https://rlang.r-lib.org/reference/sym.html">sym</a></span><span class="op">(</span><span class="va">ses</span><span class="op">)</span>, <span class="op">!</span><span class="op">!</span><span class="fu"><a href="https://rlang.r-lib.org/reference/sym.html">sym</a></span><span class="op">(</span><span class="va">run</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>trial_index <span class="op">=</span> <span class="fu">row_number</span><span class="op">(</span><span class="op">!</span><span class="op">!</span><span class="fu"><a href="https://rlang.r-lib.org/reference/sym.html">sym</a></span><span class="op">(</span><span class="va">run</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">data_a3lag</span> <span class="op">&lt;-</span> <span class="va">data_a3</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="op">!</span><span class="op">!</span><span class="fu"><a href="https://rlang.r-lib.org/reference/sym.html">sym</a></span><span class="op">(</span><span class="va">sub</span><span class="op">)</span>, <span class="op">!</span><span class="op">!</span><span class="fu"><a href="https://rlang.r-lib.org/reference/sym.html">sym</a></span><span class="op">(</span><span class="va">ses</span><span class="op">)</span>, <span class="op">!</span><span class="op">!</span><span class="fu"><a href="https://rlang.r-lib.org/reference/sym.html">sym</a></span><span class="op">(</span><span class="va">run</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>lag.OUTCOME_demean <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/lead-lag.html">lag</a></span><span class="op">(</span><span class="va">OUTCOME_demean</span>, n <span class="op">=</span> <span class="fl">1</span>, default <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Create Subjectwise Mean, centered in relation to the group mean</span></span>
<span>  <span class="va">data_a3cmc</span> <span class="op">&lt;-</span> <span class="va">data_a3lag</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="va">ungroup</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>EXPECT_cmc <span class="op">=</span> <span class="va">EXPECT_cm</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">EXPECT_cm</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>OUTCOME_cmc <span class="op">=</span> <span class="va">OUTCOME_cm</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">OUTCOME_cm</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span>  </span>
<span>  <span class="co"># Remove NA values ___________________________________________________________</span></span>
<span>  <span class="va">data_centered_NA</span> <span class="op">&lt;-</span> <span class="va">data_a3cmc</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">OUTCOME</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="co"># Remove NA values</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">EXPECT</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">data_centered_NA</span><span class="op">)</span></span>
<span>  </span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<div id="analysis-1-pain-display-distribution-of-data" class="section level2" number="7.3">
<h2>
<span class="header-section-number">7.3</span> Analysis 1: Pain display distribution of data<a class="anchor" aria-label="anchor" href="#analysis-1-pain-display-distribution-of-data"><i class="fas fa-link"></i></a>
</h2>
<p>Let’s look at the distribution of the data. X axis: Y axis:
Here’s the loaded dataset, filtered if Outcome Ratings have NA</p>
<div class="sourceCode" id="cb192"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># remove NA values first</span></span>
<span><span class="va">df.centered_NA</span> <span class="op">&lt;-</span> <span class="va">data_centered</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">OUTCOME</span><span class="op">)</span><span class="op">)</span>  <span class="co"># Remove NA values</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">df.centered_NA</span><span class="op">)</span></span></code></pre></div>
<pre><code>## # A tibble: 6 × 75
##   src_subject_id session_id param_task_name param_run_num param_counterbalance…¹
##            &lt;int&gt;      &lt;int&gt; &lt;chr&gt;                   &lt;int&gt;                  &lt;int&gt;
## 1              2          1 pain                        1                      3
## 2              2          1 pain                        1                      3
## 3              2          1 pain                        1                      3
## 4              2          1 pain                        1                      3
## 5              2          1 pain                        1                      3
## 6              2          1 pain                        1                      3
## # ℹ abbreviated name: ¹​param_counterbalance_ver
## # ℹ 70 more variables: param_counterbalance_block_num &lt;int&gt;,
## #   param_cue_type &lt;chr&gt;, param_stimulus_type &lt;chr&gt;, param_cond_type &lt;int&gt;,
## #   param_trigger_onset &lt;dbl&gt;, param_start_biopac &lt;dbl&gt;, ITI_onset &lt;dbl&gt;,
## #   ITI_biopac &lt;dbl&gt;, ITI_duration &lt;dbl&gt;, event01_cue_onset &lt;dbl&gt;,
## #   event01_cue_biopac &lt;dbl&gt;, event01_cue_type &lt;chr&gt;,
## #   event01_cue_filename &lt;chr&gt;, ISI01_onset &lt;dbl&gt;, ISI01_biopac &lt;dbl&gt;, …</code></pre>
<div id="plot-outcome-rating-distribution" class="section level3" number="7.3.1">
<h3>
<span class="header-section-number">7.3.1</span> Plot Outcome rating distribution<a class="anchor" aria-label="anchor" href="#plot-outcome-rating-distribution"><i class="fas fa-link"></i></a>
</h3>
<p>Ratings are sorted based on Median values of Outcome rating</p>
</div>
<div id="identify-subjects-with-narrow-iqr" class="section level3" number="7.3.2">
<h3>
<span class="header-section-number">7.3.2</span> Identify subjects with narrow IQR<a class="anchor" aria-label="anchor" href="#identify-subjects-with-narrow-iqr"><i class="fas fa-link"></i></a>
</h3>
<p>I plan to use this to filter out participants</p>
<div class="sourceCode" id="cb194"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Assuming df.centered_NA is your dataframe and it's already loaded</span></span>
<span></span>
<span><span class="co"># Task 1: Top and Bottom 5% Subjects</span></span>
<span><span class="va">sorted_data</span> <span class="op">&lt;-</span> <span class="va">df.centered_NA</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">subject</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span>median_outcome <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span><span class="op">(</span><span class="va">OUTCOME</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="va">median_outcome</span><span class="op">)</span></span>
<span></span>
<span><span class="va">num_subjects</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">sorted_data</span><span class="op">)</span></span>
<span><span class="va">top_bottom_count</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">ceiling</a></span><span class="op">(</span><span class="va">num_subjects</span> <span class="op">*</span> <span class="fl">0.05</span><span class="op">)</span></span>
<span></span>
<span><span class="va">top_5_percent_subjects</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">sorted_data</span>, <span class="va">top_bottom_count</span><span class="op">)</span><span class="op">$</span><span class="va">subject</span></span>
<span><span class="va">bottom_5_percent_subjects</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html">tail</a></span><span class="op">(</span><span class="va">sorted_data</span>, <span class="va">top_bottom_count</span><span class="op">)</span><span class="op">$</span><span class="va">subject</span></span>
<span></span>
<span><span class="co"># Task 2: Narrow IQR Subjects</span></span>
<span><span class="va">iqr_data</span> <span class="op">&lt;-</span> <span class="va">df.centered_NA</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">subject</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span>IQR <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/IQR.html">IQR</a></span><span class="op">(</span><span class="va">OUTCOME</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="va">IQR</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Output the subjects</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"Top 5% Subjects based on Median Outcome:\n"</span>, <span class="fu"><a href="https://rdrr.io/r/base/toString.html">toString</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">top_5_percent_subjects</span><span class="op">)</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span></code></pre></div>
<pre><code>## Top 5% Subjects based on Median Outcome:
##  3, 4, 5, 60, 130, 19</code></pre>
<div class="sourceCode" id="cb196"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"Bottom 5% Subjects based on Median Outcome:\n"</span>, <span class="fu"><a href="https://rdrr.io/r/base/toString.html">toString</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">bottom_5_percent_subjects</span><span class="op">)</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span></code></pre></div>
<pre><code>## Bottom 5% Subjects based on Median Outcome:
##  74, 46, 32, 15, 9, 50</code></pre>
<div class="sourceCode" id="cb198"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># If you want to see the subjects with the narrowest IQRs</span></span>
<span><span class="co"># cat("Subjects with the Narrowest IQRs:\n", head(iqr_data)$subject, "\n")</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"Subjects with the Narrowest IQRs:\n"</span>, <span class="fu"><a href="https://rdrr.io/r/base/toString.html">toString</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">iqr_data</span><span class="op">)</span><span class="op">$</span><span class="va">subject</span><span class="op">)</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span></code></pre></div>
<pre><code>## Subjects with the Narrowest IQRs:
##  117, 85, 66, 29, 63, 123</code></pre>
<div class="sourceCode" id="cb200"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">narrowest_iqr_string</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">'"'</span>, <span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">iqr_data</span><span class="op">)</span><span class="op">$</span><span class="va">subject</span><span class="op">)</span>, <span class="st">'"'</span>, collapse <span class="op">=</span> <span class="st">", "</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"Subjects with the Narrowest IQRs:\n"</span>, <span class="va">narrowest_iqr_string</span>, <span class="st">"\n"</span><span class="op">)</span></span></code></pre></div>
<pre><code>## Subjects with the Narrowest IQRs:
##  "117", "85", "66", "29", "63", "123"</code></pre>
<div class="sourceCode" id="cb202"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># head(iqr_data)$subject</span></span>
<span></span>
<span><span class="co"># Create filter string based on narrow variability</span></span>
<span><span class="va">subject_ids</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">iqr_data</span><span class="op">)</span><span class="op">$</span><span class="va">subject</span><span class="op">)</span></span>
<span><span class="va">formatted_subjects</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"sub-"</span>, <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span><span class="op">(</span><span class="st">"%04d"</span>, <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">subject_ids</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">filter_string</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="va">formatted_subjects</span>, collapse <span class="op">=</span> <span class="st">"|"</span><span class="op">)</span></span>
<span><span class="va">filter_string</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"sub-0001|"</span>, <span class="va">filter_string</span><span class="op">)</span></span>
<span><span class="co"># Output the filter string</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"Filter String: "</span>, <span class="va">filter_string</span>, <span class="st">"\n"</span><span class="op">)</span></span></code></pre></div>
<pre><code>## Filter String:  sub-0001|sub-0117|sub-0085|sub-0066|sub-0029|sub-0063|sub-0123</code></pre>
</div>
</div>
<div id="analysis-2-z-score-vs.-not-model-comparison" class="section level2" number="7.4">
<h2>
<span class="header-section-number">7.4</span> Analysis 2: Z score vs. not model comparison<a class="anchor" aria-label="anchor" href="#analysis-2-z-score-vs.-not-model-comparison"><i class="fas fa-link"></i></a>
</h2>
<div id="lmer-model-compare-z-score-vs-nonzscore" class="section level3 unnumbered">
<h3>lmer model compare z score vs nonzscore<a class="anchor" aria-label="anchor" href="#lmer-model-compare-z-score-vs-nonzscore"><i class="fas fa-link"></i></a>
</h3>
<p>Q. how do the coefficients change as a function of Z scoring vs not?</p>
<div class="sourceCode" id="cb204"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model.z</span> <span class="op">&lt;-</span> <span class="fu">lmer</span><span class="op">(</span><span class="va">OUTCOME</span> <span class="op">~</span> <span class="va">EXPECT_zscore</span> <span class="op">+</span> <span class="op">(</span><span class="va">EXPECT_zscore</span><span class="op">|</span><span class="va">subject</span><span class="op">)</span>, <span class="va">df.centered_NA</span><span class="op">)</span></span>
<span><span class="va">model.nonz</span> <span class="op">&lt;-</span> <span class="fu">lmer</span><span class="op">(</span><span class="va">OUTCOME</span> <span class="op">~</span> <span class="va">EXPECT</span> <span class="op">+</span> <span class="op">(</span><span class="va">EXPECT</span><span class="op">|</span><span class="va">subject</span><span class="op">)</span>, <span class="va">df.centered_NA</span><span class="op">)</span></span></code></pre></div>
<pre><code>## Warning in checkConv(attr(opt, "derivs"), opt$par, ctrl = control$checkConv, :
## Model failed to converge with max|grad| = 4.21058 (tol = 0.002, component 1)</code></pre>
<pre><code>## Warning in checkConv(attr(opt, "derivs"), opt$par, ctrl = control$checkConv, : Model is nearly unidentifiable: very large eigenvalue
##  - Rescale variables?</code></pre>
<div class="sourceCode" id="cb207"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model.cmc</span> <span class="op">&lt;-</span> <span class="fu">lmer</span><span class="op">(</span><span class="va">OUTCOME</span> <span class="op">~</span> <span class="va">EXPECT_demean</span> <span class="op">+</span> <span class="va">EXPECT_cmc</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">subject</span><span class="op">)</span>, <span class="va">df.centered_NA</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">print_dash</span><span class="op">(</span><span class="st">"model with Z scores"</span><span class="op">)</span></span></code></pre></div>
<pre><code>## 
## 
## ----------------------------------------
## model with Z scores
## ----------------------------------------</code></pre>
<div class="sourceCode" id="cb209"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">model.z</span><span class="op">)</span></span></code></pre></div>
<pre><code>## Linear mixed model fit by REML. t-tests use Satterthwaite's method [
## lmerModLmerTest]
## Formula: OUTCOME ~ EXPECT_zscore + (EXPECT_zscore | subject)
##    Data: df.centered_NA
## 
## REML criterion at convergence: 53494.5
## 
## Scaled residuals: 
##     Min      1Q  Median      3Q     Max 
## -4.5605 -0.5920  0.0064  0.5904  4.3988 
## 
## Random effects:
##  Groups   Name          Variance Std.Dev. Corr
##  subject  (Intercept)   877.15   29.62        
##           EXPECT_zscore  48.44    6.96    0.16
##  Residual               507.09   22.52        
## Number of obs: 5825, groups:  subject, 114
## 
## Fixed effects:
##               Estimate Std. Error       df t value Pr(&gt;|t|)    
## (Intercept)    64.4462     2.7981 113.2011  23.032   &lt;2e-16 ***
## EXPECT_zscore   7.1939     0.7309 115.3281   9.842   &lt;2e-16 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Correlation of Fixed Effects:
##             (Intr)
## EXPECT_zscr 0.142</code></pre>
<div class="sourceCode" id="cb211"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">print_dash</span><span class="op">(</span><span class="st">"model with raw scores, i.e. non Zscores"</span><span class="op">)</span></span></code></pre></div>
<pre><code>## 
## 
## ----------------------------------------
## model with raw scores, i.e. non Zscores
## ----------------------------------------</code></pre>
<div class="sourceCode" id="cb213"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">model.nonz</span><span class="op">)</span></span></code></pre></div>
<pre><code>## Linear mixed model fit by REML. t-tests use Satterthwaite's method [
## lmerModLmerTest]
## Formula: OUTCOME ~ EXPECT + (EXPECT | subject)
##    Data: df.centered_NA
## 
## REML criterion at convergence: 53378.1
## 
## Scaled residuals: 
##     Min      1Q  Median      3Q     Max 
## -4.5878 -0.5923  0.0121  0.5977  4.4260 
## 
## Random effects:
##  Groups   Name        Variance  Std.Dev. Corr 
##  subject  (Intercept) 869.44478 29.4863       
##           EXPECT        0.03975  0.1994  -0.58
##  Residual             503.76679 22.4447       
## Number of obs: 5825, groups:  subject, 114
## 
## Fixed effects:
##             Estimate Std. Error       df t value Pr(&gt;|t|)    
## (Intercept) 47.20152    2.89746 56.84800   16.29   &lt;2e-16 ***
## EXPECT       0.28268    0.02266 87.47735   12.47   &lt;2e-16 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Correlation of Fixed Effects:
##        (Intr)
## EXPECT -0.597
## optimizer (nloptwrap) convergence code: 0 (OK)
## Model failed to converge with max|grad| = 4.21058 (tol = 0.002, component 1)
## Model is nearly unidentifiable: very large eigenvalue
##  - Rescale variables?</code></pre>
<div class="sourceCode" id="cb215"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">print_dash</span><span class="op">(</span><span class="st">"model with raw scores CMC and CWC"</span><span class="op">)</span></span></code></pre></div>
<pre><code>## 
## 
## ----------------------------------------
## model with raw scores CMC and CWC
## ----------------------------------------</code></pre>
<div class="sourceCode" id="cb217"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">model.cmc</span><span class="op">)</span></span></code></pre></div>
<pre><code>## Linear mixed model fit by REML. t-tests use Satterthwaite's method [
## lmerModLmerTest]
## Formula: OUTCOME ~ EXPECT_demean + EXPECT_cmc + (1 | subject)
##    Data: df.centered_NA
## 
## REML criterion at convergence: 53537.7
## 
## Scaled residuals: 
##     Min      1Q  Median      3Q     Max 
## -4.3594 -0.6055  0.0008  0.6163  4.8740 
## 
## Random effects:
##  Groups   Name        Variance Std.Dev.
##  subject  (Intercept) 159.3    12.62   
##  Residual             544.4    23.33   
## Number of obs: 5825, groups:  subject, 114
## 
## Fixed effects:
##                Estimate Std. Error        df t value Pr(&gt;|t|)    
## (Intercept)   6.474e+01  1.234e+00 1.114e+02   52.48   &lt;2e-16 ***
## EXPECT_demean 2.964e-01  1.072e-02 5.712e+03   27.64   &lt;2e-16 ***
## EXPECT_cmc    9.203e-01  4.250e-02 1.109e+02   21.65   &lt;2e-16 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Correlation of Fixed Effects:
##             (Intr) EXPECT_d
## EXPECT_demn -0.001         
## EXPECT_cmc   0.007  0.001</code></pre>
<div class="sourceCode" id="cb219"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">print_dash</span><span class="op">(</span><span class="st">"model comparison"</span><span class="op">)</span></span></code></pre></div>
<pre><code>## 
## 
## ----------------------------------------
## model comparison
## ----------------------------------------</code></pre>
<div class="sourceCode" id="cb221"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="va">model.z</span>, <span class="va">model.nonz</span><span class="op">)</span></span></code></pre></div>
<pre><code>## refitting model(s) with ML (instead of REML)</code></pre>
<pre><code>## Data: df.centered_NA
## Models:
## model.z: OUTCOME ~ EXPECT_zscore + (EXPECT_zscore | subject)
## model.nonz: OUTCOME ~ EXPECT + (EXPECT | subject)
##            npar   AIC   BIC logLik deviance  Chisq Df Pr(&gt;Chisq)
## model.z       6 53512 53552 -26750    53500                     
## model.nonz    6 53380 53420 -26684    53368 131.43  0</code></pre>
</div>
<div id="plot-subjectwise-slopes-of-zscore-and-nonzscore" class="section level3" number="7.4.1">
<h3>
<span class="header-section-number">7.4.1</span> plot :: subjectwise slopes of Zscore and nonZscore<a class="anchor" aria-label="anchor" href="#plot-subjectwise-slopes-of-zscore-and-nonzscore"><i class="fas fa-link"></i></a>
</h3>
<p>TODO: change color scheme and increase figure size</p>
</div>
</div>
<div id="analysis-3-across-pvc-are-these-expectation-effects-domain-general-or-domain-specific" class="section level2" number="7.5">
<h2>
<span class="header-section-number">7.5</span> Analysis 3: across PVC, Are these expectation effects domain-general or domain-specific?<a class="anchor" aria-label="anchor" href="#analysis-3-across-pvc-are-these-expectation-effects-domain-general-or-domain-specific"><i class="fas fa-link"></i></a>
</h2>
<div id="load-entire-data-of-painvicariouscognitive" class="section level3 unlisted unnumbered">
<h3>load entire data of pain,vicarious,cognitive<a class="anchor" aria-label="anchor" href="#load-entire-data-of-painvicariouscognitive"><i class="fas fa-link"></i></a>
</h3>
</div>
</div>
<div id="validate-correlation-matrix-across-centered-variables" class="section level2" number="7.6">
<h2>
<span class="header-section-number">7.6</span> Validate: correlation matrix across centered variables<a class="anchor" aria-label="anchor" href="#validate-correlation-matrix-across-centered-variables"><i class="fas fa-link"></i></a>
</h2>
<p>::::{.todolist}The zscores do not seem to be scaled within participant.
Let’s check what’s going on.
The mean value should be 0 for all participants
::::</p>
<div class="sourceCode" id="cb224"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">df.PVC_center</span><span class="op">)</span></span></code></pre></div>
<pre><code>## # A tibble: 6 × 33
##   src_subject_id session_id param_run_num param_task_name event02_expect_angle
##            &lt;int&gt;      &lt;int&gt;         &lt;int&gt; &lt;chr&gt;                          &lt;dbl&gt;
## 1              2          1             1 pain                            5.53
## 2              2          1             1 pain                           18.9 
## 3              2          1             1 pain                          103.  
## 4              2          1             1 pain                           81.2 
## 5              2          1             1 pain                           97.2 
## 6              2          1             1 pain                          117.  
## # ℹ 28 more variables: param_cue_type &lt;chr&gt;, param_stimulus_type &lt;chr&gt;,
## #   event04_actual_angle &lt;dbl&gt;, trial_index &lt;int&gt;, trial_count_sub &lt;int&gt;,
## #   trial_ind &lt;dbl&gt;, sub &lt;chr&gt;, ses &lt;chr&gt;, run &lt;chr&gt;, runtype &lt;chr&gt;,
## #   task &lt;chr&gt;, trial_sub &lt;int&gt;, trial &lt;chr&gt;, cuetype &lt;chr&gt;,
## #   stimintensity &lt;chr&gt;, DEPc &lt;chr&gt;, DEP &lt;chr&gt;, OUTCOME &lt;dbl&gt;, EXPECT &lt;dbl&gt;,
## #   OUTCOME_cm &lt;dbl&gt;, OUTCOME_demean &lt;dbl&gt;, EXPECT_cm &lt;dbl&gt;,
## #   EXPECT_demean &lt;dbl&gt;, OUTCOME_zscore &lt;dbl&gt;, EXPECT_zscore &lt;dbl&gt;, …</code></pre>
<div class="sourceCode" id="cb226"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Assuming df is your dataframe, and 'participant', 'col1', 'col2', 'col3' are your column names</span></span>
<span><span class="va">df.PVC_center</span><span class="op">$</span><span class="va">subject</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">df.PVC_center</span><span class="op">$</span><span class="va">sub</span><span class="op">)</span></span>
<span><span class="va">df.PVC_center</span><span class="op">$</span><span class="va">OUTCOME</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">df.PVC_center</span><span class="op">$</span><span class="va">OUTCOME</span><span class="op">)</span></span>
<span><span class="va">df.PVC_center</span><span class="op">$</span><span class="va">EXPECT_cmc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">df.PVC_center</span><span class="op">$</span><span class="va">EXPECT_cmc</span><span class="op">)</span></span>
<span><span class="va">df.PVC_center</span><span class="op">$</span><span class="va">EXPECT_demean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">df.PVC_center</span><span class="op">$</span><span class="va">EXPECT_demean</span><span class="op">)</span></span>
<span><span class="va">correlation_matrix_per_participant</span> <span class="op">&lt;-</span> <span class="va">df.PVC_center</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">sub</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span></span>
<span>    cor_matrix <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span><span class="va">.</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"OUTCOME"</span>, <span class="st">"EXPECT_cmc"</span>, <span class="st">"EXPECT_demean"</span>, <span class="st">"EXPECT_zscore"</span><span class="op">)</span><span class="op">]</span>, </span>
<span>                        use <span class="op">=</span> <span class="st">"complete.obs"</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co"># To view the correlation matrix for the first participant</span></span>
<span><span class="co"># correlation_matrix_per_participant$cor_matrix[[1]]</span></span>
<span></span>
<span><span class="co"># plot correlatin matrix _______________________________________________________</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/hadley/reshape">reshape2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Assuming correlation_matrix_per_participant is the result from the previous step</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">correlation_matrix_per_participant</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">participant_id</span> <span class="op">&lt;-</span> <span class="va">correlation_matrix_per_participant</span><span class="op">$</span><span class="va">sub</span><span class="op">[</span><span class="va">i</span><span class="op">]</span></span>
<span>  <span class="va">cor_matrix</span> <span class="op">&lt;-</span> <span class="va">correlation_matrix_per_participant</span><span class="op">$</span><span class="va">cor_matrix</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span></span>
<span></span>
<span>  <span class="co"># Convert the correlation matrix to long format</span></span>
<span>  <span class="va">long_cor_matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/reshape2/man/melt.html">melt</a></span><span class="op">(</span><span class="va">cor_matrix</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">long_cor_matrix</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Var1"</span>, <span class="st">"Var2"</span>, <span class="st">"value"</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># Plotting</span></span>
<span>  <span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">long_cor_matrix</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">Var1</span>, <span class="va">Var2</span>, fill <span class="op">=</span> <span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html">geom_tile</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html">scale_fill_gradient2</a></span><span class="op">(</span>low <span class="op">=</span> <span class="st">"blue"</span>, high <span class="op">=</span> <span class="st">"red"</span>, mid <span class="op">=</span> <span class="st">"white"</span>, </span>
<span>                         midpoint <span class="op">=</span> <span class="fl">0</span>, limit <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>, space <span class="op">=</span> <span class="st">"Lab"</span>, </span>
<span>                         name<span class="op">=</span><span class="st">"Correlation"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Correlation Matrix for Participant"</span>, <span class="va">participant_id</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p><img src="09_scaling_files/figure-html/unnamed-chunk-10-1.png" width="672"><img src="09_scaling_files/figure-html/unnamed-chunk-10-2.png" width="672"><img src="09_scaling_files/figure-html/unnamed-chunk-10-3.png" width="672"><img src="09_scaling_files/figure-html/unnamed-chunk-10-4.png" width="672"><img src="09_scaling_files/figure-html/unnamed-chunk-10-5.png" width="672"><img src="09_scaling_files/figure-html/unnamed-chunk-10-6.png" width="672"><img src="09_scaling_files/figure-html/unnamed-chunk-10-7.png" width="672"><img src="09_scaling_files/figure-html/unnamed-chunk-10-8.png" width="672"><img src="09_scaling_files/figure-html/unnamed-chunk-10-9.png" width="672"><img src="09_scaling_files/figure-html/unnamed-chunk-10-10.png" width="672"><img src="09_scaling_files/figure-html/unnamed-chunk-10-11.png" width="672"><img src="09_scaling_files/figure-html/unnamed-chunk-10-12.png" width="672"><img src="09_scaling_files/figure-html/unnamed-chunk-10-13.png" width="672"><img src="09_scaling_files/figure-html/unnamed-chunk-10-14.png" width="672"><img src="09_scaling_files/figure-html/unnamed-chunk-10-15.png" width="672"><img src="09_scaling_files/figure-html/unnamed-chunk-10-16.png" width="672"><img src="09_scaling_files/figure-html/unnamed-chunk-10-17.png" width="672"><img src="09_scaling_files/figure-html/unnamed-chunk-10-18.png" width="672"><img src="09_scaling_files/figure-html/unnamed-chunk-10-19.png" width="672"><img src="09_scaling_files/figure-html/unnamed-chunk-10-20.png" width="672"><img src="09_scaling_files/figure-html/unnamed-chunk-10-21.png" width="672"><img src="09_scaling_files/figure-html/unnamed-chunk-10-22.png" width="672"><img src="09_scaling_files/figure-html/unnamed-chunk-10-23.png" width="672"><img src="09_scaling_files/figure-html/unnamed-chunk-10-24.png" width="672"><img src="09_scaling_files/figure-html/unnamed-chunk-10-25.png" width="672"><img src="09_scaling_files/figure-html/unnamed-chunk-10-26.png" width="672"><img src="09_scaling_files/figure-html/unnamed-chunk-10-27.png" width="672"><img src="09_scaling_files/figure-html/unnamed-chunk-10-28.png" width="672"><img src="09_scaling_files/figure-html/unnamed-chunk-10-29.png" width="672"><img src="09_scaling_files/figure-html/unnamed-chunk-10-30.png" width="672"><img src="09_scaling_files/figure-html/unnamed-chunk-10-31.png" width="672"><img src="09_scaling_files/figure-html/unnamed-chunk-10-32.png" width="672"><img src="09_scaling_files/figure-html/unnamed-chunk-10-33.png" width="672"><img src="09_scaling_files/figure-html/unnamed-chunk-10-34.png" width="672"><img src="09_scaling_files/figure-html/unnamed-chunk-10-35.png" width="672"><img src="09_scaling_files/figure-html/unnamed-chunk-10-36.png" width="672"><img src="09_scaling_files/figure-html/unnamed-chunk-10-37.png" width="672"><img src="09_scaling_files/figure-html/unnamed-chunk-10-38.png" width="672"><img src="09_scaling_files/figure-html/unnamed-chunk-10-39.png" width="672"><img src="09_scaling_files/figure-html/unnamed-chunk-10-40.png" width="672"><img src="09_scaling_files/figure-html/unnamed-chunk-10-41.png" width="672"><img src="09_scaling_files/figure-html/unnamed-chunk-10-42.png" width="672"><img src="09_scaling_files/figure-html/unnamed-chunk-10-43.png" width="672"><img src="09_scaling_files/figure-html/unnamed-chunk-10-44.png" width="672"><img src="09_scaling_files/figure-html/unnamed-chunk-10-45.png" width="672"><img src="09_scaling_files/figure-html/unnamed-chunk-10-46.png" width="672"><img src="09_scaling_files/figure-html/unnamed-chunk-10-47.png" width="672"><img src="09_scaling_files/figure-html/unnamed-chunk-10-48.png" width="672"><img src="09_scaling_files/figure-html/unnamed-chunk-10-49.png" width="672"><img src="09_scaling_files/figure-html/unnamed-chunk-10-50.png" width="672"><img src="09_scaling_files/figure-html/unnamed-chunk-10-51.png" width="672"><img src="09_scaling_files/figure-html/unnamed-chunk-10-52.png" width="672"><img src="09_scaling_files/figure-html/unnamed-chunk-10-53.png" width="672"><img src="09_scaling_files/figure-html/unnamed-chunk-10-54.png" width="672"><img src="09_scaling_files/figure-html/unnamed-chunk-10-55.png" width="672"><img src="09_scaling_files/figure-html/unnamed-chunk-10-56.png" width="672"><img src="09_scaling_files/figure-html/unnamed-chunk-10-57.png" width="672"><img src="09_scaling_files/figure-html/unnamed-chunk-10-58.png" width="672"><img src="09_scaling_files/figure-html/unnamed-chunk-10-59.png" width="672"><img src="09_scaling_files/figure-html/unnamed-chunk-10-60.png" width="672"><img src="09_scaling_files/figure-html/unnamed-chunk-10-61.png" width="672"><img src="09_scaling_files/figure-html/unnamed-chunk-10-62.png" width="672"><img src="09_scaling_files/figure-html/unnamed-chunk-10-63.png" width="672"><img src="09_scaling_files/figure-html/unnamed-chunk-10-64.png" width="672"><img src="09_scaling_files/figure-html/unnamed-chunk-10-65.png" width="672"><img src="09_scaling_files/figure-html/unnamed-chunk-10-66.png" width="672"><img src="09_scaling_files/figure-html/unnamed-chunk-10-67.png" width="672"><img src="09_scaling_files/figure-html/unnamed-chunk-10-68.png" width="672"><img src="09_scaling_files/figure-html/unnamed-chunk-10-69.png" width="672"><img src="09_scaling_files/figure-html/unnamed-chunk-10-70.png" width="672"><img src="09_scaling_files/figure-html/unnamed-chunk-10-71.png" width="672"><img src="09_scaling_files/figure-html/unnamed-chunk-10-72.png" width="672"><img src="09_scaling_files/figure-html/unnamed-chunk-10-73.png" width="672"><img src="09_scaling_files/figure-html/unnamed-chunk-10-74.png" width="672"><img src="09_scaling_files/figure-html/unnamed-chunk-10-75.png" width="672"><img src="09_scaling_files/figure-html/unnamed-chunk-10-76.png" width="672"><img src="09_scaling_files/figure-html/unnamed-chunk-10-77.png" width="672"><img src="09_scaling_files/figure-html/unnamed-chunk-10-78.png" width="672"><img src="09_scaling_files/figure-html/unnamed-chunk-10-79.png" width="672"><img src="09_scaling_files/figure-html/unnamed-chunk-10-80.png" width="672"><img src="09_scaling_files/figure-html/unnamed-chunk-10-81.png" width="672"><img src="09_scaling_files/figure-html/unnamed-chunk-10-82.png" width="672"><img src="09_scaling_files/figure-html/unnamed-chunk-10-83.png" width="672"><img src="09_scaling_files/figure-html/unnamed-chunk-10-84.png" width="672"><img src="09_scaling_files/figure-html/unnamed-chunk-10-85.png" width="672"><img src="09_scaling_files/figure-html/unnamed-chunk-10-86.png" width="672"><img src="09_scaling_files/figure-html/unnamed-chunk-10-87.png" width="672"><img src="09_scaling_files/figure-html/unnamed-chunk-10-88.png" width="672"><img src="09_scaling_files/figure-html/unnamed-chunk-10-89.png" width="672"><img src="09_scaling_files/figure-html/unnamed-chunk-10-90.png" width="672"><img src="09_scaling_files/figure-html/unnamed-chunk-10-91.png" width="672"><img src="09_scaling_files/figure-html/unnamed-chunk-10-92.png" width="672"><img src="09_scaling_files/figure-html/unnamed-chunk-10-93.png" width="672"><img src="09_scaling_files/figure-html/unnamed-chunk-10-94.png" width="672"><img src="09_scaling_files/figure-html/unnamed-chunk-10-95.png" width="672"><img src="09_scaling_files/figure-html/unnamed-chunk-10-96.png" width="672"><img src="09_scaling_files/figure-html/unnamed-chunk-10-97.png" width="672"><img src="09_scaling_files/figure-html/unnamed-chunk-10-98.png" width="672"><img src="09_scaling_files/figure-html/unnamed-chunk-10-99.png" width="672"><img src="09_scaling_files/figure-html/unnamed-chunk-10-100.png" width="672"><img src="09_scaling_files/figure-html/unnamed-chunk-10-101.png" width="672"><img src="09_scaling_files/figure-html/unnamed-chunk-10-102.png" width="672"><img src="09_scaling_files/figure-html/unnamed-chunk-10-103.png" width="672"><img src="09_scaling_files/figure-html/unnamed-chunk-10-104.png" width="672"><img src="09_scaling_files/figure-html/unnamed-chunk-10-105.png" width="672"><img src="09_scaling_files/figure-html/unnamed-chunk-10-106.png" width="672"><img src="09_scaling_files/figure-html/unnamed-chunk-10-107.png" width="672"><img src="09_scaling_files/figure-html/unnamed-chunk-10-108.png" width="672"><img src="09_scaling_files/figure-html/unnamed-chunk-10-109.png" width="672"></p>
<div id="plot-per-participant.-outcome-expect-demean" class="section level3" number="7.6.1">
<h3>
<span class="header-section-number">7.6.1</span> plot per participant. Outcome, Expect, demean<a class="anchor" aria-label="anchor" href="#plot-per-participant.-outcome-expect-demean"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb227"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pain.df</span> <span class="op">&lt;-</span> <span class="va">df.PVC_center</span><span class="op">[</span><span class="va">df.PVC_center</span><span class="op">$</span><span class="va">runtype</span> <span class="op">==</span> <span class="st">"runtype-pain"</span>, <span class="op">]</span></span>
<span><span class="va">sub_0063pain.df</span> <span class="op">&lt;-</span> <span class="va">pain.df</span><span class="op">[</span><span class="va">pain.df</span><span class="op">$</span><span class="va">sub</span> <span class="op">==</span> <span class="st">"sub-0060"</span>,<span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">sub_0063pain.df</span><span class="op">)</span></span></code></pre></div>
<pre><code>## # A tibble: 6 × 34
##   src_subject_id session_id param_run_num param_task_name event02_expect_angle
##            &lt;int&gt;      &lt;int&gt;         &lt;int&gt; &lt;chr&gt;                          &lt;dbl&gt;
## 1             60          1             1 pain                             0  
## 2             60          1             1 pain                            51.0
## 3             60          1             1 pain                            45.3
## 4             60          1             1 pain                            28.4
## 5             60          1             1 pain                            66.1
## 6             60          1             1 pain                             0  
## # ℹ 29 more variables: param_cue_type &lt;chr&gt;, param_stimulus_type &lt;chr&gt;,
## #   event04_actual_angle &lt;dbl&gt;, trial_index &lt;int&gt;, trial_count_sub &lt;int&gt;,
## #   trial_ind &lt;dbl&gt;, sub &lt;chr&gt;, ses &lt;chr&gt;, run &lt;chr&gt;, runtype &lt;chr&gt;,
## #   task &lt;chr&gt;, trial_sub &lt;int&gt;, trial &lt;chr&gt;, cuetype &lt;chr&gt;,
## #   stimintensity &lt;chr&gt;, DEPc &lt;chr&gt;, DEP &lt;chr&gt;, OUTCOME &lt;dbl&gt;, EXPECT &lt;dbl&gt;,
## #   OUTCOME_cm &lt;dbl&gt;, OUTCOME_demean &lt;dbl&gt;, EXPECT_cm &lt;dbl&gt;,
## #   EXPECT_demean &lt;dbl&gt;, OUTCOME_zscore &lt;dbl&gt;, EXPECT_zscore &lt;dbl&gt;, …</code></pre>
<div class="sourceCode" id="cb229"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># hist(sub_0063pain.df$EXPECT)</span></span>
<span><span class="co"># hist(sub_0063pain.df$EXPECT_zscore)</span></span>
<span><span class="co"># hist(sub_0063pain.df$EXPECT_cm)</span></span>
<span><span class="co"># hist(sub_0063pain.df$EXPECT_demean)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">sub_0063pain.df</span><span class="op">$</span><span class="va">EXPECT_demean</span>, <span class="va">sub_0063pain.df</span><span class="op">$</span><span class="va">OUTCOME</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="09_scaling_files/figure-html/unnamed-chunk-11-1.png" width="672"></div>
<div class="sourceCode" id="cb230"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">sub_0063pain.df</span><span class="op">$</span><span class="va">EXPECT_zscore</span>, <span class="va">sub_0063pain.df</span><span class="op">$</span><span class="va">OUTCOME</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="09_scaling_files/figure-html/unnamed-chunk-11-2.png" width="672"></div>
<div class="sourceCode" id="cb231"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">r</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">sub_0063pain.df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">EXPECT</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span>bins <span class="op">=</span> <span class="fl">30</span>, fill <span class="op">=</span> <span class="st">"blue"</span>, alpha <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Histogram of Variable"</span>, x <span class="op">=</span> <span class="st">"Expect (Raw)"</span>, y <span class="op">=</span> <span class="st">"Outcome"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_classic</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">z</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">sub_0063pain.df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">EXPECT_zscore</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span>bins <span class="op">=</span> <span class="fl">30</span>, fill <span class="op">=</span> <span class="st">"blue"</span>, alpha <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Histogram of Variable"</span>, x <span class="op">=</span> <span class="st">"Expect (Z)"</span>, y <span class="op">=</span> <span class="st">"Outcome"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_classic</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">cmc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">sub_0063pain.df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">EXPECT_cm</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span>bins <span class="op">=</span> <span class="fl">30</span>, fill <span class="op">=</span> <span class="st">"blue"</span>, alpha <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Histogram of Variable"</span>, x <span class="op">=</span> <span class="st">"Expect (CMC)"</span>, y <span class="op">=</span> <span class="st">"Outcome"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_classic</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">arranged_plots</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fu">ggpubr</span><span class="fu">::</span><span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/ggarrange.html">ggarrange</a></span><span class="op">(</span></span>
<span>        <span class="va">r</span>, <span class="va">z</span>, <span class="va">cmc</span>,</span>
<span>        common.legend <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>        legend <span class="op">=</span> <span class="st">"none"</span>,</span>
<span>        ncol <span class="op">=</span> <span class="fl">3</span>,</span>
<span>        nrow <span class="op">=</span> <span class="fl">1</span>,</span>
<span>        widths <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>,</span>
<span>        heights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>,</span>
<span>        align <span class="op">=</span> <span class="st">"v"</span></span>
<span>      <span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">grid.draw</span><span class="op">(</span><span class="va">arranged_plots</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="09_scaling_files/figure-html/unnamed-chunk-11-3.png" width="672"></div>
</div>
</div>
<div id="analysis-3" class="section level2" number="7.7">
<h2>
<span class="header-section-number">7.7</span> Analysis 3<a class="anchor" aria-label="anchor" href="#analysis-3"><i class="fas fa-link"></i></a>
</h2>
<div id="lmer-model-compare-z-score-vs-nonzscore-1" class="section level3" number="7.7.1">
<h3>
<span class="header-section-number">7.7.1</span> lmer model compare z score vs nonzscore<a class="anchor" aria-label="anchor" href="#lmer-model-compare-z-score-vs-nonzscore-1"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb232"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pain.df</span> <span class="op">&lt;-</span> <span class="va">df.PVC_center</span><span class="op">[</span><span class="va">df.PVC_center</span><span class="op">$</span><span class="va">runtype</span> <span class="op">==</span> <span class="st">"runtype-pain"</span>, <span class="op">]</span></span>
<span><span class="va">vic.df</span> <span class="op">&lt;-</span> <span class="va">df.PVC_center</span><span class="op">[</span><span class="va">df.PVC_center</span><span class="op">$</span><span class="va">runtype</span> <span class="op">==</span> <span class="st">"runtype-vicarious"</span>, <span class="op">]</span></span>
<span><span class="va">cog.df</span> <span class="op">&lt;-</span> <span class="va">df.PVC_center</span><span class="op">[</span><span class="va">df.PVC_center</span><span class="op">$</span><span class="va">runtype</span> <span class="op">==</span> <span class="st">"runtype-cognitive"</span>, <span class="op">]</span></span>
<span><span class="va">model.pain_z</span> <span class="op">&lt;-</span> <span class="fu">lmer</span><span class="op">(</span><span class="va">OUTCOME</span> <span class="op">~</span> <span class="va">EXPECT_zscore</span> <span class="op">+</span> <span class="op">(</span><span class="va">EXPECT_zscore</span><span class="op">|</span><span class="va">sub</span><span class="op">)</span>, <span class="va">pain.df</span><span class="op">)</span></span>
<span><span class="va">model.vic_z</span> <span class="op">&lt;-</span> <span class="fu">lmer</span><span class="op">(</span><span class="va">OUTCOME</span> <span class="op">~</span> <span class="va">EXPECT_zscore</span> <span class="op">+</span> <span class="op">(</span><span class="va">EXPECT_zscore</span><span class="op">|</span><span class="va">sub</span><span class="op">)</span>, <span class="va">vic.df</span><span class="op">)</span></span>
<span><span class="va">model.cog_z</span> <span class="op">&lt;-</span> <span class="fu">lmer</span><span class="op">(</span><span class="va">OUTCOME</span> <span class="op">~</span> <span class="va">EXPECT_zscore</span> <span class="op">+</span> <span class="op">(</span><span class="va">EXPECT_zscore</span><span class="op">|</span><span class="va">sub</span><span class="op">)</span>, <span class="va">cog.df</span><span class="op">)</span></span>
<span><span class="va">model.pain_raw</span> <span class="op">&lt;-</span> <span class="fu">lmer</span><span class="op">(</span><span class="va">OUTCOME</span> <span class="op">~</span> <span class="va">EXPECT</span> <span class="op">+</span> <span class="op">(</span><span class="va">EXPECT</span><span class="op">|</span><span class="va">sub</span><span class="op">)</span>, <span class="va">pain.df</span><span class="op">)</span></span></code></pre></div>
<pre><code>## Warning in checkConv(attr(opt, "derivs"), opt$par, ctrl = control$checkConv, :
## Model failed to converge with max|grad| = 5.82673 (tol = 0.002, component 1)</code></pre>
<pre><code>## Warning in checkConv(attr(opt, "derivs"), opt$par, ctrl = control$checkConv, : Model is nearly unidentifiable: very large eigenvalue
##  - Rescale variables?</code></pre>
<div class="sourceCode" id="cb235"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model.vic_raw</span> <span class="op">&lt;-</span> <span class="fu">lmer</span><span class="op">(</span><span class="va">OUTCOME</span> <span class="op">~</span> <span class="va">EXPECT</span> <span class="op">+</span> <span class="op">(</span><span class="va">EXPECT</span><span class="op">|</span><span class="va">sub</span><span class="op">)</span>,  <span class="va">vic.df</span><span class="op">)</span></span></code></pre></div>
<pre><code>## Warning in checkConv(attr(opt, "derivs"), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.0529862 (tol = 0.002, component 1)

## Warning in checkConv(attr(opt, "derivs"), opt$par, ctrl = control$checkConv, : Model is nearly unidentifiable: very large eigenvalue
##  - Rescale variables?</code></pre>
<div class="sourceCode" id="cb237"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model.cog_raw</span> <span class="op">&lt;-</span> <span class="fu">lmer</span><span class="op">(</span><span class="va">OUTCOME</span> <span class="op">~</span> <span class="va">EXPECT</span> <span class="op">+</span> <span class="op">(</span><span class="va">EXPECT</span><span class="op">|</span><span class="va">sub</span><span class="op">)</span>, <span class="va">cog.df</span><span class="op">)</span></span></code></pre></div>
<pre><code>## Warning in checkConv(attr(opt, "derivs"), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 2.36973 (tol = 0.002, component 1)

## Warning in checkConv(attr(opt, "derivs"), opt$par, ctrl = control$checkConv, : Model is nearly unidentifiable: very large eigenvalue
##  - Rescale variables?</code></pre>
<div class="sourceCode" id="cb239"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model.pain_cmc</span> <span class="op">&lt;-</span> <span class="fu">lmer</span><span class="op">(</span><span class="va">OUTCOME</span> <span class="op">~</span> <span class="va">EXPECT_demean</span> <span class="op">+</span> <span class="va">EXPECT_cmc</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">sub</span><span class="op">)</span>, <span class="va">pain.df</span><span class="op">)</span></span>
<span><span class="va">model.vic_cmc</span> <span class="op">&lt;-</span> <span class="fu">lmer</span><span class="op">(</span><span class="va">OUTCOME</span> <span class="op">~</span> <span class="va">EXPECT_demean</span> <span class="op">+</span> <span class="va">EXPECT_cmc</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">sub</span><span class="op">)</span>,  <span class="va">vic.df</span><span class="op">)</span></span>
<span><span class="va">model.cog_cmc</span> <span class="op">&lt;-</span> <span class="fu">lmer</span><span class="op">(</span><span class="va">OUTCOME</span> <span class="op">~</span> <span class="va">EXPECT_demean</span> <span class="op">+</span> <span class="va">EXPECT_cmc</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">sub</span><span class="op">)</span>, <span class="va">cog.df</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">model.pain_z</span> <span class="op">&lt;-</span> <span class="fu">lmer</span><span class="op">(</span><span class="va">OUTCOME</span> <span class="op">~</span> <span class="va">EXPECT_zscore</span> <span class="op">+</span> <span class="op">(</span><span class="va">EXPECT_zscore</span><span class="op">|</span><span class="va">sub</span><span class="op">)</span>, <span class="va">pain.df</span><span class="op">)</span></span>
<span><span class="va">model.pain_bothz</span> <span class="op">&lt;-</span> <span class="fu">lmer</span><span class="op">(</span><span class="va">OUTCOME_zscore</span> <span class="op">~</span> <span class="va">EXPECT_zscore</span> <span class="op">+</span> <span class="op">(</span><span class="va">EXPECT_zscore</span><span class="op">|</span><span class="va">sub</span><span class="op">)</span>, <span class="va">pain.df</span><span class="op">)</span></span>
<span><span class="va">model.pain_bothCM</span> <span class="op">&lt;-</span> <span class="fu">lmer</span><span class="op">(</span><span class="va">OUTCOME_demean</span> <span class="op">~</span> <span class="va">EXPECT_demean</span> <span class="op">+</span> <span class="op">(</span><span class="va">EXPECT_demean</span><span class="op">|</span><span class="va">sub</span><span class="op">)</span>, <span class="va">pain.df</span><span class="op">)</span></span></code></pre></div>
<pre><code>## Warning in checkConv(attr(opt, "derivs"), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.0126555 (tol = 0.002, component 1)

## Warning in checkConv(attr(opt, "derivs"), opt$par, ctrl = control$checkConv, : Model is nearly unidentifiable: very large eigenvalue
##  - Rescale variables?</code></pre>
<div class="sourceCode" id="cb241"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model.pain_CM</span> <span class="op">&lt;-</span> <span class="fu">lmer</span><span class="op">(</span><span class="va">OUTCOME</span> <span class="op">~</span> <span class="va">EXPECT_demean</span> <span class="op">+</span> <span class="op">(</span><span class="va">EXPECT_demean</span><span class="op">|</span><span class="va">sub</span><span class="op">)</span>, <span class="va">pain.df</span><span class="op">)</span></span></code></pre></div>
<pre><code>## Warning in checkConv(attr(opt, "derivs"), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.161577 (tol = 0.002, component 1)

## Warning in checkConv(attr(opt, "derivs"), opt$par, ctrl = control$checkConv, : Model is nearly unidentifiable: very large eigenvalue
##  - Rescale variables?</code></pre>
<div class="sourceCode" id="cb243"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">print_dash</span><span class="op">(</span><span class="st">"model with Z scores :: Pain"</span><span class="op">)</span></span></code></pre></div>
<pre><code>## 
## 
## ----------------------------------------
## model with Z scores :: Pain
## ----------------------------------------</code></pre>
<div class="sourceCode" id="cb245"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">model.pain_z</span><span class="op">)</span></span></code></pre></div>
<pre><code>## Linear mixed model fit by REML. t-tests use Satterthwaite's method [
## lmerModLmerTest]
## Formula: OUTCOME ~ EXPECT_zscore + (EXPECT_zscore | sub)
##    Data: pain.df
## 
## REML criterion at convergence: 52401.2
## 
## Scaled residuals: 
##     Min      1Q  Median      3Q     Max 
## -4.5165 -0.5939  0.0074  0.6040  4.3649 
## 
## Random effects:
##  Groups   Name          Variance Std.Dev. Corr
##  sub      (Intercept)   636.60   25.231       
##           EXPECT_zscore  45.32    6.732   0.25
##  Residual               516.89   22.735       
## Number of obs: 5701, groups:  sub, 108
## 
## Fixed effects:
##               Estimate Std. Error       df t value Pr(&gt;|t|)    
## (Intercept)    60.2351     2.4643 103.9474   24.44   &lt;2e-16 ***
## EXPECT_zscore   8.1635     0.7389 102.9673   11.05   &lt;2e-16 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Correlation of Fixed Effects:
##             (Intr)
## EXPECT_zscr 0.169</code></pre>
<div class="sourceCode" id="cb247"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">print_dash</span><span class="op">(</span><span class="st">"model with Z scores :: Vicarious"</span><span class="op">)</span></span></code></pre></div>
<pre><code>## 
## 
## ----------------------------------------
## model with Z scores :: Vicarious
## ----------------------------------------</code></pre>
<div class="sourceCode" id="cb249"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">model.vic_z</span><span class="op">)</span></span></code></pre></div>
<pre><code>## Linear mixed model fit by REML. t-tests use Satterthwaite's method [
## lmerModLmerTest]
## Formula: OUTCOME ~ EXPECT_zscore + (EXPECT_zscore | sub)
##    Data: vic.df
## 
## REML criterion at convergence: 55765.7
## 
## Scaled residuals: 
##     Min      1Q  Median      3Q     Max 
## -3.0181 -0.6539 -0.2608  0.4712  5.1554 
## 
## Random effects:
##  Groups   Name          Variance Std.Dev. Corr
##  sub      (Intercept)   128.10   11.32        
##           EXPECT_zscore  20.16    4.49    0.56
##  Residual               581.72   24.12        
## Number of obs: 6023, groups:  sub, 109
## 
## Fixed effects:
##               Estimate Std. Error      df t value Pr(&gt;|t|)    
## (Intercept)     28.910      1.148 110.354   25.19   &lt;2e-16 ***
## EXPECT_zscore    5.741      0.593 113.213    9.68   &lt;2e-16 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Correlation of Fixed Effects:
##             (Intr)
## EXPECT_zscr 0.483</code></pre>
<div class="sourceCode" id="cb251"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">print_dash</span><span class="op">(</span><span class="st">"model with Z scores :: Cognitive"</span><span class="op">)</span></span></code></pre></div>
<pre><code>## 
## 
## ----------------------------------------
## model with Z scores :: Cognitive
## ----------------------------------------</code></pre>
<div class="sourceCode" id="cb253"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">model.cog_z</span><span class="op">)</span></span></code></pre></div>
<pre><code>## Linear mixed model fit by REML. t-tests use Satterthwaite's method [
## lmerModLmerTest]
## Formula: OUTCOME ~ EXPECT_zscore + (EXPECT_zscore | sub)
##    Data: cog.df
## 
## REML criterion at convergence: 52720.9
## 
## Scaled residuals: 
##     Min      1Q  Median      3Q     Max 
## -4.0458 -0.6033 -0.1539  0.4586  6.6938 
## 
## Random effects:
##  Groups   Name          Variance Std.Dev. Corr
##  sub      (Intercept)   163.82   12.799       
##           EXPECT_zscore  23.29    4.825   0.38
##  Residual               367.83   19.179       
## Number of obs: 5977, groups:  sub, 109
## 
## Fixed effects:
##               Estimate Std. Error       df t value Pr(&gt;|t|)    
## (Intercept)    30.4662     1.2622 108.1152   24.14   &lt;2e-16 ***
## EXPECT_zscore   7.1026     0.5792 108.5177   12.26   &lt;2e-16 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Correlation of Fixed Effects:
##             (Intr)
## EXPECT_zscr 0.345</code></pre>
<div class="sourceCode" id="cb255"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">print_dash</span><span class="op">(</span><span class="st">"model with raw scores, i.e. non Zscores :: Pain"</span><span class="op">)</span></span></code></pre></div>
<pre><code>## 
## 
## ----------------------------------------
## model with raw scores, i.e. non Zscores :: Pain
## ----------------------------------------</code></pre>
<div class="sourceCode" id="cb257"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">model.pain_raw</span><span class="op">)</span></span></code></pre></div>
<pre><code>## Linear mixed model fit by REML. t-tests use Satterthwaite's method [
## lmerModLmerTest]
## Formula: OUTCOME ~ EXPECT + (EXPECT | sub)
##    Data: pain.df
## 
## REML criterion at convergence: 52342.5
## 
## Scaled residuals: 
##     Min      1Q  Median      3Q     Max 
## -4.5451 -0.5990  0.0130  0.6041  4.3842 
## 
## Random effects:
##  Groups   Name        Variance Std.Dev. Corr 
##  sub      (Intercept) 885.9061 29.7642       
##           EXPECT        0.0407  0.2017  -0.58
##  Residual             513.2390 22.6548       
## Number of obs: 5701, groups:  sub, 108
## 
## Fixed effects:
##             Estimate Std. Error      df t value Pr(&gt;|t|)    
## (Intercept)  48.2011     2.9898 50.6459   16.12   &lt;2e-16 ***
## EXPECT        0.2798     0.0231 81.9412   12.12   &lt;2e-16 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Correlation of Fixed Effects:
##        (Intr)
## EXPECT -0.601
## optimizer (nloptwrap) convergence code: 0 (OK)
## Model failed to converge with max|grad| = 5.82673 (tol = 0.002, component 1)
## Model is nearly unidentifiable: very large eigenvalue
##  - Rescale variables?</code></pre>
<div class="sourceCode" id="cb259"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">print_dash</span><span class="op">(</span><span class="st">"model with raw scores, i.e. non Zscores :: Vicarious"</span><span class="op">)</span></span></code></pre></div>
<pre><code>## 
## 
## ----------------------------------------
## model with raw scores, i.e. non Zscores :: Vicarious
## ----------------------------------------</code></pre>
<div class="sourceCode" id="cb261"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">model.vic_raw</span><span class="op">)</span></span></code></pre></div>
<pre><code>## Linear mixed model fit by REML. t-tests use Satterthwaite's method [
## lmerModLmerTest]
## Formula: OUTCOME ~ EXPECT + (EXPECT | sub)
##    Data: vic.df
## 
## REML criterion at convergence: 55709.4
## 
## Scaled residuals: 
##     Min      1Q  Median      3Q     Max 
## -3.0287 -0.6525 -0.2573  0.4708  5.1655 
## 
## Random effects:
##  Groups   Name        Variance Std.Dev. Corr 
##  sub      (Intercept)  61.4815  7.8410       
##           EXPECT        0.0205  0.1432  -0.30
##  Residual             581.2022 24.1081       
## Number of obs: 6023, groups:  sub, 109
## 
## Fixed effects:
##              Estimate Std. Error        df t value Pr(&gt;|t|)    
## (Intercept)  19.85080    0.92571 104.49803   21.44   &lt;2e-16 ***
## EXPECT        0.21925    0.01981 119.99847   11.06   &lt;2e-16 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Correlation of Fixed Effects:
##        (Intr)
## EXPECT -0.492
## optimizer (nloptwrap) convergence code: 0 (OK)
## Model failed to converge with max|grad| = 0.0529862 (tol = 0.002, component 1)
## Model is nearly unidentifiable: very large eigenvalue
##  - Rescale variables?</code></pre>
<div class="sourceCode" id="cb263"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">print_dash</span><span class="op">(</span><span class="st">"model with raw scores, i.e. non Zscores :: Cognitive"</span><span class="op">)</span></span></code></pre></div>
<pre><code>## 
## 
## ----------------------------------------
## model with raw scores, i.e. non Zscores :: Cognitive
## ----------------------------------------</code></pre>
<div class="sourceCode" id="cb265"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">model.cog_raw</span><span class="op">)</span></span></code></pre></div>
<pre><code>## Linear mixed model fit by REML. t-tests use Satterthwaite's method [
## lmerModLmerTest]
## Formula: OUTCOME ~ EXPECT + (EXPECT | sub)
##    Data: cog.df
## 
## REML criterion at convergence: 52652
## 
## Scaled residuals: 
##     Min      1Q  Median      3Q     Max 
## -3.7736 -0.6043 -0.1597  0.4548  6.6799 
## 
## Random effects:
##  Groups   Name        Variance  Std.Dev. Corr 
##  sub      (Intercept)  64.12102  8.0076       
##           EXPECT        0.01698  0.1303  -0.09
##  Residual             369.70089 19.2276       
## Number of obs: 5977, groups:  sub, 109
## 
## Fixed effects:
##              Estimate Std. Error        df t value Pr(&gt;|t|)    
## (Intercept)  19.47584    0.89942 119.72844   21.65   &lt;2e-16 ***
## EXPECT        0.25735    0.01726 121.97945   14.91   &lt;2e-16 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Correlation of Fixed Effects:
##        (Intr)
## EXPECT -0.339
## optimizer (nloptwrap) convergence code: 0 (OK)
## Model failed to converge with max|grad| = 2.36973 (tol = 0.002, component 1)
## Model is nearly unidentifiable: very large eigenvalue
##  - Rescale variables?</code></pre>
<div class="sourceCode" id="cb267"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">print_dash</span><span class="op">(</span><span class="st">"model with raw Pain scores CMC and CWC"</span><span class="op">)</span></span></code></pre></div>
<pre><code>## 
## 
## ----------------------------------------
## model with raw Pain scores CMC and CWC
## ----------------------------------------</code></pre>
<div class="sourceCode" id="cb269"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># summary(model.pain_cmc)</span></span>
<span><span class="fu">sjPlot</span><span class="fu">::</span><span class="fu"><a href="https://strengejacke.github.io/sjPlot/reference/tab_model.html">tab_model</a></span><span class="op">(</span><span class="va">model.pain_cmc</span>, p.val <span class="op">=</span> <span class="st">"kr"</span>, show.df <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<div class="inline-table"><table style="border-collapse:collapse; border:none;" class="table table-sm">
<tr>
<th style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; ">
 
</th>
<th colspan="4" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">
OUTCOME
</th>
</tr>
<tr>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; ">
Predictors
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
Estimates
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
CI
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
p
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
df
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
(Intercept)
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
59.75
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
56.44 – 63.05
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
<strong>&lt;0.001</strong>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
109.31
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
EXPECT demean
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.30
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.28 – 0.32
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
<strong>&lt;0.001</strong>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
5664.90
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
EXPECT cmc
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
1.25
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
1.02 – 1.47
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
<strong>&lt;0.001</strong>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
106.98
</td>
</tr>
<tr>
<td colspan="5" style="font-weight:bold; text-align:left; padding-top:.8em;">
Random Effects
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
σ<sup>2</sup>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
554.94
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
τ<sub>00</sub><sub>sub</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
283.42
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
ICC
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
0.34
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
N <sub>sub</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
108
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;">
Observations
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="4">
5701
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
Marginal R<sup>2</sup> / Conditional R<sup>2</sup>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
0.401 / 0.603
</td>
</tr>
</table></div>
<div class="sourceCode" id="cb270"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">print_dash</span><span class="op">(</span><span class="st">"model comparison"</span><span class="op">)</span></span></code></pre></div>
<pre><code>## 
## 
## ----------------------------------------
## model comparison
## ----------------------------------------</code></pre>
<div class="sourceCode" id="cb272"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="va">model.pain_z</span>, <span class="va">model.pain_raw</span><span class="op">)</span></span></code></pre></div>
<pre><code>## refitting model(s) with ML (instead of REML)</code></pre>
<pre><code>## Data: pain.df
## Models:
## model.pain_z: OUTCOME ~ EXPECT_zscore + (EXPECT_zscore | sub)
## model.pain_raw: OUTCOME ~ EXPECT + (EXPECT | sub)
##                npar   AIC   BIC logLik deviance  Chisq Df Pr(&gt;Chisq)
## model.pain_z      6 52418 52458 -26203    52406                     
## model.pain_raw    6 52344 52384 -26166    52332 74.224  0</code></pre>
<div class="sourceCode" id="cb275"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># _______________________________________________________</span></span>
<span><span class="co"># # Example using broom to get a tidied summary</span></span>
<span><span class="co"># library(broom)</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># tidy_model_pain_z &lt;- tidy(model.pain_z)</span></span>
<span><span class="co"># tidy_model_vic_z &lt;- tidy(model.vic_z)</span></span>
<span><span class="co"># # ... and so on for the other models</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># # Combine tidied summaries into one data frame</span></span>
<span><span class="co"># all_tidy_effects &lt;- bind_rows(</span></span>
<span><span class="co">#   tidy_model_pain_z %&gt;% mutate(model = "Pain Z"),</span></span>
<span><span class="co">#   tidy_model_vic_z %&gt;% mutate(model = "Vicarious Z"),</span></span>
<span><span class="co">#   # ... and so on for the other models</span></span>
<span><span class="co"># )</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># # Print the combined tidied model summaries</span></span>
<span><span class="co"># print(all_tidy_effects)</span></span></code></pre></div>
</div>
<div id="check-lmer-cmc-model" class="section level3" number="7.7.2">
<h3>
<span class="header-section-number">7.7.2</span> check lmer CMC model<a class="anchor" aria-label="anchor" href="#check-lmer-cmc-model"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb276"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">sjPlot</span><span class="fu">::</span><span class="fu"><a href="https://strengejacke.github.io/sjPlot/reference/tab_model.html">tab_model</a></span><span class="op">(</span><span class="va">model.pain_cmc</span>, p.val <span class="op">=</span> <span class="st">"kr"</span>, show.df <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<div class="inline-table"><table style="border-collapse:collapse; border:none;" class="table table-sm">
<tr>
<th style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; ">
 
</th>
<th colspan="4" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">
OUTCOME
</th>
</tr>
<tr>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; ">
Predictors
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
Estimates
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
CI
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
p
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
df
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
(Intercept)
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
59.75
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
56.44 – 63.05
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
<strong>&lt;0.001</strong>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
109.31
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
EXPECT demean
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.30
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.28 – 0.32
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
<strong>&lt;0.001</strong>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
5664.90
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
EXPECT cmc
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
1.25
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
1.02 – 1.47
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
<strong>&lt;0.001</strong>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
106.98
</td>
</tr>
<tr>
<td colspan="5" style="font-weight:bold; text-align:left; padding-top:.8em;">
Random Effects
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
σ<sup>2</sup>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
554.94
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
τ<sub>00</sub><sub>sub</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
283.42
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
ICC
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
0.34
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
N <sub>sub</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
108
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;">
Observations
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="4">
5701
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
Marginal R<sup>2</sup> / Conditional R<sup>2</sup>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
0.401 / 0.603
</td>
</tr>
</table></div>
</div>
<div id="lmer-combined-coefficients-into-table" class="section level3" number="7.7.3">
<h3>
<span class="header-section-number">7.7.3</span> lmer combined coefficients into table<a class="anchor" aria-label="anchor" href="#lmer-combined-coefficients-into-table"><i class="fas fa-link"></i></a>
</h3>
<p>Since there are multiple models, I combine the coefficients (within subject expectation effects) into one table</p>
<div class="sourceCode" id="cb277"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/rstudio/DT">DT</a></span><span class="op">)</span></span>
<span><span class="co"># Print or use kable/DT for a nicer table in R Markdown ________________________</span></span>
<span><span class="fu">DT</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/DT/man/datatable.html">datatable</a></span><span class="op">(</span><span class="va">all_fixed_effects</span>,</span>
<span>                            options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>                              pageLength <span class="op">=</span> <span class="fl">25</span>,</span>
<span>                columnDefs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>                  <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>targets <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">5</span>,<span class="fl">6</span><span class="op">)</span>,  <span class="co"># Assuming 2nd and 3rd columns are numeric</span></span>
<span>                       render <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/htmlwidgets/man/JS.html">JS</a></span><span class="op">(</span></span>
<span>                         <span class="st">"function(data, type, row, meta) {"</span>,</span>
<span>                         <span class="st">"return type === 'display' || type === 'filter' ?"</span>,</span>
<span>                         <span class="st">"parseFloat(data).toFixed(3) : data;"</span>,</span>
<span>                         <span class="st">"}"</span></span>
<span>                       <span class="op">)</span></span>
<span>                  <span class="op">)</span></span>
<span>                <span class="op">)</span></span>
<span>              <span class="op">)</span>,</span>
<span>             caption <span class="op">=</span> <span class="st">"Summary of Non-Intercept Fixed Effects across Models"</span><span class="op">)</span></span></code></pre></div>
<div class="datatables html-widget html-fill-item" id="htmlwidget-e3b51192e91363a12ec0" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-e3b51192e91363a12ec0">{"x":{"filter":"none","vertical":false,"caption":"<caption>Summary of Non-Intercept Fixed Effects across Models<\/caption>","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16"],["Pain","Vicarious","Cognitive","Pain","Vicarious","Cognitive","Pain","Pain","Vicarious","Vicarious","Cognitive","Cognitive","Pain","Pain","Pain","Pain"],["Pain Outcome ~ ExpectZ","Vicarious Outcome ~ ExpectZ","Cognitive Outcome ~ ExpectZ","Pain Outcome ~ Expect","Vicarious Outcome ~ Expect","Cognitive Outcome ~ Expect","Pain Outcome ~ demean + CMC","Pain Outcome ~ demean + CMC","Vicarious Outcome ~ demean + CMC","Vicarious Outcome ~ demean + CMC","Cognitive Outcome ~ demean + CMC","Cognitive Outcome ~ demean + CMC","Pain Outcome ~ ExpectZ","Pain OutcomeZ ~ ExpectZ","Pain Outcome_demean ~ Expect_demean","Pain Outcome ~ Expect_demean"],["EXPECT_zscore","EXPECT_zscore","EXPECT_zscore","EXPECT","EXPECT","EXPECT","EXPECT_demean","EXPECT_cmc","EXPECT_demean","EXPECT_cmc","EXPECT_demean","EXPECT_cmc","EXPECT_zscore","EXPECT_zscore","EXPECT_demean","EXPECT_demean"],[8.163467890509081,5.740994114298316,7.102600451380583,0.2798262476209707,0.2192492288904644,0.2573460289031447,0.3032840348008112,1.248386855473181,0.2233330688125646,0.5452850143554926,0.2701215194698616,0.6339551445850297,8.163467890509081,0.2754027070942442,0.2792342133316239,0.2733211565816632],[0.3319128288062573,0.1995641397288684,0.2969734100003643,0.4572662955304865,0.2342492678624501,0.3385903797802837,0.4071682737414164,0.6269353988358655,0.2338480319379488,0.7496021751200281,0.3430831405594961,0.715301415599841,0.3319128288062573,0.3347628074609175,0.3748749074444964,0.3669421754279086],[3.501178575007938e-19,1.642401095025626e-16,3.238227882441323e-22,5.920241312933025e-20,4.802659343081473e-20,2.875639855384778e-29,1.054149559552168e-162,3.320903774113289e-19,5.313052090800896e-66,1.722028052738901e-17,8.160240952144865e-136,4.932511270190545e-19,3.501178575007938e-19,2.19557172835925e-23,7.434221005436442e-24,4.993447257434274e-23]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>task<\/th>\n      <th>model<\/th>\n      <th>term<\/th>\n      <th>estimate<\/th>\n      <th>beta_std<\/th>\n      <th>p.value<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":25,"columnDefs":[{"targets":[4,5,6],"render":"function(data, type, row, meta) {\nreturn type === 'display' || type === 'filter' ?\nparseFloat(data).toFixed(3) : data;\n}"},{"className":"dt-right","targets":[4,5,6]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"task","targets":1},{"name":"model","targets":2},{"name":"term","targets":3},{"name":"estimate","targets":4},{"name":"beta_std","targets":5},{"name":"p.value","targets":6}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":["options.columnDefs.0.render"],"jsHooks":[]}</script>
</div>
<div id="plot-how-much-of-the-cmcs-predict-outcome-ratings" class="section level3" number="7.7.4">
<h3>
<span class="header-section-number">7.7.4</span> plot how much of the CMCs predict outcome ratings<a class="anchor" aria-label="anchor" href="#plot-how-much-of-the-cmcs-predict-outcome-ratings"><i class="fas fa-link"></i></a>
</h3>
</div>
<div id="plot-how-much-of-the-demeans-predict-outcome-ratings" class="section level3" number="7.7.5">
<h3>
<span class="header-section-number">7.7.5</span> plot how much of the demeans predict outcome ratings<a class="anchor" aria-label="anchor" href="#plot-how-much-of-the-demeans-predict-outcome-ratings"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb278"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">gridExtra</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">grid</span><span class="op">)</span></span>
<span></span>
<span><span class="va">plot_endertofighi</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span>, <span class="va">taskname</span>, <span class="va">color_low</span><span class="op">=</span><span class="st">"gray"</span>, <span class="va">color_high</span><span class="op">=</span><span class="st">"black"</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">runtype_filter</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"runtype-"</span>, <span class="va">taskname</span><span class="op">)</span></span>
<span>  <span class="va">data</span><span class="op">$</span><span class="va">sub_numeric</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">sub</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="co"># Plot for demean ____________________________________________________________</span></span>
<span>  <span class="va">g.Odemean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">data</span>, </span>
<span>                     <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">OUTCOME_demean</span>, x <span class="op">=</span> <span class="va">EXPECT_demean</span>, colour <span class="op">=</span> <span class="va">sub_numeric</span>, group <span class="op">=</span> <span class="va">sub</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">.3</span>, color <span class="op">=</span> <span class="st">'gray'</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="co">#geom_point(size = .1) +</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">'lm'</span>, formula <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="va">x</span>, se <span class="op">=</span> <span class="cn">FALSE</span>, size <span class="op">=</span> <span class="fl">.3</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_classic</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html">scale_colour_gradient</a></span><span class="op">(</span>low <span class="op">=</span> <span class="va">color_low</span>, high <span class="op">=</span> <span class="va">color_high</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="co"># theme(legend.position = "none") + </span></span>
<span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span>,</span>
<span>          plot.margin <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">margin</a></span><span class="op">(</span>t <span class="op">=</span> <span class="fl">.3</span>, r <span class="op">=</span> <span class="fl">.1</span>, b <span class="op">=</span> <span class="fl">.1</span>, l <span class="op">=</span> <span class="fl">.1</span>, unit <span class="op">=</span> <span class="st">"pt"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_fixed.html">coord_fixed</a></span><span class="op">(</span>ratio <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> </span>
<span>    <span class="co"># ylim(0,200)</span></span>
<span>  <span class="va">g.Odemean</span> <span class="op">&lt;-</span> <span class="fu">ggplot_largetext</span><span class="op">(</span><span class="va">g.Odemean</span><span class="op">)</span>  <span class="co"># Assuming ggplot_largetext is a defined function</span></span>
<span>  </span>
<span></span>
<span>  <span class="co"># Plot for demean ____________________________________________________________</span></span>
<span>  <span class="va">g.demean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">data</span>, </span>
<span>                     <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">OUTCOME</span>, x <span class="op">=</span> <span class="va">EXPECT_demean</span>, colour <span class="op">=</span> <span class="va">sub_numeric</span>, group <span class="op">=</span> <span class="va">sub</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">.3</span>, color <span class="op">=</span> <span class="st">'gray'</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">.1</span>, alpha <span class="op">=</span> <span class="fl">.1</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">'lm'</span>, formula <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="va">x</span>, se <span class="op">=</span> <span class="cn">FALSE</span>, size <span class="op">=</span> <span class="fl">.3</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_classic</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html">scale_colour_gradient</a></span><span class="op">(</span>low <span class="op">=</span> <span class="va">color_low</span>, high <span class="op">=</span> <span class="va">color_high</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="co"># theme(legend.position = "none") + </span></span>
<span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span>,</span>
<span>          plot.margin <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">margin</a></span><span class="op">(</span>t <span class="op">=</span> <span class="fl">.3</span>, r <span class="op">=</span> <span class="fl">.1</span>, b <span class="op">=</span> <span class="fl">.1</span>, l <span class="op">=</span> <span class="fl">.1</span>, unit <span class="op">=</span> <span class="st">"pt"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_fixed.html">coord_fixed</a></span><span class="op">(</span>ratio <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html">ylim</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">200</span><span class="op">)</span></span>
<span>  <span class="va">g.demean</span> <span class="op">&lt;-</span> <span class="fu">ggplot_largetext</span><span class="op">(</span><span class="va">g.demean</span><span class="op">)</span>  <span class="co"># Assuming ggplot_largetext is a defined function</span></span>
<span>  </span>
<span>    <span class="co"># Plot for Cluster-wise means ________________________________________________</span></span>
<span>  <span class="va">g.Ocm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">data</span>, </span>
<span>                 <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">OUTCOME</span>, x <span class="op">=</span> <span class="va">EXPECT_cm</span>, colour <span class="op">=</span> <span class="va">sub_numeric</span>, group <span class="op">=</span> <span class="va">sub</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">.3</span>, color <span class="op">=</span> <span class="st">'gray'</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="co">#geom_point(size = .1, alpha = .1) +</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/stat_summary.html">stat_summary</a></span><span class="op">(</span></span>
<span>    fun <span class="op">=</span> <span class="va">mean</span>, geom <span class="op">=</span> <span class="st">"point"</span>,</span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>group <span class="op">=</span> <span class="va">sub</span><span class="op">)</span>, <span class="co"># Group by subject</span></span>
<span>    size <span class="op">=</span> <span class="fl">1</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html">scale_colour_gradient</a></span><span class="op">(</span>low <span class="op">=</span> <span class="va">color_low</span>, high <span class="op">=</span> <span class="va">color_high</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_abline</a></span><span class="op">(</span>intercept <span class="op">=</span> <span class="fl">0</span>, slope <span class="op">=</span> <span class="fl">1</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span>, color <span class="op">=</span> <span class="va">color_low</span><span class="op">)</span> <span class="op">+</span>  <span class="co"># Add the identity line</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">'lm'</span>, formula <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="va">x</span>, se <span class="op">=</span> <span class="cn">FALSE</span>, size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span> <span class="co">#size = .3) +</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_classic</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span>,</span>
<span>              plot.margin <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">margin</a></span><span class="op">(</span>t <span class="op">=</span> <span class="fl">.3</span>, r <span class="op">=</span> <span class="fl">.1</span>, b <span class="op">=</span> <span class="fl">.1</span>, l <span class="op">=</span> <span class="fl">.1</span>, unit <span class="op">=</span> <span class="st">"pt"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_fixed.html">coord_fixed</a></span><span class="op">(</span>ratio <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html">ylim</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">200</span><span class="op">)</span></span>
<span>  <span class="va">g.Ocm</span> <span class="op">&lt;-</span> <span class="fu">ggplot_largetext</span><span class="op">(</span><span class="va">g.Ocm</span><span class="op">)</span>  <span class="co"># Assuming ggplot_largetext is a defined function</span></span>
<span>  </span>
<span>  </span>
<span>  </span>
<span>  </span>
<span>  <span class="co"># Plot for Cluster-wise means ________________________________________________</span></span>
<span>  <span class="va">g.cm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">data</span>, </span>
<span>                 <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">OUTCOME_cm</span>, x <span class="op">=</span> <span class="va">EXPECT_cm</span>, colour <span class="op">=</span> <span class="va">sub_numeric</span>, group <span class="op">=</span> <span class="va">sub</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">.3</span>, color <span class="op">=</span> <span class="st">'gray'</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/stat_summary.html">stat_summary</a></span><span class="op">(</span></span>
<span>    fun.y <span class="op">=</span> <span class="va">mean</span>, geom <span class="op">=</span> <span class="st">"point"</span>,</span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>group <span class="op">=</span><span class="va">sub_numeric</span><span class="op">)</span>, <span class="co">#EXPECT_cm),</span></span>
<span>    size <span class="op">=</span> <span class="fl">1</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>   <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">.1</span>, alpha <span class="op">=</span> <span class="fl">.1</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html">scale_colour_gradient</a></span><span class="op">(</span>low <span class="op">=</span> <span class="va">color_low</span>, high <span class="op">=</span> <span class="va">color_high</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_abline</a></span><span class="op">(</span>intercept <span class="op">=</span> <span class="fl">0</span>, slope <span class="op">=</span> <span class="fl">1</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span>, color <span class="op">=</span> <span class="va">color_low</span><span class="op">)</span> <span class="op">+</span>  <span class="co"># Add the identity line</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">'lm'</span>, formula <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="va">x</span>, se <span class="op">=</span> <span class="cn">FALSE</span>, size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span> <span class="co">#size = .3) +</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_classic</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span>,</span>
<span>              plot.margin <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">margin</a></span><span class="op">(</span>t <span class="op">=</span> <span class="fl">.3</span>, r <span class="op">=</span> <span class="fl">.1</span>, b <span class="op">=</span> <span class="fl">.1</span>, l <span class="op">=</span> <span class="fl">.1</span>, unit <span class="op">=</span> <span class="st">"pt"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_fixed.html">coord_fixed</a></span><span class="op">(</span>ratio <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html">ylim</a></span><span class="op">(</span><span class="op">-</span><span class="fl">10</span>,<span class="fl">200</span><span class="op">)</span></span>
<span>  <span class="va">g.cm</span> <span class="op">&lt;-</span> <span class="fu">ggplot_largetext</span><span class="op">(</span><span class="va">g.cm</span><span class="op">)</span>  <span class="co"># Assuming ggplot_largetext is a defined function</span></span>
<span>  </span>
<span>  </span>
<span>  <span class="co"># Plot for Zscore ____________________________________________________________</span></span>
<span>  <span class="va">g.z</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">data</span>, </span>
<span>                 <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">OUTCOME</span>, x <span class="op">=</span> <span class="va">EXPECT_zscore</span>, colour <span class="op">=</span> <span class="va">sub_numeric</span>, group <span class="op">=</span> <span class="va">sub</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">.3</span>, color <span class="op">=</span> <span class="st">'gray'</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="co">#geom_point(size = .1) +</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html">scale_colour_gradient</a></span><span class="op">(</span>low <span class="op">=</span> <span class="va">color_low</span>, high <span class="op">=</span> <span class="va">color_high</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">'lm'</span>, formula <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="va">x</span>, se <span class="op">=</span> <span class="cn">FALSE</span>, size <span class="op">=</span> <span class="fl">.3</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_classic</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span>, plot.margin <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">margin</a></span><span class="op">(</span>t <span class="op">=</span> <span class="fl">.3</span>, r <span class="op">=</span> <span class="fl">.1</span>, b <span class="op">=</span> <span class="fl">.1</span>, l <span class="op">=</span> <span class="fl">.1</span>, unit <span class="op">=</span> <span class="st">"pt"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_fixed.html">coord_fixed</a></span><span class="op">(</span>ratio <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="va">g.z</span> <span class="op">&lt;-</span> <span class="fu">ggplot_largetext</span><span class="op">(</span><span class="va">g.z</span><span class="op">)</span>  <span class="co"># Assuming ggplot_largetext is a defined function</span></span>
<span>  </span>
<span>  </span>
<span>    <span class="co"># Plot for Zscore ____________________________________________________________</span></span>
<span>  <span class="va">g.z2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">data</span>, </span>
<span>                 <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">OUTCOME_zscore</span>, x <span class="op">=</span> <span class="va">EXPECT_zscore</span>, colour <span class="op">=</span> <span class="va">sub_numeric</span>, group <span class="op">=</span> <span class="va">sub</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">.3</span>, color <span class="op">=</span> <span class="st">'gray'</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="co">#geom_point(size = .1) +</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html">scale_colour_gradient</a></span><span class="op">(</span>low <span class="op">=</span> <span class="va">color_low</span>, high <span class="op">=</span> <span class="va">color_high</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">'lm'</span>, formula <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="va">x</span>, se <span class="op">=</span> <span class="cn">FALSE</span>, size <span class="op">=</span> <span class="fl">.3</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_classic</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span>, plot.margin <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">margin</a></span><span class="op">(</span>t <span class="op">=</span> <span class="fl">.3</span>, r <span class="op">=</span> <span class="fl">.1</span>, b <span class="op">=</span> <span class="fl">.1</span>, l <span class="op">=</span> <span class="fl">.1</span>, unit <span class="op">=</span> <span class="st">"pt"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_fixed.html">coord_fixed</a></span><span class="op">(</span>ratio <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="va">g.z2</span> <span class="op">&lt;-</span> <span class="fu">ggplot_largetext</span><span class="op">(</span><span class="va">g.z2</span><span class="op">)</span>  <span class="co"># Assuming ggplot_largetext is a defined function</span></span>
<span>  </span>
<span>  <span class="co"># Combine plots</span></span>
<span>  <span class="va">title_text</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="fu">tools</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/tools/toTitleCase.html">toTitleCase</a></span><span class="op">(</span><span class="va">taskname</span><span class="op">)</span>, <span class="st">"task: within-subject centered vs. subject-cluster means\n"</span><span class="op">)</span></span>
<span>  <span class="va">title_grob</span> <span class="op">&lt;-</span> <span class="fu">grid</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/grid.text.html">textGrob</a></span><span class="op">(</span><span class="va">title_text</span>, gp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/gpar.html">gpar</a></span><span class="op">(</span>fontsize <span class="op">=</span> <span class="fl">18</span><span class="op">)</span>, vjust <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># grid.draw(gridExtra::grid.arrange(g.demean, g.cm, g.z, ncol = 3,</span></span>
<span>  <span class="co">#                         widths = c(1,  1, 1), heights = c(1, 1, 1), </span></span>
<span>  <span class="co">#                         top = title_grob</span></span>
<span>  <span class="co"># ))</span></span>
<span>  </span>
<span>  </span>
<span>    <span class="co"># Plot for Cluster-wise means ________________________________________________</span></span>
<span>  <span class="va">g.cmc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">data</span>, </span>
<span>                 <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">OUTCOME_cmc</span>, x <span class="op">=</span> <span class="va">EXPECT_cmc</span>, colour <span class="op">=</span> <span class="va">sub_numeric</span>, group <span class="op">=</span> <span class="va">sub</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">.3</span>, color <span class="op">=</span> <span class="st">'gray'</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/stat_summary.html">stat_summary</a></span><span class="op">(</span></span>
<span>    fun.y <span class="op">=</span> <span class="va">mean</span>, geom <span class="op">=</span> <span class="st">"point"</span>,</span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>group <span class="op">=</span><span class="va">sub_numeric</span><span class="op">)</span>, <span class="co">#EXPECT_cm),</span></span>
<span>    size <span class="op">=</span> <span class="fl">1</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>   <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">.1</span>, alpha <span class="op">=</span> <span class="fl">.1</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html">scale_colour_gradient</a></span><span class="op">(</span>low <span class="op">=</span> <span class="va">color_low</span>, high <span class="op">=</span> <span class="va">color_high</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_abline</a></span><span class="op">(</span>intercept <span class="op">=</span> <span class="fl">0</span>, slope <span class="op">=</span> <span class="fl">1</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span>, color <span class="op">=</span> <span class="va">color_low</span><span class="op">)</span> <span class="op">+</span>  <span class="co"># Add the identity line</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">'lm'</span>, formula <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="va">x</span>, se <span class="op">=</span> <span class="cn">FALSE</span>, size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span> <span class="co">#size = .3) +</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_classic</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span>,</span>
<span>              plot.margin <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">margin</a></span><span class="op">(</span>t <span class="op">=</span> <span class="fl">.3</span>, r <span class="op">=</span> <span class="fl">.1</span>, b <span class="op">=</span> <span class="fl">.1</span>, l <span class="op">=</span> <span class="fl">.1</span>, unit <span class="op">=</span> <span class="st">"pt"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_fixed.html">coord_fixed</a></span><span class="op">(</span>ratio <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html">ylim</a></span><span class="op">(</span><span class="op">-</span><span class="fl">10</span>,<span class="fl">200</span><span class="op">)</span></span>
<span>  <span class="va">g.cmc</span> <span class="op">&lt;-</span> <span class="fu">ggplot_largetext</span><span class="op">(</span><span class="va">g.cmc</span><span class="op">)</span>  <span class="co"># Assuming ggplot_largetext is a defined function</span></span>
<span>  </span>
<span>      <span class="co"># Plot for raw means ________________________________________________</span></span>
<span>  <span class="va">g.raw</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">data</span>, </span>
<span>                 <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">OUTCOME</span>, x <span class="op">=</span> <span class="va">EXPECT</span>, colour <span class="op">=</span> <span class="va">sub_numeric</span>, group <span class="op">=</span> <span class="va">sub</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">.3</span>, color <span class="op">=</span> <span class="st">'gray'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co">#     stat_summary(</span></span>
<span>  <span class="co">#   fun.y = mean, geom = "point",</span></span>
<span>  <span class="co">#   aes(group =sub_numeric), #EXPECT_cm),</span></span>
<span>  <span class="co">#   size = .1, alpha = .1</span></span>
<span>  <span class="co"># ) +</span></span>
<span>   <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">.1</span>, alpha <span class="op">=</span> <span class="fl">.1</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html">scale_colour_gradient</a></span><span class="op">(</span>low <span class="op">=</span> <span class="va">color_low</span>, high <span class="op">=</span> <span class="va">color_high</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_abline</a></span><span class="op">(</span>intercept <span class="op">=</span> <span class="fl">0</span>, slope <span class="op">=</span> <span class="fl">1</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span>, color <span class="op">=</span> <span class="va">color_low</span><span class="op">)</span> <span class="op">+</span>  <span class="co"># Add the identity line</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">'lm'</span>, formula <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="va">x</span>, se <span class="op">=</span> <span class="cn">FALSE</span>, size <span class="op">=</span> <span class="fl">.3</span><span class="op">)</span> <span class="op">+</span> <span class="co">#size = .3) +</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_classic</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span>,</span>
<span>              plot.margin <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">margin</a></span><span class="op">(</span>t <span class="op">=</span> <span class="fl">.3</span>, r <span class="op">=</span> <span class="fl">.1</span>, b <span class="op">=</span> <span class="fl">.1</span>, l <span class="op">=</span> <span class="fl">.1</span>, unit <span class="op">=</span> <span class="st">"pt"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_fixed.html">coord_fixed</a></span><span class="op">(</span>ratio <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html">ylim</a></span><span class="op">(</span><span class="op">-</span><span class="fl">10</span>,<span class="fl">200</span><span class="op">)</span></span>
<span>  <span class="va">g.raw</span> <span class="op">&lt;-</span> <span class="fu">ggplot_largetext</span><span class="op">(</span><span class="va">g.raw</span><span class="op">)</span>  <span class="co"># Assuming ggplot_largetext is a defined function</span></span>
<span>  </span>
<span>  </span>
<span>  <span class="va">arranged_plots</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fu">ggpubr</span><span class="fu">::</span><span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/ggarrange.html">ggarrange</a></span><span class="op">(</span></span>
<span>        <span class="va">g.demean</span>, <span class="va">g.Ocm</span>, <span class="va">g.cm</span>, <span class="va">g.z</span>, <span class="va">g.z2</span>, <span class="va">g.Odemean</span>, <span class="va">g.cmc</span>, <span class="va">g.raw</span>,</span>
<span>        common.legend <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>        legend <span class="op">=</span> <span class="st">"none"</span>,</span>
<span>        ncol <span class="op">=</span> <span class="fl">4</span>,</span>
<span>        nrow <span class="op">=</span> <span class="fl">2</span>,</span>
<span>        widths <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>,</span>
<span>        heights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>,</span>
<span>        align <span class="op">=</span> <span class="st">"v"</span></span>
<span>      <span class="op">)</span><span class="op">)</span></span>
<span>  <span class="co">#return(wbeffect)</span></span>
<span>  </span>
<span>  <span class="va">annotated_plots</span> <span class="op">&lt;-</span> <span class="fu">ggpubr</span><span class="fu">::</span><span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/annotate_figure.html">annotate_figure</a></span><span class="op">(</span><span class="va">arranged_plots</span>,</span>
<span>                                   top <span class="op">=</span> <span class="va">title_grob</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/grid/grid.draw.html">grid.draw</a></span><span class="op">(</span><span class="va">annotated_plots</span><span class="op">)</span></span>
<span></span>
<span>  </span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co">#plot_endertofighi(df.PVC_center[df.PVC_center$runtype == "runtype-pain", ], "pain")</span></span></code></pre></div>
<pre><code>## Warning: The `fun.y` argument of `stat_summary()` is deprecated as of ggplot2 3.3.0.
## ℹ Please use the `fun` argument instead.
## ℹ The deprecated feature was likely used in the cueR package.
##   Please report the issue to the authors.
## This warning is displayed once every 8 hours.
## Call `lifecycle::last_lifecycle_warnings()` to see where this warning was
## generated.</code></pre>
<pre><code>## Warning: Removed 2 rows containing missing values (`geom_smooth()`).</code></pre>
<p><img src="09_scaling_files/figure-html/unnamed-chunk-17-1.png" width="960"><img src="09_scaling_files/figure-html/unnamed-chunk-17-2.png" width="960"><img src="09_scaling_files/figure-html/unnamed-chunk-17-3.png" width="960"></p>
<div class="sourceCode" id="cb281"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">subjectwise</span> <span class="op">&lt;-</span> <span class="fu">meanSummary_2continuous</span><span class="op">(</span><span class="va">df.PVC_center</span><span class="op">[</span><span class="va">df.PVC_center</span><span class="op">$</span><span class="va">runtype</span> <span class="op">==</span> <span class="st">"runtype-pain"</span>, <span class="op">]</span>, </span>
<span>                                            <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"sub"</span><span class="op">)</span>,<span class="st">"OUTCOME"</span>, <span class="st">"EXPECT"</span><span class="op">)</span></span>
<span><span class="va">subjectwise</span><span class="op">$</span><span class="va">EXPECT_cm</span> <span class="op">&lt;-</span> <span class="va">subjectwise</span><span class="op">$</span><span class="va">DV2_mean_per_sub</span></span>
<span><span class="va">subjectwise</span><span class="op">$</span><span class="va">OUTCOME_cm</span> <span class="op">&lt;-</span> <span class="va">subjectwise</span><span class="op">$</span><span class="va">DV1_mean_per_sub</span></span>
<span><span class="va">color_low</span> <span class="op">=</span> <span class="st">"red"</span>; <span class="va">color_high</span> <span class="op">=</span> <span class="st">"darkred"</span></span>
<span>    <span class="co"># Plot for Cluster-wise means ________________________________________________</span></span>
<span><span class="co"># cueR::plot_ggplot_correlation(subjectwise, y = DV1_mean_per_sub, x = DV2_mean_per_sub,</span></span>
<span><span class="co">#                         p_acc = 0.001, r_acc = 0.001, limit_min = 0, limit_max = 200, label_position = 180)</span></span>
<span><span class="va">subjectwise</span><span class="op">$</span><span class="va">sub_numeric</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="op">(</span><span class="va">subjectwise</span><span class="op">$</span><span class="va">sub</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code>## Warning: NAs introduced by coercion</code></pre>
<div class="sourceCode" id="cb283"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">g.manualOcm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">subjectwise</span>,</span>
<span>                 <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">OUTCOME_cm</span>, x <span class="op">=</span> <span class="va">EXPECT_cm</span>, colour <span class="op">=</span> <span class="va">sub_numeric</span>, group <span class="op">=</span> <span class="va">sub</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">.3</span>, color <span class="op">=</span> <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">2</span>, alpha <span class="op">=</span> <span class="fl">1</span>, color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># stat_summary(</span></span>
<span>  <span class="co">#   fun.y = mean, geom = "point",</span></span>
<span>  <span class="co">#   aes(group = sub), # Group by subject</span></span>
<span>  <span class="co">#   size = 1</span></span>
<span>  <span class="co"># ) +</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html">scale_colour_gradient</a></span><span class="op">(</span>low <span class="op">=</span> <span class="va">color_low</span>, high <span class="op">=</span> <span class="va">color_high</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_abline</a></span><span class="op">(</span>intercept <span class="op">=</span> <span class="fl">0</span>, slope <span class="op">=</span> <span class="fl">1</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span>, color <span class="op">=</span> <span class="va">color_low</span><span class="op">)</span> <span class="op">+</span>  <span class="co"># Add the identity line</span></span>
<span>    <span class="co">#geom_smooth(method = 'lm', formula = y ~ x, se = FALSE, size = 1) + #size = .3) +</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_classic</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span>,</span>
<span>              plot.margin <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">margin</a></span><span class="op">(</span>t <span class="op">=</span> <span class="fl">.3</span>, r <span class="op">=</span> <span class="fl">.1</span>, b <span class="op">=</span> <span class="fl">.1</span>, l <span class="op">=</span> <span class="fl">.1</span>, unit <span class="op">=</span> <span class="st">"pt"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_fixed.html">coord_fixed</a></span><span class="op">(</span>ratio <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html">ylim</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">200</span><span class="op">)</span></span>
<span>  <span class="va">g.manualOcm</span> <span class="op">&lt;-</span> <span class="fu">ggplot_largetext</span><span class="op">(</span><span class="va">g.manualOcm</span><span class="op">)</span>  <span class="co"># Assuming ggplot_largetext is a defined function</span></span>
<span>  <span class="va">g.manualOcm</span></span></code></pre></div>
<div class="inline-figure"><img src="09_scaling_files/figure-html/unnamed-chunk-18-1.png" width="672"></div>
<div class="sourceCode" id="cb284"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#### TODO: DEBUG WHY?</span></span>
<span>  <span class="va">mean_xy</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">x</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">y</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="va">df.PVC_center</span><span class="op">$</span><span class="va">sub_numeric</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">df.PVC_center</span><span class="op">$</span><span class="va">sub</span><span class="op">)</span></span></code></pre></div>
<pre><code>## Warning: NAs introduced by coercion</code></pre>
<div class="sourceCode" id="cb286"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>    <span class="va">g.Ocm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">df.PVC_center</span><span class="op">[</span><span class="va">df.PVC_center</span><span class="op">$</span><span class="va">runtype</span> <span class="op">==</span> <span class="st">"runtype-pain"</span>, <span class="op">]</span>,</span>
<span>                 <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">OUTCOME</span>, x <span class="op">=</span> <span class="va">EXPECT_cm</span>, colour <span class="op">=</span> <span class="va">sub_numeric</span>, group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">sub</span><span class="op">)</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">.3</span>, color <span class="op">=</span> <span class="st">'gray'</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="co">#geom_point(size = .1, alpha = .1) +</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/stat_summary.html">stat_summary</a></span><span class="op">(</span></span>
<span>    fun.data <span class="op">=</span> <span class="va">mean_xy</span>, geom <span class="op">=</span> <span class="st">"point"</span>,</span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">sub</span><span class="op">)</span><span class="op">)</span>, <span class="co"># Group by subject</span></span>
<span>    size <span class="op">=</span> <span class="fl">1</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html">scale_colour_gradient</a></span><span class="op">(</span>low <span class="op">=</span> <span class="va">color_low</span>, high <span class="op">=</span> <span class="va">color_high</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_abline</a></span><span class="op">(</span>intercept <span class="op">=</span> <span class="fl">0</span>, slope <span class="op">=</span> <span class="fl">1</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span>, color <span class="op">=</span> <span class="va">color_low</span><span class="op">)</span> <span class="op">+</span>  <span class="co"># Add the identity line</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">'lm'</span>, formula <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="va">x</span>, se <span class="op">=</span> <span class="cn">FALSE</span>, size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span> <span class="co">#size = .3) +</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_classic</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span>,</span>
<span>              plot.margin <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">margin</a></span><span class="op">(</span>t <span class="op">=</span> <span class="fl">.3</span>, r <span class="op">=</span> <span class="fl">.1</span>, b <span class="op">=</span> <span class="fl">.1</span>, l <span class="op">=</span> <span class="fl">.1</span>, unit <span class="op">=</span> <span class="st">"pt"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_fixed.html">coord_fixed</a></span><span class="op">(</span>ratio <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html">ylim</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">200</span><span class="op">)</span></span>
<span>  <span class="va">g.Ocm</span> <span class="op">&lt;-</span> <span class="fu">ggplot_largetext</span><span class="op">(</span><span class="va">g.Ocm</span><span class="op">)</span>  <span class="co"># Assuming ggplot_largetext is a defined function</span></span>
<span>  <span class="va">g.Ocm</span></span></code></pre></div>
<pre><code>## Warning: Computation failed in `stat_summary()`
## Caused by error in `h()`:
## ! error in evaluating the argument 'x' in selecting a method for function 'mean': argument "y" is missing, with no default</code></pre>
<div class="inline-figure"><img src="09_scaling_files/figure-html/unnamed-chunk-18-2.png" width="672"></div>
<div class="sourceCode" id="cb288"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Checks</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span></span>
<span><span class="va">group_counts</span> <span class="op">&lt;-</span> <span class="va">df.PVC_center</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html">count</a></span><span class="op">(</span><span class="va">sub</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">group_counts</span><span class="op">)</span></span></code></pre></div>
<pre><code>## # A tibble: 109 × 2
##    sub          n
##    &lt;chr&gt;    &lt;int&gt;
##  1 sub-0002    92
##  2 sub-0003   205
##  3 sub-0004   197
##  4 sub-0005   200
##  5 sub-0006   200
##  6 sub-0007   199
##  7 sub-0008   143
##  8 sub-0009   209
##  9 sub-0010   192
## 10 sub-0011   190
## # ℹ 99 more rows</code></pre>
<div class="sourceCode" id="cb290"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># plot</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">df.PVC_center</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">EXPECT_cm</span>, y <span class="op">=</span> <span class="va">OUTCOME</span>, color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">sub</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="09_scaling_files/figure-html/unnamed-chunk-18-3.png" width="672"></div>
<blockquote>
<p>Demeaning has a similar efect as zscoring, the only difference is that the mean is forced to 0 and the standard deviation 1 for the zscore.
in a sense, both are removing the between subject effects and homing in onthe within subject effects.</p>
</blockquote>
</div>
</div>
<div id="analysis-4-random-effects-of-expectation.-extract-subjectwise-coefficients.-see-if-they-are-similar-across-tasks." class="section level2" number="7.8">
<h2>
<span class="header-section-number">7.8</span> Analysis 4: Random effects of Expectation. extract subjectwise coefficients. see if they are similar across tasks.<a class="anchor" aria-label="anchor" href="#analysis-4-random-effects-of-expectation.-extract-subjectwise-coefficients.-see-if-they-are-similar-across-tasks."><i class="fas fa-link"></i></a>
</h2>
<div id="function-extract-random-effect-of-expectation" class="section level4" number="7.8.0.1">
<h4>
<span class="header-section-number">7.8.0.1</span> function; extract random effect of expectation<a class="anchor" aria-label="anchor" href="#function-extract-random-effect-of-expectation"><i class="fas fa-link"></i></a>
</h4>
<div class="sourceCode" id="cb291"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">extract_fix_rand_effect</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">model</span>, <span class="va">taskname</span><span class="op">)</span><span class="op">{</span></span>
<span><span class="va">fixEffect</span> <span class="op">&lt;&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/nlme/man/fixed.effects.html">fixef</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">randEffect</span> <span class="op">&lt;&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/nlme/man/random.effects.html">ranef</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">randEffect</span><span class="op">$</span><span class="va">newcoef</span> <span class="op">&lt;-</span> <span class="fu">mapvalues</span><span class="op">(</span><span class="va">randEffect</span><span class="op">$</span><span class="va">term</span>,</span>
<span>    from <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">randEffect</span><span class="op">$</span><span class="va">term</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>,</span>
<span>             <span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">randEffect</span><span class="op">$</span><span class="va">term</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span></span>
<span>             <span class="op">)</span>,</span>
<span>    to <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"rand_intercept"</span>, <span class="st">"rand_withinexpect"</span> <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">rand_subset</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">randEffect</span>, select <span class="op">=</span> <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">grpvar</span>, <span class="va">term</span>, <span class="va">condsd</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">wide_rand</span> <span class="op">&lt;-</span> <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/spread.html">spread</a></span><span class="op">(</span><span class="va">rand_subset</span>, key <span class="op">=</span> <span class="va">newcoef</span>, value <span class="op">=</span> <span class="va">condval</span><span class="op">)</span></span>
<span></span>
<span><span class="va">wide_fix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html">do.call</a></span><span class="op">(</span></span>
<span>    <span class="st">"rbind"</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">replicate</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">wide_rand</span><span class="op">)</span>,</span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">fixEffect</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>        simplify <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>    <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">wide_fix</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span><span class="va">new_wide_fix</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html">rename</a></span><span class="op">(</span><span class="va">wide_fix</span>,</span>
<span>    fix_intercept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">wide_fix</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>    fix_withinexpect <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">wide_fix</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,</span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">total</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">wide_rand</span>, <span class="va">new_wide_fix</span><span class="op">)</span></span>
<span><span class="va">total</span><span class="op">$</span><span class="va">task</span> <span class="op">&lt;-</span> <span class="va">taskname</span></span>
<span><span class="va">new_total</span> <span class="op">&lt;-</span> <span class="va">total</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">task</span>, <span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html">everything</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">new_total</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html">rename</a></span><span class="op">(</span><span class="va">total</span>, subj <span class="op">=</span> <span class="va">grp</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">new_total</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<div class="sourceCode" id="cb292"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/range.html">range</a></span><span class="op">(</span><span class="va">df.PVC_center</span><span class="op">[</span><span class="va">df.PVC_center</span><span class="op">$</span><span class="va">runtype</span> <span class="op">==</span> <span class="st">"runtype-pain"</span>, <span class="st">"EXPECT_cmc"</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] -24.73651  42.19812</code></pre>
<div class="sourceCode" id="cb294"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/range.html">range</a></span><span class="op">(</span><span class="va">df.PVC_center</span><span class="op">[</span><span class="va">df.PVC_center</span><span class="op">$</span><span class="va">runtype</span> <span class="op">==</span> <span class="st">"runtype-pain"</span>, <span class="st">"EXPECT_demean"</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] -70.10835 114.77069</code></pre>
<div class="sourceCode" id="cb296"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">cueR</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/cueR/man/print_dash.html">print_dash</a></span><span class="op">(</span><span class="st">"Correlation Pain"</span><span class="op">)</span></span></code></pre></div>
<pre><code>## 
## 
## ----------------------------------------
## Correlation Pain
## ----------------------------------------</code></pre>
<div class="sourceCode" id="cb298"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span><span class="va">df.PVC_center</span><span class="op">[</span><span class="va">df.PVC_center</span><span class="op">$</span><span class="va">runtype</span> <span class="op">==</span> <span class="st">"runtype-pain"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"OUTCOME"</span>, <span class="st">"EXPECT_demean"</span>,<span class="st">"EXPECT_cm"</span>, <span class="st">"EXPECT_cmc"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code>##                 OUTCOME EXPECT_demean EXPECT_cm EXPECT_cmc
## OUTCOME       1.0000000     0.5363011 0.5845030  0.5845030
## EXPECT_demean 0.5363011     1.0000000 0.3406594  0.3406594
## EXPECT_cm     0.5845030     0.3406594 1.0000000  1.0000000
## EXPECT_cmc    0.5845030     0.3406594 1.0000000  1.0000000</code></pre>
<div class="sourceCode" id="cb300"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">cueR</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/cueR/man/print_dash.html">print_dash</a></span><span class="op">(</span><span class="st">"Correlation Vicarious"</span><span class="op">)</span></span></code></pre></div>
<pre><code>## 
## 
## ----------------------------------------
## Correlation Vicarious
## ----------------------------------------</code></pre>
<div class="sourceCode" id="cb302"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span><span class="va">df.PVC_center</span><span class="op">[</span><span class="va">df.PVC_center</span><span class="op">$</span><span class="va">runtype</span> <span class="op">==</span> <span class="st">"runtype-vicarious"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"OUTCOME"</span>, <span class="st">"EXPECT_demean"</span>,<span class="st">"EXPECT_cm"</span>, <span class="st">"EXPECT_cmc"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code>##                 OUTCOME EXPECT_demean  EXPECT_cm EXPECT_cmc
## OUTCOME       1.0000000     0.1824976  0.2518361  0.2518361
## EXPECT_demean 0.1824976     1.0000000 -0.2433859 -0.2433859
## EXPECT_cm     0.2518361    -0.2433859  1.0000000  1.0000000
## EXPECT_cmc    0.2518361    -0.2433859  1.0000000  1.0000000</code></pre>
<div class="sourceCode" id="cb304"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">cueR</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/cueR/man/print_dash.html">print_dash</a></span><span class="op">(</span><span class="st">"Correlation Cognitive"</span><span class="op">)</span></span></code></pre></div>
<pre><code>## 
## 
## ----------------------------------------
## Correlation Cognitive
## ----------------------------------------</code></pre>
<div class="sourceCode" id="cb306"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span><span class="va">df.PVC_center</span><span class="op">[</span><span class="va">df.PVC_center</span><span class="op">$</span><span class="va">runtype</span> <span class="op">==</span> <span class="st">"runtype-cognitive"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"OUTCOME"</span>, <span class="st">"EXPECT_demean"</span>,<span class="st">"EXPECT_cm"</span>, <span class="st">"EXPECT_cmc"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code>##                 OUTCOME EXPECT_demean  EXPECT_cm EXPECT_cmc
## OUTCOME       1.0000000     0.2925215  0.3183978  0.3183978
## EXPECT_demean 0.2925215     1.0000000 -0.2133532 -0.2133532
## EXPECT_cm     0.3183978    -0.2133532  1.0000000  1.0000000
## EXPECT_cmc    0.3183978    -0.2133532  1.0000000  1.0000000</code></pre>
<div class="sourceCode" id="cb308"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model.pain_cmc</span> <span class="op">&lt;-</span> <span class="fu">lmer</span><span class="op">(</span><span class="va">OUTCOME</span> <span class="op">~</span> <span class="va">EXPECT_demean</span> <span class="op">+</span> <span class="va">EXPECT_cmc</span> <span class="op">+</span> <span class="op">(</span><span class="va">EXPECT_demean</span><span class="op">|</span><span class="va">sub</span><span class="op">)</span>, <span class="va">df.PVC_center</span><span class="op">[</span><span class="va">df.PVC_center</span><span class="op">$</span><span class="va">runtype</span> <span class="op">==</span> <span class="st">"runtype-pain"</span>, <span class="op">]</span>, <span class="op">)</span></span></code></pre></div>
<pre><code>## Warning in checkConv(attr(opt, "derivs"), opt$par, ctrl = control$checkConv, :
## Model failed to converge with max|grad| = 1.03868 (tol = 0.002, component 1)</code></pre>
<pre><code>## Warning in checkConv(attr(opt, "derivs"), opt$par, ctrl = control$checkConv, : Model is nearly unidentifiable: very large eigenvalue
##  - Rescale variables?</code></pre>
<div class="sourceCode" id="cb311"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model.vic_cmc</span> <span class="op">&lt;-</span> <span class="fu">lmer</span><span class="op">(</span><span class="va">OUTCOME</span> <span class="op">~</span> <span class="va">EXPECT_demean</span> <span class="op">+</span> <span class="va">EXPECT_cmc</span> <span class="op">+</span> <span class="op">(</span><span class="va">EXPECT_demean</span><span class="op">|</span><span class="va">sub</span><span class="op">)</span>, <span class="va">df.PVC_center</span><span class="op">[</span><span class="va">df.PVC_center</span><span class="op">$</span><span class="va">runtype</span> <span class="op">==</span> <span class="st">"runtype-vicarious"</span>, <span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code>## Warning in checkConv(attr(opt, "derivs"), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 2.02926 (tol = 0.002, component 1)

## Warning in checkConv(attr(opt, "derivs"), opt$par, ctrl = control$checkConv, : Model is nearly unidentifiable: very large eigenvalue
##  - Rescale variables?</code></pre>
<div class="sourceCode" id="cb313"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model.cog_cmc</span> <span class="op">&lt;-</span> <span class="fu">lmer</span><span class="op">(</span><span class="va">OUTCOME</span> <span class="op">~</span> <span class="va">EXPECT_demean</span> <span class="op">+</span> <span class="va">EXPECT_cmc</span> <span class="op">+</span> <span class="op">(</span><span class="va">EXPECT_demean</span><span class="op">|</span><span class="va">sub</span><span class="op">)</span>, <span class="va">df.PVC_center</span><span class="op">[</span><span class="va">df.PVC_center</span><span class="op">$</span><span class="va">runtype</span> <span class="op">==</span> <span class="st">"runtype-cognitive"</span>, <span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code>## Warning in checkConv(attr(opt, "derivs"), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.00247733 (tol = 0.002, component 1)

## Warning in checkConv(attr(opt, "derivs"), opt$par, ctrl = control$checkConv, : Model is nearly unidentifiable: very large eigenvalue
##  - Rescale variables?</code></pre>
<div class="sourceCode" id="cb315"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">cueR</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/cueR/man/print_dash.html">print_dash</a></span><span class="op">(</span><span class="st">"lmer Pain"</span><span class="op">)</span></span></code></pre></div>
<pre><code>## 
## 
## ----------------------------------------
## lmer Pain
## ----------------------------------------</code></pre>
<div class="sourceCode" id="cb317"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">model.pain_cmc</span><span class="op">)</span></span></code></pre></div>
<pre><code>## Linear mixed model fit by REML. t-tests use Satterthwaite's method [
## lmerModLmerTest]
## Formula: OUTCOME ~ EXPECT_demean + EXPECT_cmc + (EXPECT_demean | sub)
##    Data: df.PVC_center[df.PVC_center$runtype == "runtype-pain", ]
## 
## REML criterion at convergence: 52285.6
## 
## Scaled residuals: 
##     Min      1Q  Median      3Q     Max 
## -4.5259 -0.5983  0.0133  0.6028  4.3769 
## 
## Random effects:
##  Groups   Name          Variance  Std.Dev. Corr 
##  sub      (Intercept)   310.23596 17.6135       
##           EXPECT_demean   0.03432  0.1853  -0.24
##  Residual               515.88891 22.7132       
## Number of obs: 5701, groups:  sub, 108
## 
## Fixed effects:
##               Estimate Std. Error       df t value Pr(&gt;|t|)    
## (Intercept)    60.1999     1.7497  91.4795   34.41   &lt;2e-16 ***
## EXPECT_demean   0.2731     0.0218 110.6741   12.53   &lt;2e-16 ***
## EXPECT_cmc      1.2508     0.1165  98.0229   10.73   &lt;2e-16 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Correlation of Fixed Effects:
##             (Intr) EXPECT_d
## EXPECT_demn -0.264         
## EXPECT_cmc   0.018 -0.044  
## optimizer (nloptwrap) convergence code: 0 (OK)
## Model failed to converge with max|grad| = 1.03868 (tol = 0.002, component 1)
## Model is nearly unidentifiable: very large eigenvalue
##  - Rescale variables?</code></pre>
<div class="sourceCode" id="cb319"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">cueR</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/cueR/man/print_dash.html">print_dash</a></span><span class="op">(</span><span class="st">"lmer Vicarious"</span><span class="op">)</span></span></code></pre></div>
<pre><code>## 
## 
## ----------------------------------------
## lmer Vicarious
## ----------------------------------------</code></pre>
<div class="sourceCode" id="cb321"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">model.vic_cmc</span><span class="op">)</span></span></code></pre></div>
<pre><code>## Linear mixed model fit by REML. t-tests use Satterthwaite's method [
## lmerModLmerTest]
## Formula: OUTCOME ~ EXPECT_demean + EXPECT_cmc + (EXPECT_demean | sub)
##    Data: df.PVC_center[df.PVC_center$runtype == "runtype-vicarious", ]
## 
## REML criterion at convergence: 55700.6
## 
## Scaled residuals: 
##     Min      1Q  Median      3Q     Max 
## -2.9305 -0.6507 -0.2508  0.4686  5.1421 
## 
## Random effects:
##  Groups   Name          Variance  Std.Dev. Corr
##  sub      (Intercept)    50.07515  7.0764      
##           EXPECT_demean   0.01785  0.1336  0.43
##  Residual               583.37834 24.1532      
## Number of obs: 6023, groups:  sub, 109
## 
## Fixed effects:
##                Estimate Std. Error        df t value Pr(&gt;|t|)    
## (Intercept)    29.52784    0.77616 133.06762   38.04   &lt;2e-16 ***
## EXPECT_demean   0.21937    0.01912 121.52452   11.48   &lt;2e-16 ***
## EXPECT_cmc      0.53845    0.04916 137.72661   10.95   &lt;2e-16 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Correlation of Fixed Effects:
##             (Intr) EXPECT_d
## EXPECT_demn 0.404          
## EXPECT_cmc  0.044  0.119   
## optimizer (nloptwrap) convergence code: 0 (OK)
## Model failed to converge with max|grad| = 2.02926 (tol = 0.002, component 1)
## Model is nearly unidentifiable: very large eigenvalue
##  - Rescale variables?</code></pre>
<div class="sourceCode" id="cb323"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">cueR</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/cueR/man/print_dash.html">print_dash</a></span><span class="op">(</span><span class="st">"lmer Cognitive"</span><span class="op">)</span></span></code></pre></div>
<pre><code>## 
## 
## ----------------------------------------
## lmer Cognitive
## ----------------------------------------</code></pre>
<div class="sourceCode" id="cb325"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">model.cog_cmc</span><span class="op">)</span></span></code></pre></div>
<pre><code>## Linear mixed model fit by REML. t-tests use Satterthwaite's method [
## lmerModLmerTest]
## Formula: OUTCOME ~ EXPECT_demean + EXPECT_cmc + (EXPECT_demean | sub)
##    Data: df.PVC_center[df.PVC_center$runtype == "runtype-cognitive", ]
## 
## REML criterion at convergence: 52623.4
## 
## Scaled residuals: 
##     Min      1Q  Median      3Q     Max 
## -4.0906 -0.6040 -0.1525  0.4628  6.6981 
## 
## Random effects:
##  Groups   Name          Variance  Std.Dev. Corr
##  sub      (Intercept)    69.73672  8.3509      
##           EXPECT_demean   0.01815  0.1347  0.16
##  Residual               367.61753 19.1734      
## Number of obs: 5977, groups:  sub, 109
## 
## Fixed effects:
##                Estimate Std. Error        df t value Pr(&gt;|t|)    
## (Intercept)    31.08096    0.85428 102.58765   36.38   &lt;2e-16 ***
## EXPECT_demean   0.25659    0.01762 112.72401   14.56   &lt;2e-16 ***
## EXPECT_cmc      0.65240    0.05792 107.46486   11.26   &lt;2e-16 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Correlation of Fixed Effects:
##             (Intr) EXPECT_d
## EXPECT_demn 0.192          
## EXPECT_cmc  0.029  0.044   
## optimizer (nloptwrap) convergence code: 0 (OK)
## Model failed to converge with max|grad| = 0.00247733 (tol = 0.002, component 1)
## Model is nearly unidentifiable: very large eigenvalue
##  - Rescale variables?</code></pre>
<div class="sourceCode" id="cb327"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># stack random effects across pain, vicarious, cognitive task __________________</span></span>
<span><span class="va">dfP</span> <span class="op">&lt;-</span> <span class="fu">extract_fix_rand_effect</span><span class="op">(</span><span class="va">model.pain_cmc</span>, <span class="st">"pain"</span><span class="op">)</span></span>
<span><span class="va">dfV</span> <span class="op">&lt;-</span> <span class="fu">extract_fix_rand_effect</span><span class="op">(</span><span class="va">model.vic_cmc</span>, <span class="st">"vicarious"</span><span class="op">)</span></span>
<span><span class="va">dfC</span> <span class="op">&lt;-</span> <span class="fu">extract_fix_rand_effect</span><span class="op">(</span><span class="va">model.cog_cmc</span>, <span class="st">"cognitive"</span><span class="op">)</span></span>
<span><span class="va">pvc_rand</span> <span class="op">&lt;-</span> <span class="fu">reshape</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/reshape/man/merge-recurse-2d.html">merge_recurse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">dfP</span>, <span class="va">dfV</span>, <span class="va">dfC</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">pvc_rand</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] "subj"              "rand_intercept"    "rand_withinexpect"
## [4] "fix_intercept"     "fix_withinexpect"  "EXPECT_cmc"       
## [7] "task"</code></pre>
<div class="sourceCode" id="cb329"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># subset data with just the random slopes ______________________________________</span></span>
<span><span class="va">pvc_rand_within_subset</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">pvc_rand</span>, select <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">task</span>, <span class="va">subj</span>, <span class="va">rand_withinexpect</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">pvc_rand_cue</span> <span class="op">&lt;-</span> <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/spread.html">spread</a></span><span class="op">(</span><span class="va">pvc_rand_within_subset</span>, key <span class="op">=</span> <span class="va">task</span>, value <span class="op">=</span> <span class="va">rand_withinexpect</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># plot per task and aggregate __________________________________________________</span></span>
<span><span class="va">pv</span> <span class="op">&lt;-</span> <span class="fu">cueR</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/cueR/man/plot_ggplot_correlation.html">plot_ggplot_correlation</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">pvc_rand_cue</span>, x <span class="op">=</span> <span class="st">'vicarious'</span>, y <span class="op">=</span> <span class="st">'pain'</span>, </span>
<span>                                    p_acc <span class="op">=</span> <span class="fl">0.001</span>, r_acc <span class="op">=</span> <span class="fl">0.01</span>, </span>
<span>                                    limit_min <span class="op">=</span> <span class="op">-</span><span class="fl">.75</span>, limit_max <span class="op">=</span> <span class="fl">.75</span>, label_position <span class="op">=</span> <span class="fl">.6</span><span class="op">)</span></span>
<span><span class="va">vc</span> <span class="op">&lt;-</span> <span class="fu">cueR</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/cueR/man/plot_ggplot_correlation.html">plot_ggplot_correlation</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">pvc_rand_cue</span>, x <span class="op">=</span> <span class="st">'cognitive'</span>, y <span class="op">=</span> <span class="st">'vicarious'</span>, </span>
<span>                                    p_acc <span class="op">=</span> <span class="fl">0.001</span>, r_acc <span class="op">=</span> <span class="fl">0.01</span>, </span>
<span>                                    limit_min <span class="op">=</span> <span class="op">-</span><span class="fl">.75</span>, limit_max <span class="op">=</span> <span class="fl">.75</span>, label_position <span class="op">=</span> <span class="fl">.6</span><span class="op">)</span></span>
<span><span class="va">cp</span> <span class="op">&lt;-</span> <span class="fu">cueR</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/cueR/man/plot_ggplot_correlation.html">plot_ggplot_correlation</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">pvc_rand_cue</span>, x <span class="op">=</span> <span class="st">'pain'</span>, y <span class="op">=</span> <span class="st">'cognitive'</span>, </span>
<span>                                    p_acc <span class="op">=</span> <span class="fl">0.001</span>, r_acc <span class="op">=</span> <span class="fl">0.01</span>, </span>
<span>                                    limit_min <span class="op">=</span> <span class="op">-</span><span class="fl">.75</span>, limit_max <span class="op">=</span> <span class="fl">.75</span>, label_position <span class="op">=</span> <span class="fl">.6</span><span class="op">)</span></span>
<span></span>
<span><span class="va">plots</span> <span class="op">&lt;-</span> <span class="fu">ggpubr</span><span class="fu">::</span><span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/ggarrange.html">ggarrange</a></span><span class="op">(</span><span class="va">pv</span>, <span class="va">vc</span>, <span class="va">cp</span>, ncol <span class="op">=</span> <span class="fl">3</span>, nrow <span class="op">=</span> <span class="fl">1</span>, common.legend <span class="op">=</span> <span class="cn">FALSE</span>, legend <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span></span></code></pre></div>
<pre><code>## Warning: Removed 1 rows containing non-finite values (`stat_cor()`).</code></pre>
<pre><code>## Warning: Removed 1 rows containing missing values (`geom_point()`).</code></pre>
<pre><code>## Warning: Removed 1 rows containing non-finite values (`stat_cor()`).</code></pre>
<pre><code>## Warning: Removed 1 rows containing missing values (`geom_point()`).</code></pre>
<div class="sourceCode" id="cb334"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">title_text</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="fu">tools</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/tools/toTitleCase.html">toTitleCase</a></span><span class="op">(</span><span class="st">"individual differences\n - expectation effects on outcome ratings"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">title_grob</span> <span class="op">&lt;-</span> <span class="fu">grid</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/grid.text.html">textGrob</a></span><span class="op">(</span><span class="va">title_text</span>, gp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/gpar.html">gpar</a></span><span class="op">(</span>fontsize <span class="op">=</span> <span class="fl">18</span><span class="op">)</span>, vjust <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">plots_title</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/annotate_figure.html">annotate_figure</a></span><span class="op">(</span><span class="va">plots</span>, top <span class="op">=</span> <span class="va">title_grob</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># save plots ___________________________________________________________________</span></span>
<span><span class="co"># save_plotname &lt;- file.path(</span></span>
<span><span class="co">#     analysis_dir,</span></span>
<span><span class="co">#     paste("randeffect_scatterplot_task-all_",</span></span>
<span><span class="co">#         as.character(Sys.Date()), ".png",</span></span>
<span><span class="co">#         sep = ""</span></span>
<span><span class="co">#     )</span></span>
<span><span class="co"># )</span></span>
<span><span class="co"># ggsave(save_plotname, width = 10, height = 3)</span></span>
<span><span class="va">plots_title</span></span></code></pre></div>
<div class="inline-figure"><img src="09_scaling_files/figure-html/unnamed-chunk-21-1.png" width="672"></div>
</div>
</div>
<div id="random-effect-distribution" class="section level2" number="7.9">
<h2>
<span class="header-section-number">7.9</span> Random effect distribution<a class="anchor" aria-label="anchor" href="#random-effect-distribution"><i class="fas fa-link"></i></a>
</h2>
<div class="sourceCode" id="cb335"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org">tidyr</a></span><span class="op">)</span></span></code></pre></div>
<pre><code>## 
## Attaching package: 'tidyr'</code></pre>
<pre><code>## The following object is masked from 'package:reshape2':
## 
##     smiths</code></pre>
<pre><code>## The following objects are masked from 'package:Matrix':
## 
##     expand, pack, unpack</code></pre>
<div class="sourceCode" id="cb339"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Reshape the data to long format ______________________________________________</span></span>
<span><span class="va">long_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span><span class="va">pvc_rand_cue</span>, cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">pain</span>, <span class="va">vicarious</span>, <span class="va">cognitive</span><span class="op">)</span>, names_to <span class="op">=</span> <span class="st">"task"</span>, values_to <span class="op">=</span> <span class="st">"expectation_randomeffects"</span><span class="op">)</span></span>
<span><span class="va">long_data</span><span class="op">$</span><span class="va">task</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">long_data</span><span class="op">$</span><span class="va">task</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"pain"</span>, <span class="st">"vicarious"</span>, <span class="st">"cognitive"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">custom_colors</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"pain"</span> <span class="op">=</span> <span class="st">"#941100"</span>, <span class="st">"vicarious"</span> <span class="op">=</span> <span class="st">"#008F51"</span>, <span class="st">"cognitive"</span> <span class="op">=</span> <span class="st">"#011891"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plotting all three distributions in one plot ______________________________________________</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">long_data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">expectation_randomeffects</span>, fill <span class="op">=</span> <span class="va">task</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span>position <span class="op">=</span> <span class="st">"identity"</span>, alpha <span class="op">=</span> <span class="fl">0.5</span>, bins <span class="op">=</span> <span class="fl">30</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="va">custom_colors</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="va">custom_colors</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html">geom_density</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">task</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">1.2</span>, alpha <span class="op">=</span> <span class="fl">1</span>, fill <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span> <span class="va">task</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_classic</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">"Random effects of Expectation ratings - distributions of Pain, Vicarious, and Cognitive"</span><span class="op">)</span></span></code></pre></div>
<pre><code>## Warning: Removed 1 rows containing non-finite values (`stat_bin()`).</code></pre>
<pre><code>## Warning: Removed 1 rows containing non-finite values (`stat_density()`).</code></pre>
<div class="inline-figure"><img src="09_scaling_files/figure-html/unnamed-chunk-22-1.png" width="672"></div>
<div class="sourceCode" id="cb342"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># overlay at once ______________________________________________</span></span>
<span><span class="co"># Plotting all three distributions overlaid in one plot</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">long_data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">expectation_randomeffects</span>, fill <span class="op">=</span> <span class="va">task</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span>position <span class="op">=</span> <span class="st">"identity"</span>, alpha <span class="op">=</span> <span class="fl">0.5</span>, bins <span class="op">=</span> <span class="fl">50</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">..density..</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="co">#geom_density(alpha = 0.5, size = .5) +</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html">geom_density</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">task</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">1.2</span>, alpha <span class="op">=</span> <span class="fl">1</span>, fill <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="va">custom_colors</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="va">custom_colors</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_classic</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">"Random effects of Expectation ratings - distributions of Pain, Vicarious, and Cognitive"</span><span class="op">)</span></span></code></pre></div>
<pre><code>## Warning: The dot-dot notation (`..density..`) was deprecated in ggplot2 3.4.0.
## ℹ Please use `after_stat(density)` instead.
## This warning is displayed once every 8 hours.
## Call `lifecycle::last_lifecycle_warnings()` to see where this warning was
## generated.</code></pre>
<pre><code>## Warning: Removed 1 rows containing non-finite values (`stat_bin()`).</code></pre>
<pre><code>## Warning: Removed 1 rows containing non-finite values (`stat_density()`).</code></pre>
<div class="inline-figure"><img src="09_scaling_files/figure-html/unnamed-chunk-22-2.png" width="672"></div>
<div class="sourceCode" id="cb346"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Random effect ________________________________________________________________</span></span>
<span><span class="co"># fixEffect &lt;&lt;- as.data.frame(fixef(model.pain_cmc))</span></span>
<span><span class="co"># randEffect &lt;&lt;- as.data.frame(ranef(model.pain_cmc))</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># </span></span>
<span><span class="co"># randEffect$newcoef &lt;- mapvalues(randEffect$term,</span></span>
<span><span class="co">#     from = c(as.character(unique(randEffect$term)[1]),</span></span>
<span><span class="co">#              as.character(unique(randEffect$term)[2])</span></span>
<span><span class="co">#              ),</span></span>
<span><span class="co">#     to = c("rand_intercept", "rand_withinexpect" )</span></span>
<span><span class="co"># )</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># rand_subset &lt;- subset(randEffect, select = -c(grpvar, term, condsd))</span></span>
<span><span class="co"># wide_rand &lt;- tidyr::spread(rand_subset, key = newcoef, value = condval)</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># wide_fix &lt;- do.call(</span></span>
<span><span class="co">#     "rbind",</span></span>
<span><span class="co">#     replicate(nrow(wide_rand),</span></span>
<span><span class="co">#         as.data.frame(t(as.matrix(fixEffect))),</span></span>
<span><span class="co">#         simplify = FALSE</span></span>
<span><span class="co">#     )</span></span>
<span><span class="co"># )</span></span>
<span><span class="co"># rownames(wide_fix) &lt;- NULL</span></span>
<span><span class="co"># new_wide_fix &lt;- dplyr::rename(wide_fix,</span></span>
<span><span class="co">#     fix_intercept = colnames(wide_fix)[1],</span></span>
<span><span class="co">#     fix_withinexpect = colnames(wide_fix)[2],</span></span>
<span><span class="co"># )</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># total &lt;- cbind(wide_rand, new_wide_fix)</span></span>
<span><span class="co"># total$task &lt;- taskname</span></span>
<span><span class="co"># new_total &lt;- total %&gt;% dplyr::select(task, everything())</span></span>
<span><span class="co"># new_total &lt;- dplyr::rename(total, subj = grp)</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># rand_savefname &lt;- file.path(</span></span>
<span><span class="co">#     analysis_dir,</span></span>
<span><span class="co">#     paste("randeffect_task-", taskname, "_",</span></span>
<span><span class="co">#         as.character(Sys.Date()), "_outlier-cooksd.csv",</span></span>
<span><span class="co">#         sep = ""</span></span>
<span><span class="co">#     )</span></span>
<span><span class="co"># )</span></span>
<span><span class="co"># write.csv(new_total, rand_savefname, row.names = FALSE)</span></span>
<span></span>
<span><span class="co">###################################### reference</span></span>
<span><span class="co">#     cooksd &lt;- cueR::lmer_onefactor_cooksd(data, taskname, iv, dv, subject, dv_keyword, model_savefname, print_lmer_output) # run lmer</span></span>
<span><span class="co">#     influential &lt;- as.numeric(names(cooksd)[</span></span>
<span><span class="co">#     (cooksd &gt; (4 / as.numeric(length(unique(data$subject)))))])</span></span>
<span><span class="co">#     data_screen &lt;- data[-influential, ]</span></span>
<span><span class="co"># </span></span>
<span><span class="co">#     ## summary statistics</span></span>
<span><span class="co">#     subjectwise &lt;- meanSummary(data_screen, c(subject, iv), dv)</span></span>
<span><span class="co">#     groupwise &lt;- summarySEwithin(</span></span>
<span><span class="co">#         data = subjectwise,</span></span>
<span><span class="co">#         measurevar = subjectwise_mean, # variable created from above</span></span>
<span><span class="co">#         withinvars = c(iv), # iv</span></span>
<span><span class="co">#         idvar = "subject"</span></span>
<span><span class="co">#     )</span></span>
<span><span class="co"># </span></span>
<span><span class="co">#     ## designate plot save location</span></span>
<span><span class="co">#     ggtitle &lt;- paste0(str_to_title(taskname), ggtitle_phrase, " N = (", length(unique(data$subject)), ")");</span></span>
<span><span class="co">#     title &lt;- paste0(str_to_title(taskname), " - ", str_to_title(dv_keyword))</span></span>
<span><span class="co">#     w = 5; h = 3;</span></span>
<span><span class="co">#     plot_savefname &lt;- file.path(analysis_dir,</span></span>
<span><span class="co">#                                 paste0("raincloud_task", taskname,"iv-", iv_keyword, "_dv-rating-", dv_keyword,"_", as.character(Sys.Date()), ".png")</span></span>
<span><span class="co">#                                 )</span></span>
<span><span class="co"># </span></span>
<span><span class="co">#     # plot_rainclouds_onefactor</span></span>
<span><span class="co">#     p1 &lt;- plot_halfrainclouds_onefactor(</span></span>
<span><span class="co">#         subjectwise, groupwise,</span></span>
<span><span class="co">#         iv, subjectwise_mean, group_mean, se, subject,</span></span>
<span><span class="co">#         ggtitle, title, xlab, ylab, task_name,ylim,</span></span>
<span><span class="co">#         w, h, dv_keyword, color_scheme, plot_savefname</span></span>
<span><span class="co">#     )</span></span>
<span><span class="co"># randEffect$newcoef &lt;- mapvalues(randEffect$term,</span></span>
<span><span class="co">#     from = c(as.character(unique(randEffect$term)[1]),</span></span>
<span><span class="co">#              as.character(unique(randEffect$term)[2])</span></span>
<span><span class="co">#              ),</span></span>
<span><span class="co">#     to = c("rand_intercept", "rand_cue")</span></span>
<span><span class="co"># )</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># rand_subset &lt;- subset(randEffect, select = -c(grpvar, term, condsd))</span></span>
<span><span class="co"># wide_rand &lt;- spread(rand_subset, key = newcoef, value = condval)</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># wide_fix &lt;- do.call(</span></span>
<span><span class="co">#     "rbind",</span></span>
<span><span class="co">#     replicate(nrow(wide_rand),</span></span>
<span><span class="co">#         as.data.frame(t(as.matrix(fixEffect))),</span></span>
<span><span class="co">#         simplify = FALSE</span></span>
<span><span class="co">#     )</span></span>
<span><span class="co"># )</span></span>
<span><span class="co"># rownames(wide_fix) &lt;- NULL</span></span>
<span><span class="co"># new_wide_fix &lt;- dplyr::rename(wide_fix,</span></span>
<span><span class="co">#     fix_intercept = colnames(wide_fix)[1],</span></span>
<span><span class="co">#     fix_cue = colnames(wide_fix)[2],</span></span>
<span><span class="co"># )</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># total &lt;- cbind(wide_rand, new_wide_fix)</span></span>
<span><span class="co"># total$task &lt;- taskname</span></span>
<span><span class="co"># new_total &lt;- total %&gt;% dplyr::select(task, everything())</span></span>
<span><span class="co"># new_total &lt;- dplyr::rename(total, subj = grp)</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># rand_savefname &lt;- file.path(</span></span>
<span><span class="co">#     analysis_dir,</span></span>
<span><span class="co">#     paste("randeffect_task-", taskname, "_",</span></span>
<span><span class="co">#         as.character(Sys.Date()), "_outlier-cooksd.csv",</span></span>
<span><span class="co">#         sep = ""</span></span>
<span><span class="co">#     )</span></span>
<span><span class="co"># )</span></span>
<span><span class="co"># write.csv(new_total, rand_savefname, row.names = FALSE)</span></span></code></pre></div>
</div>
<div id="analysis-5-buchel.-plot-the-distribution-of-stimulus-intensity-as-a-function-of-pain-sensitivity-people" class="section level2" number="7.10">
<h2>
<span class="header-section-number">7.10</span> Analysis 5: Buchel. plot the distribution of stimulus intensity as a function of pain sensitivity people<a class="anchor" aria-label="anchor" href="#analysis-5-buchel.-plot-the-distribution-of-stimulus-intensity-as-a-function-of-pain-sensitivity-people"><i class="fas fa-link"></i></a>
</h2>
</div>
<div id="analysis-6-create-rawzscore-cue-effect" class="section level2" number="7.11">
<h2>
<span class="header-section-number">7.11</span> Analysis 6: create raw/zscore cue effect<a class="anchor" aria-label="anchor" href="#analysis-6-create-rawzscore-cue-effect"><i class="fas fa-link"></i></a>
</h2>
<p>TODO: create new Rmd</p>
<div class="sourceCode" id="cb347"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">df.PVC_center</span><span class="op">)</span></span></code></pre></div>
<pre><code>## # A tibble: 6 × 35
##   src_subject_id session_id param_run_num param_task_name event02_expect_angle
##            &lt;int&gt;      &lt;int&gt;         &lt;int&gt; &lt;chr&gt;                          &lt;dbl&gt;
## 1              2          1             1 pain                            5.53
## 2              2          1             1 pain                           18.9 
## 3              2          1             1 pain                          103.  
## 4              2          1             1 pain                           81.2 
## 5              2          1             1 pain                           97.2 
## 6              2          1             1 pain                          117.  
## # ℹ 30 more variables: param_cue_type &lt;chr&gt;, param_stimulus_type &lt;chr&gt;,
## #   event04_actual_angle &lt;dbl&gt;, trial_index &lt;int&gt;, trial_count_sub &lt;int&gt;,
## #   trial_ind &lt;dbl&gt;, sub &lt;chr&gt;, ses &lt;chr&gt;, run &lt;chr&gt;, runtype &lt;chr&gt;,
## #   task &lt;chr&gt;, trial_sub &lt;int&gt;, trial &lt;chr&gt;, cuetype &lt;chr&gt;,
## #   stimintensity &lt;chr&gt;, DEPc &lt;chr&gt;, DEP &lt;chr&gt;, OUTCOME &lt;dbl&gt;, EXPECT &lt;dbl&gt;,
## #   OUTCOME_cm &lt;dbl&gt;, OUTCOME_demean &lt;dbl&gt;, EXPECT_cm &lt;dbl&gt;,
## #   EXPECT_demean &lt;dbl&gt;, OUTCOME_zscore &lt;dbl&gt;, EXPECT_zscore &lt;dbl&gt;, …</code></pre>
<div class="sourceCode" id="cb349"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dv</span> <span class="op">&lt;-</span> <span class="st">"OUTCOME"</span></span>
<span></span>
<span><span class="co"># 3. calculate difference scores and summarize _____________________________</span></span>
<span><span class="va">sub_diff</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">df.PVC_center</span>,</span>
<span>                   select <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"sub"</span>, <span class="st">"ses"</span>, <span class="st">"run"</span>, <span class="st">"task"</span>, <span class="st">"stimintensity"</span>, <span class="st">"cuetype"</span>, <span class="va">dv</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">sub_diff</span><span class="op">)</span></span></code></pre></div>
<pre><code>## # A tibble: 6 × 7
##   sub      ses    run    task  stimintensity cuetype      OUTCOME
##   &lt;chr&gt;    &lt;chr&gt;  &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;         &lt;chr&gt;          &lt;dbl&gt;
## 1 sub-0002 ses-01 run-01 pain  low           cuetype-low     40.1
## 2 sub-0002 ses-01 run-01 pain  high          cuetype-low    107. 
## 3 sub-0002 ses-01 run-01 pain  low           cuetype-high    70.8
## 4 sub-0002 ses-01 run-01 pain  med           cuetype-high    77.7
## 5 sub-0002 ses-01 run-01 pain  high          cuetype-high   115. 
## 6 sub-0002 ses-01 run-01 pain  low           cuetype-high    76.6</code></pre>
<div class="sourceCode" id="cb351"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sub_diff_NA</span> <span class="op">&lt;-</span> <span class="va">sub_diff</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">dv</span><span class="op">)</span><span class="op">)</span>  <span class="co"># drop NA</span></span>
<span><span class="co"># ___ 1) first, summarize each condition _______________________________________</span></span>
<span><span class="va">subjectwise</span> <span class="op">&lt;-</span> <span class="fu">meanSummary</span><span class="op">(</span><span class="va">sub_diff_NA</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>    <span class="st">"sub"</span>, <span class="st">"ses"</span>, <span class="st">"run"</span>,</span>
<span>    <span class="st">"task"</span>, <span class="st">"cuetype"</span>,</span>
<span>    <span class="st">"stimintensity"</span><span class="op">)</span>, <span class="va">dv</span><span class="op">)</span></span>
<span><span class="co"># ___ 2) spread out high and low cue columns ___________________________________</span></span>
<span><span class="va">mean_outcome</span> <span class="op">&lt;-</span> <span class="va">subjectwise</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">subjectwise</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">wide</span> <span class="op">&lt;-</span> <span class="va">mean_outcome</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/spread.html">spread</a></span><span class="op">(</span><span class="va">cuetype</span>, <span class="va">mean_per_sub</span><span class="op">)</span></span>
<span><span class="co"># ___ 3) calculate difference score "cue effect" _______________________________</span></span>
<span><span class="va">wide</span><span class="op">$</span><span class="va">diff</span> <span class="op">&lt;-</span> <span class="va">wide</span><span class="op">$</span><span class="va">`cuetype-high`</span> <span class="op">-</span> <span class="va">wide</span><span class="op">$</span><span class="va">`cuetype-low`</span></span>
<span><span class="va">subjectwise_diff</span> <span class="op">&lt;-</span> <span class="fu">meanSummary</span><span class="op">(</span><span class="va">wide</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"sub"</span>, <span class="st">"task"</span><span class="op">)</span>, <span class="st">"diff"</span><span class="op">)</span></span>
<span><span class="va">subjectwise_NA</span> <span class="op">&lt;-</span> <span class="va">subjectwise_diff</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">sd</span><span class="op">)</span><span class="op">)</span> <span class="co"># drop na values</span></span>
<span><span class="co"># ___ 4) calculate group wise contrast  _______________________________________</span></span>
<span><span class="va">groupwise_diff</span> <span class="op">&lt;-</span> <span class="fu">Rmisc</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Rmisc/man/summarySEwithin.html">summarySEwithin</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">subjectwise_NA</span>,</span>
<span>    measurevar <span class="op">=</span> <span class="st">"mean_per_sub"</span>, <span class="co"># variable created from above</span></span>
<span>    withinvars <span class="op">=</span> <span class="st">"task"</span>, <span class="co"># iv</span></span>
<span>    idvar <span class="op">=</span> <span class="st">"sub"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code>## Automatically converting the following non-factors to factors: task</code></pre>
<div class="sourceCode" id="cb353"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">groupwise_diff</span><span class="op">)</span></span></code></pre></div>
<pre><code>##        task   N mean_per_sub       sd        se       ci
## 1 cognitive 109     8.164638 6.102858 0.5845478 1.158675
## 2      pain 108     8.184808 7.561432 0.7275991 1.442380
## 3 vicarious 109     8.212411 5.560329 0.5325829 1.055672</code></pre>
<div class="sourceCode" id="cb355"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># save dataframe _______________________________________________________________</span></span>
<span><span class="va">sorted_df</span> <span class="op">&lt;-</span> <span class="va">subjectwise_diff</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="va">task</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html">rename</a></span><span class="op">(</span>cue_contrast_high_gt_low <span class="op">=</span> <span class="va">mean_per_sub</span><span class="op">)</span></span>
<span><span class="co"># write.csv(sorted_df, file = file.path(main_dir,"analysis", "mixedeffect", "dataframes", "beh_cueeffect_rawoutcome.csv"), row.names = FALSE)</span></span>
<span></span>
<span><span class="co"># TODO: create json file for describing file metadata. BIDS format please</span></span>
<span><span class="co"># column_metadata &lt;- list(</span></span>
<span><span class="co">#   sub = list(</span></span>
<span><span class="co"># description = "subject id in BIDS formats"</span></span>
<span><span class="co"># labels = "sub-%04d"</span></span>
<span><span class="co"># ),</span></span>
<span><span class="co">#   task = list(</span></span>
<span><span class="co">#     description = "Task performed by the subject in cue expectancy task",</span></span>
<span><span class="co">#     generation_info = "counter balanced across runs. However number of runs performed are included in computations. Subjects may have different frequencies of tasks performed. Some may have completed 6 pain runs, whereas other may have completed 2 pain runs, depending on how many sessions they attended. ",</span></span>
<span><span class="co">#     labels = c("pain", "vicarious", "cognitive")</span></span>
<span><span class="co">#   ),</span></span>
<span><span class="co">#   cue_contrast_high_gt_low = list(</span></span>
<span><span class="co">#     description = "Mean cue difference (high vs. low cue) per subject",</span></span>
<span><span class="co">#     generation_info = "Calculated as the mean of cue effects across participants, per task ",</span></span>
<span><span class="co">#   ),</span></span>
<span><span class="co">#   sd = list(</span></span>
<span><span class="co">#     description = "Standard deviasion",</span></span>
<span><span class="co">#     generation_info = "How column3 was generated",</span></span>
<span><span class="co">#     labels = c("Label1", "Label2", "Label3")</span></span>
<span><span class="co">#   )</span></span>
<span><span class="co"># )</span></span></code></pre></div>
<blockquote>
<p>Summary:</p>
</blockquote>
<div id="plot" class="section level3 unlisted unnumbered">
<h3>plot<a class="anchor" aria-label="anchor" href="#plot"><i class="fas fa-link"></i></a>
</h3>
<p>We’ll plot Y as a function of A and B
X axis:
Y axis:
Each data point indicates …</p>
<blockquote>
<p>Conclusion:</p>
</blockquote>
<div class="infobox">
<p>Include the actual content here. here are my thoughts</p>
</div>
<div class="refbox">
<p>Include the actual content here. here are my thoughts</p>
</div>

</div>
</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="jepma.html"><span class="header-section-number">6</span> beh :: expect-outcome ~ cue * trial</a></div>
<div class="next"><a href="variability.html"><span class="header-section-number">8</span> beh :: rating variability</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#scaling"><span class="header-section-number">7</span> within / between subject effect and Scaling</a></li>
<li><a class="nav-link" href="#what-is-the-purpose-of-this-notebook-4">What is the purpose of this notebook?</a></li>
<li>
<a class="nav-link" href="#todo-1"><span class="header-section-number">7.1</span> TODO:</a><ul class="nav navbar-nav"><li><a class="nav-link" href="#load-libraries">load libraries</a></li></ul>
</li>
<li><a class="nav-link" href="#computed_enderstofighi"><span class="header-section-number">7.2</span> computed_enderstofighi</a></li>
<li>
<a class="nav-link" href="#analysis-1-pain-display-distribution-of-data"><span class="header-section-number">7.3</span> Analysis 1: Pain display distribution of data</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#plot-outcome-rating-distribution"><span class="header-section-number">7.3.1</span> Plot Outcome rating distribution</a></li>
<li><a class="nav-link" href="#identify-subjects-with-narrow-iqr"><span class="header-section-number">7.3.2</span> Identify subjects with narrow IQR</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#analysis-2-z-score-vs.-not-model-comparison"><span class="header-section-number">7.4</span> Analysis 2: Z score vs. not model comparison</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#lmer-model-compare-z-score-vs-nonzscore">lmer model compare z score vs nonzscore</a></li>
<li><a class="nav-link" href="#plot-subjectwise-slopes-of-zscore-and-nonzscore"><span class="header-section-number">7.4.1</span> plot :: subjectwise slopes of Zscore and nonZscore</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#analysis-3-across-pvc-are-these-expectation-effects-domain-general-or-domain-specific"><span class="header-section-number">7.5</span> Analysis 3: across PVC, Are these expectation effects domain-general or domain-specific?</a><ul class="nav navbar-nav"><li><a class="nav-link" href="#load-entire-data-of-painvicariouscognitive">load entire data of pain,vicarious,cognitive</a></li></ul>
</li>
<li>
<a class="nav-link" href="#validate-correlation-matrix-across-centered-variables"><span class="header-section-number">7.6</span> Validate: correlation matrix across centered variables</a><ul class="nav navbar-nav"><li><a class="nav-link" href="#plot-per-participant.-outcome-expect-demean"><span class="header-section-number">7.6.1</span> plot per participant. Outcome, Expect, demean</a></li></ul>
</li>
<li>
<a class="nav-link" href="#analysis-3"><span class="header-section-number">7.7</span> Analysis 3</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#lmer-model-compare-z-score-vs-nonzscore-1"><span class="header-section-number">7.7.1</span> lmer model compare z score vs nonzscore</a></li>
<li><a class="nav-link" href="#check-lmer-cmc-model"><span class="header-section-number">7.7.2</span> check lmer CMC model</a></li>
<li><a class="nav-link" href="#lmer-combined-coefficients-into-table"><span class="header-section-number">7.7.3</span> lmer combined coefficients into table</a></li>
<li><a class="nav-link" href="#plot-how-much-of-the-cmcs-predict-outcome-ratings"><span class="header-section-number">7.7.4</span> plot how much of the CMCs predict outcome ratings</a></li>
<li><a class="nav-link" href="#plot-how-much-of-the-demeans-predict-outcome-ratings"><span class="header-section-number">7.7.5</span> plot how much of the demeans predict outcome ratings</a></li>
</ul>
</li>
<li><a class="nav-link" href="#analysis-4-random-effects-of-expectation.-extract-subjectwise-coefficients.-see-if-they-are-similar-across-tasks."><span class="header-section-number">7.8</span> Analysis 4: Random effects of Expectation. extract subjectwise coefficients. see if they are similar across tasks.</a></li>
<li><a class="nav-link" href="#random-effect-distribution"><span class="header-section-number">7.9</span> Random effect distribution</a></li>
<li><a class="nav-link" href="#analysis-5-buchel.-plot-the-distribution-of-stimulus-intensity-as-a-function-of-pain-sensitivity-people"><span class="header-section-number">7.10</span> Analysis 5: Buchel. plot the distribution of stimulus intensity as a function of pain sensitivity people</a></li>
<li>
<a class="nav-link" href="#analysis-6-create-rawzscore-cue-effect"><span class="header-section-number">7.11</span> Analysis 6: create raw/zscore cue effect</a><ul class="nav navbar-nav"><li><a class="nav-link" href="#plot">plot</a></li></ul>
</li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/jungheejung/cue_expectancy/blob/master/09_scaling.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/jungheejung/cue_expectancy/edit/master/09_scaling.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Your Document Title</strong>" was written by Your Name. It was last built on 16 January, 2024.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer>
</body>
</html>
