<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 16 [fMRI] FIR ~ task TTL1 | 52_ROI TTL1</title>
  <meta name="description" content="This is a logbook of all the mixed model analyses in one setting." />
  <meta name="generator" content="bookdown 0.37 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 16 [fMRI] FIR ~ task TTL1 | 52_ROI TTL1" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="This is a logbook of all the mixed model analyses in one setting." />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 16 [fMRI] FIR ~ task TTL1 | 52_ROI TTL1" />
  
  <meta name="twitter:description" content="This is a logbook of all the mixed model analyses in one setting." />
  

<meta name="author" content="Heejung Jung" />


<meta name="date" content="2023-08-14" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="taskwise-6-cond-effect.html"/>

<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/codefolding-lua-1.1/codefolding-lua.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.10.3/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-2.11.1/plotly-latest.min.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> About</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#usage"><i class="fa fa-check"></i><b>1.1</b> Usage</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="ch2_expect.html"><a href="ch2_expect.html"><i class="fa fa-check"></i><b>2</b> [beh] expectation ~ cue</a>
<ul>
<li class="chapter" data-level="2.1" data-path="ch2_expect.html"><a href="ch2_expect.html#pain"><i class="fa fa-check"></i><b>2.1</b> Pain</a></li>
<li class="chapter" data-level="2.2" data-path="ch2_expect.html"><a href="ch2_expect.html#vicarious"><i class="fa fa-check"></i><b>2.2</b> Vicarious</a></li>
<li class="chapter" data-level="2.3" data-path="ch2_expect.html"><a href="ch2_expect.html#cognitive"><i class="fa fa-check"></i><b>2.3</b> Cognitive</a></li>
<li class="chapter" data-level="2.4" data-path="ch2_expect.html"><a href="ch2_expect.html#individual-difference-analysis"><i class="fa fa-check"></i><b>2.4</b> Individual difference analysis</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="ch03_cue.html"><a href="ch03_cue.html"><i class="fa fa-check"></i><b>3</b> [beh] outcome ~ cue</a>
<ul>
<li class="chapter" data-level="3.1" data-path="ch03_cue.html"><a href="ch03_cue.html#pain-1"><i class="fa fa-check"></i><b>3.1</b> Pain</a></li>
<li class="chapter" data-level="3.2" data-path="ch03_cue.html"><a href="ch03_cue.html#vicarious-1"><i class="fa fa-check"></i><b>3.2</b> Vicarious</a></li>
<li class="chapter" data-level="3.3" data-path="ch03_cue.html"><a href="ch03_cue.html#cognitive-1"><i class="fa fa-check"></i><b>3.3</b> Cognitive</a></li>
<li class="chapter" data-level="3.4" data-path="ch03_cue.html"><a href="ch03_cue.html#individual-differences-analysis-random-cue-effects"><i class="fa fa-check"></i><b>3.4</b> Individual differences analysis: random cue effects</a></li>
<li class="chapter" data-level="3.5" data-path="ch03_cue.html"><a href="ch03_cue.html#individual-differences-analysis-2-random-intercept-random-slopes-of-cue-effect"><i class="fa fa-check"></i><b>3.5</b> Individual differences analysis 2: random intercept + random slopes of cue effect</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="ch04_outcome-stim.html"><a href="ch04_outcome-stim.html"><i class="fa fa-check"></i><b>4</b> [beh] outcome ~ stimulus_intensity</a>
<ul>
<li class="chapter" data-level="4.1" data-path="ch04_outcome-stim.html"><a href="ch04_outcome-stim.html#pain-2"><i class="fa fa-check"></i><b>4.1</b> Pain</a></li>
<li class="chapter" data-level="4.2" data-path="ch04_outcome-stim.html"><a href="ch04_outcome-stim.html#vicarious-2"><i class="fa fa-check"></i><b>4.2</b> Vicarious</a></li>
<li class="chapter" data-level="4.3" data-path="ch04_outcome-stim.html"><a href="ch04_outcome-stim.html#cognitive-2"><i class="fa fa-check"></i><b>4.3</b> Cognitive</a></li>
<li class="chapter" data-level="4.4" data-path="ch04_outcome-stim.html"><a href="ch04_outcome-stim.html#for-loop"><i class="fa fa-check"></i><b>4.4</b> for loop</a></li>
<li class="chapter" data-level="4.5" data-path="ch04_outcome-stim.html"><a href="ch04_outcome-stim.html#lineplot"><i class="fa fa-check"></i><b>4.5</b> Lineplot</a></li>
<li class="chapter" data-level="4.6" data-path="ch04_outcome-stim.html"><a href="ch04_outcome-stim.html#individual-differences-in-outcome-rating-cue-effect"><i class="fa fa-check"></i><b>4.6</b> individual differences in outcome rating cue effect</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="ch05_outcome-cueXstim.html"><a href="ch05_outcome-cueXstim.html"><i class="fa fa-check"></i><b>5</b> [beh] outcome_rating ~ cue * stim</a>
<ul>
<li class="chapter" data-level="5.1" data-path="ch05_outcome-cueXstim.html"><a href="ch05_outcome-cueXstim.html#model-03-iv-cuecontrast-dv-outcome"><i class="fa fa-check"></i><b>5.1</b> model 03 iv-cuecontrast dv-outcome</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="ch05_outcome-cueXstim.html"><a href="ch05_outcome-cueXstim.html#model-03-3-2.-individual-difference"><i class="fa fa-check"></i><b>5.1.1</b> model 03 3-2. individual difference</a></li>
<li class="chapter" data-level="5.1.2" data-path="ch05_outcome-cueXstim.html"><a href="ch05_outcome-cueXstim.html#model-04-iv-cue-stim-dv-outcome"><i class="fa fa-check"></i><b>5.1.2</b> model 04 iv-cue-stim dv-outcome</a></li>
<li class="chapter" data-level="5.1.3" data-path="ch05_outcome-cueXstim.html"><a href="ch05_outcome-cueXstim.html#nov-17-lmer"><i class="fa fa-check"></i><b>5.1.3</b> Nov 17 lmer</a></li>
<li class="chapter" data-level="5.1.4" data-path="ch05_outcome-cueXstim.html"><a href="ch05_outcome-cueXstim.html#model-04-4-2-individual-differences-in-cue-effects"><i class="fa fa-check"></i><b>5.1.4</b> model 04 4-2 individual differences in cue effects</a></li>
<li class="chapter" data-level="5.1.5" data-path="ch05_outcome-cueXstim.html"><a href="ch05_outcome-cueXstim.html#model-04-4-3-scatter-plot"><i class="fa fa-check"></i><b>5.1.5</b> model 04 4-3 scatter plot</a></li>
<li class="chapter" data-level="5.1.6" data-path="ch05_outcome-cueXstim.html"><a href="ch05_outcome-cueXstim.html#model-04-4-4-lineplot"><i class="fa fa-check"></i><b>5.1.6</b> model 04 4-4 lineplot</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="clinical-trials.html"><a href="clinical-trials.html"><i class="fa fa-check"></i><b>6</b> Clinical trials</a>
<ul>
<li class="chapter" data-level="6.1" data-path="clinical-trials.html"><a href="clinical-trials.html#cue-contrast-average-across-intensity"><i class="fa fa-check"></i><b>6.1</b> cue contrast average across intensity</a></li>
<li class="chapter" data-level="6.2" data-path="clinical-trials.html"><a href="clinical-trials.html#cue-contrast-average-across-expectation"><i class="fa fa-check"></i><b>6.2</b> cue contrast average across expectation</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="ch06_Jepma.html"><a href="ch06_Jepma.html"><i class="fa fa-check"></i><b>7</b> expect-actual ~ cue * trial</a>
<ul>
<li class="chapter" data-level="7.1" data-path="ch06_Jepma.html"><a href="ch06_Jepma.html#overview"><i class="fa fa-check"></i><b>7.1</b> Overview</a></li>
<li class="chapter" data-level="7.2" data-path="ch06_Jepma.html"><a href="ch06_Jepma.html#plot-1---one-run-average-across-participants"><i class="fa fa-check"></i><b>7.2</b> plot 1 - one run, average across participants</a></li>
<li class="chapter" data-level="7.3" data-path="ch06_Jepma.html"><a href="ch06_Jepma.html#plot-2---average-across-participant-but-spread-all-6-runs-in-one-x-axis"><i class="fa fa-check"></i><b>7.3</b> plot 2 - average across participant, but spread all 6 runs in one x axis</a></li>
<li class="chapter" data-level="7.4" data-path="ch06_Jepma.html"><a href="ch06_Jepma.html#vicarious-3"><i class="fa fa-check"></i><b>7.4</b> vicarious</a></li>
<li class="chapter" data-level="7.5" data-path="ch06_Jepma.html"><a href="ch06_Jepma.html#cognitive-3"><i class="fa fa-check"></i><b>7.5</b> cognitive</a></li>
<li class="chapter" data-level="7.6" data-path="ch06_Jepma.html"><a href="ch06_Jepma.html#within-subject-vicarious"><i class="fa fa-check"></i><b>7.6</b> within subject vicarious</a></li>
<li class="chapter" data-level="7.7" data-path="ch06_Jepma.html"><a href="ch06_Jepma.html#tor-request-only-outcome-ratings.-3-tasks"><i class="fa fa-check"></i><b>7.7</b> Tor request – only outcome ratings. 3 tasks</a>
<ul>
<li class="chapter" data-level="7.7.1" data-path="ch06_Jepma.html"><a href="ch06_Jepma.html#pain-3"><i class="fa fa-check"></i><b>7.7.1</b> pain</a></li>
<li class="chapter" data-level="7.7.2" data-path="ch06_Jepma.html"><a href="ch06_Jepma.html#vicarious-4"><i class="fa fa-check"></i><b>7.7.2</b> vicarious</a></li>
<li class="chapter" data-level="7.7.3" data-path="ch06_Jepma.html"><a href="ch06_Jepma.html#cognitive-4"><i class="fa fa-check"></i><b>7.7.3</b> cognitive</a></li>
</ul></li>
<li class="chapter" data-level="7.8" data-path="ch06_Jepma.html"><a href="ch06_Jepma.html#tor-request-only-expect-ratings.-3-tasks"><i class="fa fa-check"></i><b>7.8</b> Tor request – only expect ratings. 3 tasks</a>
<ul>
<li class="chapter" data-level="7.8.1" data-path="ch06_Jepma.html"><a href="ch06_Jepma.html#pain-4"><i class="fa fa-check"></i><b>7.8.1</b> pain</a></li>
<li class="chapter" data-level="7.8.2" data-path="ch06_Jepma.html"><a href="ch06_Jepma.html#vicarious-5"><i class="fa fa-check"></i><b>7.8.2</b> vicarious</a></li>
<li class="chapter" data-level="7.8.3" data-path="ch06_Jepma.html"><a href="ch06_Jepma.html#cognitive-5"><i class="fa fa-check"></i><b>7.8.3</b> cognitive</a></li>
</ul></li>
<li class="chapter" data-level="7.9" data-path="ch06_Jepma.html"><a href="ch06_Jepma.html#lmer"><i class="fa fa-check"></i><b>7.9</b> lmer</a>
<ul>
<li class="chapter" data-level="7.9.1" data-path="ch06_Jepma.html"><a href="ch06_Jepma.html#lmer-histogram"><i class="fa fa-check"></i><b>7.9.1</b> lmer histogram</a></li>
</ul></li>
<li class="chapter" data-level="7.10" data-path="ch06_Jepma.html"><a href="ch06_Jepma.html#do-current-expectation-ratings-predict-outcome-ratings"><i class="fa fa-check"></i><b>7.10</b> Do current expectation ratings predict outcome ratings?</a></li>
<li class="chapter" data-level="7.11" data-path="ch06_Jepma.html"><a href="ch06_Jepma.html#additional-analysis"><i class="fa fa-check"></i><b>7.11</b> Additional analysis</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="ch15_demean_per_sub.html"><a href="ch15_demean_per_sub.html"><i class="fa fa-check"></i><b>8</b> [ beh ] outcome_demean ~ cue * stim * expectrating * n-1outcomerating</a>
<ul>
<li class="chapter" data-level="8.1" data-path="ch15_demean_per_sub.html"><a href="ch15_demean_per_sub.html#linear-model-0508"><i class="fa fa-check"></i><b>8.1</b> linear model 0508</a></li>
<li class="chapter" data-level="8.2" data-path="ch15_demean_per_sub.html"><a href="ch15_demean_per_sub.html#linear-model"><i class="fa fa-check"></i><b>8.2</b> linear model</a></li>
<li class="chapter" data-level="8.3" data-path="ch15_demean_per_sub.html"><a href="ch15_demean_per_sub.html#q.-are-those-overestimating-for-high-cues-also-underestimators-for-low-cues"><i class="fa fa-check"></i><b>8.3</b> Q. Are those overestimating for high cues also underestimators for low cues?</a></li>
<li class="chapter" data-level="8.4" data-path="ch15_demean_per_sub.html"><a href="ch15_demean_per_sub.html#todo-can-you-test-if-the-slopes-are-the-same-that-might-tell-us-something-about-whether-expectancies-translate-into-outcomes-with-the-same-efficacy-across-all-three-tasks."><i class="fa fa-check"></i><b>8.4</b> TODO: Can you test if the slopes are the same? That might tell us something about whether, expectancies translate into outcomes with the same efficacy across all three tasks.</a></li>
<li class="chapter" data-level="8.5" data-path="ch15_demean_per_sub.html"><a href="ch15_demean_per_sub.html#pain-run-collapsed-across-stimulus-intensity"><i class="fa fa-check"></i><b>8.5</b> pain run, collapsed across stimulus intensity</a></li>
<li class="chapter" data-level="8.6" data-path="ch15_demean_per_sub.html"><a href="ch15_demean_per_sub.html#vicarious-6"><i class="fa fa-check"></i><b>8.6</b> vicarious</a></li>
<li class="chapter" data-level="8.7" data-path="ch15_demean_per_sub.html"><a href="ch15_demean_per_sub.html#cognitive-6"><i class="fa fa-check"></i><b>8.7</b> cognitive</a></li>
<li class="chapter" data-level="8.8" data-path="ch15_demean_per_sub.html"><a href="ch15_demean_per_sub.html#linear-model-0508-1"><i class="fa fa-check"></i><b>8.8</b> linear model 0508</a></li>
<li class="chapter" data-level="8.9" data-path="ch15_demean_per_sub.html"><a href="ch15_demean_per_sub.html#across-tasks-pvc-is-the-slope-for-highvslow-cue-the-sametor-question"><i class="fa fa-check"></i><b>8.9</b> across tasks (PVC), is the slope for (highvslow cue) the same?Tor question</a></li>
<li class="chapter" data-level="8.10" data-path="ch15_demean_per_sub.html"><a href="ch15_demean_per_sub.html#alireza-congruent-incongruent-pe"><i class="fa fa-check"></i><b>8.10</b> Alireza congruent incongruent (PE)</a>
<ul>
<li class="chapter" data-level="8.10.1" data-path="ch15_demean_per_sub.html"><a href="ch15_demean_per_sub.html#archive-this-cell"><i class="fa fa-check"></i><b>8.10.1</b> archive this cell</a></li>
</ul></li>
<li class="chapter" data-level="8.11" data-path="ch15_demean_per_sub.html"><a href="ch15_demean_per_sub.html#alireza-congruent-incongruent-incorrect"><i class="fa fa-check"></i><b>8.11</b> Alireza congruent incongruent (incorrect)</a>
<ul>
<li class="chapter" data-level="8.11.1" data-path="ch15_demean_per_sub.html"><a href="ch15_demean_per_sub.html#archive-this-cell-1"><i class="fa fa-check"></i><b>8.11.1</b> archive this cell</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="ch17_mediation.html"><a href="ch17_mediation.html"><i class="fa fa-check"></i><b>9</b> [beh] Mediation outcome ~ cue * stim * expectrating * n-1outcomerating</a>
<ul>
<li class="chapter" data-level="9.1" data-path="ch17_mediation.html"><a href="ch17_mediation.html#mediation"><i class="fa fa-check"></i><b>9.1</b> mediation</a></li>
<li class="chapter" data-level="9.2" data-path="ch17_mediation.html"><a href="ch17_mediation.html#mediation-2"><i class="fa fa-check"></i><b>9.2</b> mediation 2</a></li>
<li class="chapter" data-level="9.3" data-path="ch17_mediation.html"><a href="ch17_mediation.html#mediation-3-test-same-model-using-mediation-from-mbess"><i class="fa fa-check"></i><b>9.3</b> mediation 3: Test same model using mediation() from MBESS</a></li>
<li class="chapter" data-level="9.4" data-path="ch17_mediation.html"><a href="ch17_mediation.html#mediation-4-test-library-mediation"><i class="fa fa-check"></i><b>9.4</b> mediation 4: Test library mediation</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="ch18_simulation.html"><a href="ch18_simulation.html"><i class="fa fa-check"></i><b>10</b> [beh] RL simulation</a>
<ul>
<li class="chapter" data-level="10.1" data-path="ch18_simulation.html"><a href="ch18_simulation.html#function"><i class="fa fa-check"></i><b>10.1</b> function</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="ch18_simulation_aryan.html"><a href="ch18_simulation_aryan.html"><i class="fa fa-check"></i><b>11</b> [beh] RL simulation Aryan</a>
<ul>
<li class="chapter" data-level="11.1" data-path="ch18_simulation_aryan.html"><a href="ch18_simulation_aryan.html#plot-the-relationship-between-expectation-and-outcome-rating-using-model-4-simulations-jepma"><i class="fa fa-check"></i><b>11.1</b> Plot the relationship between expectation and outcome rating using model 4 simulations (Jepma)</a></li>
<li class="chapter" data-level="11.2" data-path="ch18_simulation_aryan.html"><a href="ch18_simulation_aryan.html#plot-the-relationship-between-expectation-and-outcome-rating-using-model-2-simulations-jepma"><i class="fa fa-check"></i><b>11.2</b> Plot the relationship between expectation and outcome rating using model 2 simulations (Jepma)</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="ch18_simulation_aryan.html"><a href="ch18_simulation_aryan.html#model-fits-from-model-2.-expectation-ratings-jepma-model"><i class="fa fa-check"></i><b>11.2.1</b> model fits from model 2. expectation ratings (Jepma model)</a></li>
<li class="chapter" data-level="11.2.2" data-path="ch18_simulation_aryan.html"><a href="ch18_simulation_aryan.html#model-fits-from-model-2.-outcome-ratings-jepma-model"><i class="fa fa-check"></i><b>11.2.2</b> model fits from model 2. outcome ratings (Jepma model)</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="ch18_simulation_aryan.html"><a href="ch18_simulation_aryan.html#correlation-betweeen-alpha_incongruent-and-cue-trial-slope-randome-effects-of-cue"><i class="fa fa-check"></i><b>11.3</b> correlation betweeen alpha_incongruent and cue trial slope (randome effects of cue)</a></li>
<li class="chapter" data-level="11.4" data-path="ch18_simulation_aryan.html"><a href="ch18_simulation_aryan.html#correlation-betweeen-alpha_incongruent-and-nps"><i class="fa fa-check"></i><b>11.4</b> correlation betweeen alpha_incongruent and NPS</a></li>
<li class="chapter" data-level="11.5" data-path="ch18_simulation_aryan.html"><a href="ch18_simulation_aryan.html#correlation-bettween-nps-and-pe"><i class="fa fa-check"></i><b>11.5</b> correlation bettween NPS and PE</a>
<ul>
<li class="chapter" data-level="11.5.1" data-path="ch18_simulation_aryan.html"><a href="ch18_simulation_aryan.html#test-similarity-between-nps-positive-values-and-pe-11062023"><i class="fa fa-check"></i><b>11.5.1</b> test similarity between NPS positive values and PE (11/06/2023)</a></li>
<li class="chapter" data-level="11.5.2" data-path="ch18_simulation_aryan.html"><a href="ch18_simulation_aryan.html#test-relationship-between-pe-and-cue-type-and-stimintensity-06162023"><i class="fa fa-check"></i><b>11.5.2</b> test relationship between PE and cue type and stimintensity (06/16/2023)</a></li>
<li class="chapter" data-level="11.5.3" data-path="ch18_simulation_aryan.html"><a href="ch18_simulation_aryan.html#plot-the-relationship-between-pe-and-nps-as-a-function-of-cue"><i class="fa fa-check"></i><b>11.5.3</b> plot the relationship between PE and NPS as a function of cue</a></li>
<li class="chapter" data-level="11.5.4" data-path="ch18_simulation_aryan.html"><a href="ch18_simulation_aryan.html#plot-the-relationship-between-pe-and-nps-as-a-function-of-cue-and-stimulus-intensity"><i class="fa fa-check"></i><b>11.5.4</b> plot the relationship between PE and NPS as a function of cue and stimulus intensity</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="ch20_npssimulation.html"><a href="ch20_npssimulation.html"><i class="fa fa-check"></i><b>12</b> [model] NPSsimulation</a>
<ul>
<li class="chapter" data-level="12.0.1" data-path="ch20_npssimulation.html"><a href="ch20_npssimulation.html#function-1"><i class="fa fa-check"></i><b>12.0.1</b> Function</a></li>
<li class="chapter" data-level="12.0.2" data-path="ch20_npssimulation.html"><a href="ch20_npssimulation.html#nps-data"><i class="fa fa-check"></i><b>12.0.2</b> NPS data</a></li>
<li class="chapter" data-level="12.0.3" data-path="ch20_npssimulation.html"><a href="ch20_npssimulation.html#behavioral-data"><i class="fa fa-check"></i><b>12.0.3</b> behavioral data</a></li>
<li class="chapter" data-level="12.0.4" data-path="ch20_npssimulation.html"><a href="ch20_npssimulation.html#get-pain-relationship-controlling-for-cue-cuetype-expect"><i class="fa fa-check"></i><b>12.0.4</b> get pain relationship, controlling for cue, cuetype, expect</a></li>
<li class="chapter" data-level="12.1" data-path="ch20_npssimulation.html"><a href="ch20_npssimulation.html#simulation"><i class="fa fa-check"></i><b>12.1</b> simulation **</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="ch51_fir_glasserTPJttl2.html"><a href="ch51_fir_glasserTPJttl2.html"><i class="fa fa-check"></i><b>13</b> [fMRI] FIR ~ task</a>
<ul>
<li class="chapter" data-level="13.1" data-path="ch51_fir_glasserTPJttl2.html"><a href="ch51_fir_glasserTPJttl2.html#parameters-todo-ignore"><i class="fa fa-check"></i><b>13.1</b> parameters {TODO: ignore}</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="taskwise-stim-effect.html"><a href="taskwise-stim-effect.html"><i class="fa fa-check"></i><b>14</b> taskwise stim effect</a>
<ul>
<li class="chapter" data-level="14.0.1" data-path="taskwise-stim-effect.html"><a href="taskwise-stim-effect.html#pca-subjectwise"><i class="fa fa-check"></i><b>14.0.1</b> PCA subjectwise</a></li>
<li class="chapter" data-level="14.0.2" data-path="taskwise-stim-effect.html"><a href="taskwise-stim-effect.html#pca-groupwise"><i class="fa fa-check"></i><b>14.0.2</b> PCA groupwise</a></li>
<li class="chapter" data-level="14.1" data-path="taskwise-stim-effect.html"><a href="taskwise-stim-effect.html#dep-epoch-stim-high-cue-vs-low-cue"><i class="fa fa-check"></i><b>14.1</b> DEP: epoch: stim, high cue vs low cue</a></li>
<li class="chapter" data-level="14.2" data-path="taskwise-stim-effect.html"><a href="taskwise-stim-effect.html#taskwise-cue-effect"><i class="fa fa-check"></i><b>14.2</b> taskwise cue effect</a></li>
<li class="chapter" data-level="14.3" data-path="taskwise-stim-effect.html"><a href="taskwise-stim-effect.html#epoch-stim-rating"><i class="fa fa-check"></i><b>14.3</b> epoch: stim, rating</a></li>
<li class="chapter" data-level="14.4" data-path="taskwise-stim-effect.html"><a href="taskwise-stim-effect.html#epoch-6-cond"><i class="fa fa-check"></i><b>14.4</b> epoch: 6 cond</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="taskwise-6-cond-effect.html"><a href="taskwise-6-cond-effect.html"><i class="fa fa-check"></i><b>15</b> taskwise 6 cond effect</a></li>
<li class="chapter" data-level="16" data-path="ch52_timeseries.html"><a href="ch52_timeseries.html"><i class="fa fa-check"></i><b>16</b> [fMRI] FIR ~ task TTL1</a>
<ul>
<li class="chapter" data-level="16.1" data-path="ch52_timeseries.html"><a href="ch52_timeseries.html#references"><i class="fa fa-check"></i><b>16.1</b> references</a></li>
<li class="chapter" data-level="16.2" data-path="ch52_timeseries.html"><a href="ch52_timeseries.html#taskwise-stim-effect-1"><i class="fa fa-check"></i><b>16.2</b> taskwise stim effect</a>
<ul>
<li class="chapter" data-level="16.2.1" data-path="ch52_timeseries.html"><a href="ch52_timeseries.html#pca-subjectwise-1"><i class="fa fa-check"></i><b>16.2.1</b> PCA subjectwise</a></li>
<li class="chapter" data-level="16.2.2" data-path="ch52_timeseries.html"><a href="ch52_timeseries.html#pca-groupwise-1"><i class="fa fa-check"></i><b>16.2.2</b> PCA groupwise</a></li>
</ul></li>
<li class="chapter" data-level="16.3" data-path="ch52_timeseries.html"><a href="ch52_timeseries.html#taskwise-cue-effect-1"><i class="fa fa-check"></i><b>16.3</b> taskwise cue effect</a>
<ul>
<li class="chapter" data-level="16.3.1" data-path="ch52_timeseries.html"><a href="ch52_timeseries.html#epoch-stim-rating-1"><i class="fa fa-check"></i><b>16.3.1</b> epoch: stim, rating</a></li>
</ul></li>
<li class="chapter" data-level="16.4" data-path="ch52_timeseries.html"><a href="ch52_timeseries.html#main-sandbox-6-condition-in-three-panels.-per-task.-per-roi"><i class="fa fa-check"></i><b>16.4</b> MAIN SANDBOX: 6 condition in three panels. per task. per ROI</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">52_ROI TTL1</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="ch52_timeseries" class="section level1 hasAnchor" number="16">
<h1><span class="header-section-number">Chapter 16</span> [fMRI] FIR ~ task TTL1<a href="ch52_timeseries.html#ch52_timeseries" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>The purpose of this notebook is to plot the BOLD timeseries from SPM FIR model.
TODO
* load tsv
* concatenate
* per time column, calculate mean and variance
* plot</p>
<div id="references" class="section level2 hasAnchor" number="16.1">
<h2><span class="header-section-number">16.1</span> references<a href="ch52_timeseries.html#references" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><a href="https://stackoverflow.com/questions/29402528/append-data-frames-together-in-a-for-loop/29419402" class="uri">https://stackoverflow.com/questions/29402528/append-data-frames-together-in-a-for-loop/29419402</a></p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb365"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb365-1"><a href="ch52_timeseries.html#cb365-1" aria-hidden="true" tabindex="-1"></a>plot_timeseries_onefactor <span class="ot">&lt;-</span></span>
<span id="cb365-2"><a href="ch52_timeseries.html#cb365-2" aria-hidden="true" tabindex="-1"></a>  <span class="cf">function</span>(df, iv1, mean, error, xlab, ylab, ggtitle, color) {</span>
<span id="cb365-3"><a href="ch52_timeseries.html#cb365-3" aria-hidden="true" tabindex="-1"></a>    n_points <span class="ot">&lt;-</span> <span class="dv">100</span> <span class="co"># Number of points for interpolation</span></span>
<span id="cb365-4"><a href="ch52_timeseries.html#cb365-4" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb365-5"><a href="ch52_timeseries.html#cb365-5" aria-hidden="true" tabindex="-1"></a>    g <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(</span>
<span id="cb365-6"><a href="ch52_timeseries.html#cb365-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">data =</span> df,</span>
<span id="cb365-7"><a href="ch52_timeseries.html#cb365-7" aria-hidden="true" tabindex="-1"></a>      <span class="fu">aes</span>(</span>
<span id="cb365-8"><a href="ch52_timeseries.html#cb365-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> .data[[iv1]],</span>
<span id="cb365-9"><a href="ch52_timeseries.html#cb365-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> .data[[mean]],</span>
<span id="cb365-10"><a href="ch52_timeseries.html#cb365-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">group =</span> <span class="dv">1</span>,</span>
<span id="cb365-11"><a href="ch52_timeseries.html#cb365-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">color =</span> color</span>
<span id="cb365-12"><a href="ch52_timeseries.html#cb365-12" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb365-13"><a href="ch52_timeseries.html#cb365-13" aria-hidden="true" tabindex="-1"></a>      <span class="at">cex.lab =</span> <span class="fl">1.5</span>,</span>
<span id="cb365-14"><a href="ch52_timeseries.html#cb365-14" aria-hidden="true" tabindex="-1"></a>      <span class="at">cex.axis =</span> <span class="dv">2</span>,</span>
<span id="cb365-15"><a href="ch52_timeseries.html#cb365-15" aria-hidden="true" tabindex="-1"></a>      <span class="at">cex.main =</span> <span class="fl">1.5</span>,</span>
<span id="cb365-16"><a href="ch52_timeseries.html#cb365-16" aria-hidden="true" tabindex="-1"></a>      <span class="at">cex.sub =</span> <span class="fl">1.5</span></span>
<span id="cb365-17"><a href="ch52_timeseries.html#cb365-17" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb365-18"><a href="ch52_timeseries.html#cb365-18" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(</span>
<span id="cb365-19"><a href="ch52_timeseries.html#cb365-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">ymin =</span> (.data[[mean]] <span class="sc">-</span> .data[[error]]),</span>
<span id="cb365-20"><a href="ch52_timeseries.html#cb365-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">ymax =</span> (.data[[mean]] <span class="sc">+</span> .data[[error]]),</span>
<span id="cb365-21"><a href="ch52_timeseries.html#cb365-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">color =</span> color</span>
<span id="cb365-22"><a href="ch52_timeseries.html#cb365-22" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb365-23"><a href="ch52_timeseries.html#cb365-23" aria-hidden="true" tabindex="-1"></a>      <span class="at">width =</span> .<span class="dv">1</span>,</span>
<span id="cb365-24"><a href="ch52_timeseries.html#cb365-24" aria-hidden="true" tabindex="-1"></a>      <span class="at">alpha =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb365-25"><a href="ch52_timeseries.html#cb365-25" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb365-26"><a href="ch52_timeseries.html#cb365-26" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_point</span>(<span class="at">color =</span> color) <span class="sc">+</span></span>
<span id="cb365-27"><a href="ch52_timeseries.html#cb365-27" aria-hidden="true" tabindex="-1"></a>      <span class="fu">ggtitle</span>(ggtitle) <span class="sc">+</span></span>
<span id="cb365-28"><a href="ch52_timeseries.html#cb365-28" aria-hidden="true" tabindex="-1"></a>      <span class="fu">xlab</span>(xlab) <span class="sc">+</span></span>
<span id="cb365-29"><a href="ch52_timeseries.html#cb365-29" aria-hidden="true" tabindex="-1"></a>      <span class="fu">ylab</span>(ylab) <span class="sc">+</span></span>
<span id="cb365-30"><a href="ch52_timeseries.html#cb365-30" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb365-31"><a href="ch52_timeseries.html#cb365-31" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme</span>(<span class="at">aspect.ratio =</span> .<span class="dv">6</span>) <span class="sc">+</span></span>
<span id="cb365-32"><a href="ch52_timeseries.html#cb365-32" aria-hidden="true" tabindex="-1"></a>      <span class="fu">expand_limits</span>(<span class="at">x =</span> <span class="fl">3.25</span>) <span class="sc">+</span></span>
<span id="cb365-33"><a href="ch52_timeseries.html#cb365-33" aria-hidden="true" tabindex="-1"></a>      <span class="fu">scale_color_manual</span>(<span class="st">&quot;&quot;</span>,</span>
<span id="cb365-34"><a href="ch52_timeseries.html#cb365-34" aria-hidden="true" tabindex="-1"></a>                         <span class="at">values =</span> color) <span class="sc">+</span></span>
<span id="cb365-35"><a href="ch52_timeseries.html#cb365-35" aria-hidden="true" tabindex="-1"></a>      <span class="co"># theme(</span></span>
<span id="cb365-36"><a href="ch52_timeseries.html#cb365-36" aria-hidden="true" tabindex="-1"></a>      <span class="co">#   legend.position = c(.99, .99),</span></span>
<span id="cb365-37"><a href="ch52_timeseries.html#cb365-37" aria-hidden="true" tabindex="-1"></a>      <span class="co">#   legend.justification = c(&quot;right&quot;, &quot;top&quot;),</span></span>
<span id="cb365-38"><a href="ch52_timeseries.html#cb365-38" aria-hidden="true" tabindex="-1"></a>      <span class="co">#   legend.box.just = &quot;right&quot;,</span></span>
<span id="cb365-39"><a href="ch52_timeseries.html#cb365-39" aria-hidden="true" tabindex="-1"></a>      <span class="co">#   legend.margin = margin(6, 6, 6, 6)</span></span>
<span id="cb365-40"><a href="ch52_timeseries.html#cb365-40" aria-hidden="true" tabindex="-1"></a>      <span class="co"># ) +</span></span>
<span id="cb365-41"><a href="ch52_timeseries.html#cb365-41" aria-hidden="true" tabindex="-1"></a>      <span class="co"># theme(legend.key = element_rect(fill = &quot;white&quot;, colour = &quot;white&quot;)) +</span></span>
<span id="cb365-42"><a href="ch52_timeseries.html#cb365-42" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme_bw</span>()</span>
<span id="cb365-43"><a href="ch52_timeseries.html#cb365-43" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb365-44"><a href="ch52_timeseries.html#cb365-44" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(g)</span>
<span id="cb365-45"><a href="ch52_timeseries.html#cb365-45" aria-hidden="true" tabindex="-1"></a>  }</span></code></pre></div>
</details>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb366"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb366-1"><a href="ch52_timeseries.html#cb366-1" aria-hidden="true" tabindex="-1"></a>plot_timeseries_bar_SANDBOX <span class="ot">&lt;-</span> </span>
<span id="cb366-2"><a href="ch52_timeseries.html#cb366-2" aria-hidden="true" tabindex="-1"></a>  <span class="cf">function</span>(df, iv1, iv2, mean, error, xlab, ylab, ggtitle, color) {</span>
<span id="cb366-3"><a href="ch52_timeseries.html#cb366-3" aria-hidden="true" tabindex="-1"></a>    n_points <span class="ot">&lt;-</span> <span class="dv">100</span> <span class="co"># Number of points for interpolation</span></span>
<span id="cb366-4"><a href="ch52_timeseries.html#cb366-4" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb366-5"><a href="ch52_timeseries.html#cb366-5" aria-hidden="true" tabindex="-1"></a>    <span class="do">## Removing &quot;tr&quot; from the column values</span></span>
<span id="cb366-6"><a href="ch52_timeseries.html#cb366-6" aria-hidden="true" tabindex="-1"></a>    df[[iv1]] <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">sub</span>(<span class="st">&quot;tr&quot;</span>, <span class="st">&quot;&quot;</span>, df[[iv1]]))</span>
<span id="cb366-7"><a href="ch52_timeseries.html#cb366-7" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb366-8"><a href="ch52_timeseries.html#cb366-8" aria-hidden="true" tabindex="-1"></a>    g <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(</span>
<span id="cb366-9"><a href="ch52_timeseries.html#cb366-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">data =</span> df,</span>
<span id="cb366-10"><a href="ch52_timeseries.html#cb366-10" aria-hidden="true" tabindex="-1"></a>      <span class="fu">aes</span>(</span>
<span id="cb366-11"><a href="ch52_timeseries.html#cb366-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> .data[[iv1]],</span>
<span id="cb366-12"><a href="ch52_timeseries.html#cb366-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> .data[[mean]],</span>
<span id="cb366-13"><a href="ch52_timeseries.html#cb366-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">group =</span> <span class="fu">factor</span>(.data[[iv2]]),</span>
<span id="cb366-14"><a href="ch52_timeseries.html#cb366-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">color =</span> <span class="fu">factor</span>(.data[[iv2]])</span>
<span id="cb366-15"><a href="ch52_timeseries.html#cb366-15" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb366-16"><a href="ch52_timeseries.html#cb366-16" aria-hidden="true" tabindex="-1"></a>      <span class="at">cex.lab =</span> <span class="fl">1.5</span>,</span>
<span id="cb366-17"><a href="ch52_timeseries.html#cb366-17" aria-hidden="true" tabindex="-1"></a>      <span class="at">cex.axis =</span> <span class="dv">2</span>,</span>
<span id="cb366-18"><a href="ch52_timeseries.html#cb366-18" aria-hidden="true" tabindex="-1"></a>      <span class="at">cex.main =</span> <span class="fl">1.5</span>,</span>
<span id="cb366-19"><a href="ch52_timeseries.html#cb366-19" aria-hidden="true" tabindex="-1"></a>      <span class="at">cex.sub =</span> <span class="fl">1.5</span></span>
<span id="cb366-20"><a href="ch52_timeseries.html#cb366-20" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb366-21"><a href="ch52_timeseries.html#cb366-21" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(</span>
<span id="cb366-22"><a href="ch52_timeseries.html#cb366-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">ymin =</span> (.data[[mean]] <span class="sc">-</span> .data[[error]]),</span>
<span id="cb366-23"><a href="ch52_timeseries.html#cb366-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">ymax =</span> (.data[[mean]] <span class="sc">+</span> .data[[error]]),</span>
<span id="cb366-24"><a href="ch52_timeseries.html#cb366-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">fill =</span>  <span class="fu">factor</span>(.data[[iv2]])</span>
<span id="cb366-25"><a href="ch52_timeseries.html#cb366-25" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb366-26"><a href="ch52_timeseries.html#cb366-26" aria-hidden="true" tabindex="-1"></a>      <span class="at">width =</span> .<span class="dv">1</span>,</span>
<span id="cb366-27"><a href="ch52_timeseries.html#cb366-27" aria-hidden="true" tabindex="-1"></a>      <span class="at">alpha =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb366-28"><a href="ch52_timeseries.html#cb366-28" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb366-29"><a href="ch52_timeseries.html#cb366-29" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb366-30"><a href="ch52_timeseries.html#cb366-30" aria-hidden="true" tabindex="-1"></a>      <span class="fu">ggtitle</span>(ggtitle) <span class="sc">+</span></span>
<span id="cb366-31"><a href="ch52_timeseries.html#cb366-31" aria-hidden="true" tabindex="-1"></a>      <span class="fu">xlab</span>(xlab) <span class="sc">+</span></span>
<span id="cb366-32"><a href="ch52_timeseries.html#cb366-32" aria-hidden="true" tabindex="-1"></a>      <span class="fu">ylab</span>(ylab) <span class="sc">+</span></span>
<span id="cb366-33"><a href="ch52_timeseries.html#cb366-33" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb366-34"><a href="ch52_timeseries.html#cb366-34" aria-hidden="true" tabindex="-1"></a>      <span class="fu">expand_limits</span>(<span class="at">x =</span> <span class="fl">3.25</span>) <span class="sc">+</span></span>
<span id="cb366-35"><a href="ch52_timeseries.html#cb366-35" aria-hidden="true" tabindex="-1"></a>      <span class="fu">scale_color_manual</span>(<span class="st">&quot;&quot;</span>,</span>
<span id="cb366-36"><a href="ch52_timeseries.html#cb366-36" aria-hidden="true" tabindex="-1"></a>                         <span class="at">values =</span> color) <span class="sc">+</span></span>
<span id="cb366-37"><a href="ch52_timeseries.html#cb366-37" aria-hidden="true" tabindex="-1"></a>      <span class="fu">scale_fill_manual</span>(<span class="st">&quot;&quot;</span>,</span>
<span id="cb366-38"><a href="ch52_timeseries.html#cb366-38" aria-hidden="true" tabindex="-1"></a>                        <span class="at">values =</span> color) <span class="sc">+</span></span>
<span id="cb366-39"><a href="ch52_timeseries.html#cb366-39" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme</span>(</span>
<span id="cb366-40"><a href="ch52_timeseries.html#cb366-40" aria-hidden="true" tabindex="-1"></a>        <span class="at">aspect.ratio =</span> .<span class="dv">6</span>,</span>
<span id="cb366-41"><a href="ch52_timeseries.html#cb366-41" aria-hidden="true" tabindex="-1"></a>        <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>),</span>
<span id="cb366-42"><a href="ch52_timeseries.html#cb366-42" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">24</span>),</span>
<span id="cb366-43"><a href="ch52_timeseries.html#cb366-43" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">24</span>),</span>
<span id="cb366-44"><a href="ch52_timeseries.html#cb366-44" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="fu">c</span>(.<span class="dv">99</span>, .<span class="dv">99</span>),</span>
<span id="cb366-45"><a href="ch52_timeseries.html#cb366-45" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.justification =</span> <span class="fu">c</span>(<span class="st">&quot;right&quot;</span>, <span class="st">&quot;top&quot;</span>),</span>
<span id="cb366-46"><a href="ch52_timeseries.html#cb366-46" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.box.just =</span> <span class="st">&quot;right&quot;</span>,</span>
<span id="cb366-47"><a href="ch52_timeseries.html#cb366-47" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.margin =</span> <span class="fu">margin</span>(<span class="dv">6</span>, <span class="dv">6</span>, <span class="dv">6</span>, <span class="dv">6</span>)</span>
<span id="cb366-48"><a href="ch52_timeseries.html#cb366-48" aria-hidden="true" tabindex="-1"></a>      ) <span class="sc">+</span></span>
<span id="cb366-49"><a href="ch52_timeseries.html#cb366-49" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme</span>(<span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="at">colour =</span> <span class="st">&quot;white&quot;</span>)) <span class="sc">+</span></span>
<span id="cb366-50"><a href="ch52_timeseries.html#cb366-50" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme_bw</span>()</span>
<span id="cb366-51"><a href="ch52_timeseries.html#cb366-51" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb366-52"><a href="ch52_timeseries.html#cb366-52" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(g)</span>
<span id="cb366-53"><a href="ch52_timeseries.html#cb366-53" aria-hidden="true" tabindex="-1"></a>  }</span></code></pre></div>
</details>
<div id="parameters" class="section level3 unlisted unnumbered hasAnchor">
<h3>parameters<a href="ch52_timeseries.html#parameters" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb367"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb367-1"><a href="ch52_timeseries.html#cb367-1" aria-hidden="true" tabindex="-1"></a>main_dir <span class="ot">&lt;-</span> <span class="fu">dirname</span>(<span class="fu">dirname</span>(<span class="fu">getwd</span>()))</span>
<span id="cb367-2"><a href="ch52_timeseries.html#cb367-2" aria-hidden="true" tabindex="-1"></a>datadir <span class="ot">&lt;-</span> <span class="fu">file.path</span>(main_dir, <span class="st">&quot;analysis/fmri/nilearn/glm/fir&quot;</span>)</span>
<span id="cb367-3"><a href="ch52_timeseries.html#cb367-3" aria-hidden="true" tabindex="-1"></a>analysis_folder <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;model52_iv-6cond_dv-firglasserSPM_ttl1&quot;</span>)</span>
<span id="cb367-4"><a href="ch52_timeseries.html#cb367-4" aria-hidden="true" tabindex="-1"></a>analysis_dir <span class="ot">&lt;-</span></span>
<span id="cb367-5"><a href="ch52_timeseries.html#cb367-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">file.path</span>(main_dir,</span>
<span id="cb367-6"><a href="ch52_timeseries.html#cb367-6" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;analysis&quot;</span>,</span>
<span id="cb367-7"><a href="ch52_timeseries.html#cb367-7" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;mixedeffect&quot;</span>,</span>
<span id="cb367-8"><a href="ch52_timeseries.html#cb367-8" aria-hidden="true" tabindex="-1"></a>            analysis_folder,</span>
<span id="cb367-9"><a href="ch52_timeseries.html#cb367-9" aria-hidden="true" tabindex="-1"></a>            <span class="fu">as.character</span>(<span class="fu">Sys.Date</span>()))</span>
<span id="cb367-10"><a href="ch52_timeseries.html#cb367-10" aria-hidden="true" tabindex="-1"></a><span class="fu">dir.create</span>(analysis_dir,</span>
<span id="cb367-11"><a href="ch52_timeseries.html#cb367-11" aria-hidden="true" tabindex="-1"></a>           <span class="at">showWarnings =</span> <span class="cn">FALSE</span>,</span>
<span id="cb367-12"><a href="ch52_timeseries.html#cb367-12" aria-hidden="true" tabindex="-1"></a>           <span class="at">recursive =</span> <span class="cn">TRUE</span>)</span>
<span id="cb367-13"><a href="ch52_timeseries.html#cb367-13" aria-hidden="true" tabindex="-1"></a>save_dir <span class="ot">&lt;-</span> analysis_dir</span></code></pre></div>
</details>
</div>
</div>
<div id="taskwise-stim-effect-1" class="section level2 hasAnchor" number="16.2">
<h2><span class="header-section-number">16.2</span> taskwise stim effect<a href="ch52_timeseries.html#taskwise-stim-effect-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Here, I have a list of ROIs. Per ROI, I have FIR values for pain, vicarious, cognitive tasks.
We’ll aggregate data per ROI and plot the time series for the 3 tasks.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb368"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb368-1"><a href="ch52_timeseries.html#cb368-1" aria-hidden="true" tabindex="-1"></a>roi_list <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;dACC&quot;</span>, <span class="st">&quot;PHG&quot;</span>, <span class="st">&quot;V1&quot;</span>, <span class="st">&quot;SM&quot;</span>, <span class="st">&quot;MT&quot;</span>, <span class="st">&quot;RSC&quot;</span>, <span class="st">&quot;LOC&quot;</span>, <span class="st">&quot;FFC&quot;</span>, <span class="st">&quot;PIT&quot;</span>, <span class="st">&quot;pSTS&quot;</span>, <span class="st">&quot;AIP&quot;</span>, <span class="st">&quot;premotor&quot;</span>) <span class="co"># &#39;rINS&#39;, &#39;TPJ&#39;,</span></span>
<span id="cb368-2"><a href="ch52_timeseries.html#cb368-2" aria-hidden="true" tabindex="-1"></a>run_types <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;pain&quot;</span>, <span class="st">&quot;vicarious&quot;</span>, <span class="st">&quot;cognitive&quot;</span>)</span>
<span id="cb368-3"><a href="ch52_timeseries.html#cb368-3" aria-hidden="true" tabindex="-1"></a>plot_list <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb368-4"><a href="ch52_timeseries.html#cb368-4" aria-hidden="true" tabindex="-1"></a>TR_length <span class="ot">&lt;-</span> <span class="dv">42</span></span>
<span id="cb368-5"><a href="ch52_timeseries.html#cb368-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb368-6"><a href="ch52_timeseries.html#cb368-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb368-7"><a href="ch52_timeseries.html#cb368-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (ROI <span class="cf">in</span> roi_list) {</span>
<span id="cb368-8"><a href="ch52_timeseries.html#cb368-8" aria-hidden="true" tabindex="-1"></a>  main_dir <span class="ot">&lt;-</span> <span class="fu">dirname</span>(<span class="fu">dirname</span>(<span class="fu">getwd</span>()))</span>
<span id="cb368-9"><a href="ch52_timeseries.html#cb368-9" aria-hidden="true" tabindex="-1"></a>  datadir <span class="ot">&lt;-</span> <span class="fu">file.path</span>(main_dir, <span class="st">&quot;analysis/fmri/spm/fir/ttl1par&quot;</span>)</span>
<span id="cb368-10"><a href="ch52_timeseries.html#cb368-10" aria-hidden="true" tabindex="-1"></a>  taskname <span class="ot">&lt;-</span> <span class="st">&quot;pain&quot;</span></span>
<span id="cb368-11"><a href="ch52_timeseries.html#cb368-11" aria-hidden="true" tabindex="-1"></a>  exclude <span class="ot">&lt;-</span> <span class="st">&quot;sub-0001&quot;</span></span>
<span id="cb368-12"><a href="ch52_timeseries.html#cb368-12" aria-hidden="true" tabindex="-1"></a>  filename <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;sub-*&quot;</span>, <span class="st">&quot;*roi-&quot;</span>, ROI, <span class="st">&quot;_tr-42.csv&quot;</span>)</span>
<span id="cb368-13"><a href="ch52_timeseries.html#cb368-13" aria-hidden="true" tabindex="-1"></a>  common_path <span class="ot">&lt;-</span> <span class="fu">Sys.glob</span>(<span class="fu">file.path</span>(datadir, <span class="st">&quot;sub-*&quot;</span>, filename))</span>
<span id="cb368-14"><a href="ch52_timeseries.html#cb368-14" aria-hidden="true" tabindex="-1"></a>  filter_path <span class="ot">&lt;-</span></span>
<span id="cb368-15"><a href="ch52_timeseries.html#cb368-15" aria-hidden="true" tabindex="-1"></a>    common_path[<span class="sc">!</span><span class="fu">str_detect</span>(common_path, <span class="at">pattern =</span> exclude)]</span>
<span id="cb368-16"><a href="ch52_timeseries.html#cb368-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb368-17"><a href="ch52_timeseries.html#cb368-17" aria-hidden="true" tabindex="-1"></a>  df <span class="ot">&lt;-</span></span>
<span id="cb368-18"><a href="ch52_timeseries.html#cb368-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">do.call</span>(<span class="st">&quot;rbind.fill&quot;</span>, <span class="fu">lapply</span>(</span>
<span id="cb368-19"><a href="ch52_timeseries.html#cb368-19" aria-hidden="true" tabindex="-1"></a>      filter_path,</span>
<span id="cb368-20"><a href="ch52_timeseries.html#cb368-20" aria-hidden="true" tabindex="-1"></a>      <span class="at">FUN =</span> <span class="cf">function</span>(files) {</span>
<span id="cb368-21"><a href="ch52_timeseries.html#cb368-21" aria-hidden="true" tabindex="-1"></a>        <span class="fu">read.table</span>(files, <span class="at">header =</span> <span class="cn">TRUE</span>, <span class="at">sep =</span> <span class="st">&quot;,&quot;</span>)</span>
<span id="cb368-22"><a href="ch52_timeseries.html#cb368-22" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb368-23"><a href="ch52_timeseries.html#cb368-23" aria-hidden="true" tabindex="-1"></a>    ))</span>
<span id="cb368-24"><a href="ch52_timeseries.html#cb368-24" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb368-25"><a href="ch52_timeseries.html#cb368-25" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (run_type <span class="cf">in</span> run_types) {</span>
<span id="cb368-26"><a href="ch52_timeseries.html#cb368-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(run_type)</span>
<span id="cb368-27"><a href="ch52_timeseries.html#cb368-27" aria-hidden="true" tabindex="-1"></a>    filtered_df <span class="ot">&lt;-</span></span>
<span id="cb368-28"><a href="ch52_timeseries.html#cb368-28" aria-hidden="true" tabindex="-1"></a>      df[<span class="sc">!</span>(df<span class="sc">$</span>condition <span class="sc">==</span> <span class="st">&quot;rating&quot;</span> <span class="sc">|</span></span>
<span id="cb368-29"><a href="ch52_timeseries.html#cb368-29" aria-hidden="true" tabindex="-1"></a>             df<span class="sc">$</span>condition <span class="sc">==</span> <span class="st">&quot;cue&quot;</span> <span class="sc">|</span> df<span class="sc">$</span>runtype <span class="sc">!=</span> run_type),]</span>
<span id="cb368-30"><a href="ch52_timeseries.html#cb368-30" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb368-31"><a href="ch52_timeseries.html#cb368-31" aria-hidden="true" tabindex="-1"></a>    parsed_df <span class="ot">&lt;-</span> filtered_df <span class="sc">%&gt;%</span></span>
<span id="cb368-32"><a href="ch52_timeseries.html#cb368-32" aria-hidden="true" tabindex="-1"></a>      <span class="fu">separate</span>(</span>
<span id="cb368-33"><a href="ch52_timeseries.html#cb368-33" aria-hidden="true" tabindex="-1"></a>        condition,</span>
<span id="cb368-34"><a href="ch52_timeseries.html#cb368-34" aria-hidden="true" tabindex="-1"></a>        <span class="at">into =</span> <span class="fu">c</span>(<span class="st">&quot;cue&quot;</span>, <span class="st">&quot;stim&quot;</span>),</span>
<span id="cb368-35"><a href="ch52_timeseries.html#cb368-35" aria-hidden="true" tabindex="-1"></a>        <span class="at">sep =</span> <span class="st">&quot;_&quot;</span>,</span>
<span id="cb368-36"><a href="ch52_timeseries.html#cb368-36" aria-hidden="true" tabindex="-1"></a>        <span class="at">remove =</span> <span class="cn">FALSE</span></span>
<span id="cb368-37"><a href="ch52_timeseries.html#cb368-37" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb368-38"><a href="ch52_timeseries.html#cb368-38" aria-hidden="true" tabindex="-1"></a>    <span class="co"># --------------------------------------------------------------------------</span></span>
<span id="cb368-39"><a href="ch52_timeseries.html#cb368-39" aria-hidden="true" tabindex="-1"></a>    <span class="co">#                           0) subset dataframe based on ROI</span></span>
<span id="cb368-40"><a href="ch52_timeseries.html#cb368-40" aria-hidden="true" tabindex="-1"></a>    <span class="co"># --------------------------------------------------------------------------</span></span>
<span id="cb368-41"><a href="ch52_timeseries.html#cb368-41" aria-hidden="true" tabindex="-1"></a>    df_long <span class="ot">&lt;-</span></span>
<span id="cb368-42"><a href="ch52_timeseries.html#cb368-42" aria-hidden="true" tabindex="-1"></a>      <span class="fu">pivot_longer</span>(</span>
<span id="cb368-43"><a href="ch52_timeseries.html#cb368-43" aria-hidden="true" tabindex="-1"></a>        parsed_df,</span>
<span id="cb368-44"><a href="ch52_timeseries.html#cb368-44" aria-hidden="true" tabindex="-1"></a>        <span class="at">cols =</span> <span class="fu">starts_with</span>(<span class="st">&quot;tr&quot;</span>),</span>
<span id="cb368-45"><a href="ch52_timeseries.html#cb368-45" aria-hidden="true" tabindex="-1"></a>        <span class="at">names_to =</span> <span class="st">&quot;tr_num&quot;</span>,</span>
<span id="cb368-46"><a href="ch52_timeseries.html#cb368-46" aria-hidden="true" tabindex="-1"></a>        <span class="at">values_to =</span> <span class="st">&quot;tr_value&quot;</span></span>
<span id="cb368-47"><a href="ch52_timeseries.html#cb368-47" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb368-48"><a href="ch52_timeseries.html#cb368-48" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb368-49"><a href="ch52_timeseries.html#cb368-49" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb368-50"><a href="ch52_timeseries.html#cb368-50" aria-hidden="true" tabindex="-1"></a>    <span class="co"># --------------------------------------------------------------------------</span></span>
<span id="cb368-51"><a href="ch52_timeseries.html#cb368-51" aria-hidden="true" tabindex="-1"></a>    <span class="co">#                           1) clean factor</span></span>
<span id="cb368-52"><a href="ch52_timeseries.html#cb368-52" aria-hidden="true" tabindex="-1"></a>    <span class="co"># --------------------------------------------------------------------------</span></span>
<span id="cb368-53"><a href="ch52_timeseries.html#cb368-53" aria-hidden="true" tabindex="-1"></a>    df_long<span class="sc">$</span>tr_ordered <span class="ot">&lt;-</span> <span class="fu">factor</span>(df_long<span class="sc">$</span>tr_num,</span>
<span id="cb368-54"><a href="ch52_timeseries.html#cb368-54" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">levels =</span> <span class="fu">c</span>(<span class="fu">paste0</span>(<span class="st">&quot;tr&quot;</span>, <span class="dv">1</span><span class="sc">:</span>TR_length)))</span>
<span id="cb368-55"><a href="ch52_timeseries.html#cb368-55" aria-hidden="true" tabindex="-1"></a>    df_long<span class="sc">$</span>stim_ordered <span class="ot">&lt;-</span> <span class="fu">factor</span>(df_long<span class="sc">$</span>stim,</span>
<span id="cb368-56"><a href="ch52_timeseries.html#cb368-56" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;stimH&quot;</span>, <span class="st">&quot;stimM&quot;</span>, <span class="st">&quot;stimL&quot;</span>))</span>
<span id="cb368-57"><a href="ch52_timeseries.html#cb368-57" aria-hidden="true" tabindex="-1"></a>    <span class="co"># --------------------------------------------------------------------------</span></span>
<span id="cb368-58"><a href="ch52_timeseries.html#cb368-58" aria-hidden="true" tabindex="-1"></a>    <span class="co">#                             2) summary statistics</span></span>
<span id="cb368-59"><a href="ch52_timeseries.html#cb368-59" aria-hidden="true" tabindex="-1"></a>    <span class="co"># --------------------------------------------------------------------------</span></span>
<span id="cb368-60"><a href="ch52_timeseries.html#cb368-60" aria-hidden="true" tabindex="-1"></a>    subjectwise <span class="ot">&lt;-</span> <span class="fu">meanSummary</span>(df_long,</span>
<span id="cb368-61"><a href="ch52_timeseries.html#cb368-61" aria-hidden="true" tabindex="-1"></a>                               <span class="fu">c</span>(<span class="st">&quot;sub&quot;</span>, <span class="st">&quot;tr_ordered&quot;</span>, <span class="st">&quot;stim_ordered&quot;</span>),</span>
<span id="cb368-62"><a href="ch52_timeseries.html#cb368-62" aria-hidden="true" tabindex="-1"></a>                               <span class="st">&quot;tr_value&quot;</span>)</span>
<span id="cb368-63"><a href="ch52_timeseries.html#cb368-63" aria-hidden="true" tabindex="-1"></a>    groupwise <span class="ot">&lt;-</span> <span class="fu">summarySEwithin</span>(</span>
<span id="cb368-64"><a href="ch52_timeseries.html#cb368-64" aria-hidden="true" tabindex="-1"></a>      <span class="at">data =</span> subjectwise,</span>
<span id="cb368-65"><a href="ch52_timeseries.html#cb368-65" aria-hidden="true" tabindex="-1"></a>      <span class="at">measurevar =</span> <span class="st">&quot;mean_per_sub&quot;</span>,</span>
<span id="cb368-66"><a href="ch52_timeseries.html#cb368-66" aria-hidden="true" tabindex="-1"></a>      <span class="at">withinvars =</span> <span class="fu">c</span>(<span class="st">&quot;stim_ordered&quot;</span>, <span class="st">&quot;tr_ordered&quot;</span>),</span>
<span id="cb368-67"><a href="ch52_timeseries.html#cb368-67" aria-hidden="true" tabindex="-1"></a>      <span class="at">idvar =</span> <span class="st">&quot;sub&quot;</span></span>
<span id="cb368-68"><a href="ch52_timeseries.html#cb368-68" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb368-69"><a href="ch52_timeseries.html#cb368-69" aria-hidden="true" tabindex="-1"></a>    groupwise<span class="sc">$</span>task <span class="ot">&lt;-</span> run_type</span>
<span id="cb368-70"><a href="ch52_timeseries.html#cb368-70" aria-hidden="true" tabindex="-1"></a>    <span class="co"># https://stackoverflow.com/questions/29402528/append-data-frames-together-in-a-for-loop/29419402</span></span>
<span id="cb368-71"><a href="ch52_timeseries.html#cb368-71" aria-hidden="true" tabindex="-1"></a>    LINEIV1 <span class="ot">&lt;-</span> <span class="st">&quot;tr_ordered&quot;</span></span>
<span id="cb368-72"><a href="ch52_timeseries.html#cb368-72" aria-hidden="true" tabindex="-1"></a>    LINEIV2 <span class="ot">&lt;-</span> <span class="st">&quot;stim_ordered&quot;</span></span>
<span id="cb368-73"><a href="ch52_timeseries.html#cb368-73" aria-hidden="true" tabindex="-1"></a>    MEAN <span class="ot">&lt;-</span> <span class="st">&quot;mean_per_sub_norm_mean&quot;</span></span>
<span id="cb368-74"><a href="ch52_timeseries.html#cb368-74" aria-hidden="true" tabindex="-1"></a>    ERROR <span class="ot">&lt;-</span> <span class="st">&quot;se&quot;</span></span>
<span id="cb368-75"><a href="ch52_timeseries.html#cb368-75" aria-hidden="true" tabindex="-1"></a>    dv_keyword <span class="ot">&lt;-</span> <span class="st">&quot;actual&quot;</span></span>
<span id="cb368-76"><a href="ch52_timeseries.html#cb368-76" aria-hidden="true" tabindex="-1"></a>    sorted_indices <span class="ot">&lt;-</span> <span class="fu">order</span>(groupwise<span class="sc">$</span>tr_ordered)</span>
<span id="cb368-77"><a href="ch52_timeseries.html#cb368-77" aria-hidden="true" tabindex="-1"></a>    groupwise_sorted <span class="ot">&lt;-</span> groupwise[sorted_indices,]</span>
<span id="cb368-78"><a href="ch52_timeseries.html#cb368-78" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb368-79"><a href="ch52_timeseries.html#cb368-79" aria-hidden="true" tabindex="-1"></a>    <span class="co"># --------------------------------------------------------------------------</span></span>
<span id="cb368-80"><a href="ch52_timeseries.html#cb368-80" aria-hidden="true" tabindex="-1"></a>    <span class="co">#                             3) plot per run</span></span>
<span id="cb368-81"><a href="ch52_timeseries.html#cb368-81" aria-hidden="true" tabindex="-1"></a>    <span class="co"># --------------------------------------------------------------------------</span></span>
<span id="cb368-82"><a href="ch52_timeseries.html#cb368-82" aria-hidden="true" tabindex="-1"></a>    p1 <span class="ot">&lt;-</span> <span class="fu">plot_timeseries_bar_SANDBOX</span>(</span>
<span id="cb368-83"><a href="ch52_timeseries.html#cb368-83" aria-hidden="true" tabindex="-1"></a>      groupwise_sorted,</span>
<span id="cb368-84"><a href="ch52_timeseries.html#cb368-84" aria-hidden="true" tabindex="-1"></a>      LINEIV1,</span>
<span id="cb368-85"><a href="ch52_timeseries.html#cb368-85" aria-hidden="true" tabindex="-1"></a>      LINEIV2,</span>
<span id="cb368-86"><a href="ch52_timeseries.html#cb368-86" aria-hidden="true" tabindex="-1"></a>      MEAN,</span>
<span id="cb368-87"><a href="ch52_timeseries.html#cb368-87" aria-hidden="true" tabindex="-1"></a>      ERROR,</span>
<span id="cb368-88"><a href="ch52_timeseries.html#cb368-88" aria-hidden="true" tabindex="-1"></a>      <span class="at">xlab =</span> <span class="st">&quot;TRs&quot;</span>,</span>
<span id="cb368-89"><a href="ch52_timeseries.html#cb368-89" aria-hidden="true" tabindex="-1"></a>      <span class="at">ylab =</span> <span class="fu">paste0</span>(ROI, <span class="st">&quot; activation (A.U.)&quot;</span>),</span>
<span id="cb368-90"><a href="ch52_timeseries.html#cb368-90" aria-hidden="true" tabindex="-1"></a>      <span class="at">ggtitle =</span> <span class="fu">paste0</span>(</span>
<span id="cb368-91"><a href="ch52_timeseries.html#cb368-91" aria-hidden="true" tabindex="-1"></a>        ROI,</span>
<span id="cb368-92"><a href="ch52_timeseries.html#cb368-92" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;: &quot;</span>,</span>
<span id="cb368-93"><a href="ch52_timeseries.html#cb368-93" aria-hidden="true" tabindex="-1"></a>        run_type,</span>
<span id="cb368-94"><a href="ch52_timeseries.html#cb368-94" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot; (N = &quot;</span>,</span>
<span id="cb368-95"><a href="ch52_timeseries.html#cb368-95" aria-hidden="true" tabindex="-1"></a>        <span class="fu">length</span>(<span class="fu">unique</span>(subjectwise<span class="sc">$</span>sub)),</span>
<span id="cb368-96"><a href="ch52_timeseries.html#cb368-96" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;) time series, Epoch - stimulus&quot;</span></span>
<span id="cb368-97"><a href="ch52_timeseries.html#cb368-97" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb368-98"><a href="ch52_timeseries.html#cb368-98" aria-hidden="true" tabindex="-1"></a>      <span class="at">color =</span> <span class="fu">c</span>(<span class="st">&quot;#5f0f40&quot;</span>, <span class="st">&quot;#ae2012&quot;</span>, <span class="st">&quot;#fcbf49&quot;</span>)</span>
<span id="cb368-99"><a href="ch52_timeseries.html#cb368-99" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb368-100"><a href="ch52_timeseries.html#cb368-100" aria-hidden="true" tabindex="-1"></a>    time_points <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="fl">0.46</span> <span class="sc">*</span> TR_length, <span class="fl">0.46</span>)</span>
<span id="cb368-101"><a href="ch52_timeseries.html#cb368-101" aria-hidden="true" tabindex="-1"></a>    p1 <span class="ot">&lt;-</span> p1 <span class="sc">+</span></span>
<span id="cb368-102"><a href="ch52_timeseries.html#cb368-102" aria-hidden="true" tabindex="-1"></a>      <span class="fu">annotate</span>(</span>
<span id="cb368-103"><a href="ch52_timeseries.html#cb368-103" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;rect&quot;</span>,</span>
<span id="cb368-104"><a href="ch52_timeseries.html#cb368-104" aria-hidden="true" tabindex="-1"></a>        <span class="at">xmin =</span> <span class="dv">0</span>,</span>
<span id="cb368-105"><a href="ch52_timeseries.html#cb368-105" aria-hidden="true" tabindex="-1"></a>        <span class="at">xmax =</span> <span class="dv">20</span>,</span>
<span id="cb368-106"><a href="ch52_timeseries.html#cb368-106" aria-hidden="true" tabindex="-1"></a>        <span class="at">ymin =</span> <span class="fu">min</span>(df[[MEAN]], <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">-</span> <span class="dv">5</span>,</span>
<span id="cb368-107"><a href="ch52_timeseries.html#cb368-107" aria-hidden="true" tabindex="-1"></a>        <span class="at">ymax =</span> <span class="fu">max</span>(df[[MEAN]], <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">+</span> <span class="dv">5</span>,</span>
<span id="cb368-108"><a href="ch52_timeseries.html#cb368-108" aria-hidden="true" tabindex="-1"></a>        <span class="at">fill =</span> <span class="st">&quot;grey&quot;</span>,</span>
<span id="cb368-109"><a href="ch52_timeseries.html#cb368-109" aria-hidden="true" tabindex="-1"></a>        <span class="at">alpha =</span> <span class="fl">0.2</span></span>
<span id="cb368-110"><a href="ch52_timeseries.html#cb368-110" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb368-111"><a href="ch52_timeseries.html#cb368-111" aria-hidden="true" tabindex="-1"></a>    plot_list[[run_type]] <span class="ot">&lt;-</span> p1 <span class="sc">+</span> <span class="fu">theme_classic</span>()</span>
<span id="cb368-112"><a href="ch52_timeseries.html#cb368-112" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb368-113"><a href="ch52_timeseries.html#cb368-113" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb368-114"><a href="ch52_timeseries.html#cb368-114" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb368-115"><a href="ch52_timeseries.html#cb368-115" aria-hidden="true" tabindex="-1"></a>  <span class="co"># --------------------------------------------------------------------------</span></span>
<span id="cb368-116"><a href="ch52_timeseries.html#cb368-116" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                             4) plot three tasks per ROI</span></span>
<span id="cb368-117"><a href="ch52_timeseries.html#cb368-117" aria-hidden="true" tabindex="-1"></a>  <span class="co"># --------------------------------------------------------------------------</span></span>
<span id="cb368-118"><a href="ch52_timeseries.html#cb368-118" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(gridExtra)</span>
<span id="cb368-119"><a href="ch52_timeseries.html#cb368-119" aria-hidden="true" tabindex="-1"></a>  plot_list <span class="ot">&lt;-</span> <span class="fu">lapply</span>(plot_list, <span class="cf">function</span>(plot) {</span>
<span id="cb368-120"><a href="ch52_timeseries.html#cb368-120" aria-hidden="true" tabindex="-1"></a>    plot <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">plot.margin =</span> <span class="fu">margin</span>(<span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">5</span>)) <span class="co"># Adjust plot margins if needed</span></span>
<span id="cb368-121"><a href="ch52_timeseries.html#cb368-121" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb368-122"><a href="ch52_timeseries.html#cb368-122" aria-hidden="true" tabindex="-1"></a>  combined_plot <span class="ot">&lt;-</span> ggpubr<span class="sc">::</span><span class="fu">ggarrange</span>(</span>
<span id="cb368-123"><a href="ch52_timeseries.html#cb368-123" aria-hidden="true" tabindex="-1"></a>    plot_list[[<span class="st">&quot;pain&quot;</span>]],</span>
<span id="cb368-124"><a href="ch52_timeseries.html#cb368-124" aria-hidden="true" tabindex="-1"></a>    plot_list[[<span class="st">&quot;vicarious&quot;</span>]],</span>
<span id="cb368-125"><a href="ch52_timeseries.html#cb368-125" aria-hidden="true" tabindex="-1"></a>    plot_list[[<span class="st">&quot;cognitive&quot;</span>]],</span>
<span id="cb368-126"><a href="ch52_timeseries.html#cb368-126" aria-hidden="true" tabindex="-1"></a>    <span class="at">common.legend =</span> <span class="cn">TRUE</span>,</span>
<span id="cb368-127"><a href="ch52_timeseries.html#cb368-127" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend =</span> <span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb368-128"><a href="ch52_timeseries.html#cb368-128" aria-hidden="true" tabindex="-1"></a>    <span class="at">ncol =</span> <span class="dv">3</span>,</span>
<span id="cb368-129"><a href="ch52_timeseries.html#cb368-129" aria-hidden="true" tabindex="-1"></a>    <span class="at">nrow =</span> <span class="dv">1</span>,</span>
<span id="cb368-130"><a href="ch52_timeseries.html#cb368-130" aria-hidden="true" tabindex="-1"></a>    <span class="at">widths =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>),</span>
<span id="cb368-131"><a href="ch52_timeseries.html#cb368-131" aria-hidden="true" tabindex="-1"></a>    <span class="at">heights =</span> <span class="fu">c</span>(.<span class="dv">5</span>, .<span class="dv">5</span>, .<span class="dv">5</span>),</span>
<span id="cb368-132"><a href="ch52_timeseries.html#cb368-132" aria-hidden="true" tabindex="-1"></a>    <span class="at">align =</span> <span class="st">&quot;v&quot;</span></span>
<span id="cb368-133"><a href="ch52_timeseries.html#cb368-133" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb368-134"><a href="ch52_timeseries.html#cb368-134" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(combined_plot)</span>
<span id="cb368-135"><a href="ch52_timeseries.html#cb368-135" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggsave</span>(<span class="fu">file.path</span>(</span>
<span id="cb368-136"><a href="ch52_timeseries.html#cb368-136" aria-hidden="true" tabindex="-1"></a>    save_dir,</span>
<span id="cb368-137"><a href="ch52_timeseries.html#cb368-137" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste0</span>(<span class="st">&quot;roi-&quot;</span>, ROI, <span class="st">&quot;_epoch-stim_desc-highstimGTlowstim.png&quot;</span>)</span>
<span id="cb368-138"><a href="ch52_timeseries.html#cb368-138" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb368-139"><a href="ch52_timeseries.html#cb368-139" aria-hidden="true" tabindex="-1"></a>  combined_plot,</span>
<span id="cb368-140"><a href="ch52_timeseries.html#cb368-140" aria-hidden="true" tabindex="-1"></a>  <span class="at">width =</span> <span class="dv">12</span>,</span>
<span id="cb368-141"><a href="ch52_timeseries.html#cb368-141" aria-hidden="true" tabindex="-1"></a>  <span class="at">height =</span> <span class="dv">4</span>)</span>
<span id="cb368-142"><a href="ch52_timeseries.html#cb368-142" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</details>
<pre><code>## [1] &quot;pain&quot;</code></pre>
<pre><code>## 
## Attaching package: &#39;raincloudplots&#39;</code></pre>
<pre><code>## The following object is masked _by_ &#39;.GlobalEnv&#39;:
## 
##     GeomFlatViolin</code></pre>
<pre><code>## Warning in geom_errorbar(aes(ymin = (.data[[mean]] - .data[[error]]), ymax =
## (.data[[mean]] + : Ignoring unknown aesthetics: fill</code></pre>
<pre><code>## Warning in min(df[[MEAN]], na.rm = TRUE): no non-missing arguments to min;
## returning Inf</code></pre>
<pre><code>## Warning in max(df[[MEAN]], na.rm = TRUE): no non-missing arguments to max;
## returning -Inf</code></pre>
<pre><code>## [1] &quot;vicarious&quot;</code></pre>
<pre><code>## Warning in geom_errorbar(aes(ymin = (.data[[mean]] - .data[[error]]), ymax =
## (.data[[mean]] + : Ignoring unknown aesthetics: fill</code></pre>
<pre><code>## Warning in min(df[[MEAN]], na.rm = TRUE): no non-missing arguments to min;
## returning Inf</code></pre>
<pre><code>## Warning in max(df[[MEAN]], na.rm = TRUE): no non-missing arguments to max;
## returning -Inf</code></pre>
<pre><code>## [1] &quot;cognitive&quot;</code></pre>
<pre><code>## Warning in geom_errorbar(aes(ymin = (.data[[mean]] - .data[[error]]), ymax =
## (.data[[mean]] + : Ignoring unknown aesthetics: fill</code></pre>
<pre><code>## Warning in min(df[[MEAN]], na.rm = TRUE): no non-missing arguments to min;
## returning Inf</code></pre>
<pre><code>## Warning in max(df[[MEAN]], na.rm = TRUE): no non-missing arguments to max;
## returning -Inf</code></pre>
<pre><code>## 
## Attaching package: &#39;gridExtra&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:dplyr&#39;:
## 
##     combine</code></pre>
<pre><code>## [1] &quot;pain&quot;</code></pre>
<pre><code>## Warning in geom_errorbar(aes(ymin = (.data[[mean]] - .data[[error]]), ymax =
## (.data[[mean]] + : Ignoring unknown aesthetics: fill</code></pre>
<pre><code>## Warning in min(df[[MEAN]], na.rm = TRUE): no non-missing arguments to min;
## returning Inf</code></pre>
<pre><code>## Warning in max(df[[MEAN]], na.rm = TRUE): no non-missing arguments to max;
## returning -Inf</code></pre>
<pre><code>## [1] &quot;vicarious&quot;</code></pre>
<pre><code>## Warning in geom_errorbar(aes(ymin = (.data[[mean]] - .data[[error]]), ymax =
## (.data[[mean]] + : Ignoring unknown aesthetics: fill</code></pre>
<pre><code>## Warning in min(df[[MEAN]], na.rm = TRUE): no non-missing arguments to min;
## returning Inf</code></pre>
<pre><code>## Warning in max(df[[MEAN]], na.rm = TRUE): no non-missing arguments to max;
## returning -Inf</code></pre>
<pre><code>## [1] &quot;cognitive&quot;</code></pre>
<pre><code>## Warning in geom_errorbar(aes(ymin = (.data[[mean]] - .data[[error]]), ymax =
## (.data[[mean]] + : Ignoring unknown aesthetics: fill</code></pre>
<pre><code>## Warning in min(df[[MEAN]], na.rm = TRUE): no non-missing arguments to min;
## returning Inf</code></pre>
<pre><code>## Warning in max(df[[MEAN]], na.rm = TRUE): no non-missing arguments to max;
## returning -Inf</code></pre>
<p><img src="52_iv-6cond_dv-firglasserSPM_ttl1_rois_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<pre><code>## [1] &quot;pain&quot;</code></pre>
<pre><code>## Warning in geom_errorbar(aes(ymin = (.data[[mean]] - .data[[error]]), ymax =
## (.data[[mean]] + : Ignoring unknown aesthetics: fill</code></pre>
<pre><code>## Warning in min(df[[MEAN]], na.rm = TRUE): no non-missing arguments to min;
## returning Inf</code></pre>
<pre><code>## Warning in max(df[[MEAN]], na.rm = TRUE): no non-missing arguments to max;
## returning -Inf</code></pre>
<pre><code>## [1] &quot;vicarious&quot;</code></pre>
<pre><code>## Warning in geom_errorbar(aes(ymin = (.data[[mean]] - .data[[error]]), ymax =
## (.data[[mean]] + : Ignoring unknown aesthetics: fill</code></pre>
<pre><code>## Warning in min(df[[MEAN]], na.rm = TRUE): no non-missing arguments to min;
## returning Inf</code></pre>
<pre><code>## Warning in max(df[[MEAN]], na.rm = TRUE): no non-missing arguments to max;
## returning -Inf</code></pre>
<pre><code>## [1] &quot;cognitive&quot;</code></pre>
<pre><code>## Warning in geom_errorbar(aes(ymin = (.data[[mean]] - .data[[error]]), ymax =
## (.data[[mean]] + : Ignoring unknown aesthetics: fill</code></pre>
<pre><code>## Warning in min(df[[MEAN]], na.rm = TRUE): no non-missing arguments to min;
## returning Inf</code></pre>
<pre><code>## Warning in max(df[[MEAN]], na.rm = TRUE): no non-missing arguments to max;
## returning -Inf</code></pre>
<p><img src="52_iv-6cond_dv-firglasserSPM_ttl1_rois_files/figure-html/unnamed-chunk-4-2.png" width="672" /></p>
<pre><code>## [1] &quot;pain&quot;</code></pre>
<pre><code>## Warning in geom_errorbar(aes(ymin = (.data[[mean]] - .data[[error]]), ymax =
## (.data[[mean]] + : Ignoring unknown aesthetics: fill</code></pre>
<pre><code>## Warning in min(df[[MEAN]], na.rm = TRUE): no non-missing arguments to min;
## returning Inf</code></pre>
<pre><code>## Warning in max(df[[MEAN]], na.rm = TRUE): no non-missing arguments to max;
## returning -Inf</code></pre>
<pre><code>## [1] &quot;vicarious&quot;</code></pre>
<pre><code>## Warning in geom_errorbar(aes(ymin = (.data[[mean]] - .data[[error]]), ymax =
## (.data[[mean]] + : Ignoring unknown aesthetics: fill</code></pre>
<pre><code>## Warning in min(df[[MEAN]], na.rm = TRUE): no non-missing arguments to min;
## returning Inf</code></pre>
<pre><code>## Warning in max(df[[MEAN]], na.rm = TRUE): no non-missing arguments to max;
## returning -Inf</code></pre>
<pre><code>## [1] &quot;cognitive&quot;</code></pre>
<pre><code>## Warning in geom_errorbar(aes(ymin = (.data[[mean]] - .data[[error]]), ymax =
## (.data[[mean]] + : Ignoring unknown aesthetics: fill</code></pre>
<pre><code>## Warning in min(df[[MEAN]], na.rm = TRUE): no non-missing arguments to min;
## returning Inf</code></pre>
<pre><code>## Warning in max(df[[MEAN]], na.rm = TRUE): no non-missing arguments to max;
## returning -Inf</code></pre>
<p><img src="52_iv-6cond_dv-firglasserSPM_ttl1_rois_files/figure-html/unnamed-chunk-4-3.png" width="672" /></p>
<pre><code>## [1] &quot;pain&quot;</code></pre>
<pre><code>## Warning in geom_errorbar(aes(ymin = (.data[[mean]] - .data[[error]]), ymax =
## (.data[[mean]] + : Ignoring unknown aesthetics: fill</code></pre>
<pre><code>## Warning in min(df[[MEAN]], na.rm = TRUE): no non-missing arguments to min;
## returning Inf</code></pre>
<pre><code>## Warning in max(df[[MEAN]], na.rm = TRUE): no non-missing arguments to max;
## returning -Inf</code></pre>
<pre><code>## [1] &quot;vicarious&quot;</code></pre>
<pre><code>## Warning in geom_errorbar(aes(ymin = (.data[[mean]] - .data[[error]]), ymax =
## (.data[[mean]] + : Ignoring unknown aesthetics: fill</code></pre>
<pre><code>## Warning in min(df[[MEAN]], na.rm = TRUE): no non-missing arguments to min;
## returning Inf</code></pre>
<pre><code>## Warning in max(df[[MEAN]], na.rm = TRUE): no non-missing arguments to max;
## returning -Inf</code></pre>
<pre><code>## [1] &quot;cognitive&quot;</code></pre>
<pre><code>## Warning in geom_errorbar(aes(ymin = (.data[[mean]] - .data[[error]]), ymax =
## (.data[[mean]] + : Ignoring unknown aesthetics: fill</code></pre>
<pre><code>## Warning in min(df[[MEAN]], na.rm = TRUE): no non-missing arguments to min;
## returning Inf</code></pre>
<pre><code>## Warning in max(df[[MEAN]], na.rm = TRUE): no non-missing arguments to max;
## returning -Inf</code></pre>
<p><img src="52_iv-6cond_dv-firglasserSPM_ttl1_rois_files/figure-html/unnamed-chunk-4-4.png" width="672" /></p>
<pre><code>## [1] &quot;pain&quot;</code></pre>
<pre><code>## Warning in geom_errorbar(aes(ymin = (.data[[mean]] - .data[[error]]), ymax =
## (.data[[mean]] + : Ignoring unknown aesthetics: fill</code></pre>
<pre><code>## Warning in min(df[[MEAN]], na.rm = TRUE): no non-missing arguments to min;
## returning Inf</code></pre>
<pre><code>## Warning in max(df[[MEAN]], na.rm = TRUE): no non-missing arguments to max;
## returning -Inf</code></pre>
<pre><code>## [1] &quot;vicarious&quot;</code></pre>
<pre><code>## Warning in geom_errorbar(aes(ymin = (.data[[mean]] - .data[[error]]), ymax =
## (.data[[mean]] + : Ignoring unknown aesthetics: fill</code></pre>
<pre><code>## Warning in min(df[[MEAN]], na.rm = TRUE): no non-missing arguments to min;
## returning Inf</code></pre>
<pre><code>## Warning in max(df[[MEAN]], na.rm = TRUE): no non-missing arguments to max;
## returning -Inf</code></pre>
<pre><code>## [1] &quot;cognitive&quot;</code></pre>
<pre><code>## Warning in geom_errorbar(aes(ymin = (.data[[mean]] - .data[[error]]), ymax =
## (.data[[mean]] + : Ignoring unknown aesthetics: fill</code></pre>
<pre><code>## Warning in min(df[[MEAN]], na.rm = TRUE): no non-missing arguments to min;
## returning Inf</code></pre>
<pre><code>## Warning in max(df[[MEAN]], na.rm = TRUE): no non-missing arguments to max;
## returning -Inf</code></pre>
<p><img src="52_iv-6cond_dv-firglasserSPM_ttl1_rois_files/figure-html/unnamed-chunk-4-5.png" width="672" /></p>
<pre><code>## [1] &quot;pain&quot;</code></pre>
<pre><code>## Warning in geom_errorbar(aes(ymin = (.data[[mean]] - .data[[error]]), ymax =
## (.data[[mean]] + : Ignoring unknown aesthetics: fill</code></pre>
<pre><code>## Warning in min(df[[MEAN]], na.rm = TRUE): no non-missing arguments to min;
## returning Inf</code></pre>
<pre><code>## Warning in max(df[[MEAN]], na.rm = TRUE): no non-missing arguments to max;
## returning -Inf</code></pre>
<pre><code>## [1] &quot;vicarious&quot;</code></pre>
<pre><code>## Warning in geom_errorbar(aes(ymin = (.data[[mean]] - .data[[error]]), ymax =
## (.data[[mean]] + : Ignoring unknown aesthetics: fill</code></pre>
<pre><code>## Warning in min(df[[MEAN]], na.rm = TRUE): no non-missing arguments to min;
## returning Inf</code></pre>
<pre><code>## Warning in max(df[[MEAN]], na.rm = TRUE): no non-missing arguments to max;
## returning -Inf</code></pre>
<pre><code>## [1] &quot;cognitive&quot;</code></pre>
<pre><code>## Warning in geom_errorbar(aes(ymin = (.data[[mean]] - .data[[error]]), ymax =
## (.data[[mean]] + : Ignoring unknown aesthetics: fill</code></pre>
<pre><code>## Warning in min(df[[MEAN]], na.rm = TRUE): no non-missing arguments to min;
## returning Inf</code></pre>
<pre><code>## Warning in max(df[[MEAN]], na.rm = TRUE): no non-missing arguments to max;
## returning -Inf</code></pre>
<p><img src="52_iv-6cond_dv-firglasserSPM_ttl1_rois_files/figure-html/unnamed-chunk-4-6.png" width="672" /></p>
<pre><code>## [1] &quot;pain&quot;</code></pre>
<pre><code>## Warning in geom_errorbar(aes(ymin = (.data[[mean]] - .data[[error]]), ymax =
## (.data[[mean]] + : Ignoring unknown aesthetics: fill</code></pre>
<pre><code>## Warning in min(df[[MEAN]], na.rm = TRUE): no non-missing arguments to min;
## returning Inf</code></pre>
<pre><code>## Warning in max(df[[MEAN]], na.rm = TRUE): no non-missing arguments to max;
## returning -Inf</code></pre>
<pre><code>## [1] &quot;vicarious&quot;</code></pre>
<pre><code>## Warning in geom_errorbar(aes(ymin = (.data[[mean]] - .data[[error]]), ymax =
## (.data[[mean]] + : Ignoring unknown aesthetics: fill</code></pre>
<pre><code>## Warning in min(df[[MEAN]], na.rm = TRUE): no non-missing arguments to min;
## returning Inf</code></pre>
<pre><code>## Warning in max(df[[MEAN]], na.rm = TRUE): no non-missing arguments to max;
## returning -Inf</code></pre>
<pre><code>## [1] &quot;cognitive&quot;</code></pre>
<pre><code>## Warning in geom_errorbar(aes(ymin = (.data[[mean]] - .data[[error]]), ymax =
## (.data[[mean]] + : Ignoring unknown aesthetics: fill</code></pre>
<pre><code>## Warning in min(df[[MEAN]], na.rm = TRUE): no non-missing arguments to min;
## returning Inf</code></pre>
<pre><code>## Warning in max(df[[MEAN]], na.rm = TRUE): no non-missing arguments to max;
## returning -Inf</code></pre>
<p><img src="52_iv-6cond_dv-firglasserSPM_ttl1_rois_files/figure-html/unnamed-chunk-4-7.png" width="672" /></p>
<pre><code>## [1] &quot;pain&quot;</code></pre>
<pre><code>## Warning in geom_errorbar(aes(ymin = (.data[[mean]] - .data[[error]]), ymax =
## (.data[[mean]] + : Ignoring unknown aesthetics: fill</code></pre>
<pre><code>## Warning in min(df[[MEAN]], na.rm = TRUE): no non-missing arguments to min;
## returning Inf</code></pre>
<pre><code>## Warning in max(df[[MEAN]], na.rm = TRUE): no non-missing arguments to max;
## returning -Inf</code></pre>
<pre><code>## [1] &quot;vicarious&quot;</code></pre>
<pre><code>## Warning in geom_errorbar(aes(ymin = (.data[[mean]] - .data[[error]]), ymax =
## (.data[[mean]] + : Ignoring unknown aesthetics: fill</code></pre>
<pre><code>## Warning in min(df[[MEAN]], na.rm = TRUE): no non-missing arguments to min;
## returning Inf</code></pre>
<pre><code>## Warning in max(df[[MEAN]], na.rm = TRUE): no non-missing arguments to max;
## returning -Inf</code></pre>
<pre><code>## [1] &quot;cognitive&quot;</code></pre>
<pre><code>## Warning in geom_errorbar(aes(ymin = (.data[[mean]] - .data[[error]]), ymax =
## (.data[[mean]] + : Ignoring unknown aesthetics: fill</code></pre>
<pre><code>## Warning in min(df[[MEAN]], na.rm = TRUE): no non-missing arguments to min;
## returning Inf</code></pre>
<pre><code>## Warning in max(df[[MEAN]], na.rm = TRUE): no non-missing arguments to max;
## returning -Inf</code></pre>
<p><img src="52_iv-6cond_dv-firglasserSPM_ttl1_rois_files/figure-html/unnamed-chunk-4-8.png" width="672" /></p>
<pre><code>## [1] &quot;pain&quot;</code></pre>
<pre><code>## Warning in geom_errorbar(aes(ymin = (.data[[mean]] - .data[[error]]), ymax =
## (.data[[mean]] + : Ignoring unknown aesthetics: fill</code></pre>
<pre><code>## Warning in min(df[[MEAN]], na.rm = TRUE): no non-missing arguments to min;
## returning Inf</code></pre>
<pre><code>## Warning in max(df[[MEAN]], na.rm = TRUE): no non-missing arguments to max;
## returning -Inf</code></pre>
<pre><code>## [1] &quot;vicarious&quot;</code></pre>
<pre><code>## Warning in geom_errorbar(aes(ymin = (.data[[mean]] - .data[[error]]), ymax =
## (.data[[mean]] + : Ignoring unknown aesthetics: fill</code></pre>
<pre><code>## Warning in min(df[[MEAN]], na.rm = TRUE): no non-missing arguments to min;
## returning Inf</code></pre>
<pre><code>## Warning in max(df[[MEAN]], na.rm = TRUE): no non-missing arguments to max;
## returning -Inf</code></pre>
<pre><code>## [1] &quot;cognitive&quot;</code></pre>
<pre><code>## Warning in geom_errorbar(aes(ymin = (.data[[mean]] - .data[[error]]), ymax =
## (.data[[mean]] + : Ignoring unknown aesthetics: fill</code></pre>
<pre><code>## Warning in min(df[[MEAN]], na.rm = TRUE): no non-missing arguments to min;
## returning Inf</code></pre>
<pre><code>## Warning in max(df[[MEAN]], na.rm = TRUE): no non-missing arguments to max;
## returning -Inf</code></pre>
<p><img src="52_iv-6cond_dv-firglasserSPM_ttl1_rois_files/figure-html/unnamed-chunk-4-9.png" width="672" /></p>
<pre><code>## [1] &quot;pain&quot;</code></pre>
<pre><code>## Warning in geom_errorbar(aes(ymin = (.data[[mean]] - .data[[error]]), ymax =
## (.data[[mean]] + : Ignoring unknown aesthetics: fill</code></pre>
<pre><code>## Warning in min(df[[MEAN]], na.rm = TRUE): no non-missing arguments to min;
## returning Inf</code></pre>
<pre><code>## Warning in max(df[[MEAN]], na.rm = TRUE): no non-missing arguments to max;
## returning -Inf</code></pre>
<pre><code>## [1] &quot;vicarious&quot;</code></pre>
<pre><code>## Warning in geom_errorbar(aes(ymin = (.data[[mean]] - .data[[error]]), ymax =
## (.data[[mean]] + : Ignoring unknown aesthetics: fill</code></pre>
<pre><code>## Warning in min(df[[MEAN]], na.rm = TRUE): no non-missing arguments to min;
## returning Inf</code></pre>
<pre><code>## Warning in max(df[[MEAN]], na.rm = TRUE): no non-missing arguments to max;
## returning -Inf</code></pre>
<pre><code>## [1] &quot;cognitive&quot;</code></pre>
<pre><code>## Warning in geom_errorbar(aes(ymin = (.data[[mean]] - .data[[error]]), ymax =
## (.data[[mean]] + : Ignoring unknown aesthetics: fill</code></pre>
<pre><code>## Warning in min(df[[MEAN]], na.rm = TRUE): no non-missing arguments to min;
## returning Inf</code></pre>
<pre><code>## Warning in max(df[[MEAN]], na.rm = TRUE): no non-missing arguments to max;
## returning -Inf</code></pre>
<p><img src="52_iv-6cond_dv-firglasserSPM_ttl1_rois_files/figure-html/unnamed-chunk-4-10.png" width="672" /></p>
<pre><code>## [1] &quot;pain&quot;</code></pre>
<pre><code>## Warning in geom_errorbar(aes(ymin = (.data[[mean]] - .data[[error]]), ymax =
## (.data[[mean]] + : Ignoring unknown aesthetics: fill</code></pre>
<pre><code>## Warning in min(df[[MEAN]], na.rm = TRUE): no non-missing arguments to min;
## returning Inf</code></pre>
<pre><code>## Warning in max(df[[MEAN]], na.rm = TRUE): no non-missing arguments to max;
## returning -Inf</code></pre>
<pre><code>## [1] &quot;vicarious&quot;</code></pre>
<pre><code>## Warning in geom_errorbar(aes(ymin = (.data[[mean]] - .data[[error]]), ymax =
## (.data[[mean]] + : Ignoring unknown aesthetics: fill</code></pre>
<pre><code>## Warning in min(df[[MEAN]], na.rm = TRUE): no non-missing arguments to min;
## returning Inf</code></pre>
<pre><code>## Warning in max(df[[MEAN]], na.rm = TRUE): no non-missing arguments to max;
## returning -Inf</code></pre>
<pre><code>## [1] &quot;cognitive&quot;</code></pre>
<pre><code>## Warning in geom_errorbar(aes(ymin = (.data[[mean]] - .data[[error]]), ymax =
## (.data[[mean]] + : Ignoring unknown aesthetics: fill</code></pre>
<pre><code>## Warning in min(df[[MEAN]], na.rm = TRUE): no non-missing arguments to min;
## returning Inf</code></pre>
<pre><code>## Warning in max(df[[MEAN]], na.rm = TRUE): no non-missing arguments to max;
## returning -Inf</code></pre>
<p><img src="52_iv-6cond_dv-firglasserSPM_ttl1_rois_files/figure-html/unnamed-chunk-4-11.png" width="672" /><img src="52_iv-6cond_dv-firglasserSPM_ttl1_rois_files/figure-html/unnamed-chunk-4-12.png" width="672" /></p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb517"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb517-1"><a href="ch52_timeseries.html#cb517-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">+</span> <span class="fu">annotate</span>(<span class="st">&quot;rect&quot;</span>, <span class="at">xmin =</span> <span class="dv">0</span>, <span class="at">xmax =</span> <span class="dv">10</span>, <span class="at">ymin =</span> <span class="fu">min</span>(df[[MEAN]], <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">-</span> <span class="dv">5</span>, <span class="at">ymax =</span> <span class="fu">max</span>(df[[MEAN]], <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">+</span> <span class="dv">5</span>, <span class="at">fill =</span> <span class="st">&quot;grey&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.2</span>)</span></code></pre></div>
</details>
<pre><code>## Warning in min(df[[MEAN]], na.rm = TRUE): no non-missing arguments to min;
## returning Inf</code></pre>
<pre><code>## Warning in max(df[[MEAN]], na.rm = TRUE): no non-missing arguments to max;
## returning -Inf</code></pre>
<p><img src="52_iv-6cond_dv-firglasserSPM_ttl1_rois_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<div id="pca-subjectwise-1" class="section level3 hasAnchor" number="16.2.1">
<h3><span class="header-section-number">16.2.1</span> PCA subjectwise<a href="ch52_timeseries.html#pca-subjectwise-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb520"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb520-1"><a href="ch52_timeseries.html#cb520-1" aria-hidden="true" tabindex="-1"></a>run_types <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;pain&quot;</span>)</span>
<span id="cb520-2"><a href="ch52_timeseries.html#cb520-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (run_type <span class="cf">in</span> run_types) {</span>
<span id="cb520-3"><a href="ch52_timeseries.html#cb520-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(run_type)</span>
<span id="cb520-4"><a href="ch52_timeseries.html#cb520-4" aria-hidden="true" tabindex="-1"></a>  filtered_df <span class="ot">&lt;-</span></span>
<span id="cb520-5"><a href="ch52_timeseries.html#cb520-5" aria-hidden="true" tabindex="-1"></a>    df[<span class="sc">!</span>(df<span class="sc">$</span>condition <span class="sc">==</span> <span class="st">&quot;rating&quot;</span> <span class="sc">|</span></span>
<span id="cb520-6"><a href="ch52_timeseries.html#cb520-6" aria-hidden="true" tabindex="-1"></a>           df<span class="sc">$</span>condition <span class="sc">==</span> <span class="st">&quot;cue&quot;</span> <span class="sc">|</span> df<span class="sc">$</span>runtype <span class="sc">!=</span> run_type),]</span>
<span id="cb520-7"><a href="ch52_timeseries.html#cb520-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb520-8"><a href="ch52_timeseries.html#cb520-8" aria-hidden="true" tabindex="-1"></a>  parsed_df <span class="ot">&lt;-</span> filtered_df <span class="sc">%&gt;%</span></span>
<span id="cb520-9"><a href="ch52_timeseries.html#cb520-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">separate</span>(</span>
<span id="cb520-10"><a href="ch52_timeseries.html#cb520-10" aria-hidden="true" tabindex="-1"></a>      condition,</span>
<span id="cb520-11"><a href="ch52_timeseries.html#cb520-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">into =</span> <span class="fu">c</span>(<span class="st">&quot;cue&quot;</span>, <span class="st">&quot;stim&quot;</span>),</span>
<span id="cb520-12"><a href="ch52_timeseries.html#cb520-12" aria-hidden="true" tabindex="-1"></a>      <span class="at">sep =</span> <span class="st">&quot;_&quot;</span>,</span>
<span id="cb520-13"><a href="ch52_timeseries.html#cb520-13" aria-hidden="true" tabindex="-1"></a>      <span class="at">remove =</span> <span class="cn">FALSE</span></span>
<span id="cb520-14"><a href="ch52_timeseries.html#cb520-14" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb520-15"><a href="ch52_timeseries.html#cb520-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ------------------------------------------------------------------------------</span></span>
<span id="cb520-16"><a href="ch52_timeseries.html#cb520-16" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                       subset regions based on ROI</span></span>
<span id="cb520-17"><a href="ch52_timeseries.html#cb520-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ------------------------------------------------------------------------------</span></span>
<span id="cb520-18"><a href="ch52_timeseries.html#cb520-18" aria-hidden="true" tabindex="-1"></a>  df_long <span class="ot">&lt;-</span></span>
<span id="cb520-19"><a href="ch52_timeseries.html#cb520-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pivot_longer</span>(</span>
<span id="cb520-20"><a href="ch52_timeseries.html#cb520-20" aria-hidden="true" tabindex="-1"></a>      parsed_df,</span>
<span id="cb520-21"><a href="ch52_timeseries.html#cb520-21" aria-hidden="true" tabindex="-1"></a>      <span class="at">cols =</span> <span class="fu">starts_with</span>(<span class="st">&quot;tr&quot;</span>),</span>
<span id="cb520-22"><a href="ch52_timeseries.html#cb520-22" aria-hidden="true" tabindex="-1"></a>      <span class="at">names_to =</span> <span class="st">&quot;tr_num&quot;</span>,</span>
<span id="cb520-23"><a href="ch52_timeseries.html#cb520-23" aria-hidden="true" tabindex="-1"></a>      <span class="at">values_to =</span> <span class="st">&quot;tr_value&quot;</span></span>
<span id="cb520-24"><a href="ch52_timeseries.html#cb520-24" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb520-25"><a href="ch52_timeseries.html#cb520-25" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb520-26"><a href="ch52_timeseries.html#cb520-26" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ------------------------------------------------------------------------------</span></span>
<span id="cb520-27"><a href="ch52_timeseries.html#cb520-27" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                             clean factor</span></span>
<span id="cb520-28"><a href="ch52_timeseries.html#cb520-28" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ------------------------------------------------------------------------------</span></span>
<span id="cb520-29"><a href="ch52_timeseries.html#cb520-29" aria-hidden="true" tabindex="-1"></a>  df_long<span class="sc">$</span>tr_ordered <span class="ot">&lt;-</span> <span class="fu">factor</span>(df_long<span class="sc">$</span>tr_num,</span>
<span id="cb520-30"><a href="ch52_timeseries.html#cb520-30" aria-hidden="true" tabindex="-1"></a>                               <span class="at">levels =</span> <span class="fu">c</span>(<span class="fu">paste0</span>(<span class="st">&quot;tr&quot;</span>, <span class="dv">1</span><span class="sc">:</span>TR_length)))</span>
<span id="cb520-31"><a href="ch52_timeseries.html#cb520-31" aria-hidden="true" tabindex="-1"></a>  df_long<span class="sc">$</span>stim_ordered <span class="ot">&lt;-</span> <span class="fu">factor</span>(df_long<span class="sc">$</span>stim,</span>
<span id="cb520-32"><a href="ch52_timeseries.html#cb520-32" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;stimH&quot;</span>, <span class="st">&quot;stimM&quot;</span>, <span class="st">&quot;stimL&quot;</span>))</span>
<span id="cb520-33"><a href="ch52_timeseries.html#cb520-33" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb520-34"><a href="ch52_timeseries.html#cb520-34" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ------------------------------------------------------------------------------</span></span>
<span id="cb520-35"><a href="ch52_timeseries.html#cb520-35" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                            summary stats</span></span>
<span id="cb520-36"><a href="ch52_timeseries.html#cb520-36" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ------------------------------------------------------------------------------</span></span>
<span id="cb520-37"><a href="ch52_timeseries.html#cb520-37" aria-hidden="true" tabindex="-1"></a>  subjectwise <span class="ot">&lt;-</span> <span class="fu">meanSummary</span>(df_long,</span>
<span id="cb520-38"><a href="ch52_timeseries.html#cb520-38" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">c</span>(<span class="st">&quot;sub&quot;</span>, <span class="st">&quot;tr_ordered&quot;</span>, <span class="st">&quot;stim_ordered&quot;</span>), <span class="st">&quot;tr_value&quot;</span>)</span>
<span id="cb520-39"><a href="ch52_timeseries.html#cb520-39" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb520-40"><a href="ch52_timeseries.html#cb520-40" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb520-41"><a href="ch52_timeseries.html#cb520-41" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ------------------------------------------------------------------------------</span></span>
<span id="cb520-42"><a href="ch52_timeseries.html#cb520-42" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                             convert dataframe long to wide</span></span>
<span id="cb520-43"><a href="ch52_timeseries.html#cb520-43" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ------------------------------------------------------------------------------</span></span>
<span id="cb520-44"><a href="ch52_timeseries.html#cb520-44" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb520-45"><a href="ch52_timeseries.html#cb520-45" aria-hidden="true" tabindex="-1"></a>  df_wide <span class="ot">&lt;-</span> <span class="fu">pivot_wider</span>(</span>
<span id="cb520-46"><a href="ch52_timeseries.html#cb520-46" aria-hidden="true" tabindex="-1"></a>    subjectwise,</span>
<span id="cb520-47"><a href="ch52_timeseries.html#cb520-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">id_cols =</span> <span class="fu">c</span>(<span class="st">&quot;tr_ordered&quot;</span>, <span class="st">&quot;stim_ordered&quot;</span>),</span>
<span id="cb520-48"><a href="ch52_timeseries.html#cb520-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_from =</span> <span class="fu">c</span>(<span class="st">&quot;sub&quot;</span>),</span>
<span id="cb520-49"><a href="ch52_timeseries.html#cb520-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_from =</span> <span class="st">&quot;mean_per_sub&quot;</span></span>
<span id="cb520-50"><a href="ch52_timeseries.html#cb520-50" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb520-51"><a href="ch52_timeseries.html#cb520-51" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb520-52"><a href="ch52_timeseries.html#cb520-52" aria-hidden="true" tabindex="-1"></a>  stim_high.df <span class="ot">&lt;-</span> df_wide[df_wide<span class="sc">$</span>stim_ordered <span class="sc">==</span> <span class="st">&quot;stimH&quot;</span>,]</span>
<span id="cb520-53"><a href="ch52_timeseries.html#cb520-53" aria-hidden="true" tabindex="-1"></a>  stim_med.df <span class="ot">&lt;-</span> df_wide[df_wide<span class="sc">$</span>stim_ordered <span class="sc">==</span> <span class="st">&quot;stimM&quot;</span>,]</span>
<span id="cb520-54"><a href="ch52_timeseries.html#cb520-54" aria-hidden="true" tabindex="-1"></a>  stim_low.df <span class="ot">&lt;-</span> df_wide[df_wide<span class="sc">$</span>stim_ordered <span class="sc">==</span> <span class="st">&quot;stimL&quot;</span>,]</span>
<span id="cb520-55"><a href="ch52_timeseries.html#cb520-55" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb520-56"><a href="ch52_timeseries.html#cb520-56" aria-hidden="true" tabindex="-1"></a>  meanhighdf <span class="ot">&lt;-</span></span>
<span id="cb520-57"><a href="ch52_timeseries.html#cb520-57" aria-hidden="true" tabindex="-1"></a>    <span class="fu">data.frame</span>(<span class="fu">subset</span>(stim_high.df, <span class="at">select =</span> <span class="dv">3</span><span class="sc">:</span>(<span class="fu">ncol</span>(stim_high.df) <span class="sc">-</span> <span class="dv">1</span>)))</span>
<span id="cb520-58"><a href="ch52_timeseries.html#cb520-58" aria-hidden="true" tabindex="-1"></a>  high.pca_result <span class="ot">&lt;-</span> <span class="fu">prcomp</span>(meanhighdf)</span>
<span id="cb520-59"><a href="ch52_timeseries.html#cb520-59" aria-hidden="true" tabindex="-1"></a>  high.pca_scores <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(high.pca_result<span class="sc">$</span>x)</span>
<span id="cb520-60"><a href="ch52_timeseries.html#cb520-60" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Access the proportion of variance explained by each principal component</span></span>
<span id="cb520-61"><a href="ch52_timeseries.html#cb520-61" aria-hidden="true" tabindex="-1"></a>  high.variance_explained <span class="ot">&lt;-</span></span>
<span id="cb520-62"><a href="ch52_timeseries.html#cb520-62" aria-hidden="true" tabindex="-1"></a>    high.pca_result<span class="sc">$</span>sdev <span class="sc">^</span> <span class="dv">2</span> <span class="sc">/</span> <span class="fu">sum</span>(high.pca_result<span class="sc">$</span>sdev <span class="sc">^</span> <span class="dv">2</span>)</span>
<span id="cb520-63"><a href="ch52_timeseries.html#cb520-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(high.variance_explained)</span>
<span id="cb520-64"><a href="ch52_timeseries.html#cb520-64" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Access the standard deviations of each principal component</span></span>
<span id="cb520-65"><a href="ch52_timeseries.html#cb520-65" aria-hidden="true" tabindex="-1"></a>  high.stdev <span class="ot">&lt;-</span> high.pca_result<span class="sc">$</span>sdev</span>
<span id="cb520-66"><a href="ch52_timeseries.html#cb520-66" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb520-67"><a href="ch52_timeseries.html#cb520-67" aria-hidden="true" tabindex="-1"></a>  meanmeddf <span class="ot">&lt;-</span></span>
<span id="cb520-68"><a href="ch52_timeseries.html#cb520-68" aria-hidden="true" tabindex="-1"></a>    <span class="fu">data.frame</span>(<span class="fu">subset</span>(stim_med.df, <span class="at">select =</span> <span class="dv">3</span><span class="sc">:</span>(<span class="fu">ncol</span>(stim_med.df) <span class="sc">-</span> <span class="dv">1</span>)))</span>
<span id="cb520-69"><a href="ch52_timeseries.html#cb520-69" aria-hidden="true" tabindex="-1"></a>  med.pca <span class="ot">&lt;-</span> <span class="fu">prcomp</span>(meanmeddf)</span>
<span id="cb520-70"><a href="ch52_timeseries.html#cb520-70" aria-hidden="true" tabindex="-1"></a>  med.pca_scores <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(med.pca<span class="sc">$</span>x)</span>
<span id="cb520-71"><a href="ch52_timeseries.html#cb520-71" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb520-72"><a href="ch52_timeseries.html#cb520-72" aria-hidden="true" tabindex="-1"></a>  meanlowdf <span class="ot">&lt;-</span></span>
<span id="cb520-73"><a href="ch52_timeseries.html#cb520-73" aria-hidden="true" tabindex="-1"></a>    <span class="fu">data.frame</span>(<span class="fu">subset</span>(stim_low.df, <span class="at">select =</span> <span class="dv">3</span><span class="sc">:</span>(<span class="fu">ncol</span>(stim_low.df) <span class="sc">-</span> <span class="dv">1</span>)))</span>
<span id="cb520-74"><a href="ch52_timeseries.html#cb520-74" aria-hidden="true" tabindex="-1"></a>  low.pca <span class="ot">&lt;-</span> <span class="fu">prcomp</span>(meanlowdf)</span>
<span id="cb520-75"><a href="ch52_timeseries.html#cb520-75" aria-hidden="true" tabindex="-1"></a>  low.pca_scores <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(low.pca<span class="sc">$</span>x)</span>
<span id="cb520-76"><a href="ch52_timeseries.html#cb520-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb520-77"><a href="ch52_timeseries.html#cb520-77" aria-hidden="true" tabindex="-1"></a>  combined_pca_scores <span class="ot">&lt;-</span></span>
<span id="cb520-78"><a href="ch52_timeseries.html#cb520-78" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rbind</span>(high.pca_scores, med.pca_scores, low.pca_scores)</span>
<span id="cb520-79"><a href="ch52_timeseries.html#cb520-79" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb520-80"><a href="ch52_timeseries.html#cb520-80" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add a new column to indicate the stim_ordered category (high_stim or low_stim)</span></span>
<span id="cb520-81"><a href="ch52_timeseries.html#cb520-81" aria-hidden="true" tabindex="-1"></a>  combined_pca_scores<span class="sc">$</span>stim_ordered <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">&quot;high_stim&quot;</span>, <span class="fu">nrow</span>(high.pca_scores)),</span>
<span id="cb520-82"><a href="ch52_timeseries.html#cb520-82" aria-hidden="true" tabindex="-1"></a>                                        <span class="fu">rep</span>(<span class="st">&quot;med_stim&quot;</span>, <span class="fu">nrow</span>(med.pca_scores)),</span>
<span id="cb520-83"><a href="ch52_timeseries.html#cb520-83" aria-hidden="true" tabindex="-1"></a>                                        <span class="fu">rep</span>(<span class="st">&quot;low_stim&quot;</span>, <span class="fu">nrow</span>(low.pca_scores)))</span>
<span id="cb520-84"><a href="ch52_timeseries.html#cb520-84" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb520-85"><a href="ch52_timeseries.html#cb520-85" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ------------------------------------------------------------------------------</span></span>
<span id="cb520-86"><a href="ch52_timeseries.html#cb520-86" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                             3d PCA plot</span></span>
<span id="cb520-87"><a href="ch52_timeseries.html#cb520-87" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ------------------------------------------------------------------------------</span></span>
<span id="cb520-88"><a href="ch52_timeseries.html#cb520-88" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_ly</span>(</span>
<span id="cb520-89"><a href="ch52_timeseries.html#cb520-89" aria-hidden="true" tabindex="-1"></a>    combined_pca_scores,</span>
<span id="cb520-90"><a href="ch52_timeseries.html#cb520-90" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="sc">~</span> PC1,</span>
<span id="cb520-91"><a href="ch52_timeseries.html#cb520-91" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="sc">~</span> PC2,</span>
<span id="cb520-92"><a href="ch52_timeseries.html#cb520-92" aria-hidden="true" tabindex="-1"></a>    <span class="at">z =</span> <span class="sc">~</span> PC3,</span>
<span id="cb520-93"><a href="ch52_timeseries.html#cb520-93" aria-hidden="true" tabindex="-1"></a>    <span class="at">type =</span> <span class="st">&quot;scatter3d&quot;</span>,</span>
<span id="cb520-94"><a href="ch52_timeseries.html#cb520-94" aria-hidden="true" tabindex="-1"></a>    <span class="at">mode =</span> <span class="st">&quot;markers&quot;</span>,</span>
<span id="cb520-95"><a href="ch52_timeseries.html#cb520-95" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="sc">~</span> stim_ordered</span>
<span id="cb520-96"><a href="ch52_timeseries.html#cb520-96" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb520-97"><a href="ch52_timeseries.html#cb520-97" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</details>
<pre><code>## [1] &quot;pain&quot;</code></pre>
<p><img src="52_iv-6cond_dv-firglasserSPM_ttl1_rois_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb522"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb522-1"><a href="ch52_timeseries.html#cb522-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_ly</span>(</span>
<span id="cb522-2"><a href="ch52_timeseries.html#cb522-2" aria-hidden="true" tabindex="-1"></a>  combined_pca_scores,</span>
<span id="cb522-3"><a href="ch52_timeseries.html#cb522-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="sc">~</span> PC1,</span>
<span id="cb522-4"><a href="ch52_timeseries.html#cb522-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="sc">~</span> PC2,</span>
<span id="cb522-5"><a href="ch52_timeseries.html#cb522-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">z =</span> <span class="sc">~</span> PC3,</span>
<span id="cb522-6"><a href="ch52_timeseries.html#cb522-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">&quot;scatter3d&quot;</span>,</span>
<span id="cb522-7"><a href="ch52_timeseries.html#cb522-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">mode =</span> <span class="st">&quot;markers&quot;</span>,</span>
<span id="cb522-8"><a href="ch52_timeseries.html#cb522-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">color =</span> <span class="sc">~</span> stim_ordered</span>
<span id="cb522-9"><a href="ch52_timeseries.html#cb522-9" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
</details>
<div class="plotly html-widget html-fill-item" id="htmlwidget-d3b518ea8a2314213a1b" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-d3b518ea8a2314213a1b">{"x":{"visdat":{"2b006f336e67":["function () ","plotlyVisDat"]},"cur_data":"2b006f336e67","attrs":{"2b006f336e67":{"x":{},"y":{},"z":{},"mode":"markers","color":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter3d"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"scene":{"xaxis":{"title":"PC1"},"yaxis":{"title":"PC2"},"zaxis":{"title":"PC3"}},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[-2.5490822884318294,-1.2248213055348995,-5.8458842657447869,-2.5003841075838684,-0.55085362736220711,2.2230724417057228,4.8678184761095906,6.6837420584025562,14.275803714919425,16.915973817148156,27.695843980435704,22.442763940798006,34.384953906597197,39.720592983220882,55.781228495191044,62.507149255664828,72.389659232029373,76.780835381245709,85.914211358286536,85.458629221249495,87.892340015903969,90.192370008461495,89.264824033514685,77.815659543618494,77.55763810389216,70.540017301264584,65.795147839591436,51.368692591764152,30.569878751404055,9.8113126972385807,-14.650090378348622,-31.636969838980932,-63.239747970558525,-79.975308854129324,-98.878624025053725,-114.94027409961703,-125.22648796393933,-137.31867231989514,-146.39921288575684,-147.66355950786374,-143.23225094880019,-143.01793476205688],"y":[-33.263024508666142,-38.367816501153797,-48.217054279942005,-49.080483011803736,-57.121997002001159,-56.745237659764165,-60.250411018061499,-59.985977297766716,-64.437323780153093,-55.752535501820702,-48.285399471000993,-54.858730473750363,-45.65338429989081,-43.688953396500935,-28.444166913996082,-29.369593341146288,-13.008851895054873,-6.4897144627792454,10.693746208553589,16.307427192226886,24.555477185549456,42.047638438297263,41.458389198795317,53.303354884485429,61.729320117855728,71.249503249670084,66.130624961889879,49.139211730952496,50.963619227824189,39.061931382351702,35.9040157236441,33.601394572984759,36.766637576916843,32.327942130947363,35.374455319129602,30.544859047435775,25.599475398277292,16.40241685204591,8.9484128217060785,11.354339769663538,2.1505348835652418,-2.5940730595160182],"z":[-19.966186837600119,-20.756157530945174,-26.0676326548822,-25.992103514923588,-23.745504697010205,-21.464943023786386,-21.270102937654809,-15.508890065498679,-13.446113560923992,-7.9875678296226882,3.2044002572436767,0.20799937005373886,13.5348873769239,20.372623400037568,26.874347146995124,32.889099660116649,33.347869463135162,36.109721054579836,35.381494258789964,26.360798691605179,18.714460130874297,19.584978245703304,14.386654169041654,9.9978129366810311,1.5329490864773982,-4.3627125345729798,-17.833272520997138,-33.780208071796068,-31.832711133682608,-34.756856282870146,-38.72836786574549,-35.60038702609635,-29.0410884998713,-18.627270598746865,-2.6595895476733817,1.6496275357414496,10.381190579246359,18.714676068717871,27.381958743283626,26.869750735354824,30.524468257920649,35.405899566376846],"mode":"markers","type":"scatter3d","name":"high_stim","marker":{"color":"rgba(102,194,165,1)","line":{"color":"rgba(102,194,165,1)"}},"textfont":{"color":"rgba(102,194,165,1)"},"error_y":{"color":"rgba(102,194,165,1)"},"error_x":{"color":"rgba(102,194,165,1)"},"line":{"color":"rgba(102,194,165,1)"},"frame":null},{"x":[-33.165907587007645,-33.078160472805834,-32.178934398683467,-31.967086819611819,-31.981421215893562,-26.07004499457922,-24.555919959572904,-15.422626882109757,-11.369549773542776,-1.5373212884195835,0.80260122370354681,5.1791084833491903,13.773141748943489,17.815233424509966,26.920705472121082,34.608651063842331,43.177958372253691,48.697347679220613,55.679042882428959,60.75067573141326,56.088698869990729,57.142872735405057,59.958362399150978,53.767537585927776,45.189092889759664,44.766468517728669,42.451766425190307,34.015461822492028,31.618231273672908,27.741366484203624,7.1203776031014172,-3.3765666324291694,-15.691785986405009,-31.795188786427094,-36.949978258523572,-55.369809144256479,-55.45704366525262,-61.206070092789673,-63.555398357438442,-67.165748361509216,-68.770553820543299,-66.59958619060815],"y":[-33.699768845449263,-37.538144175523648,-35.277132136734473,-36.857567811378608,-41.505823417539212,-36.994635455497011,-44.057611512370485,-42.15784751615751,-36.259199217599509,-39.26591558873838,-39.638180060701551,-42.407527147067832,-31.967736805998552,-34.89941003054367,-33.967987442298366,-36.651666914109583,-26.597041134281969,-18.630472658394904,-3.4399300324677382,3.0712647124330976,12.363866526201654,26.5564059927651,28.653990644582873,26.985550532021634,28.080587591283944,25.86459063412671,24.036930075161802,31.722283267251676,30.42801170255111,30.706074990805028,37.906587172292475,36.398154454963176,34.784148340785805,37.911818385076216,37.655603730074304,35.403264145894681,27.991448365892108,33.226938426101739,28.068641029977137,27.0272257784864,29.09615623553734,17.874055168586253],"z":[12.125799557068046,23.981211091369641,27.334931524826718,29.226255248601081,16.664274472797281,20.382910940394847,10.321060661100981,8.714723518497685,7.3023789524777802,-0.30274970689675296,-11.470407697623681,-6.6897494510882636,-20.389419043400007,-20.623091238986515,-22.074722377455686,-30.368440012044289,-21.045082561419544,-19.860662047110527,-16.157324471126341,-14.687318443287571,-5.1466483177862914,-6.4857346569491217,3.8214160961969159,9.9816341136969058,19.535860942340161,21.576134234889135,16.503350170684186,22.473363695752852,22.502526355425616,4.6737945563414884,8.0053553505042832,8.9413380003043557,0.71597526459013427,2.4139860337263039,-5.1508466178996946,-4.6930091538838363,-11.71413741476351,-16.889681692018833,-19.161111802742496,-23.774876020222464,-15.901748141736684,-4.6115199131442424],"mode":"markers","type":"scatter3d","name":"low_stim","marker":{"color":"rgba(252,141,98,1)","line":{"color":"rgba(252,141,98,1)"}},"textfont":{"color":"rgba(252,141,98,1)"},"error_y":{"color":"rgba(252,141,98,1)"},"error_x":{"color":"rgba(252,141,98,1)"},"line":{"color":"rgba(252,141,98,1)"},"frame":null},{"x":[-19.002327600916097,-19.339653881253184,-14.659147181720433,-19.170135399646814,-13.095598982618645,-15.89428802718357,-7.6752519282447427,-6.2795298738842904,-8.7496622897701979,2.3108507851310569,7.4085686921250309,18.470780669095653,27.591395878623487,40.675610926501115,53.987962041799818,60.181520655069725,66.788905827727561,80.480144451558814,78.475337686728949,83.040192529920375,83.822809432953662,78.953628556994005,68.605806918997999,71.839497182169808,69.653445323717548,59.145627103367644,59.266883605465189,58.064638332708213,38.990478684331435,22.451495315037654,-4.6566595074520443,-20.291657908269322,-48.859346135464087,-69.029209732215506,-93.831115064066282,-92.713092469360319,-100.58132809666479,-111.73236352029299,-119.76134601754715,-119.78881686818882,-116.15114816273726,-108.94390195252811],"y":[-43.879649225752644,-41.480836241356798,-49.13896875272026,-45.09473120950058,-50.172228639854815,-53.53041521755793,-47.344914213689712,-51.708594623260403,-53.363609039192895,-48.922228168207575,-42.39184477121092,-46.941801132702871,-41.710192372262391,-35.547219013461344,-29.465300283983186,-21.14830038935639,-8.2424380085419351,-7.2758092660073359,4.8350120671276899,10.996765883429717,18.684447580617856,26.107969648620294,25.472770067583255,37.5998145174865,38.426672687622343,45.433398876715707,49.302967307721794,43.509529783764137,49.985828375626042,48.733324363268117,48.284405539954335,42.935229692900187,40.245441833418774,35.668801911048924,33.950788614799599,28.016512571182734,25.959423332064187,21.960591252761503,17.993376864186779,8.7198043897484734,8.5645491376164404,5.9716542693544623],"z":[-18.035465678215211,-22.734844629337729,-16.682337664457069,-25.239698772182674,-23.590118362570237,-21.66219544835376,-14.8425032848803,-15.43054063940024,-12.515814779661039,-7.782696055165629,-3.6268197259213397,5.0603779521977561,13.927248269233568,23.279670455304899,23.117738993661028,23.435729450989985,23.480877057711648,26.747355476122578,23.869556362673116,17.035283029379539,21.970587280094023,26.649067922196259,12.816623980933416,9.2054680417368893,-9.5460040016575025,-16.467526088987917,-21.505388585038094,-21.776476970656148,-25.080255923050455,-24.476326728082235,-29.096296907533503,-21.678363802535905,-23.267391125397634,-15.419084159511121,-5.6562532924247293,-1.6869165971326827,17.630133559173,19.729865147572642,26.248072035253308,32.990239795316228,26.32744883066756,24.277975581935706],"mode":"markers","type":"scatter3d","name":"med_stim","marker":{"color":"rgba(141,160,203,1)","line":{"color":"rgba(141,160,203,1)"}},"textfont":{"color":"rgba(141,160,203,1)"},"error_y":{"color":"rgba(141,160,203,1)"},"error_x":{"color":"rgba(141,160,203,1)"},"line":{"color":"rgba(141,160,203,1)"},"frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
<div id="pca-groupwise-1" class="section level3 hasAnchor" number="16.2.2">
<h3><span class="header-section-number">16.2.2</span> PCA groupwise<a href="ch52_timeseries.html#pca-groupwise-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb523"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb523-1"><a href="ch52_timeseries.html#cb523-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ------------------------------------------------------------------------------</span></span>
<span id="cb523-2"><a href="ch52_timeseries.html#cb523-2" aria-hidden="true" tabindex="-1"></a><span class="co">#                       data formatting</span></span>
<span id="cb523-3"><a href="ch52_timeseries.html#cb523-3" aria-hidden="true" tabindex="-1"></a><span class="co"># ------------------------------------------------------------------------------</span></span>
<span id="cb523-4"><a href="ch52_timeseries.html#cb523-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb523-5"><a href="ch52_timeseries.html#cb523-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert the dataframe to wide format</span></span>
<span id="cb523-6"><a href="ch52_timeseries.html#cb523-6" aria-hidden="true" tabindex="-1"></a>df_wide.group <span class="ot">&lt;-</span> <span class="fu">pivot_wider</span>(</span>
<span id="cb523-7"><a href="ch52_timeseries.html#cb523-7" aria-hidden="true" tabindex="-1"></a>  subjectwise,</span>
<span id="cb523-8"><a href="ch52_timeseries.html#cb523-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">id_cols =</span> <span class="fu">c</span>(<span class="st">&quot;tr_ordered&quot;</span>, <span class="st">&quot;stim_ordered&quot;</span>),</span>
<span id="cb523-9"><a href="ch52_timeseries.html#cb523-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">names_from =</span> <span class="st">&quot;sub&quot;</span>,</span>
<span id="cb523-10"><a href="ch52_timeseries.html#cb523-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">values_from =</span> <span class="st">&quot;mean_per_sub&quot;</span></span>
<span id="cb523-11"><a href="ch52_timeseries.html#cb523-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb523-12"><a href="ch52_timeseries.html#cb523-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb523-13"><a href="ch52_timeseries.html#cb523-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Split the data into two subsets based on the &#39;stim_ordered&#39; value</span></span>
<span id="cb523-14"><a href="ch52_timeseries.html#cb523-14" aria-hidden="true" tabindex="-1"></a><span class="co"># One for &#39;stimH&#39; and another for &#39;stimL&#39;</span></span>
<span id="cb523-15"><a href="ch52_timeseries.html#cb523-15" aria-hidden="true" tabindex="-1"></a>stim_high.df <span class="ot">&lt;-</span> df_wide[df_wide<span class="sc">$</span>stim_ordered <span class="sc">==</span> <span class="st">&quot;stimH&quot;</span>,]</span>
<span id="cb523-16"><a href="ch52_timeseries.html#cb523-16" aria-hidden="true" tabindex="-1"></a>stim_low.df <span class="ot">&lt;-</span> df_wide[df_wide<span class="sc">$</span>stim_ordered <span class="sc">==</span> <span class="st">&quot;stimL&quot;</span>,]</span>
<span id="cb523-17"><a href="ch52_timeseries.html#cb523-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb523-18"><a href="ch52_timeseries.html#cb523-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Prepare data for PCA analysis by selecting relevant columns</span></span>
<span id="cb523-19"><a href="ch52_timeseries.html#cb523-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Exclude the first two columns and the last column</span></span>
<span id="cb523-20"><a href="ch52_timeseries.html#cb523-20" aria-hidden="true" tabindex="-1"></a>meanhighdf <span class="ot">&lt;-</span></span>
<span id="cb523-21"><a href="ch52_timeseries.html#cb523-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(<span class="fu">subset</span>(stim_high.df, <span class="at">select =</span> <span class="dv">3</span><span class="sc">:</span>(<span class="fu">ncol</span>(stim_high.df) <span class="sc">-</span> <span class="dv">1</span>)))</span>
<span id="cb523-22"><a href="ch52_timeseries.html#cb523-22" aria-hidden="true" tabindex="-1"></a>meanlowdf <span class="ot">&lt;-</span></span>
<span id="cb523-23"><a href="ch52_timeseries.html#cb523-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(<span class="fu">subset</span>(stim_low.df, <span class="at">select =</span> <span class="dv">3</span><span class="sc">:</span>(<span class="fu">ncol</span>(stim_low.df) <span class="sc">-</span> <span class="dv">1</span>)))</span>
<span id="cb523-24"><a href="ch52_timeseries.html#cb523-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb523-25"><a href="ch52_timeseries.html#cb523-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb523-26"><a href="ch52_timeseries.html#cb523-26" aria-hidden="true" tabindex="-1"></a><span class="co"># ------------------------------------------------------------------------------</span></span>
<span id="cb523-27"><a href="ch52_timeseries.html#cb523-27" aria-hidden="true" tabindex="-1"></a><span class="co">#                      Principal Component Analysis (PCA)</span></span>
<span id="cb523-28"><a href="ch52_timeseries.html#cb523-28" aria-hidden="true" tabindex="-1"></a><span class="co"># ------------------------------------------------------------------------------</span></span>
<span id="cb523-29"><a href="ch52_timeseries.html#cb523-29" aria-hidden="true" tabindex="-1"></a>high.pca <span class="ot">&lt;-</span> <span class="fu">prcomp</span>(meanhighdf) <span class="co"># Perform Principal Component Analysis (PCA)</span></span>
<span id="cb523-30"><a href="ch52_timeseries.html#cb523-30" aria-hidden="true" tabindex="-1"></a>high.pca_scores <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(high.pca<span class="sc">$</span>x) <span class="co"># Extract PCA scores</span></span>
<span id="cb523-31"><a href="ch52_timeseries.html#cb523-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb523-32"><a href="ch52_timeseries.html#cb523-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Repeat the process for the low stimulus data</span></span>
<span id="cb523-33"><a href="ch52_timeseries.html#cb523-33" aria-hidden="true" tabindex="-1"></a>low.pca <span class="ot">&lt;-</span> <span class="fu">prcomp</span>(meanlowdf)</span>
<span id="cb523-34"><a href="ch52_timeseries.html#cb523-34" aria-hidden="true" tabindex="-1"></a>low.pca_scores <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(low.pca<span class="sc">$</span>x)</span>
<span id="cb523-35"><a href="ch52_timeseries.html#cb523-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb523-36"><a href="ch52_timeseries.html#cb523-36" aria-hidden="true" tabindex="-1"></a>combined_pca_scores <span class="ot">&lt;-</span> <span class="fu">rbind</span>(high.pca_scores, low.pca_scores)</span>
<span id="cb523-37"><a href="ch52_timeseries.html#cb523-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb523-38"><a href="ch52_timeseries.html#cb523-38" aria-hidden="true" tabindex="-1"></a><span class="co"># Add a new column to indicate the &#39;stim_ordered&#39; category (high_stim or low_stim)</span></span>
<span id="cb523-39"><a href="ch52_timeseries.html#cb523-39" aria-hidden="true" tabindex="-1"></a><span class="co"># This helps in distinguishing the groups in the plot</span></span>
<span id="cb523-40"><a href="ch52_timeseries.html#cb523-40" aria-hidden="true" tabindex="-1"></a>combined_pca_scores<span class="sc">$</span>stim_ordered <span class="ot">&lt;-</span></span>
<span id="cb523-41"><a href="ch52_timeseries.html#cb523-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">&quot;high_stim&quot;</span>, <span class="fu">nrow</span>(high.pca_scores)), <span class="fu">rep</span>(<span class="st">&quot;low_stim&quot;</span>, <span class="fu">nrow</span>(low.pca_scores)))</span>
<span id="cb523-42"><a href="ch52_timeseries.html#cb523-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb523-43"><a href="ch52_timeseries.html#cb523-43" aria-hidden="true" tabindex="-1"></a><span class="co"># ------------------------------------------------------------------------------</span></span>
<span id="cb523-44"><a href="ch52_timeseries.html#cb523-44" aria-hidden="true" tabindex="-1"></a><span class="co">#                      plot 3D scatter plot of the PCA scores</span></span>
<span id="cb523-45"><a href="ch52_timeseries.html#cb523-45" aria-hidden="true" tabindex="-1"></a><span class="co"># ------------------------------------------------------------------------------</span></span>
<span id="cb523-46"><a href="ch52_timeseries.html#cb523-46" aria-hidden="true" tabindex="-1"></a><span class="co"># The points are colored based on their stim_ordered category</span></span>
<span id="cb523-47"><a href="ch52_timeseries.html#cb523-47" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_ly</span>(</span>
<span id="cb523-48"><a href="ch52_timeseries.html#cb523-48" aria-hidden="true" tabindex="-1"></a>  combined_pca_scores,</span>
<span id="cb523-49"><a href="ch52_timeseries.html#cb523-49" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="sc">~</span> PC1,</span>
<span id="cb523-50"><a href="ch52_timeseries.html#cb523-50" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="sc">~</span> PC2,</span>
<span id="cb523-51"><a href="ch52_timeseries.html#cb523-51" aria-hidden="true" tabindex="-1"></a>  <span class="at">z =</span> <span class="sc">~</span> PC3,</span>
<span id="cb523-52"><a href="ch52_timeseries.html#cb523-52" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">&quot;scatter3d&quot;</span>,</span>
<span id="cb523-53"><a href="ch52_timeseries.html#cb523-53" aria-hidden="true" tabindex="-1"></a>  <span class="at">mode =</span> <span class="st">&quot;markers&quot;</span>,</span>
<span id="cb523-54"><a href="ch52_timeseries.html#cb523-54" aria-hidden="true" tabindex="-1"></a>  <span class="at">color =</span> <span class="sc">~</span> stim_ordered</span>
<span id="cb523-55"><a href="ch52_timeseries.html#cb523-55" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
</details>
<pre><code>## Warning in RColorBrewer::brewer.pal(N, &quot;Set2&quot;): minimal value for n is 3, returning requested palette with 3 different levels

## Warning in RColorBrewer::brewer.pal(N, &quot;Set2&quot;): minimal value for n is 3, returning requested palette with 3 different levels</code></pre>
<div class="plotly html-widget html-fill-item" id="htmlwidget-4d3fc907100078e57158" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-4d3fc907100078e57158">{"x":{"visdat":{"2b001f28cff5":["function () ","plotlyVisDat"]},"cur_data":"2b001f28cff5","attrs":{"2b001f28cff5":{"x":{},"y":{},"z":{},"mode":"markers","color":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter3d"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"scene":{"xaxis":{"title":"PC1"},"yaxis":{"title":"PC2"},"zaxis":{"title":"PC3"}},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[-2.5490822884318294,-1.2248213055348995,-5.8458842657447869,-2.5003841075838684,-0.55085362736220711,2.2230724417057228,4.8678184761095906,6.6837420584025562,14.275803714919425,16.915973817148156,27.695843980435704,22.442763940798006,34.384953906597197,39.720592983220882,55.781228495191044,62.507149255664828,72.389659232029373,76.780835381245709,85.914211358286536,85.458629221249495,87.892340015903969,90.192370008461495,89.264824033514685,77.815659543618494,77.55763810389216,70.540017301264584,65.795147839591436,51.368692591764152,30.569878751404055,9.8113126972385807,-14.650090378348622,-31.636969838980932,-63.239747970558525,-79.975308854129324,-98.878624025053725,-114.94027409961703,-125.22648796393933,-137.31867231989514,-146.39921288575684,-147.66355950786374,-143.23225094880019,-143.01793476205688],"y":[-33.263024508666142,-38.367816501153797,-48.217054279942005,-49.080483011803736,-57.121997002001159,-56.745237659764165,-60.250411018061499,-59.985977297766716,-64.437323780153093,-55.752535501820702,-48.285399471000993,-54.858730473750363,-45.65338429989081,-43.688953396500935,-28.444166913996082,-29.369593341146288,-13.008851895054873,-6.4897144627792454,10.693746208553589,16.307427192226886,24.555477185549456,42.047638438297263,41.458389198795317,53.303354884485429,61.729320117855728,71.249503249670084,66.130624961889879,49.139211730952496,50.963619227824189,39.061931382351702,35.9040157236441,33.601394572984759,36.766637576916843,32.327942130947363,35.374455319129602,30.544859047435775,25.599475398277292,16.40241685204591,8.9484128217060785,11.354339769663538,2.1505348835652418,-2.5940730595160182],"z":[-19.966186837600119,-20.756157530945174,-26.0676326548822,-25.992103514923588,-23.745504697010205,-21.464943023786386,-21.270102937654809,-15.508890065498679,-13.446113560923992,-7.9875678296226882,3.2044002572436767,0.20799937005373886,13.5348873769239,20.372623400037568,26.874347146995124,32.889099660116649,33.347869463135162,36.109721054579836,35.381494258789964,26.360798691605179,18.714460130874297,19.584978245703304,14.386654169041654,9.9978129366810311,1.5329490864773982,-4.3627125345729798,-17.833272520997138,-33.780208071796068,-31.832711133682608,-34.756856282870146,-38.72836786574549,-35.60038702609635,-29.0410884998713,-18.627270598746865,-2.6595895476733817,1.6496275357414496,10.381190579246359,18.714676068717871,27.381958743283626,26.869750735354824,30.524468257920649,35.405899566376846],"mode":"markers","type":"scatter3d","name":"high_stim","marker":{"color":"rgba(102,194,165,1)","line":{"color":"rgba(102,194,165,1)"}},"textfont":{"color":"rgba(102,194,165,1)"},"error_y":{"color":"rgba(102,194,165,1)"},"error_x":{"color":"rgba(102,194,165,1)"},"line":{"color":"rgba(102,194,165,1)"},"frame":null},{"x":[-33.165907587007645,-33.078160472805834,-32.178934398683467,-31.967086819611819,-31.981421215893562,-26.07004499457922,-24.555919959572904,-15.422626882109757,-11.369549773542776,-1.5373212884195835,0.80260122370354681,5.1791084833491903,13.773141748943489,17.815233424509966,26.920705472121082,34.608651063842331,43.177958372253691,48.697347679220613,55.679042882428959,60.75067573141326,56.088698869990729,57.142872735405057,59.958362399150978,53.767537585927776,45.189092889759664,44.766468517728669,42.451766425190307,34.015461822492028,31.618231273672908,27.741366484203624,7.1203776031014172,-3.3765666324291694,-15.691785986405009,-31.795188786427094,-36.949978258523572,-55.369809144256479,-55.45704366525262,-61.206070092789673,-63.555398357438442,-67.165748361509216,-68.770553820543299,-66.59958619060815],"y":[-33.699768845449263,-37.538144175523648,-35.277132136734473,-36.857567811378608,-41.505823417539212,-36.994635455497011,-44.057611512370485,-42.15784751615751,-36.259199217599509,-39.26591558873838,-39.638180060701551,-42.407527147067832,-31.967736805998552,-34.89941003054367,-33.967987442298366,-36.651666914109583,-26.597041134281969,-18.630472658394904,-3.4399300324677382,3.0712647124330976,12.363866526201654,26.5564059927651,28.653990644582873,26.985550532021634,28.080587591283944,25.86459063412671,24.036930075161802,31.722283267251676,30.42801170255111,30.706074990805028,37.906587172292475,36.398154454963176,34.784148340785805,37.911818385076216,37.655603730074304,35.403264145894681,27.991448365892108,33.226938426101739,28.068641029977137,27.0272257784864,29.09615623553734,17.874055168586253],"z":[12.125799557068046,23.981211091369641,27.334931524826718,29.226255248601081,16.664274472797281,20.382910940394847,10.321060661100981,8.714723518497685,7.3023789524777802,-0.30274970689675296,-11.470407697623681,-6.6897494510882636,-20.389419043400007,-20.623091238986515,-22.074722377455686,-30.368440012044289,-21.045082561419544,-19.860662047110527,-16.157324471126341,-14.687318443287571,-5.1466483177862914,-6.4857346569491217,3.8214160961969159,9.9816341136969058,19.535860942340161,21.576134234889135,16.503350170684186,22.473363695752852,22.502526355425616,4.6737945563414884,8.0053553505042832,8.9413380003043557,0.71597526459013427,2.4139860337263039,-5.1508466178996946,-4.6930091538838363,-11.71413741476351,-16.889681692018833,-19.161111802742496,-23.774876020222464,-15.901748141736684,-4.6115199131442424],"mode":"markers","type":"scatter3d","name":"low_stim","marker":{"color":"rgba(141,160,203,1)","line":{"color":"rgba(141,160,203,1)"}},"textfont":{"color":"rgba(141,160,203,1)"},"error_y":{"color":"rgba(141,160,203,1)"},"error_x":{"color":"rgba(141,160,203,1)"},"line":{"color":"rgba(141,160,203,1)"},"frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb525"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb525-1"><a href="ch52_timeseries.html#cb525-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ------------------------------------------------------------------------------</span></span>
<span id="cb525-2"><a href="ch52_timeseries.html#cb525-2" aria-hidden="true" tabindex="-1"></a><span class="co">#                      plot 2D group plot</span></span>
<span id="cb525-3"><a href="ch52_timeseries.html#cb525-3" aria-hidden="true" tabindex="-1"></a><span class="co"># ------------------------------------------------------------------------------</span></span>
<span id="cb525-4"><a href="ch52_timeseries.html#cb525-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a 2D plot with smoothed lines for each stim_ordered group</span></span>
<span id="cb525-5"><a href="ch52_timeseries.html#cb525-5" aria-hidden="true" tabindex="-1"></a>combined_pca <span class="ot">&lt;-</span> combined_pca_scores <span class="sc">%&gt;%</span></span>
<span id="cb525-6"><a href="ch52_timeseries.html#cb525-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(stim_ordered) <span class="sc">%&gt;%</span></span>
<span id="cb525-7"><a href="ch52_timeseries.html#cb525-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">group_index =</span> <span class="fu">row_number</span>())</span>
<span id="cb525-8"><a href="ch52_timeseries.html#cb525-8" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(combined_pca,</span>
<span id="cb525-9"><a href="ch52_timeseries.html#cb525-9" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(</span>
<span id="cb525-10"><a href="ch52_timeseries.html#cb525-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">x =</span> group_index,</span>
<span id="cb525-11"><a href="ch52_timeseries.html#cb525-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> PC1,</span>
<span id="cb525-12"><a href="ch52_timeseries.html#cb525-12" aria-hidden="true" tabindex="-1"></a>         <span class="at">group =</span> stim_ordered,</span>
<span id="cb525-13"><a href="ch52_timeseries.html#cb525-13" aria-hidden="true" tabindex="-1"></a>         <span class="at">colour =</span> stim_ordered</span>
<span id="cb525-14"><a href="ch52_timeseries.html#cb525-14" aria-hidden="true" tabindex="-1"></a>       )) <span class="sc">+</span></span>
<span id="cb525-15"><a href="ch52_timeseries.html#cb525-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_smooth</span>(</span>
<span id="cb525-16"><a href="ch52_timeseries.html#cb525-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">method =</span> <span class="st">&quot;loess&quot;</span>,</span>
<span id="cb525-17"><a href="ch52_timeseries.html#cb525-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">span =</span> <span class="fl">0.25</span>,</span>
<span id="cb525-18"><a href="ch52_timeseries.html#cb525-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">se =</span> <span class="cn">TRUE</span>,</span>
<span id="cb525-19"><a href="ch52_timeseries.html#cb525-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">color =</span> stim_ordered),</span>
<span id="cb525-20"><a href="ch52_timeseries.html#cb525-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.3</span></span>
<span id="cb525-21"><a href="ch52_timeseries.html#cb525-21" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb525-22"><a href="ch52_timeseries.html#cb525-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
</details>
<pre><code>## `geom_smooth()` using formula = &#39;y ~ x&#39;</code></pre>
<p><img src="52_iv-6cond_dv-firglasserSPM_ttl1_rois_files/figure-html/unnamed-chunk-8-2.png" width="672" /></p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb527"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb527-1"><a href="ch52_timeseries.html#cb527-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the plot</span></span>
<span id="cb527-2"><a href="ch52_timeseries.html#cb527-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb527-3"><a href="ch52_timeseries.html#cb527-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(</span>
<span id="cb527-4"><a href="ch52_timeseries.html#cb527-4" aria-hidden="true" tabindex="-1"></a>  groupwise,</span>
<span id="cb527-5"><a href="ch52_timeseries.html#cb527-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(</span>
<span id="cb527-6"><a href="ch52_timeseries.html#cb527-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> tr_ordered,</span>
<span id="cb527-7"><a href="ch52_timeseries.html#cb527-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> mean_per_sub_mean,</span>
<span id="cb527-8"><a href="ch52_timeseries.html#cb527-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">group =</span> stim_ordered,</span>
<span id="cb527-9"><a href="ch52_timeseries.html#cb527-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">colour =</span> stim_ordered</span>
<span id="cb527-10"><a href="ch52_timeseries.html#cb527-10" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb527-11"><a href="ch52_timeseries.html#cb527-11" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb527-12"><a href="ch52_timeseries.html#cb527-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_smooth</span>(</span>
<span id="cb527-13"><a href="ch52_timeseries.html#cb527-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">method =</span> <span class="st">&quot;loess&quot;</span>,</span>
<span id="cb527-14"><a href="ch52_timeseries.html#cb527-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">span =</span> <span class="fl">0.25</span>,</span>
<span id="cb527-15"><a href="ch52_timeseries.html#cb527-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">se =</span> <span class="cn">TRUE</span>,</span>
<span id="cb527-16"><a href="ch52_timeseries.html#cb527-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">color =</span> stim_ordered),</span>
<span id="cb527-17"><a href="ch52_timeseries.html#cb527-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.3</span></span>
<span id="cb527-18"><a href="ch52_timeseries.html#cb527-18" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb527-19"><a href="ch52_timeseries.html#cb527-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
</details>
<pre><code>## `geom_smooth()` using formula = &#39;y ~ x&#39;</code></pre>
<p><img src="52_iv-6cond_dv-firglasserSPM_ttl1_rois_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb529"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb529-1"><a href="ch52_timeseries.html#cb529-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the plot</span></span>
<span id="cb529-2"><a href="ch52_timeseries.html#cb529-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the plot with custom span and smoothing method</span></span>
<span id="cb529-3"><a href="ch52_timeseries.html#cb529-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(groupwise, <span class="fu">aes</span>(<span class="at">x =</span> tr_ordered, <span class="at">y =</span> mean_per_sub_mean)) <span class="sc">+</span></span>
<span id="cb529-4"><a href="ch52_timeseries.html#cb529-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> <span class="co"># Plot the smooth line for the mean</span></span>
<span id="cb529-5"><a href="ch52_timeseries.html#cb529-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> mean_per_sub_mean <span class="sc">-</span> se, <span class="at">ymax =</span> mean_per_sub_mean <span class="sc">+</span> se),</span>
<span id="cb529-6"><a href="ch52_timeseries.html#cb529-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span> <span class="co"># Add the ribbon for standard error</span></span>
<span id="cb529-7"><a href="ch52_timeseries.html#cb529-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;loess&quot;</span>, <span class="at">span =</span> <span class="fl">0.1</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span> <span class="co"># Add the loess smoothing curve</span></span>
<span id="cb529-8"><a href="ch52_timeseries.html#cb529-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;X-axis Label&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Y-axis Label&quot;</span>, <span class="at">title =</span> <span class="st">&quot;Smooth Line with Standard Error Ribbon&quot;</span>) <span class="sc">+</span></span>
<span id="cb529-9"><a href="ch52_timeseries.html#cb529-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
</details>
<pre><code>## `geom_smooth()` using formula = &#39;y ~ x&#39;</code></pre>
<p><img src="52_iv-6cond_dv-firglasserSPM_ttl1_rois_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
</div>
</div>
<div id="taskwise-cue-effect-1" class="section level2 hasAnchor" number="16.3">
<h2><span class="header-section-number">16.3</span> taskwise cue effect<a href="ch52_timeseries.html#taskwise-cue-effect-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb531"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb531-1"><a href="ch52_timeseries.html#cb531-1" aria-hidden="true" tabindex="-1"></a>roi_list <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;dACC&quot;</span>, <span class="st">&quot;PHG&quot;</span>, <span class="st">&quot;V1&quot;</span>, <span class="st">&quot;SM&quot;</span>, <span class="st">&quot;MT&quot;</span>, <span class="st">&quot;RSC&quot;</span>, <span class="st">&quot;LOC&quot;</span>, <span class="st">&quot;FFC&quot;</span>, <span class="st">&quot;PIT&quot;</span>, <span class="st">&quot;pSTS&quot;</span>, <span class="st">&quot;AIP&quot;</span>, <span class="st">&quot;premotor&quot;</span>) <span class="co"># &#39;rINS&#39;, &#39;TPJ&#39;,</span></span>
<span id="cb531-2"><a href="ch52_timeseries.html#cb531-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (ROI <span class="cf">in</span> roi_list) {</span>
<span id="cb531-3"><a href="ch52_timeseries.html#cb531-3" aria-hidden="true" tabindex="-1"></a>  datadir <span class="ot">&lt;-</span> <span class="fu">file.path</span>(main_dir, <span class="st">&quot;analysis/fmri/spm/fir/ttl2par&quot;</span>)</span>
<span id="cb531-4"><a href="ch52_timeseries.html#cb531-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># taskname = &#39;pain&#39;</span></span>
<span id="cb531-5"><a href="ch52_timeseries.html#cb531-5" aria-hidden="true" tabindex="-1"></a>  exclude <span class="ot">&lt;-</span> <span class="st">&quot;sub-0001&quot;</span></span>
<span id="cb531-6"><a href="ch52_timeseries.html#cb531-6" aria-hidden="true" tabindex="-1"></a>  filename <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;sub-*&quot;</span>, <span class="st">&quot;*roi-&quot;</span>, ROI, <span class="st">&quot;_tr-42.csv&quot;</span>)</span>
<span id="cb531-7"><a href="ch52_timeseries.html#cb531-7" aria-hidden="true" tabindex="-1"></a>  common_path <span class="ot">&lt;-</span> <span class="fu">Sys.glob</span>(<span class="fu">file.path</span>(datadir, <span class="st">&quot;sub-*&quot;</span>, filename))</span>
<span id="cb531-8"><a href="ch52_timeseries.html#cb531-8" aria-hidden="true" tabindex="-1"></a>  filter_path <span class="ot">&lt;-</span></span>
<span id="cb531-9"><a href="ch52_timeseries.html#cb531-9" aria-hidden="true" tabindex="-1"></a>    common_path[<span class="sc">!</span><span class="fu">str_detect</span>(common_path, <span class="at">pattern =</span> exclude)]</span>
<span id="cb531-10"><a href="ch52_timeseries.html#cb531-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb531-11"><a href="ch52_timeseries.html#cb531-11" aria-hidden="true" tabindex="-1"></a>  df <span class="ot">&lt;-</span></span>
<span id="cb531-12"><a href="ch52_timeseries.html#cb531-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">do.call</span>(<span class="st">&quot;rbind.fill&quot;</span>, <span class="fu">lapply</span>(</span>
<span id="cb531-13"><a href="ch52_timeseries.html#cb531-13" aria-hidden="true" tabindex="-1"></a>      filter_path,</span>
<span id="cb531-14"><a href="ch52_timeseries.html#cb531-14" aria-hidden="true" tabindex="-1"></a>      <span class="at">FUN =</span> <span class="cf">function</span>(files) {</span>
<span id="cb531-15"><a href="ch52_timeseries.html#cb531-15" aria-hidden="true" tabindex="-1"></a>        <span class="fu">read.table</span>(files, <span class="at">header =</span> <span class="cn">TRUE</span>, <span class="at">sep =</span> <span class="st">&quot;,&quot;</span>)</span>
<span id="cb531-16"><a href="ch52_timeseries.html#cb531-16" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb531-17"><a href="ch52_timeseries.html#cb531-17" aria-hidden="true" tabindex="-1"></a>    ))</span>
<span id="cb531-18"><a href="ch52_timeseries.html#cb531-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb531-19"><a href="ch52_timeseries.html#cb531-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb531-20"><a href="ch52_timeseries.html#cb531-20" aria-hidden="true" tabindex="-1"></a>  run_types <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;pain&quot;</span>, <span class="st">&quot;vicarious&quot;</span>, <span class="st">&quot;cognitive&quot;</span>)</span>
<span id="cb531-21"><a href="ch52_timeseries.html#cb531-21" aria-hidden="true" tabindex="-1"></a>  plot_list <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb531-22"><a href="ch52_timeseries.html#cb531-22" aria-hidden="true" tabindex="-1"></a>  TR_length <span class="ot">&lt;-</span> <span class="dv">42</span></span>
<span id="cb531-23"><a href="ch52_timeseries.html#cb531-23" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (run_type <span class="cf">in</span> run_types) {</span>
<span id="cb531-24"><a href="ch52_timeseries.html#cb531-24" aria-hidden="true" tabindex="-1"></a>    filtered_df <span class="ot">&lt;-</span></span>
<span id="cb531-25"><a href="ch52_timeseries.html#cb531-25" aria-hidden="true" tabindex="-1"></a>      df[<span class="sc">!</span>(df<span class="sc">$</span>condition <span class="sc">==</span> <span class="st">&quot;rating&quot;</span> <span class="sc">|</span></span>
<span id="cb531-26"><a href="ch52_timeseries.html#cb531-26" aria-hidden="true" tabindex="-1"></a>             df<span class="sc">$</span>condition <span class="sc">==</span> <span class="st">&quot;cue&quot;</span> <span class="sc">|</span> df<span class="sc">$</span>runtype <span class="sc">!=</span> run_type),]</span>
<span id="cb531-27"><a href="ch52_timeseries.html#cb531-27" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb531-28"><a href="ch52_timeseries.html#cb531-28" aria-hidden="true" tabindex="-1"></a>    parsed_df <span class="ot">&lt;-</span> filtered_df <span class="sc">%&gt;%</span></span>
<span id="cb531-29"><a href="ch52_timeseries.html#cb531-29" aria-hidden="true" tabindex="-1"></a>      <span class="fu">separate</span>(</span>
<span id="cb531-30"><a href="ch52_timeseries.html#cb531-30" aria-hidden="true" tabindex="-1"></a>        condition,</span>
<span id="cb531-31"><a href="ch52_timeseries.html#cb531-31" aria-hidden="true" tabindex="-1"></a>        <span class="at">into =</span> <span class="fu">c</span>(<span class="st">&quot;cue&quot;</span>, <span class="st">&quot;stim&quot;</span>),</span>
<span id="cb531-32"><a href="ch52_timeseries.html#cb531-32" aria-hidden="true" tabindex="-1"></a>        <span class="at">sep =</span> <span class="st">&quot;_&quot;</span>,</span>
<span id="cb531-33"><a href="ch52_timeseries.html#cb531-33" aria-hidden="true" tabindex="-1"></a>        <span class="at">remove =</span> <span class="cn">FALSE</span></span>
<span id="cb531-34"><a href="ch52_timeseries.html#cb531-34" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb531-35"><a href="ch52_timeseries.html#cb531-35" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb531-36"><a href="ch52_timeseries.html#cb531-36" aria-hidden="true" tabindex="-1"></a>    <span class="co"># --------------------------------------------------------------------------</span></span>
<span id="cb531-37"><a href="ch52_timeseries.html#cb531-37" aria-hidden="true" tabindex="-1"></a>    <span class="co">#                        subset regions based on ROI</span></span>
<span id="cb531-38"><a href="ch52_timeseries.html#cb531-38" aria-hidden="true" tabindex="-1"></a>    <span class="co"># --------------------------------------------------------------------------</span></span>
<span id="cb531-39"><a href="ch52_timeseries.html#cb531-39" aria-hidden="true" tabindex="-1"></a>    df_long <span class="ot">&lt;-</span></span>
<span id="cb531-40"><a href="ch52_timeseries.html#cb531-40" aria-hidden="true" tabindex="-1"></a>      <span class="fu">pivot_longer</span>(</span>
<span id="cb531-41"><a href="ch52_timeseries.html#cb531-41" aria-hidden="true" tabindex="-1"></a>        parsed_df,</span>
<span id="cb531-42"><a href="ch52_timeseries.html#cb531-42" aria-hidden="true" tabindex="-1"></a>        <span class="at">cols =</span> <span class="fu">starts_with</span>(<span class="st">&quot;tr&quot;</span>),</span>
<span id="cb531-43"><a href="ch52_timeseries.html#cb531-43" aria-hidden="true" tabindex="-1"></a>        <span class="at">names_to =</span> <span class="st">&quot;tr_num&quot;</span>,</span>
<span id="cb531-44"><a href="ch52_timeseries.html#cb531-44" aria-hidden="true" tabindex="-1"></a>        <span class="at">values_to =</span> <span class="st">&quot;tr_value&quot;</span></span>
<span id="cb531-45"><a href="ch52_timeseries.html#cb531-45" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb531-46"><a href="ch52_timeseries.html#cb531-46" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb531-47"><a href="ch52_timeseries.html#cb531-47" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb531-48"><a href="ch52_timeseries.html#cb531-48" aria-hidden="true" tabindex="-1"></a>    <span class="co"># --------------------------------------------------------------------------</span></span>
<span id="cb531-49"><a href="ch52_timeseries.html#cb531-49" aria-hidden="true" tabindex="-1"></a>    <span class="co">#                             clean factor</span></span>
<span id="cb531-50"><a href="ch52_timeseries.html#cb531-50" aria-hidden="true" tabindex="-1"></a>    <span class="co"># --------------------------------------------------------------------------</span></span>
<span id="cb531-51"><a href="ch52_timeseries.html#cb531-51" aria-hidden="true" tabindex="-1"></a>    df_long<span class="sc">$</span>tr_ordered <span class="ot">&lt;-</span> <span class="fu">factor</span>(df_long<span class="sc">$</span>tr_num,</span>
<span id="cb531-52"><a href="ch52_timeseries.html#cb531-52" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">levels =</span> <span class="fu">c</span>(<span class="fu">paste0</span>(<span class="st">&quot;tr&quot;</span>, <span class="dv">1</span><span class="sc">:</span>TR_length)))</span>
<span id="cb531-53"><a href="ch52_timeseries.html#cb531-53" aria-hidden="true" tabindex="-1"></a>    df_long<span class="sc">$</span>cue_ordered <span class="ot">&lt;-</span> <span class="fu">factor</span>(df_long<span class="sc">$</span>cue,</span>
<span id="cb531-54"><a href="ch52_timeseries.html#cb531-54" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;cueH&quot;</span>, <span class="st">&quot;cueL&quot;</span>))</span>
<span id="cb531-55"><a href="ch52_timeseries.html#cb531-55" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb531-56"><a href="ch52_timeseries.html#cb531-56" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb531-57"><a href="ch52_timeseries.html#cb531-57" aria-hidden="true" tabindex="-1"></a>    <span class="co"># --------------------------------------------------------------------------</span></span>
<span id="cb531-58"><a href="ch52_timeseries.html#cb531-58" aria-hidden="true" tabindex="-1"></a>    <span class="co">#                             summary statistics </span></span>
<span id="cb531-59"><a href="ch52_timeseries.html#cb531-59" aria-hidden="true" tabindex="-1"></a>    <span class="co"># --------------------------------------------------------------------------    </span></span>
<span id="cb531-60"><a href="ch52_timeseries.html#cb531-60" aria-hidden="true" tabindex="-1"></a>    subjectwise <span class="ot">&lt;-</span> <span class="fu">meanSummary</span>(df_long,</span>
<span id="cb531-61"><a href="ch52_timeseries.html#cb531-61" aria-hidden="true" tabindex="-1"></a>                               <span class="fu">c</span>(<span class="st">&quot;sub&quot;</span>, <span class="st">&quot;tr_ordered&quot;</span>, <span class="st">&quot;cue_ordered&quot;</span>), <span class="st">&quot;tr_value&quot;</span>)</span>
<span id="cb531-62"><a href="ch52_timeseries.html#cb531-62" aria-hidden="true" tabindex="-1"></a>    groupwise <span class="ot">&lt;-</span> <span class="fu">summarySEwithin</span>(</span>
<span id="cb531-63"><a href="ch52_timeseries.html#cb531-63" aria-hidden="true" tabindex="-1"></a>      <span class="at">data =</span> subjectwise,</span>
<span id="cb531-64"><a href="ch52_timeseries.html#cb531-64" aria-hidden="true" tabindex="-1"></a>      <span class="at">measurevar =</span> <span class="st">&quot;mean_per_sub&quot;</span>,</span>
<span id="cb531-65"><a href="ch52_timeseries.html#cb531-65" aria-hidden="true" tabindex="-1"></a>      <span class="at">withinvars =</span> <span class="fu">c</span>(<span class="st">&quot;cue_ordered&quot;</span>, <span class="st">&quot;tr_ordered&quot;</span>),</span>
<span id="cb531-66"><a href="ch52_timeseries.html#cb531-66" aria-hidden="true" tabindex="-1"></a>      <span class="at">idvar =</span> <span class="st">&quot;sub&quot;</span></span>
<span id="cb531-67"><a href="ch52_timeseries.html#cb531-67" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb531-68"><a href="ch52_timeseries.html#cb531-68" aria-hidden="true" tabindex="-1"></a>    groupwise<span class="sc">$</span>task <span class="ot">&lt;-</span> run_type</span>
<span id="cb531-69"><a href="ch52_timeseries.html#cb531-69" aria-hidden="true" tabindex="-1"></a>    <span class="co"># https://stackoverflow.com/questions/29402528/append-data-frames-together-in-a-for-loop/29419402</span></span>
<span id="cb531-70"><a href="ch52_timeseries.html#cb531-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb531-71"><a href="ch52_timeseries.html#cb531-71" aria-hidden="true" tabindex="-1"></a>    LINEIV1 <span class="ot">&lt;-</span> <span class="st">&quot;tr_ordered&quot;</span></span>
<span id="cb531-72"><a href="ch52_timeseries.html#cb531-72" aria-hidden="true" tabindex="-1"></a>    LINEIV2 <span class="ot">&lt;-</span> <span class="st">&quot;cue_ordered&quot;</span></span>
<span id="cb531-73"><a href="ch52_timeseries.html#cb531-73" aria-hidden="true" tabindex="-1"></a>    MEAN <span class="ot">&lt;-</span> <span class="st">&quot;mean_per_sub_norm_mean&quot;</span></span>
<span id="cb531-74"><a href="ch52_timeseries.html#cb531-74" aria-hidden="true" tabindex="-1"></a>    ERROR <span class="ot">&lt;-</span> <span class="st">&quot;se&quot;</span></span>
<span id="cb531-75"><a href="ch52_timeseries.html#cb531-75" aria-hidden="true" tabindex="-1"></a>    dv_keyword <span class="ot">&lt;-</span> <span class="st">&quot;actual&quot;</span></span>
<span id="cb531-76"><a href="ch52_timeseries.html#cb531-76" aria-hidden="true" tabindex="-1"></a>    sorted_indices <span class="ot">&lt;-</span> <span class="fu">order</span>(groupwise<span class="sc">$</span>tr_ordered)</span>
<span id="cb531-77"><a href="ch52_timeseries.html#cb531-77" aria-hidden="true" tabindex="-1"></a>    groupwise_sorted <span class="ot">&lt;-</span> groupwise[sorted_indices,]</span>
<span id="cb531-78"><a href="ch52_timeseries.html#cb531-78" aria-hidden="true" tabindex="-1"></a>    p1 <span class="ot">&lt;-</span> <span class="fu">plot_timeseries_bar</span>(</span>
<span id="cb531-79"><a href="ch52_timeseries.html#cb531-79" aria-hidden="true" tabindex="-1"></a>      groupwise_sorted,</span>
<span id="cb531-80"><a href="ch52_timeseries.html#cb531-80" aria-hidden="true" tabindex="-1"></a>      LINEIV1,</span>
<span id="cb531-81"><a href="ch52_timeseries.html#cb531-81" aria-hidden="true" tabindex="-1"></a>      LINEIV2,</span>
<span id="cb531-82"><a href="ch52_timeseries.html#cb531-82" aria-hidden="true" tabindex="-1"></a>      MEAN,</span>
<span id="cb531-83"><a href="ch52_timeseries.html#cb531-83" aria-hidden="true" tabindex="-1"></a>      ERROR,</span>
<span id="cb531-84"><a href="ch52_timeseries.html#cb531-84" aria-hidden="true" tabindex="-1"></a>      <span class="at">xlab =</span> <span class="st">&quot;TRs&quot;</span>,</span>
<span id="cb531-85"><a href="ch52_timeseries.html#cb531-85" aria-hidden="true" tabindex="-1"></a>      <span class="at">ylab =</span> <span class="fu">paste0</span>(ROI, <span class="st">&quot; activation (A.U.)&quot;</span>),</span>
<span id="cb531-86"><a href="ch52_timeseries.html#cb531-86" aria-hidden="true" tabindex="-1"></a>      <span class="at">ggtitle =</span> <span class="fu">paste0</span>(run_type, <span class="st">&quot; time series, Epoch - stimulus&quot;</span>),</span>
<span id="cb531-87"><a href="ch52_timeseries.html#cb531-87" aria-hidden="true" tabindex="-1"></a>      <span class="at">color =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb531-88"><a href="ch52_timeseries.html#cb531-88" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb531-89"><a href="ch52_timeseries.html#cb531-89" aria-hidden="true" tabindex="-1"></a>    time_points <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="fl">0.46</span> <span class="sc">*</span> TR_length, <span class="fl">0.46</span>)</span>
<span id="cb531-90"><a href="ch52_timeseries.html#cb531-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb531-91"><a href="ch52_timeseries.html#cb531-91" aria-hidden="true" tabindex="-1"></a>    plot_list[[run_type]] <span class="ot">&lt;-</span> p1 <span class="sc">+</span> <span class="fu">theme_classic</span>()</span>
<span id="cb531-92"><a href="ch52_timeseries.html#cb531-92" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb531-93"><a href="ch52_timeseries.html#cb531-93" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb531-94"><a href="ch52_timeseries.html#cb531-94" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ----------------------------------------------------------------------------</span></span>
<span id="cb531-95"><a href="ch52_timeseries.html#cb531-95" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                             plot three tasks</span></span>
<span id="cb531-96"><a href="ch52_timeseries.html#cb531-96" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ----------------------------------------------------------------------------  </span></span>
<span id="cb531-97"><a href="ch52_timeseries.html#cb531-97" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(gridExtra)</span>
<span id="cb531-98"><a href="ch52_timeseries.html#cb531-98" aria-hidden="true" tabindex="-1"></a>  plot_list <span class="ot">&lt;-</span> <span class="fu">lapply</span>(plot_list, <span class="cf">function</span>(plot) {</span>
<span id="cb531-99"><a href="ch52_timeseries.html#cb531-99" aria-hidden="true" tabindex="-1"></a>    plot <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">plot.margin =</span> <span class="fu">margin</span>(<span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">5</span>)) <span class="co"># Adjust plot margins if needed</span></span>
<span id="cb531-100"><a href="ch52_timeseries.html#cb531-100" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb531-101"><a href="ch52_timeseries.html#cb531-101" aria-hidden="true" tabindex="-1"></a>  combined_plot <span class="ot">&lt;-</span></span>
<span id="cb531-102"><a href="ch52_timeseries.html#cb531-102" aria-hidden="true" tabindex="-1"></a>    ggpubr<span class="sc">::</span><span class="fu">ggarrange</span>(</span>
<span id="cb531-103"><a href="ch52_timeseries.html#cb531-103" aria-hidden="true" tabindex="-1"></a>      plot_list[[<span class="st">&quot;pain&quot;</span>]],</span>
<span id="cb531-104"><a href="ch52_timeseries.html#cb531-104" aria-hidden="true" tabindex="-1"></a>      plot_list[[<span class="st">&quot;vicarious&quot;</span>]],</span>
<span id="cb531-105"><a href="ch52_timeseries.html#cb531-105" aria-hidden="true" tabindex="-1"></a>      plot_list[[<span class="st">&quot;cognitive&quot;</span>]],</span>
<span id="cb531-106"><a href="ch52_timeseries.html#cb531-106" aria-hidden="true" tabindex="-1"></a>      <span class="at">common.legend =</span> <span class="cn">TRUE</span>,</span>
<span id="cb531-107"><a href="ch52_timeseries.html#cb531-107" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend =</span> <span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb531-108"><a href="ch52_timeseries.html#cb531-108" aria-hidden="true" tabindex="-1"></a>      <span class="at">ncol =</span> <span class="dv">3</span>,</span>
<span id="cb531-109"><a href="ch52_timeseries.html#cb531-109" aria-hidden="true" tabindex="-1"></a>      <span class="at">nrow =</span> <span class="dv">1</span>,</span>
<span id="cb531-110"><a href="ch52_timeseries.html#cb531-110" aria-hidden="true" tabindex="-1"></a>      <span class="at">widths =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>),</span>
<span id="cb531-111"><a href="ch52_timeseries.html#cb531-111" aria-hidden="true" tabindex="-1"></a>      <span class="at">heights =</span> <span class="fu">c</span>(.<span class="dv">5</span>, .<span class="dv">5</span>, .<span class="dv">5</span>),</span>
<span id="cb531-112"><a href="ch52_timeseries.html#cb531-112" aria-hidden="true" tabindex="-1"></a>      <span class="at">align =</span> <span class="st">&quot;v&quot;</span></span>
<span id="cb531-113"><a href="ch52_timeseries.html#cb531-113" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb531-114"><a href="ch52_timeseries.html#cb531-114" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb531-115"><a href="ch52_timeseries.html#cb531-115" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(combined_plot)</span>
<span id="cb531-116"><a href="ch52_timeseries.html#cb531-116" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggsave</span>(<span class="fu">file.path</span>(</span>
<span id="cb531-117"><a href="ch52_timeseries.html#cb531-117" aria-hidden="true" tabindex="-1"></a>    save_dir,</span>
<span id="cb531-118"><a href="ch52_timeseries.html#cb531-118" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste0</span>(<span class="st">&quot;roi-&quot;</span>, ROI, <span class="st">&quot;_epoch-cue_desc-highcueGTlowcue.png&quot;</span>)</span>
<span id="cb531-119"><a href="ch52_timeseries.html#cb531-119" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb531-120"><a href="ch52_timeseries.html#cb531-120" aria-hidden="true" tabindex="-1"></a>  combined_plot,</span>
<span id="cb531-121"><a href="ch52_timeseries.html#cb531-121" aria-hidden="true" tabindex="-1"></a>  <span class="at">width =</span> <span class="dv">12</span>,</span>
<span id="cb531-122"><a href="ch52_timeseries.html#cb531-122" aria-hidden="true" tabindex="-1"></a>  <span class="at">height =</span> <span class="dv">4</span>)</span>
<span id="cb531-123"><a href="ch52_timeseries.html#cb531-123" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</details>
<p><img src="52_iv-6cond_dv-firglasserSPM_ttl1_rois_files/figure-html/unnamed-chunk-11-1.png" width="672" /><img src="52_iv-6cond_dv-firglasserSPM_ttl1_rois_files/figure-html/unnamed-chunk-11-2.png" width="672" /><img src="52_iv-6cond_dv-firglasserSPM_ttl1_rois_files/figure-html/unnamed-chunk-11-3.png" width="672" /><img src="52_iv-6cond_dv-firglasserSPM_ttl1_rois_files/figure-html/unnamed-chunk-11-4.png" width="672" /><img src="52_iv-6cond_dv-firglasserSPM_ttl1_rois_files/figure-html/unnamed-chunk-11-5.png" width="672" /><img src="52_iv-6cond_dv-firglasserSPM_ttl1_rois_files/figure-html/unnamed-chunk-11-6.png" width="672" /><img src="52_iv-6cond_dv-firglasserSPM_ttl1_rois_files/figure-html/unnamed-chunk-11-7.png" width="672" /><img src="52_iv-6cond_dv-firglasserSPM_ttl1_rois_files/figure-html/unnamed-chunk-11-8.png" width="672" /><img src="52_iv-6cond_dv-firglasserSPM_ttl1_rois_files/figure-html/unnamed-chunk-11-9.png" width="672" /><img src="52_iv-6cond_dv-firglasserSPM_ttl1_rois_files/figure-html/unnamed-chunk-11-10.png" width="672" /><img src="52_iv-6cond_dv-firglasserSPM_ttl1_rois_files/figure-html/unnamed-chunk-11-11.png" width="672" /><img src="52_iv-6cond_dv-firglasserSPM_ttl1_rois_files/figure-html/unnamed-chunk-11-12.png" width="672" /></p>
<div id="epoch-stim-rating-1" class="section level3 hasAnchor" number="16.3.1">
<h3><span class="header-section-number">16.3.1</span> epoch: stim, rating<a href="ch52_timeseries.html#epoch-stim-rating-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
</div>
<div id="main-sandbox-6-condition-in-three-panels.-per-task.-per-roi" class="section level2 hasAnchor" number="16.4">
<h2><span class="header-section-number">16.4</span> MAIN SANDBOX: 6 condition in three panels. per task. per ROI<a href="ch52_timeseries.html#main-sandbox-6-condition-in-three-panels.-per-task.-per-roi" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb532"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb532-1"><a href="ch52_timeseries.html#cb532-1" aria-hidden="true" tabindex="-1"></a><span class="co"># A function to plot data</span></span>
<span id="cb532-2"><a href="ch52_timeseries.html#cb532-2" aria-hidden="true" tabindex="-1"></a>plot_data <span class="ot">&lt;-</span> <span class="cf">function</span>(groupwise, iv1, iv2, mean, error, xlab, ylab, ggtitle, run_type, colors) {</span>
<span id="cb532-3"><a href="ch52_timeseries.html#cb532-3" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="fu">plot_timeseries_bar</span>(</span>
<span id="cb532-4"><a href="ch52_timeseries.html#cb532-4" aria-hidden="true" tabindex="-1"></a>    groupwise,</span>
<span id="cb532-5"><a href="ch52_timeseries.html#cb532-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;tr_ordered&quot;</span>,</span>
<span id="cb532-6"><a href="ch52_timeseries.html#cb532-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;sixcond&quot;</span>,</span>
<span id="cb532-7"><a href="ch52_timeseries.html#cb532-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;mean_per_sub_norm_mean&quot;</span>,</span>
<span id="cb532-8"><a href="ch52_timeseries.html#cb532-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;se&quot;</span>,</span>
<span id="cb532-9"><a href="ch52_timeseries.html#cb532-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlab =</span> <span class="st">&quot;TRs&quot;</span>,</span>
<span id="cb532-10"><a href="ch52_timeseries.html#cb532-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">ylab =</span> <span class="st">&quot;Epoch: stimulus, High cue vs. Low cue&quot;</span>,</span>
<span id="cb532-11"><a href="ch52_timeseries.html#cb532-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">ggtitle =</span> <span class="fu">paste0</span>(run_type, <span class="st">&quot; intensity (N = &quot;</span>, <span class="fu">unique</span>(groupwise<span class="sc">$</span>N), <span class="st">&quot;)&quot;</span>),</span>
<span id="cb532-12"><a href="ch52_timeseries.html#cb532-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">color_mapping =</span> colors,</span>
<span id="cb532-13"><a href="ch52_timeseries.html#cb532-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">show_legend =</span> <span class="cn">FALSE</span></span>
<span id="cb532-14"><a href="ch52_timeseries.html#cb532-14" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb532-15"><a href="ch52_timeseries.html#cb532-15" aria-hidden="true" tabindex="-1"></a>  p <span class="sc">+</span> <span class="fu">theme_classic</span>()</span>
<span id="cb532-16"><a href="ch52_timeseries.html#cb532-16" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</details>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb533"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb533-1"><a href="ch52_timeseries.html#cb533-1" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; Calculate Point Size Proportionally</span></span>
<span id="cb533-2"><a href="ch52_timeseries.html#cb533-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39;</span></span>
<span id="cb533-3"><a href="ch52_timeseries.html#cb533-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; This function calculates point size proportionally based on a base point size and figure dimensions</span></span>
<span id="cb533-4"><a href="ch52_timeseries.html#cb533-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; (width and height). It can be used to adjust the point size in plots to maintain proportionality</span></span>
<span id="cb533-5"><a href="ch52_timeseries.html#cb533-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; with varying figure sizes.</span></span>
<span id="cb533-6"><a href="ch52_timeseries.html#cb533-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39;</span></span>
<span id="cb533-7"><a href="ch52_timeseries.html#cb533-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param point_size_base The base point size for `geom_points`.</span></span>
<span id="cb533-8"><a href="ch52_timeseries.html#cb533-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param figure_width The width of the figure in which the point size needs to be adjusted.</span></span>
<span id="cb533-9"><a href="ch52_timeseries.html#cb533-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param figure_height The height of the figure in which the point size needs to be adjusted.</span></span>
<span id="cb533-10"><a href="ch52_timeseries.html#cb533-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39;</span></span>
<span id="cb533-11"><a href="ch52_timeseries.html#cb533-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @return The calculated point size.</span></span>
<span id="cb533-12"><a href="ch52_timeseries.html#cb533-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39;</span></span>
<span id="cb533-13"><a href="ch52_timeseries.html#cb533-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @examples</span></span>
<span id="cb533-14"><a href="ch52_timeseries.html#cb533-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; # Define your point size base</span></span>
<span id="cb533-15"><a href="ch52_timeseries.html#cb533-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; point_size_base &lt;- 3</span></span>
<span id="cb533-16"><a href="ch52_timeseries.html#cb533-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39;</span></span>
<span id="cb533-17"><a href="ch52_timeseries.html#cb533-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; # Define your figure dimensions (width and height)</span></span>
<span id="cb533-18"><a href="ch52_timeseries.html#cb533-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; figure_width &lt;- 12</span></span>
<span id="cb533-19"><a href="ch52_timeseries.html#cb533-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; figure_height &lt;- 8</span></span>
<span id="cb533-20"><a href="ch52_timeseries.html#cb533-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39;</span></span>
<span id="cb533-21"><a href="ch52_timeseries.html#cb533-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; # Calculate the point size using the function</span></span>
<span id="cb533-22"><a href="ch52_timeseries.html#cb533-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; POINT_SIZE &lt;- calculate_point_size(point_size_base, figure_width, figure_height)</span></span>
<span id="cb533-23"><a href="ch52_timeseries.html#cb533-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39;</span></span>
<span id="cb533-24"><a href="ch52_timeseries.html#cb533-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; # Apply the point size to your plot elements</span></span>
<span id="cb533-25"><a href="ch52_timeseries.html#cb533-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; plot + geom_point(size = POINT_SIZE)</span></span>
<span id="cb533-26"><a href="ch52_timeseries.html#cb533-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39;</span></span>
<span id="cb533-27"><a href="ch52_timeseries.html#cb533-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @export</span></span>
<span id="cb533-28"><a href="ch52_timeseries.html#cb533-28" aria-hidden="true" tabindex="-1"></a>calculate_point_size <span class="ot">&lt;-</span> <span class="cf">function</span>(figure_width, figure_height, <span class="at">point_size_base =</span> <span class="dv">5</span>) {</span>
<span id="cb533-29"><a href="ch52_timeseries.html#cb533-29" aria-hidden="true" tabindex="-1"></a>  scaling_factor <span class="ot">&lt;-</span> <span class="fu">min</span>(figure_width, figure_height) <span class="sc">/</span> point_size_base</span>
<span id="cb533-30"><a href="ch52_timeseries.html#cb533-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(scaling_factor)</span>
<span id="cb533-31"><a href="ch52_timeseries.html#cb533-31" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</details>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb534"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb534-1"><a href="ch52_timeseries.html#cb534-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ------------------------------------------------------------------------------</span></span>
<span id="cb534-2"><a href="ch52_timeseries.html#cb534-2" aria-hidden="true" tabindex="-1"></a><span class="co">#                       epoch stim, high cue vs low cue</span></span>
<span id="cb534-3"><a href="ch52_timeseries.html#cb534-3" aria-hidden="true" tabindex="-1"></a><span class="co"># ------------------------------------------------------------------------------</span></span>
<span id="cb534-4"><a href="ch52_timeseries.html#cb534-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb534-5"><a href="ch52_timeseries.html#cb534-5" aria-hidden="true" tabindex="-1"></a>run_types <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;pain&quot;</span>, <span class="st">&quot;vicarious&quot;</span>, <span class="st">&quot;cognitive&quot;</span>)</span>
<span id="cb534-6"><a href="ch52_timeseries.html#cb534-6" aria-hidden="true" tabindex="-1"></a>all_plots <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb534-7"><a href="ch52_timeseries.html#cb534-7" aria-hidden="true" tabindex="-1"></a>TR_length <span class="ot">&lt;-</span> <span class="dv">42</span></span>
<span id="cb534-8"><a href="ch52_timeseries.html#cb534-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (roi <span class="cf">in</span> <span class="fu">c</span>(<span class="st">&quot;dACC&quot;</span>, <span class="st">&quot;PHG&quot;</span>)) {</span>
<span id="cb534-9"><a href="ch52_timeseries.html#cb534-9" aria-hidden="true" tabindex="-1"></a>  plot_list_per_roi <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb534-10"><a href="ch52_timeseries.html#cb534-10" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (run_type <span class="cf">in</span> run_types) {</span>
<span id="cb534-11"><a href="ch52_timeseries.html#cb534-11" aria-hidden="true" tabindex="-1"></a>    filtered_df <span class="ot">&lt;-</span></span>
<span id="cb534-12"><a href="ch52_timeseries.html#cb534-12" aria-hidden="true" tabindex="-1"></a>      df[<span class="sc">!</span>(</span>
<span id="cb534-13"><a href="ch52_timeseries.html#cb534-13" aria-hidden="true" tabindex="-1"></a>        df<span class="sc">$</span>condition <span class="sc">==</span> <span class="st">&quot;rating&quot;</span> <span class="sc">|</span></span>
<span id="cb534-14"><a href="ch52_timeseries.html#cb534-14" aria-hidden="true" tabindex="-1"></a>          df<span class="sc">$</span>condition <span class="sc">==</span> <span class="st">&quot;cue&quot;</span> <span class="sc">|</span></span>
<span id="cb534-15"><a href="ch52_timeseries.html#cb534-15" aria-hidden="true" tabindex="-1"></a>          df<span class="sc">$</span>runtype <span class="sc">!=</span> run_type <span class="sc">|</span> df<span class="sc">$</span>ROI <span class="sc">==</span> roi</span>
<span id="cb534-16"><a href="ch52_timeseries.html#cb534-16" aria-hidden="true" tabindex="-1"></a>      ),]</span>
<span id="cb534-17"><a href="ch52_timeseries.html#cb534-17" aria-hidden="true" tabindex="-1"></a>    plot_list <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb534-18"><a href="ch52_timeseries.html#cb534-18" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb534-19"><a href="ch52_timeseries.html#cb534-19" aria-hidden="true" tabindex="-1"></a>    parsed_df <span class="ot">&lt;-</span> filtered_df <span class="sc">%&gt;%</span></span>
<span id="cb534-20"><a href="ch52_timeseries.html#cb534-20" aria-hidden="true" tabindex="-1"></a>      <span class="fu">separate</span>(</span>
<span id="cb534-21"><a href="ch52_timeseries.html#cb534-21" aria-hidden="true" tabindex="-1"></a>        condition,</span>
<span id="cb534-22"><a href="ch52_timeseries.html#cb534-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">into =</span> <span class="fu">c</span>(<span class="st">&quot;cue&quot;</span>, <span class="st">&quot;stim&quot;</span>),</span>
<span id="cb534-23"><a href="ch52_timeseries.html#cb534-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">sep =</span> <span class="st">&quot;_&quot;</span>,</span>
<span id="cb534-24"><a href="ch52_timeseries.html#cb534-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">remove =</span> <span class="cn">FALSE</span></span>
<span id="cb534-25"><a href="ch52_timeseries.html#cb534-25" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb534-26"><a href="ch52_timeseries.html#cb534-26" aria-hidden="true" tabindex="-1"></a>    <span class="co"># --------------------- subset regions based on ROI ----------------------------</span></span>
<span id="cb534-27"><a href="ch52_timeseries.html#cb534-27" aria-hidden="true" tabindex="-1"></a>    df_long <span class="ot">&lt;-</span></span>
<span id="cb534-28"><a href="ch52_timeseries.html#cb534-28" aria-hidden="true" tabindex="-1"></a>      <span class="fu">pivot_longer</span>(</span>
<span id="cb534-29"><a href="ch52_timeseries.html#cb534-29" aria-hidden="true" tabindex="-1"></a>        parsed_df,</span>
<span id="cb534-30"><a href="ch52_timeseries.html#cb534-30" aria-hidden="true" tabindex="-1"></a>        <span class="at">cols =</span> <span class="fu">starts_with</span>(<span class="st">&quot;tr&quot;</span>),</span>
<span id="cb534-31"><a href="ch52_timeseries.html#cb534-31" aria-hidden="true" tabindex="-1"></a>        <span class="at">names_to =</span> <span class="st">&quot;tr_num&quot;</span>,</span>
<span id="cb534-32"><a href="ch52_timeseries.html#cb534-32" aria-hidden="true" tabindex="-1"></a>        <span class="at">values_to =</span> <span class="st">&quot;tr_value&quot;</span></span>
<span id="cb534-33"><a href="ch52_timeseries.html#cb534-33" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb534-34"><a href="ch52_timeseries.html#cb534-34" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb534-35"><a href="ch52_timeseries.html#cb534-35" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ----------------------------------------------------------------------------</span></span>
<span id="cb534-36"><a href="ch52_timeseries.html#cb534-36" aria-hidden="true" tabindex="-1"></a>    <span class="co">#                             clean factor</span></span>
<span id="cb534-37"><a href="ch52_timeseries.html#cb534-37" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ----------------------------------------------------------------------------</span></span>
<span id="cb534-38"><a href="ch52_timeseries.html#cb534-38" aria-hidden="true" tabindex="-1"></a>    df_long<span class="sc">$</span>tr_ordered <span class="ot">&lt;-</span> <span class="fu">factor</span>(df_long<span class="sc">$</span>tr_num,</span>
<span id="cb534-39"><a href="ch52_timeseries.html#cb534-39" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">levels =</span> <span class="fu">c</span>(<span class="fu">paste0</span>(<span class="st">&quot;tr&quot;</span>, <span class="dv">1</span><span class="sc">:</span>TR_length)))</span>
<span id="cb534-40"><a href="ch52_timeseries.html#cb534-40" aria-hidden="true" tabindex="-1"></a>    df_long<span class="sc">$</span>cue_ordered <span class="ot">&lt;-</span> <span class="fu">factor</span>(df_long<span class="sc">$</span>cue,</span>
<span id="cb534-41"><a href="ch52_timeseries.html#cb534-41" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;cueH&quot;</span>, <span class="st">&quot;cueL&quot;</span>))</span>
<span id="cb534-42"><a href="ch52_timeseries.html#cb534-42" aria-hidden="true" tabindex="-1"></a>    df_long<span class="sc">$</span>stim_ordered <span class="ot">&lt;-</span> <span class="fu">factor</span>(df_long<span class="sc">$</span>stim,</span>
<span id="cb534-43"><a href="ch52_timeseries.html#cb534-43" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;stimH&quot;</span>, <span class="st">&quot;stimM&quot;</span>, <span class="st">&quot;stimL&quot;</span>))</span>
<span id="cb534-44"><a href="ch52_timeseries.html#cb534-44" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb534-45"><a href="ch52_timeseries.html#cb534-45" aria-hidden="true" tabindex="-1"></a>    df_long<span class="sc">$</span>sixcond <span class="ot">&lt;-</span> <span class="fu">factor</span>(</span>
<span id="cb534-46"><a href="ch52_timeseries.html#cb534-46" aria-hidden="true" tabindex="-1"></a>      df_long<span class="sc">$</span>condition,</span>
<span id="cb534-47"><a href="ch52_timeseries.html#cb534-47" aria-hidden="true" tabindex="-1"></a>      <span class="at">levels =</span> <span class="fu">c</span>(</span>
<span id="cb534-48"><a href="ch52_timeseries.html#cb534-48" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;cueH_stimH&quot;</span>,</span>
<span id="cb534-49"><a href="ch52_timeseries.html#cb534-49" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;cueL_stimH&quot;</span>,</span>
<span id="cb534-50"><a href="ch52_timeseries.html#cb534-50" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;cueH_stimM&quot;</span>,</span>
<span id="cb534-51"><a href="ch52_timeseries.html#cb534-51" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;cueL_stimM&quot;</span>,</span>
<span id="cb534-52"><a href="ch52_timeseries.html#cb534-52" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;cueH_stimL&quot;</span>,</span>
<span id="cb534-53"><a href="ch52_timeseries.html#cb534-53" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;cueL_stimL&quot;</span></span>
<span id="cb534-54"><a href="ch52_timeseries.html#cb534-54" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb534-55"><a href="ch52_timeseries.html#cb534-55" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb534-56"><a href="ch52_timeseries.html#cb534-56" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb534-57"><a href="ch52_timeseries.html#cb534-57" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ------------------------------------------------------------------------------</span></span>
<span id="cb534-58"><a href="ch52_timeseries.html#cb534-58" aria-hidden="true" tabindex="-1"></a>    <span class="co">#                             summary statistics</span></span>
<span id="cb534-59"><a href="ch52_timeseries.html#cb534-59" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ------------------------------------------------------------------------------</span></span>
<span id="cb534-60"><a href="ch52_timeseries.html#cb534-60" aria-hidden="true" tabindex="-1"></a>    subjectwise <span class="ot">&lt;-</span> <span class="fu">meanSummary</span>(df_long,</span>
<span id="cb534-61"><a href="ch52_timeseries.html#cb534-61" aria-hidden="true" tabindex="-1"></a>                               <span class="fu">c</span>(<span class="st">&quot;sub&quot;</span>, <span class="st">&quot;tr_ordered&quot;</span>, <span class="st">&quot;sixcond&quot;</span>), <span class="st">&quot;tr_value&quot;</span>)</span>
<span id="cb534-62"><a href="ch52_timeseries.html#cb534-62" aria-hidden="true" tabindex="-1"></a>    groupwise <span class="ot">&lt;-</span> <span class="fu">summarySEwithin</span>(</span>
<span id="cb534-63"><a href="ch52_timeseries.html#cb534-63" aria-hidden="true" tabindex="-1"></a>      <span class="at">data =</span> subjectwise,</span>
<span id="cb534-64"><a href="ch52_timeseries.html#cb534-64" aria-hidden="true" tabindex="-1"></a>      <span class="at">measurevar =</span> <span class="st">&quot;mean_per_sub&quot;</span>,</span>
<span id="cb534-65"><a href="ch52_timeseries.html#cb534-65" aria-hidden="true" tabindex="-1"></a>      <span class="at">withinvars =</span> <span class="fu">c</span>(<span class="st">&quot;sixcond&quot;</span>, <span class="st">&quot;tr_ordered&quot;</span>),</span>
<span id="cb534-66"><a href="ch52_timeseries.html#cb534-66" aria-hidden="true" tabindex="-1"></a>      <span class="at">idvar =</span> <span class="st">&quot;sub&quot;</span></span>
<span id="cb534-67"><a href="ch52_timeseries.html#cb534-67" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb534-68"><a href="ch52_timeseries.html#cb534-68" aria-hidden="true" tabindex="-1"></a>    groupwise<span class="sc">$</span>task <span class="ot">&lt;-</span> taskname</span>
<span id="cb534-69"><a href="ch52_timeseries.html#cb534-69" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb534-70"><a href="ch52_timeseries.html#cb534-70" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb534-71"><a href="ch52_timeseries.html#cb534-71" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ----------------------------------------------------------------------------</span></span>
<span id="cb534-72"><a href="ch52_timeseries.html#cb534-72" aria-hidden="true" tabindex="-1"></a>    <span class="co">#                             plot parameters</span></span>
<span id="cb534-73"><a href="ch52_timeseries.html#cb534-73" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ----------------------------------------------------------------------------</span></span>
<span id="cb534-74"><a href="ch52_timeseries.html#cb534-74" aria-hidden="true" tabindex="-1"></a>    <span class="co"># convert TR orders to numeric values</span></span>
<span id="cb534-75"><a href="ch52_timeseries.html#cb534-75" aria-hidden="true" tabindex="-1"></a>    tr_numbers <span class="ot">&lt;-</span></span>
<span id="cb534-76"><a href="ch52_timeseries.html#cb534-76" aria-hidden="true" tabindex="-1"></a>      <span class="fu">as.numeric</span>(<span class="fu">sub</span>(<span class="st">&quot;tr&quot;</span>, <span class="st">&quot;&quot;</span>, <span class="fu">as.character</span>(groupwise<span class="sc">$</span>tr_ordered)))</span>
<span id="cb534-77"><a href="ch52_timeseries.html#cb534-77" aria-hidden="true" tabindex="-1"></a>    tr_sequence <span class="ot">&lt;-</span> (tr_numbers <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> <span class="fl">0.46</span></span>
<span id="cb534-78"><a href="ch52_timeseries.html#cb534-78" aria-hidden="true" tabindex="-1"></a>    groupwise<span class="sc">$</span>tr_sequence <span class="ot">&lt;-</span> tr_sequence</span>
<span id="cb534-79"><a href="ch52_timeseries.html#cb534-79" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb534-80"><a href="ch52_timeseries.html#cb534-80" aria-hidden="true" tabindex="-1"></a>    LINEIV1 <span class="ot">&lt;-</span> <span class="st">&quot;tr_sequence&quot;</span></span>
<span id="cb534-81"><a href="ch52_timeseries.html#cb534-81" aria-hidden="true" tabindex="-1"></a>    LINEIV2 <span class="ot">&lt;-</span> <span class="st">&quot;sixcond&quot;</span></span>
<span id="cb534-82"><a href="ch52_timeseries.html#cb534-82" aria-hidden="true" tabindex="-1"></a>    MEAN <span class="ot">&lt;-</span> <span class="st">&quot;mean_per_sub_norm_mean&quot;</span></span>
<span id="cb534-83"><a href="ch52_timeseries.html#cb534-83" aria-hidden="true" tabindex="-1"></a>    ERROR <span class="ot">&lt;-</span> <span class="st">&quot;se&quot;</span></span>
<span id="cb534-84"><a href="ch52_timeseries.html#cb534-84" aria-hidden="true" tabindex="-1"></a>    dv_keyword <span class="ot">&lt;-</span> <span class="st">&quot;actual&quot;</span></span>
<span id="cb534-85"><a href="ch52_timeseries.html#cb534-85" aria-hidden="true" tabindex="-1"></a>    sorted_indices <span class="ot">&lt;-</span> <span class="fu">order</span>(groupwise<span class="sc">$</span>tr_ordered)</span>
<span id="cb534-86"><a href="ch52_timeseries.html#cb534-86" aria-hidden="true" tabindex="-1"></a>    groupwise_sorted <span class="ot">&lt;-</span> groupwise[sorted_indices,]</span>
<span id="cb534-87"><a href="ch52_timeseries.html#cb534-87" aria-hidden="true" tabindex="-1"></a>    XLAB <span class="ot">&lt;-</span> <span class="st">&quot;TRs&quot;</span></span>
<span id="cb534-88"><a href="ch52_timeseries.html#cb534-88" aria-hidden="true" tabindex="-1"></a>    YLAB <span class="ot">&lt;-</span> <span class="st">&quot;Stimulus Epoch High vs. Low cue&quot;</span></span>
<span id="cb534-89"><a href="ch52_timeseries.html#cb534-89" aria-hidden="true" tabindex="-1"></a>    HIGHSTIM_COLOR <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb534-90"><a href="ch52_timeseries.html#cb534-90" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;cueH_stimH&quot;</span> <span class="ot">=</span> <span class="st">&quot;red&quot;</span>,</span>
<span id="cb534-91"><a href="ch52_timeseries.html#cb534-91" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;cueL_stimH&quot;</span> <span class="ot">=</span> <span class="st">&quot;#5f0f40&quot;</span>,</span>
<span id="cb534-92"><a href="ch52_timeseries.html#cb534-92" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;cueH_stimM&quot;</span> <span class="ot">=</span> <span class="st">&quot;gray&quot;</span>,</span>
<span id="cb534-93"><a href="ch52_timeseries.html#cb534-93" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;cueL_stimM&quot;</span> <span class="ot">=</span> <span class="st">&quot;gray&quot;</span>,</span>
<span id="cb534-94"><a href="ch52_timeseries.html#cb534-94" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;cueH_stimL&quot;</span> <span class="ot">=</span> <span class="st">&quot;gray&quot;</span>,</span>
<span id="cb534-95"><a href="ch52_timeseries.html#cb534-95" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;cueL_stimL&quot;</span> <span class="ot">=</span> <span class="st">&quot;gray&quot;</span></span>
<span id="cb534-96"><a href="ch52_timeseries.html#cb534-96" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb534-97"><a href="ch52_timeseries.html#cb534-97" aria-hidden="true" tabindex="-1"></a>    MEDSTIM_COLOR <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb534-98"><a href="ch52_timeseries.html#cb534-98" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;cueH_stimH&quot;</span> <span class="ot">=</span> <span class="st">&quot;gray&quot;</span>,</span>
<span id="cb534-99"><a href="ch52_timeseries.html#cb534-99" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;cueL_stimH&quot;</span> <span class="ot">=</span> <span class="st">&quot;gray&quot;</span>,</span>
<span id="cb534-100"><a href="ch52_timeseries.html#cb534-100" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;cueH_stimM&quot;</span> <span class="ot">=</span> <span class="st">&quot;#bc3908&quot;</span>,</span>
<span id="cb534-101"><a href="ch52_timeseries.html#cb534-101" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;cueL_stimM&quot;</span> <span class="ot">=</span> <span class="st">&quot;#f6aa1c&quot;</span>,</span>
<span id="cb534-102"><a href="ch52_timeseries.html#cb534-102" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;cueH_stimL&quot;</span> <span class="ot">=</span> <span class="st">&quot;gray&quot;</span>,</span>
<span id="cb534-103"><a href="ch52_timeseries.html#cb534-103" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;cueL_stimL&quot;</span> <span class="ot">=</span> <span class="st">&quot;gray&quot;</span></span>
<span id="cb534-104"><a href="ch52_timeseries.html#cb534-104" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb534-105"><a href="ch52_timeseries.html#cb534-105" aria-hidden="true" tabindex="-1"></a>    LOWSTIM_COLOR <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb534-106"><a href="ch52_timeseries.html#cb534-106" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;cueH_stimH&quot;</span> <span class="ot">=</span> <span class="st">&quot;gray&quot;</span>,</span>
<span id="cb534-107"><a href="ch52_timeseries.html#cb534-107" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;cueL_stimH&quot;</span> <span class="ot">=</span> <span class="st">&quot;gray&quot;</span>,</span>
<span id="cb534-108"><a href="ch52_timeseries.html#cb534-108" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;cueH_stimM&quot;</span> <span class="ot">=</span> <span class="st">&quot;gray&quot;</span>,</span>
<span id="cb534-109"><a href="ch52_timeseries.html#cb534-109" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;cueL_stimM&quot;</span> <span class="ot">=</span> <span class="st">&quot;gray&quot;</span>,</span>
<span id="cb534-110"><a href="ch52_timeseries.html#cb534-110" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;cueH_stimL&quot;</span> <span class="ot">=</span> <span class="st">&quot;#2541b2&quot;</span>,</span>
<span id="cb534-111"><a href="ch52_timeseries.html#cb534-111" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;cueL_stimL&quot;</span> <span class="ot">=</span> <span class="st">&quot;#00a6fb&quot;</span></span>
<span id="cb534-112"><a href="ch52_timeseries.html#cb534-112" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb534-113"><a href="ch52_timeseries.html#cb534-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb534-114"><a href="ch52_timeseries.html#cb534-114" aria-hidden="true" tabindex="-1"></a>    AXIS_FONTSIZE <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb534-115"><a href="ch52_timeseries.html#cb534-115" aria-hidden="true" tabindex="-1"></a>    COMMONAXIS_FONTSIZE <span class="ot">&lt;-</span> <span class="dv">15</span></span>
<span id="cb534-116"><a href="ch52_timeseries.html#cb534-116" aria-hidden="true" tabindex="-1"></a>    TITLE_FONTSIZE <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb534-117"><a href="ch52_timeseries.html#cb534-117" aria-hidden="true" tabindex="-1"></a>    figure_width <span class="ot">&lt;-</span> <span class="dv">10</span>  <span class="co"># Adjust this to your actual figure width</span></span>
<span id="cb534-118"><a href="ch52_timeseries.html#cb534-118" aria-hidden="true" tabindex="-1"></a>    figure_height <span class="ot">&lt;-</span> <span class="dv">10</span>  <span class="co"># Adjust this to your actual figure height</span></span>
<span id="cb534-119"><a href="ch52_timeseries.html#cb534-119" aria-hidden="true" tabindex="-1"></a>    GEOMPOINT_SIZE <span class="ot">&lt;-</span> <span class="fu">calculate_point_size</span>(figure_width, figure_height)</span>
<span id="cb534-120"><a href="ch52_timeseries.html#cb534-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb534-121"><a href="ch52_timeseries.html#cb534-121" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ----------------------------------------------------------------------------</span></span>
<span id="cb534-122"><a href="ch52_timeseries.html#cb534-122" aria-hidden="true" tabindex="-1"></a>    <span class="co">#                             plot intensity per task</span></span>
<span id="cb534-123"><a href="ch52_timeseries.html#cb534-123" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ----------------------------------------------------------------------------</span></span>
<span id="cb534-124"><a href="ch52_timeseries.html#cb534-124" aria-hidden="true" tabindex="-1"></a>    p3H <span class="ot">&lt;-</span> <span class="fu">plot_timeseries_bar</span>(</span>
<span id="cb534-125"><a href="ch52_timeseries.html#cb534-125" aria-hidden="true" tabindex="-1"></a>      groupwise,</span>
<span id="cb534-126"><a href="ch52_timeseries.html#cb534-126" aria-hidden="true" tabindex="-1"></a>      LINEIV1,</span>
<span id="cb534-127"><a href="ch52_timeseries.html#cb534-127" aria-hidden="true" tabindex="-1"></a>      LINEIV2,</span>
<span id="cb534-128"><a href="ch52_timeseries.html#cb534-128" aria-hidden="true" tabindex="-1"></a>      MEAN,</span>
<span id="cb534-129"><a href="ch52_timeseries.html#cb534-129" aria-hidden="true" tabindex="-1"></a>      ERROR,</span>
<span id="cb534-130"><a href="ch52_timeseries.html#cb534-130" aria-hidden="true" tabindex="-1"></a>      XLAB,</span>
<span id="cb534-131"><a href="ch52_timeseries.html#cb534-131" aria-hidden="true" tabindex="-1"></a>      YLAB,</span>
<span id="cb534-132"><a href="ch52_timeseries.html#cb534-132" aria-hidden="true" tabindex="-1"></a>      <span class="at">ggtitle =</span> <span class="fu">paste0</span>(tools<span class="sc">::</span><span class="fu">toTitleCase</span>(run_type), <span class="st">&quot;</span><span class="sc">\n</span><span class="st"> High intensity (N = &quot;</span>, <span class="fu">unique</span>(groupwise<span class="sc">$</span>N), <span class="st">&quot;)&quot;</span>),</span>
<span id="cb534-133"><a href="ch52_timeseries.html#cb534-133" aria-hidden="true" tabindex="-1"></a>      <span class="at">color_mapping =</span> HIGHSTIM_COLOR,</span>
<span id="cb534-134"><a href="ch52_timeseries.html#cb534-134" aria-hidden="true" tabindex="-1"></a>      <span class="at">show_legend =</span> <span class="cn">FALSE</span>, </span>
<span id="cb534-135"><a href="ch52_timeseries.html#cb534-135" aria-hidden="true" tabindex="-1"></a>      <span class="at">geompoint_size =</span> GEOMPOINT_SIZE</span>
<span id="cb534-136"><a href="ch52_timeseries.html#cb534-136" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb534-137"><a href="ch52_timeseries.html#cb534-137" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb534-138"><a href="ch52_timeseries.html#cb534-138" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Assuming tr_sequence is correct and has been added to groupwise</span></span>
<span id="cb534-139"><a href="ch52_timeseries.html#cb534-139" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate breaks to show every 10th TR</span></span>
<span id="cb534-140"><a href="ch52_timeseries.html#cb534-140" aria-hidden="true" tabindex="-1"></a>    breaks_to_show <span class="ot">&lt;-</span></span>
<span id="cb534-141"><a href="ch52_timeseries.html#cb534-141" aria-hidden="true" tabindex="-1"></a>      <span class="fu">seq</span>(<span class="dv">0</span>, <span class="fu">max</span>(groupwise<span class="sc">$</span>tr_sequence), <span class="at">by =</span> <span class="fl">0.46</span> <span class="sc">*</span> <span class="dv">5</span>)</span>
<span id="cb534-142"><a href="ch52_timeseries.html#cb534-142" aria-hidden="true" tabindex="-1"></a>    labels_to_show <span class="ot">&lt;-</span></span>
<span id="cb534-143"><a href="ch52_timeseries.html#cb534-143" aria-hidden="true" tabindex="-1"></a>      <span class="fu">seq</span>(<span class="dv">0</span>, <span class="fu">max</span>(groupwise<span class="sc">$</span>tr_sequence), <span class="at">by =</span> <span class="fl">0.46</span> <span class="sc">*</span> <span class="dv">5</span>)</span>
<span id="cb534-144"><a href="ch52_timeseries.html#cb534-144" aria-hidden="true" tabindex="-1"></a>    <span class="co"># It&#39;s important to ensure that both &#39;breaks_to_show&#39; and &#39;labels_to_show&#39; have the same length</span></span>
<span id="cb534-145"><a href="ch52_timeseries.html#cb534-145" aria-hidden="true" tabindex="-1"></a>    <span class="co"># If the lengths differ, we need to adjust them so they match</span></span>
<span id="cb534-146"><a href="ch52_timeseries.html#cb534-146" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">length</span>(breaks_to_show) <span class="sc">!=</span> <span class="fu">length</span>(labels_to_show)) {</span>
<span id="cb534-147"><a href="ch52_timeseries.html#cb534-147" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Assuming you want to keep all the breaks and just adjust the labels</span></span>
<span id="cb534-148"><a href="ch52_timeseries.html#cb534-148" aria-hidden="true" tabindex="-1"></a>      labels_to_show <span class="ot">&lt;-</span> labels_to_show[<span class="fu">seq_along</span>(breaks_to_show)]</span>
<span id="cb534-149"><a href="ch52_timeseries.html#cb534-149" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb534-150"><a href="ch52_timeseries.html#cb534-150" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb534-151"><a href="ch52_timeseries.html#cb534-151" aria-hidden="true" tabindex="-1"></a>    <span class="co"># High intensity</span></span>
<span id="cb534-152"><a href="ch52_timeseries.html#cb534-152" aria-hidden="true" tabindex="-1"></a>    plot_list[[<span class="st">&quot;H&quot;</span>]] <span class="ot">&lt;-</span> p3H <span class="sc">+</span></span>
<span id="cb534-153"><a href="ch52_timeseries.html#cb534-153" aria-hidden="true" tabindex="-1"></a>      <span class="fu">scale_x_continuous</span>(</span>
<span id="cb534-154"><a href="ch52_timeseries.html#cb534-154" aria-hidden="true" tabindex="-1"></a>        <span class="at">breaks =</span> breaks_to_show,</span>
<span id="cb534-155"><a href="ch52_timeseries.html#cb534-155" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Set breaks at every 10th point</span></span>
<span id="cb534-156"><a href="ch52_timeseries.html#cb534-156" aria-hidden="true" tabindex="-1"></a>        <span class="at">labels =</span> labels_to_show,</span>
<span id="cb534-157"><a href="ch52_timeseries.html#cb534-157" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Use the calculated labels</span></span>
<span id="cb534-158"><a href="ch52_timeseries.html#cb534-158" aria-hidden="true" tabindex="-1"></a>        <span class="at">limits =</span> <span class="fu">range</span>(groupwise<span class="sc">$</span>tr_sequence)  <span class="co"># Set the limits based on the sequence</span></span>
<span id="cb534-159"><a href="ch52_timeseries.html#cb534-159" aria-hidden="true" tabindex="-1"></a>      ) <span class="sc">+</span></span>
<span id="cb534-160"><a href="ch52_timeseries.html#cb534-160" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme_classic</span>()</span>
<span id="cb534-161"><a href="ch52_timeseries.html#cb534-161" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb534-162"><a href="ch52_timeseries.html#cb534-162" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Medium intensity</span></span>
<span id="cb534-163"><a href="ch52_timeseries.html#cb534-163" aria-hidden="true" tabindex="-1"></a>    p3M <span class="ot">&lt;-</span> <span class="fu">plot_timeseries_bar</span>(</span>
<span id="cb534-164"><a href="ch52_timeseries.html#cb534-164" aria-hidden="true" tabindex="-1"></a>      groupwise,</span>
<span id="cb534-165"><a href="ch52_timeseries.html#cb534-165" aria-hidden="true" tabindex="-1"></a>      LINEIV1,</span>
<span id="cb534-166"><a href="ch52_timeseries.html#cb534-166" aria-hidden="true" tabindex="-1"></a>      LINEIV2,</span>
<span id="cb534-167"><a href="ch52_timeseries.html#cb534-167" aria-hidden="true" tabindex="-1"></a>      MEAN,</span>
<span id="cb534-168"><a href="ch52_timeseries.html#cb534-168" aria-hidden="true" tabindex="-1"></a>      ERROR,</span>
<span id="cb534-169"><a href="ch52_timeseries.html#cb534-169" aria-hidden="true" tabindex="-1"></a>      XLAB,</span>
<span id="cb534-170"><a href="ch52_timeseries.html#cb534-170" aria-hidden="true" tabindex="-1"></a>      YLAB,</span>
<span id="cb534-171"><a href="ch52_timeseries.html#cb534-171" aria-hidden="true" tabindex="-1"></a>      <span class="at">ggtitle =</span> <span class="fu">paste0</span>(</span>
<span id="cb534-172"><a href="ch52_timeseries.html#cb534-172" aria-hidden="true" tabindex="-1"></a>        tools<span class="sc">::</span><span class="fu">toTitleCase</span>(run_type),</span>
<span id="cb534-173"><a href="ch52_timeseries.html#cb534-173" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;</span><span class="sc">\n</span><span class="st"> Medium intensity (N = &quot;</span>,</span>
<span id="cb534-174"><a href="ch52_timeseries.html#cb534-174" aria-hidden="true" tabindex="-1"></a>        <span class="fu">unique</span>(groupwise<span class="sc">$</span>N),</span>
<span id="cb534-175"><a href="ch52_timeseries.html#cb534-175" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;)&quot;</span></span>
<span id="cb534-176"><a href="ch52_timeseries.html#cb534-176" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb534-177"><a href="ch52_timeseries.html#cb534-177" aria-hidden="true" tabindex="-1"></a>      <span class="at">color_mapping =</span> MEDSTIM_COLOR,</span>
<span id="cb534-178"><a href="ch52_timeseries.html#cb534-178" aria-hidden="true" tabindex="-1"></a>      <span class="at">show_legend =</span> <span class="cn">FALSE</span>,</span>
<span id="cb534-179"><a href="ch52_timeseries.html#cb534-179" aria-hidden="true" tabindex="-1"></a>      <span class="at">geompoint_size =</span> GEOMPOINT_SIZE</span>
<span id="cb534-180"><a href="ch52_timeseries.html#cb534-180" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb534-181"><a href="ch52_timeseries.html#cb534-181" aria-hidden="true" tabindex="-1"></a>    plot_list[[<span class="st">&quot;M&quot;</span>]] <span class="ot">&lt;-</span> p3M <span class="sc">+</span></span>
<span id="cb534-182"><a href="ch52_timeseries.html#cb534-182" aria-hidden="true" tabindex="-1"></a>      <span class="fu">scale_x_continuous</span>(</span>
<span id="cb534-183"><a href="ch52_timeseries.html#cb534-183" aria-hidden="true" tabindex="-1"></a>        <span class="at">breaks =</span> breaks_to_show,        <span class="co"># Set breaks at every 10th point</span></span>
<span id="cb534-184"><a href="ch52_timeseries.html#cb534-184" aria-hidden="true" tabindex="-1"></a>        <span class="at">labels =</span> labels_to_show,        <span class="co"># Use the calculated labels</span></span>
<span id="cb534-185"><a href="ch52_timeseries.html#cb534-185" aria-hidden="true" tabindex="-1"></a>        <span class="at">limits =</span> <span class="fu">range</span>(groupwise<span class="sc">$</span>tr_sequence)  <span class="co"># Set the limits based on the sequence</span></span>
<span id="cb534-186"><a href="ch52_timeseries.html#cb534-186" aria-hidden="true" tabindex="-1"></a>      ) <span class="sc">+</span></span>
<span id="cb534-187"><a href="ch52_timeseries.html#cb534-187" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme_classic</span>()</span>
<span id="cb534-188"><a href="ch52_timeseries.html#cb534-188" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb534-189"><a href="ch52_timeseries.html#cb534-189" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Low intensity</span></span>
<span id="cb534-190"><a href="ch52_timeseries.html#cb534-190" aria-hidden="true" tabindex="-1"></a>    p3L <span class="ot">&lt;-</span> <span class="fu">plot_timeseries_bar</span>(</span>
<span id="cb534-191"><a href="ch52_timeseries.html#cb534-191" aria-hidden="true" tabindex="-1"></a>      groupwise,</span>
<span id="cb534-192"><a href="ch52_timeseries.html#cb534-192" aria-hidden="true" tabindex="-1"></a>      LINEIV1,</span>
<span id="cb534-193"><a href="ch52_timeseries.html#cb534-193" aria-hidden="true" tabindex="-1"></a>      LINEIV2,</span>
<span id="cb534-194"><a href="ch52_timeseries.html#cb534-194" aria-hidden="true" tabindex="-1"></a>      MEAN,</span>
<span id="cb534-195"><a href="ch52_timeseries.html#cb534-195" aria-hidden="true" tabindex="-1"></a>      ERROR,</span>
<span id="cb534-196"><a href="ch52_timeseries.html#cb534-196" aria-hidden="true" tabindex="-1"></a>      XLAB,</span>
<span id="cb534-197"><a href="ch52_timeseries.html#cb534-197" aria-hidden="true" tabindex="-1"></a>      YLAB,</span>
<span id="cb534-198"><a href="ch52_timeseries.html#cb534-198" aria-hidden="true" tabindex="-1"></a>      <span class="at">ggtitle =</span> <span class="fu">paste0</span>(tools<span class="sc">::</span><span class="fu">toTitleCase</span>(run_type), <span class="st">&quot;</span><span class="sc">\n</span><span class="st"> Low intensity (N = &quot;</span>, <span class="fu">unique</span>(groupwise<span class="sc">$</span>N), <span class="st">&quot;)&quot;</span>),</span>
<span id="cb534-199"><a href="ch52_timeseries.html#cb534-199" aria-hidden="true" tabindex="-1"></a>      <span class="at">color_mapping =</span> LOWSTIM_COLOR,</span>
<span id="cb534-200"><a href="ch52_timeseries.html#cb534-200" aria-hidden="true" tabindex="-1"></a>      <span class="at">show_legend =</span> <span class="cn">FALSE</span>,</span>
<span id="cb534-201"><a href="ch52_timeseries.html#cb534-201" aria-hidden="true" tabindex="-1"></a>      <span class="at">geompoint_size =</span> GEOMPOINT_SIZE</span>
<span id="cb534-202"><a href="ch52_timeseries.html#cb534-202" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb534-203"><a href="ch52_timeseries.html#cb534-203" aria-hidden="true" tabindex="-1"></a>    plot_list[[<span class="st">&quot;L&quot;</span>]] <span class="ot">&lt;-</span> p3L <span class="sc">+</span></span>
<span id="cb534-204"><a href="ch52_timeseries.html#cb534-204" aria-hidden="true" tabindex="-1"></a>      <span class="fu">scale_x_continuous</span>(</span>
<span id="cb534-205"><a href="ch52_timeseries.html#cb534-205" aria-hidden="true" tabindex="-1"></a>        <span class="at">breaks =</span> breaks_to_show,</span>
<span id="cb534-206"><a href="ch52_timeseries.html#cb534-206" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Set breaks at every 10th point</span></span>
<span id="cb534-207"><a href="ch52_timeseries.html#cb534-207" aria-hidden="true" tabindex="-1"></a>        <span class="at">labels =</span> labels_to_show,</span>
<span id="cb534-208"><a href="ch52_timeseries.html#cb534-208" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Use the calculated labels</span></span>
<span id="cb534-209"><a href="ch52_timeseries.html#cb534-209" aria-hidden="true" tabindex="-1"></a>        <span class="at">limits =</span> <span class="fu">range</span>(groupwise<span class="sc">$</span>tr_sequence)  <span class="co"># Set the limits based on the sequence</span></span>
<span id="cb534-210"><a href="ch52_timeseries.html#cb534-210" aria-hidden="true" tabindex="-1"></a>      ) <span class="sc">+</span></span>
<span id="cb534-211"><a href="ch52_timeseries.html#cb534-211" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme_classic</span>()</span>
<span id="cb534-212"><a href="ch52_timeseries.html#cb534-212" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb534-213"><a href="ch52_timeseries.html#cb534-213" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ----------------------------------------------------------------------------</span></span>
<span id="cb534-214"><a href="ch52_timeseries.html#cb534-214" aria-hidden="true" tabindex="-1"></a>    <span class="co">#                   combine three tasks in one panel per ROI</span></span>
<span id="cb534-215"><a href="ch52_timeseries.html#cb534-215" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ----------------------------------------------------------------------------</span></span>
<span id="cb534-216"><a href="ch52_timeseries.html#cb534-216" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb534-217"><a href="ch52_timeseries.html#cb534-217" aria-hidden="true" tabindex="-1"></a>    <span class="fu">library</span>(gridExtra)</span>
<span id="cb534-218"><a href="ch52_timeseries.html#cb534-218" aria-hidden="true" tabindex="-1"></a>    plot_list <span class="ot">&lt;-</span> <span class="fu">lapply</span>(plot_list, <span class="cf">function</span>(plot) {</span>
<span id="cb534-219"><a href="ch52_timeseries.html#cb534-219" aria-hidden="true" tabindex="-1"></a>      plot <span class="sc">+</span></span>
<span id="cb534-220"><a href="ch52_timeseries.html#cb534-220" aria-hidden="true" tabindex="-1"></a>        <span class="fu">theme</span>(</span>
<span id="cb534-221"><a href="ch52_timeseries.html#cb534-221" aria-hidden="true" tabindex="-1"></a>          <span class="at">plot.margin =</span> <span class="fu">margin</span>(<span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">5</span>),          <span class="co"># Adjust plot margins if needed</span></span>
<span id="cb534-222"><a href="ch52_timeseries.html#cb534-222" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.title.y =</span> <span class="fu">element_blank</span>(),          <span class="co"># Remove y-axis title</span></span>
<span id="cb534-223"><a href="ch52_timeseries.html#cb534-223" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.title.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb534-224"><a href="ch52_timeseries.html#cb534-224" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> AXIS_FONTSIZE),          <span class="co"># Increase y-axis text size</span></span>
<span id="cb534-225"><a href="ch52_timeseries.html#cb534-225" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> AXIS_FONTSIZE, <span class="at">angle =</span> <span class="dv">30</span>)</span>
<span id="cb534-226"><a href="ch52_timeseries.html#cb534-226" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb534-227"><a href="ch52_timeseries.html#cb534-227" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb534-228"><a href="ch52_timeseries.html#cb534-228" aria-hidden="true" tabindex="-1"></a>    combined_plot_per_run <span class="ot">&lt;-</span></span>
<span id="cb534-229"><a href="ch52_timeseries.html#cb534-229" aria-hidden="true" tabindex="-1"></a>      ggpubr<span class="sc">::</span><span class="fu">ggarrange</span>(</span>
<span id="cb534-230"><a href="ch52_timeseries.html#cb534-230" aria-hidden="true" tabindex="-1"></a>        plot_list[[<span class="st">&quot;H&quot;</span>]],</span>
<span id="cb534-231"><a href="ch52_timeseries.html#cb534-231" aria-hidden="true" tabindex="-1"></a>        plot_list[[<span class="st">&quot;M&quot;</span>]],</span>
<span id="cb534-232"><a href="ch52_timeseries.html#cb534-232" aria-hidden="true" tabindex="-1"></a>        plot_list[[<span class="st">&quot;L&quot;</span>]],</span>
<span id="cb534-233"><a href="ch52_timeseries.html#cb534-233" aria-hidden="true" tabindex="-1"></a>        <span class="at">common.legend =</span> <span class="cn">FALSE</span>,</span>
<span id="cb534-234"><a href="ch52_timeseries.html#cb534-234" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb534-235"><a href="ch52_timeseries.html#cb534-235" aria-hidden="true" tabindex="-1"></a>        <span class="at">ncol =</span> <span class="dv">3</span>,</span>
<span id="cb534-236"><a href="ch52_timeseries.html#cb534-236" aria-hidden="true" tabindex="-1"></a>        <span class="at">nrow =</span> <span class="dv">1</span>,</span>
<span id="cb534-237"><a href="ch52_timeseries.html#cb534-237" aria-hidden="true" tabindex="-1"></a>        <span class="at">widths =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>),</span>
<span id="cb534-238"><a href="ch52_timeseries.html#cb534-238" aria-hidden="true" tabindex="-1"></a>        <span class="at">heights =</span> <span class="fu">c</span>(.<span class="dv">5</span>, .<span class="dv">5</span>, .<span class="dv">5</span>),</span>
<span id="cb534-239"><a href="ch52_timeseries.html#cb534-239" aria-hidden="true" tabindex="-1"></a>        <span class="at">align =</span> <span class="st">&quot;v&quot;</span></span>
<span id="cb534-240"><a href="ch52_timeseries.html#cb534-240" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb534-241"><a href="ch52_timeseries.html#cb534-241" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb534-242"><a href="ch52_timeseries.html#cb534-242" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Add the combined plot for this run type to the list for the current ROI</span></span>
<span id="cb534-243"><a href="ch52_timeseries.html#cb534-243" aria-hidden="true" tabindex="-1"></a>    plot_list_per_roi[[run_type]] <span class="ot">&lt;-</span> combined_plot_per_run</span>
<span id="cb534-244"><a href="ch52_timeseries.html#cb534-244" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb534-245"><a href="ch52_timeseries.html#cb534-245" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb534-246"><a href="ch52_timeseries.html#cb534-246" aria-hidden="true" tabindex="-1"></a>  } <span class="co"># end of run loop</span></span>
<span id="cb534-247"><a href="ch52_timeseries.html#cb534-247" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb534-248"><a href="ch52_timeseries.html#cb534-248" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ----------------------------------------------------------------------------</span></span>
<span id="cb534-249"><a href="ch52_timeseries.html#cb534-249" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                  add commom legend</span></span>
<span id="cb534-250"><a href="ch52_timeseries.html#cb534-250" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ----------------------------------------------------------------------------</span></span>
<span id="cb534-251"><a href="ch52_timeseries.html#cb534-251" aria-hidden="true" tabindex="-1"></a>  legend_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb534-252"><a href="ch52_timeseries.html#cb534-252" aria-hidden="true" tabindex="-1"></a>    <span class="at">sixcond =</span> <span class="fu">factor</span>(</span>
<span id="cb534-253"><a href="ch52_timeseries.html#cb534-253" aria-hidden="true" tabindex="-1"></a>      <span class="fu">c</span>(</span>
<span id="cb534-254"><a href="ch52_timeseries.html#cb534-254" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;cueH_stimH&quot;</span>,</span>
<span id="cb534-255"><a href="ch52_timeseries.html#cb534-255" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;cueL_stimH&quot;</span>,</span>
<span id="cb534-256"><a href="ch52_timeseries.html#cb534-256" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;cueH_stimM&quot;</span>,</span>
<span id="cb534-257"><a href="ch52_timeseries.html#cb534-257" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;cueL_stimM&quot;</span>,</span>
<span id="cb534-258"><a href="ch52_timeseries.html#cb534-258" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;cueH_stimL&quot;</span>,</span>
<span id="cb534-259"><a href="ch52_timeseries.html#cb534-259" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;cueL_stimL&quot;</span></span>
<span id="cb534-260"><a href="ch52_timeseries.html#cb534-260" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb534-261"><a href="ch52_timeseries.html#cb534-261" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb534-262"><a href="ch52_timeseries.html#cb534-262" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;#5f0f40&quot;</span>, <span class="st">&quot;#bc3908&quot;</span>, <span class="st">&quot;#f6aa1c&quot;</span>, <span class="st">&quot;#2541b2&quot;</span>, <span class="st">&quot;#00a6fb&quot;</span>),</span>
<span id="cb534-263"><a href="ch52_timeseries.html#cb534-263" aria-hidden="true" tabindex="-1"></a>    <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span></span>
<span id="cb534-264"><a href="ch52_timeseries.html#cb534-264" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb534-265"><a href="ch52_timeseries.html#cb534-265" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb534-266"><a href="ch52_timeseries.html#cb534-266" aria-hidden="true" tabindex="-1"></a>  legend_plot <span class="ot">&lt;-</span></span>
<span id="cb534-267"><a href="ch52_timeseries.html#cb534-267" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(legend_data, <span class="fu">aes</span>(<span class="at">x =</span> sixcond, <span class="at">y =</span> <span class="dv">1</span>, <span class="at">color =</span> sixcond)) <span class="sc">+</span></span>
<span id="cb534-268"><a href="ch52_timeseries.html#cb534-268" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb534-269"><a href="ch52_timeseries.html#cb534-269" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">values =</span> legend_data<span class="sc">$</span>color) <span class="sc">+</span></span>
<span id="cb534-270"><a href="ch52_timeseries.html#cb534-270" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb534-271"><a href="ch52_timeseries.html#cb534-271" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>) <span class="sc">+</span></span>
<span id="cb534-272"><a href="ch52_timeseries.html#cb534-272" aria-hidden="true" tabindex="-1"></a>    <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">title =</span> <span class="st">&quot;Condition&quot;</span>))</span>
<span id="cb534-273"><a href="ch52_timeseries.html#cb534-273" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb534-274"><a href="ch52_timeseries.html#cb534-274" aria-hidden="true" tabindex="-1"></a>  legend_grob <span class="ot">&lt;-</span></span>
<span id="cb534-275"><a href="ch52_timeseries.html#cb534-275" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplotGrob</span>(legend_plot)<span class="sc">$</span>grobs[[<span class="fu">which</span>(<span class="fu">sapply</span>(<span class="fu">ggplotGrob</span>(legend_plot)<span class="sc">$</span>grobs, <span class="cf">function</span>(x)</span>
<span id="cb534-276"><a href="ch52_timeseries.html#cb534-276" aria-hidden="true" tabindex="-1"></a>      x<span class="sc">$</span>name) <span class="sc">==</span> <span class="st">&quot;guide-box&quot;</span>)]]</span>
<span id="cb534-277"><a href="ch52_timeseries.html#cb534-277" aria-hidden="true" tabindex="-1"></a>  heights <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span>, <span class="fu">length</span>(run_types)), <span class="dv">2</span>)</span>
<span id="cb534-278"><a href="ch52_timeseries.html#cb534-278" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ----------------------------------------------------------------------------</span></span>
<span id="cb534-279"><a href="ch52_timeseries.html#cb534-279" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                  common axes for the 9 panels</span></span>
<span id="cb534-280"><a href="ch52_timeseries.html#cb534-280" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ----------------------------------------------------------------------------</span></span>
<span id="cb534-281"><a href="ch52_timeseries.html#cb534-281" aria-hidden="true" tabindex="-1"></a>  y_axis_label <span class="ot">&lt;-</span></span>
<span id="cb534-282"><a href="ch52_timeseries.html#cb534-282" aria-hidden="true" tabindex="-1"></a>    <span class="fu">textGrob</span>(</span>
<span id="cb534-283"><a href="ch52_timeseries.html#cb534-283" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;FIR BOLD </span><span class="sc">\n</span><span class="st">(high &gt; low cue; stimulus epoch)&quot;</span>,</span>
<span id="cb534-284"><a href="ch52_timeseries.html#cb534-284" aria-hidden="true" tabindex="-1"></a>      <span class="at">rot =</span> <span class="dv">90</span>,</span>
<span id="cb534-285"><a href="ch52_timeseries.html#cb534-285" aria-hidden="true" tabindex="-1"></a>      <span class="at">gp =</span> <span class="fu">gpar</span>(<span class="at">fontsize =</span> COMMONAXIS_FONTSIZE)</span>
<span id="cb534-286"><a href="ch52_timeseries.html#cb534-286" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb534-287"><a href="ch52_timeseries.html#cb534-287" aria-hidden="true" tabindex="-1"></a>    x_axis_label <span class="ot">&lt;-</span></span>
<span id="cb534-288"><a href="ch52_timeseries.html#cb534-288" aria-hidden="true" tabindex="-1"></a>    <span class="fu">textGrob</span>(</span>
<span id="cb534-289"><a href="ch52_timeseries.html#cb534-289" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;TR (0.46s per TR)&quot;</span>,</span>
<span id="cb534-290"><a href="ch52_timeseries.html#cb534-290" aria-hidden="true" tabindex="-1"></a>      <span class="at">rot =</span> <span class="dv">0</span>,</span>
<span id="cb534-291"><a href="ch52_timeseries.html#cb534-291" aria-hidden="true" tabindex="-1"></a>      <span class="at">gp =</span> <span class="fu">gpar</span>(<span class="at">fontsize =</span> COMMONAXIS_FONTSIZE)</span>
<span id="cb534-292"><a href="ch52_timeseries.html#cb534-292" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb534-293"><a href="ch52_timeseries.html#cb534-293" aria-hidden="true" tabindex="-1"></a>  num_rows <span class="ot">&lt;-</span> <span class="fu">length</span>(plot_list_per_roi) <span class="sc">+</span> <span class="dv">1</span>  <span class="co"># +1 for the legend</span></span>
<span id="cb534-294"><a href="ch52_timeseries.html#cb534-294" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ----------------------------------------------------------------------------</span></span>
<span id="cb534-295"><a href="ch52_timeseries.html#cb534-295" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                  combined plots across 3 tasks</span></span>
<span id="cb534-296"><a href="ch52_timeseries.html#cb534-296" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ----------------------------------------------------------------------------</span></span>
<span id="cb534-297"><a href="ch52_timeseries.html#cb534-297" aria-hidden="true" tabindex="-1"></a>  roi_combined_plot <span class="ot">&lt;-</span></span>
<span id="cb534-298"><a href="ch52_timeseries.html#cb534-298" aria-hidden="true" tabindex="-1"></a>    <span class="fu">do.call</span>(grid.arrange, <span class="fu">c</span>(plot_list_per_roi, <span class="at">ncol =</span> <span class="dv">1</span>))</span>
<span id="cb534-299"><a href="ch52_timeseries.html#cb534-299" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb534-300"><a href="ch52_timeseries.html#cb534-300" aria-hidden="true" tabindex="-1"></a>  final_plot <span class="ot">&lt;-</span> <span class="fu">grid.arrange</span>(</span>
<span id="cb534-301"><a href="ch52_timeseries.html#cb534-301" aria-hidden="true" tabindex="-1"></a>    y_axis_label,</span>
<span id="cb534-302"><a href="ch52_timeseries.html#cb534-302" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrangeGrob</span>(</span>
<span id="cb534-303"><a href="ch52_timeseries.html#cb534-303" aria-hidden="true" tabindex="-1"></a>      roi_combined_plot,</span>
<span id="cb534-304"><a href="ch52_timeseries.html#cb534-304" aria-hidden="true" tabindex="-1"></a>     x_axis_label,</span>
<span id="cb534-305"><a href="ch52_timeseries.html#cb534-305" aria-hidden="true" tabindex="-1"></a>      legend_grob,</span>
<span id="cb534-306"><a href="ch52_timeseries.html#cb534-306" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb534-307"><a href="ch52_timeseries.html#cb534-307" aria-hidden="true" tabindex="-1"></a>      <span class="at">ncol =</span> <span class="dv">1</span>,</span>
<span id="cb534-308"><a href="ch52_timeseries.html#cb534-308" aria-hidden="true" tabindex="-1"></a>      <span class="at">heights =</span> <span class="fu">c</span>(<span class="dv">11</span>,.<span class="dv">5</span>, <span class="dv">1</span>)</span>
<span id="cb534-309"><a href="ch52_timeseries.html#cb534-309" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb534-310"><a href="ch52_timeseries.html#cb534-310" aria-hidden="true" tabindex="-1"></a>    <span class="at">ncol =</span> <span class="dv">2</span>,</span>
<span id="cb534-311"><a href="ch52_timeseries.html#cb534-311" aria-hidden="true" tabindex="-1"></a>    <span class="at">widths =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">10</span>),    <span class="co"># Relative widths for the label, plots, and legend,</span></span>
<span id="cb534-312"><a href="ch52_timeseries.html#cb534-312" aria-hidden="true" tabindex="-1"></a>    <span class="at">top =</span> <span class="fu">textGrob</span>(<span class="fu">sprintf</span>(<span class="st">&quot;%s Time series per task&quot;</span>, roi), <span class="at">gp =</span> <span class="fu">gpar</span>(</span>
<span id="cb534-313"><a href="ch52_timeseries.html#cb534-313" aria-hidden="true" tabindex="-1"></a>      <span class="at">fontsize =</span> TITLE_FONTSIZE, <span class="at">fontface =</span> <span class="st">&quot;bold&quot;</span></span>
<span id="cb534-314"><a href="ch52_timeseries.html#cb534-314" aria-hidden="true" tabindex="-1"></a>    ))  <span class="co"># title parameter</span></span>
<span id="cb534-315"><a href="ch52_timeseries.html#cb534-315" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb534-316"><a href="ch52_timeseries.html#cb534-316" aria-hidden="true" tabindex="-1"></a>  <span class="fu">grid.draw</span>(final_plot)</span>
<span id="cb534-317"><a href="ch52_timeseries.html#cb534-317" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb534-318"><a href="ch52_timeseries.html#cb534-318" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb534-319"><a href="ch52_timeseries.html#cb534-319" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ----------------------------------------------------------------------------</span></span>
<span id="cb534-320"><a href="ch52_timeseries.html#cb534-320" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                 save all plots</span></span>
<span id="cb534-321"><a href="ch52_timeseries.html#cb534-321" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ----------------------------------------------------------------------------</span></span>
<span id="cb534-322"><a href="ch52_timeseries.html#cb534-322" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggsave</span>(<span class="fu">file.path</span>(</span>
<span id="cb534-323"><a href="ch52_timeseries.html#cb534-323" aria-hidden="true" tabindex="-1"></a>    save_dir,</span>
<span id="cb534-324"><a href="ch52_timeseries.html#cb534-324" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste0</span>(<span class="st">&quot;roi-&quot;</span>,</span>
<span id="cb534-325"><a href="ch52_timeseries.html#cb534-325" aria-hidden="true" tabindex="-1"></a>           roi ,</span>
<span id="cb534-326"><a href="ch52_timeseries.html#cb534-326" aria-hidden="true" tabindex="-1"></a>           <span class="st">&quot;_epoch-stim_desc-stimcuecomparison.png&quot;</span>)</span>
<span id="cb534-327"><a href="ch52_timeseries.html#cb534-327" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb534-328"><a href="ch52_timeseries.html#cb534-328" aria-hidden="true" tabindex="-1"></a>  all_plots[[roi]],</span>
<span id="cb534-329"><a href="ch52_timeseries.html#cb534-329" aria-hidden="true" tabindex="-1"></a>  <span class="at">width =</span> <span class="dv">12</span>,</span>
<span id="cb534-330"><a href="ch52_timeseries.html#cb534-330" aria-hidden="true" tabindex="-1"></a>  <span class="at">height =</span> <span class="dv">20</span>)</span>
<span id="cb534-331"><a href="ch52_timeseries.html#cb534-331" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</details>
<p><img src="52_iv-6cond_dv-firglasserSPM_ttl1_rois_files/figure-html/unnamed-chunk-15-1.png" width="960" /><img src="52_iv-6cond_dv-firglasserSPM_ttl1_rois_files/figure-html/unnamed-chunk-15-2.png" width="960" /><img src="52_iv-6cond_dv-firglasserSPM_ttl1_rois_files/figure-html/unnamed-chunk-15-3.png" width="960" /><img src="52_iv-6cond_dv-firglasserSPM_ttl1_rois_files/figure-html/unnamed-chunk-15-4.png" width="960" /></p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="taskwise-6-cond-effect.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": null,
"history": {
"link": "https://github.com/jungheejung/cue_expectancy/commits/main/52_iv-6cond_dv-firglasserSPM_ttl1_rois.Rmd",
"text": "Chapter edit history"
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "lunr",
"options": null
},
"toc": {
"collapse": "subsection",
"scroll_highlight": true
},
"toolbar": {
"position": "fixed"
},
"info": true
});
});
</script>

</body>

</html>
