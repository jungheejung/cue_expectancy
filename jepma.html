<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 6 beh :: expect-outcome ~ cue * trial | Your Document Title</title>
<meta name="author" content="Your Name">
<meta name="description" content="6.1 Overview The purpose of this markdown is to benchmark the plots from Jepma et al. (2018). Here, we plot the expectancy ratings and the actual ratings, with the high and low cues – in one...">
<meta name="generator" content="bookdown 0.37 with bs4_book()">
<meta property="og:title" content="Chapter 6 beh :: expect-outcome ~ cue * trial | Your Document Title">
<meta property="og:type" content="book">
<meta property="og:description" content="6.1 Overview The purpose of this markdown is to benchmark the plots from Jepma et al. (2018). Here, we plot the expectancy ratings and the actual ratings, with the high and low cues – in one...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 6 beh :: expect-outcome ~ cue * trial | Your Document Title">
<meta name="twitter:description" content="6.1 Overview The purpose of this markdown is to benchmark the plots from Jepma et al. (2018). Here, we plot the expectancy ratings and the actual ratings, with the high and low cues – in one...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.6.1/transition.js"></script><script src="libs/bs3compat-0.6.1/tabs.js"></script><script src="libs/bs3compat-0.6.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/htmlwidgets-1.6.4/htmlwidgets.js"></script><script src="libs/plotly-binding-4.10.4/plotly.js"></script><script src="libs/typedarray-0.1/typedarray.min.js"></script><link href="libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet">
<script src="libs/crosstalk-1.2.1/js/crosstalk.min.js"></script><link href="libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="libs/plotly-main-2.11.1/plotly-latest.min.js"></script><link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="libs/datatables-binding-0.31/datatables.js"></script><link href="libs/dt-core-1.13.6/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="libs/dt-core-1.13.6/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="libs/dt-core-1.13.6/js/jquery.dataTables.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<link rel="stylesheet" href="docute.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Your Document Title</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html"><span class="header-section-number">1</span> About</a></li>
<li class="book-part">Behavioral</li>
<li><a class="" href="beh-intro.html">Behavioral Rating analysis</a></li>
<li><a class="" href="beh-expect-cue.html"><span class="header-section-number">2</span> beh :: expectation ~ cue</a></li>
<li><a class="" href="beh-outcome-cue.html"><span class="header-section-number">3</span> beh :: outcome ~ cue</a></li>
<li><a class="" href="beh-outcome-stim.html"><span class="header-section-number">4</span> beh :: outcome ~ stim</a></li>
<li><a class="" href="beh-outcome-cueXstim.html"><span class="header-section-number">5</span> beh :: outcome ~ cue * stim</a></li>
<li><a class="active" href="jepma.html"><span class="header-section-number">6</span> beh :: expect-outcome ~ cue * trial</a></li>
<li><a class="" href="scaling.html"><span class="header-section-number">7</span> within / between subject effect and Scaling</a></li>
<li><a class="" href="variability.html"><span class="header-section-number">8</span> beh :: rating variability</a></li>
<li><a class="" href="cueeffects.html"><span class="header-section-number">9</span> beh :: Different scaling methods ~ Cue effects</a></li>
<li><a class="" href="demean-per-sub-n1.html"><span class="header-section-number">10</span> beh :: outcome_demean ~ cue * stim * expect * n-1outcome</a></li>
<li><a class="" href="mediation.html"><span class="header-section-number">11</span> beh :: Mediation</a></li>
<li><a class="" href="simulation.html"><span class="header-section-number">12</span> RL :: simulation</a></li>
<li><a class="" href="simulation_aryan.html"><span class="header-section-number">13</span> RL :: simulation Aryan</a></li>
<li><a class="" href="ch20_npssimulation.html"><span class="header-section-number">14</span> [model] NPSsimulation</a></li>
<li class="book-part">fMRI timeseries</li>
<li><a class="" href="fmri_time.html">fMRI timeseries</a></li>
<li><a class="" href="fir_ttl2.html"><span class="header-section-number">15</span> fMRI :: FIR ~ task</a></li>
<li><a class="" href="taskwise-stim-effect.html"><span class="header-section-number">16</span> taskwise stim effect</a></li>
<li><a class="" href="taskwise-6-cond-effect.html"><span class="header-section-number">17</span> taskwise 6 cond effect</a></li>
<li><a class="" href="fmritimeseries_tt1.html"><span class="header-section-number">18</span> fMRI :: FIR ~ task TTL1</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/jungheejung/cue_expectancy">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="jepma" class="section level1" number="6">
<h1>
<span class="header-section-number">6</span> beh :: expect-outcome ~ cue * trial<a class="anchor" aria-label="anchor" href="#jepma"><i class="fas fa-link"></i></a>
</h1>
<div id="overview" class="section level2" number="6.1">
<h2>
<span class="header-section-number">6.1</span> Overview<a class="anchor" aria-label="anchor" href="#overview"><i class="fas fa-link"></i></a>
</h2>
<p>The purpose of this markdown is to benchmark the plots from Jepma et al. (2018).
Here, we plot the expectancy ratings and the actual ratings, with the high and low cues – in one panel.</p>
<div id="some-thoughts-todos" class="section level3 unlisted unnumbered">
<h3>Some thoughts, TODOs<a class="anchor" aria-label="anchor" href="#some-thoughts-todos"><i class="fas fa-link"></i></a>
</h3>
<ul>
<li>plot 2. some runs were repeated or omitted for the subjects that have more than 72 trials. I need to identify that list and work on the behavioral data.</li>
<li>I need to check whether the counterbalancing was done correctly.</li>
</ul>
<p>load data and combine participant data</p>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">main_dir</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/basename.html">dirname</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/basename.html">dirname</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html">getwd</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">datadir</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">main_dir</span>, <span class="st">'data'</span>, <span class="st">'beh'</span>, <span class="st">'beh02_preproc'</span><span class="op">)</span></span>
<span><span class="co"># parameters _____________________________________ # nolint</span></span>
<span><span class="va">subject_varkey</span> <span class="op">&lt;-</span> <span class="st">"src_subject_id"</span></span>
<span><span class="va">iv</span> <span class="op">&lt;-</span> <span class="st">"param_cue_type"</span></span>
<span><span class="va">dv</span> <span class="op">&lt;-</span> <span class="st">"event03_RT"</span></span>
<span><span class="va">dv_keyword</span> <span class="op">&lt;-</span> <span class="st">"RT"</span></span>
<span><span class="va">xlab</span> <span class="op">&lt;-</span> <span class="st">""</span></span>
<span><span class="va">taskname</span> <span class="op">&lt;-</span> <span class="st">"pain"</span></span>
<span></span>
<span><span class="va">ylab</span> <span class="op">&lt;-</span> <span class="st">"ratings (degree)"</span></span>
<span><span class="va">subject</span> <span class="op">&lt;-</span> <span class="st">"subject"</span></span>
<span><span class="va">exclude</span> <span class="op">&lt;-</span> <span class="st">"sub-0001|sub-0003|sub-0004|sub-0005|sub-0025|sub-0999"</span> <span class="co">#/ "sub-0999|sub-0001|sub-0002|sub-0003|sub-0004|sub-0005|sub-0006|sub-0007|sub-0008|sub-0009|sub-0010|sub-0011"</span></span>
<span></span>
<span><span class="co"># load data _____________________________________</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu">df_load_beh</span><span class="op">(</span><span class="va">datadir</span>, taskname <span class="op">=</span> <span class="va">taskname</span>, subject_varkey <span class="op">=</span> <span class="va">subject_varkey</span>, iv <span class="op">=</span> <span class="va">iv</span>, exclude <span class="op">=</span> <span class="va">exclude</span><span class="op">)</span></span>
<span><span class="va">data</span><span class="op">$</span><span class="va">event03_RT</span> <span class="op">&lt;-</span> <span class="va">data</span><span class="op">$</span><span class="va">event03_stimulusC_reseponseonset</span> <span class="op">-</span> <span class="va">data</span><span class="op">$</span><span class="va">event03_stimulus_displayonset</span></span>
<span><span class="co"># data['event03_RT'], data.event03_RT - pandas</span></span>
<span><span class="va">analysis_dir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">main_dir</span>, <span class="st">"analysis"</span>, <span class="st">"mixedeffect"</span>, <span class="st">"model06_iv-cue-trial_dv-expect-actual"</span>, <span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html">Sys.Date</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/files2.html">dir.create</a></span><span class="op">(</span><span class="va">analysis_dir</span>, showWarnings <span class="op">=</span> <span class="cn">FALSE</span>, recursive <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span></code></pre></div>
<pre><code>##  src_subject_id     session_id    param_task_name    param_run_num   
##  Min.   :  2.00   Min.   :1.000   Length:6492        Min.   :-2.000  
##  1st Qu.: 37.00   1st Qu.:1.000   Class :character   1st Qu.: 2.000  
##  Median : 73.00   Median :3.000   Mode  :character   Median : 3.000  
##  Mean   : 69.86   Mean   :2.595                      Mean   : 3.462  
##  3rd Qu.:101.00   3rd Qu.:4.000                      3rd Qu.: 5.000  
##  Max.   :133.00   Max.   :4.000                      Max.   : 6.000  
##                                                                      
##  param_counterbalance_ver param_counterbalance_block_num param_cue_type    
##  Min.   :1.000            Min.   :1.000                  Length:6492       
##  1st Qu.:2.000            1st Qu.:1.000                  Class :character  
##  Median :3.000            Median :2.000                  Mode  :character  
##  Mean   :3.157            Mean   :1.503                                    
##  3rd Qu.:4.000            3rd Qu.:2.000                                    
##  Max.   :5.000            Max.   :2.000                                    
##                                                                            
##  param_stimulus_type param_cond_type param_trigger_onset param_start_biopac 
##  Length:6492         Min.   :1.0     Min.   :1.615e+09   Min.   :1.615e+09  
##  Class :character    1st Qu.:2.0     1st Qu.:1.627e+09   1st Qu.:1.627e+09  
##  Mode  :character    Median :3.5     Median :1.632e+09   Median :1.632e+09  
##                      Mean   :3.5     Mean   :1.634e+09   Mean   :1.634e+09  
##                      3rd Qu.:5.0     3rd Qu.:1.644e+09   3rd Qu.:1.644e+09  
##                      Max.   :6.0     Max.   :1.657e+09   Max.   :1.657e+09  
##                                                                             
##    ITI_onset           ITI_biopac         ITI_duration      event01_cue_onset  
##  Min.   :1.615e+09   Min.   :1.615e+09   Min.   : 0.00281   Min.   :1.615e+09  
##  1st Qu.:1.627e+09   1st Qu.:1.627e+09   1st Qu.: 1.56340   1st Qu.:1.627e+09  
##  Median :1.632e+09   Median :1.632e+09   Median : 3.26975   Median :1.632e+09  
##  Mean   :1.634e+09   Mean   :1.634e+09   Mean   : 4.44243   Mean   :1.634e+09  
##  3rd Qu.:1.644e+09   3rd Qu.:1.644e+09   3rd Qu.: 6.65337   3rd Qu.:1.644e+09  
##  Max.   :1.657e+09   Max.   :1.657e+09   Max.   :17.07488   Max.   :1.657e+09  
##                                                                                
##  event01_cue_biopac  event01_cue_type   event01_cue_filename
##  Min.   :1.615e+09   Length:6492        Length:6492         
##  1st Qu.:1.627e+09   Class :character   Class :character    
##  Median :1.632e+09   Mode  :character   Mode  :character    
##  Mean   :1.634e+09                                          
##  3rd Qu.:1.644e+09                                          
##  Max.   :1.657e+09                                          
##                                                             
##   ISI01_onset         ISI01_biopac       ISI01_duration   
##  Min.   :1.615e+09   Min.   :1.615e+09   Min.   :0.00396  
##  1st Qu.:1.627e+09   1st Qu.:1.627e+09   1st Qu.:0.99133  
##  Median :1.632e+09   Median :1.632e+09   Median :1.39215  
##  Mean   :1.634e+09   Mean   :1.634e+09   Mean   :1.47844  
##  3rd Qu.:1.644e+09   3rd Qu.:1.644e+09   3rd Qu.:1.98314  
##  Max.   :1.657e+09   Max.   :1.657e+09   Max.   :2.89685  
##                                                           
##  event02_expect_displayonset event02_expect_biopac event02_expect_responseonset
##  Min.   :1.615e+09           Min.   :1.615e+09     Min.   :1.615e+09           
##  1st Qu.:1.627e+09           1st Qu.:1.627e+09     1st Qu.:1.627e+09           
##  Median :1.632e+09           Median :1.632e+09     Median :1.632e+09           
##  Mean   :1.634e+09           Mean   :1.634e+09     Mean   :1.634e+09           
##  3rd Qu.:1.644e+09           3rd Qu.:1.644e+09     3rd Qu.:1.643e+09           
##  Max.   :1.657e+09           Max.   :1.657e+09     Max.   :1.657e+09           
##                                                    NA's   :661                 
##  event02_expect_RT event02_expect_angle event02_expect_angle_label
##  Min.   :0.6504    Min.   :  0.00       Length:6492               
##  1st Qu.:1.6341    1st Qu.: 30.18       Class :character          
##  Median :2.0517    Median : 58.56       Mode  :character          
##  Mean   :2.1397    Mean   : 62.94                                 
##  3rd Qu.:2.5678    3rd Qu.: 90.00                                 
##  Max.   :3.9912    Max.   :180.00                                 
##  NA's   :661       NA's   :661                                    
##   ISI02_onset         ISI02_biopac       ISI02_duration   
##  Min.   :1.615e+09   Min.   :1.615e+09   Min.   : 0.1422  
##  1st Qu.:1.627e+09   1st Qu.:1.627e+09   1st Qu.: 1.8599  
##  Median :1.632e+09   Median :1.632e+09   Median : 4.3664  
##  Mean   :1.634e+09   Mean   :1.634e+09   Mean   : 4.4542  
##  3rd Qu.:1.644e+09   3rd Qu.:1.644e+09   3rd Qu.: 6.2697  
##  Max.   :1.657e+09   Max.   :1.657e+09   Max.   :20.0723  
##                                                           
##  event03_stimulus_type event03_stimulus_displayonset event03_stimulus_biopac
##  Length:6492           Min.   :1.615e+09             Min.   :1.615e+09      
##  Class :character      1st Qu.:1.627e+09             1st Qu.:1.627e+09      
##  Mode  :character      Median :1.632e+09             Median :1.632e+09      
##                        Mean   :1.634e+09             Mean   :1.634e+09      
##                        3rd Qu.:1.644e+09             3rd Qu.:1.644e+09      
##                        Max.   :1.657e+09             Max.   :1.657e+09      
##                                                                             
##  event03_stimulus_C_stim_match event03_stimulusC_response
##  Mode:logical                  Min.   :0                 
##  NA's:6492                     1st Qu.:0                 
##                                Median :0                 
##                                Mean   :0                 
##                                3rd Qu.:0                 
##                                Max.   :0                 
##                                                          
##  event03_stimulusC_responsekeyname event03_stimulusC_reseponseonset
##  Mode:logical                      Min.   :0                       
##  NA's:6492                         1st Qu.:0                       
##                                    Median :0                       
##                                    Mean   :0                       
##                                    3rd Qu.:0                       
##                                    Max.   :0                       
##                                                                    
##  event03_stimulusC_RT  ISI03_onset         ISI03_biopac       ISI03_duration   
##  Min.   :0            Min.   :1.615e+09   Min.   :1.615e+09   Min.   : 0.4788  
##  1st Qu.:0            1st Qu.:1.627e+09   1st Qu.:1.627e+09   1st Qu.: 2.3846  
##  Median :0            Median :1.632e+09   Median :1.632e+09   Median : 4.0370  
##  Mean   :0            Mean   :1.634e+09   Mean   :1.634e+09   Mean   : 4.4870  
##  3rd Qu.:0            3rd Qu.:1.644e+09   3rd Qu.:1.644e+09   3rd Qu.: 5.8864  
##  Max.   :0            Max.   :1.657e+09   Max.   :1.657e+09   Max.   :17.6951  
##                                                                                
##  event04_actual_displayonset event04_actual_biopac event04_actual_responseonset
##  Min.   :1.615e+09           Min.   :1.615e+09     Min.   :1.615e+09           
##  1st Qu.:1.627e+09           1st Qu.:1.627e+09     1st Qu.:1.627e+09           
##  Median :1.632e+09           Median :1.632e+09     Median :1.631e+09           
##  Mean   :1.634e+09           Mean   :1.634e+09     Mean   :1.634e+09           
##  3rd Qu.:1.644e+09           3rd Qu.:1.644e+09     3rd Qu.:1.643e+09           
##  Max.   :1.657e+09           Max.   :1.657e+09     Max.   :1.657e+09           
##                                                    NA's   :638                 
##  event04_actual_RT event04_actual_angle event04_actual_angle_label
##  Min.   :0.0168    Min.   :  0.00       Length:6492               
##  1st Qu.:1.9197    1st Qu.: 38.80       Class :character          
##  Median :2.3510    Median : 60.77       Mode  :character          
##  Mean   :2.4005    Mean   : 66.33                                 
##  3rd Qu.:2.8512    3rd Qu.: 88.38                                 
##  Max.   :3.9930    Max.   :180.00                                 
##  NA's   :638       NA's   :641                                    
##  param_end_instruct_onset param_end_biopac    param_experiment_duration
##  Min.   :1.615e+09        Min.   :1.615e+09   Min.   :398.1            
##  1st Qu.:1.627e+09        1st Qu.:1.627e+09   1st Qu.:398.6            
##  Median :1.632e+09        Median :1.632e+09   Median :398.8            
##  Mean   :1.634e+09        Mean   :1.634e+09   Mean   :398.8            
##  3rd Qu.:1.644e+09        3rd Qu.:1.644e+09   3rd Qu.:399.0            
##  Max.   :1.657e+09        Max.   :1.657e+09   Max.   :399.5            
##                                                                        
##  event03_stimulus_P_trigger event03_stimulus_P_delay_between_medoc
##  Length:6492                Min.   :0                             
##  Class :character           1st Qu.:0                             
##  Mode  :character           Median :0                             
##                             Mean   :0                             
##                             3rd Qu.:0                             
##                             Max.   :0                             
##                                                                   
##  event03_stimulus_V_patientid event03_stimulus_V_filename
##  Mode:logical                 Mode:logical               
##  NA's:6492                    NA's:6492                  
##                                                          
##                                                          
##                                                          
##                                                          
##                                                          
##  event03_stimulus_C_stim_num event03_stimulus_C_stim_filename
##  Min.   :0                   Mode:logical                    
##  1st Qu.:0                   NA's:6492                       
##  Median :0                                                   
##  Mean   :0                                                   
##  3rd Qu.:0                                                   
##  Max.   :0                                                   
##                                                              
##  delay_between_medoc    subject       event03_RT        
##  Min.   :0.01409     98     :  96   Min.   :-1.657e+09  
##  1st Qu.:0.03728     6      :  72   1st Qu.:-1.644e+09  
##  Median :0.04537     9      :  72   Median :-1.632e+09  
##  Mean   :0.04818     10     :  72   Mean   :-1.634e+09  
##  3rd Qu.:0.05712     18     :  72   3rd Qu.:-1.627e+09  
##  Max.   :2.03502     29     :  72   Max.   :-1.615e+09  
##                      (Other):6036</code></pre>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># data(data, package = 'visibly')</span></span>
<span></span>
<span><span class="va">myvars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span> <span class="st">"event02_expect_angle"</span>, <span class="st">"event02_expect_RT"</span>, <span class="st">"event04_actual_angle"</span>, <span class="st">"event04_actual_RT"</span>, <span class="st">"event01_cue_onset"</span><span class="op">)</span></span>
<span><span class="va">newdata</span> <span class="op">&lt;-</span> <span class="va">data</span><span class="op">[</span><span class="va">myvars</span><span class="op">]</span></span>
<span><span class="co"># numdata  &lt;- unlist(lapply(data, is.numeric), use.names = FALSE)</span></span>
<span><span class="va">data_naomit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html">na.omit</a></span><span class="op">(</span><span class="va">newdata</span><span class="op">)</span></span>
<span><span class="va">cor_matrix</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span><span class="va">data_naomit</span><span class="op">)</span></span>
<span><span class="fu">corr_heat</span><span class="op">(</span><span class="va">cor_matrix</span><span class="op">)</span></span></code></pre></div>
<pre><code>## No FA options specified, using psych package defaults.</code></pre>
<pre><code>## Warning in fac(r = r, nfactors = nfactors, n.obs = n.obs, rotate = rotate, : I
## am sorry, to do these rotations requires the GPArotation package to be
## installed</code></pre>
<div class="plotly html-widget html-fill-item" id="htmlwidget-ecdce883544827f9d898" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-ecdce883544827f9d898">{"x":{"visdat":{"223023365671":["function () ","plotlyVisDat"]},"cur_data":"223023365671","attrs":{"223023365671":{"z":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"heatmap","colors":["#590007","#590007","#5B0107","#5C0108","#5D0207","#5D0207","#5E0308","#5F0308","#600407","#610507","#620606","#620606","#630707","#640807","#650906","#660906","#670A07","#670B07","#680C06","#690C06","#6A0D06","#6B0D06","#6C0E07","#6C0F07","#6D1006","#6E1006","#6F1107","#701207","#711306","#721306","#731405","#731405","#741506","#751606","#761705","#771705","#781806","#791906","#7A1A05","#7B1A06","#7C1B06","#7D1C06","#7E1D05","#7E1D06","#7F1E06","#801E06","#822006","#832106","#842105","#852206","#862206","#872406","#882506","#892606","#8A2605","#8B2706","#8C2806","#8D2905","#8E2A05","#8F2B06","#902C06","#912D05","#932E05","#942F06","#953006","#963107","#973206","#983307","#993407","#9A3508","#9B3608","#9C3709","#9E3809","#9F390A","#A03B0A","#A13C0B","#A23D0C","#A33E0D","#A43F0E","#A5410F","#A6420F","#A74310","#A84411","#A94612","#AA4713","#AB4914","#AC4915","#AE4A16","#AE4B17","#AF4D19","#AF4E1A","#B1501C","#B2511D","#B2521E","#B3531F","#B4531F","#B55521","#B55622","#B65824","#B65925","#B75A26","#B75B27","#B85C28","#B95D29","#BA5E2A","#BA5F2C","#BB602D","#BB612E","#BC622F","#BC6330","#BD6431","#BD6432","#BE6533","#BD6635","#BE6736","#BE6837","#BF6938","#BF6A39","#C06B3A","#C06C3B","#C16D3C","#C16D3E","#C26E3F","#C16F40","#C27041","#C27142","#C37243","#C37344","#C47446","#C47447","#C57548","#C57649","#C6774A","#C5784B","#C67A4D","#C67A4E","#C77B50","#C87C51","#C87C51","#C97E53","#C87F54","#C98056","#C98157","#CA8258","#CA8259","#CB835A","#CB845B","#CC855D","#CB865E","#CC875F","#CC8860","#CD8961","#CD8A63","#CE8B64","#CE8B65","#CF8C66","#CE8D67","#CF8E68","#CF8F6A","#D0906B","#D0916C","#D1926D","#D1936F","#D29470","#D29471","#D39572","#D29673","#D39775","#D39876","#D49977","#D49A78","#D59B7A","#D59C7B","#D69D7C","#D59E7D","#D69F7F","#D69F80","#D7A081","#D7A182","#D8A284","#D8A385","#D9A486","#DAA688","#DAA789","#DBA88B","#DAA98C","#DBAA8D","#DBAB8E","#DCAC90","#DCAD91","#DDAE93","#DDAF94","#DEB095","#DEB196","#DFB298","#DEB399","#DFB49A","#DFB59B","#E0B69D","#E0B79F","#E1B8A0","#E1B9A1","#E2BAA2","#E2BBA4","#E3BCA5","#E3BDA7","#E4BEA8","#E3BEA9","#E4BFAA","#E4C0AC","#E5C1AE","#E5C3AF","#E6C4B0","#E6C5B1","#E7C6B2","#E7C7B4","#E8C8B6","#E8C9B7","#E9CAB8","#E8CBB9","#E9CCBB","#E9CDBC","#EACEBE","#EACFBF","#EBD0C1","#EBD0C2","#EBD1C3","#EBD3C5","#ECD4C6","#EDD5C8","#ECD6C9","#EDD7CB","#EDD8CC","#EED9CD","#EEDACE","#EDDBD0","#EDDCD1","#EEDDD3","#EEDDD4","#EEDED5","#EEDFD6","#EDE0D8","#EDE0D9","#EEE1DA","#EEE2DB","#EDE3DC","#EDE3DD","#ECE4DE","#ECE4DF","#EBE5E0","#EBE5E1","#EAE6E2","#EAE5E3","#E9E6E4","#E8E6E4","#E7E7E5","#E7E7E6","#E6E6E7","#E5E6E7","#E3E7E7","#E2E7E7","#E1E6E8","#E0E6E8","#DFE5E9","#DEE6E9","#DCE5E8","#DBE5E8","#D9E4E9","#D8E4E9","#D6E3E8","#D5E3E8","#D3E2E9","#D2E1E9","#D0E0E8","#CEDFE7","#CDDFE7","#CBDEE7","#CADDE7","#C8DCE6","#C7DBE6","#C5DAE5","#C4DAE5","#C2D9E4","#C1D8E4","#BFD7E3","#BED6E3","#BCD5E2","#BBD5E2","#B9D4E1","#B7D3E1","#B5D2E0","#B3D1DF","#B2D0DE","#B0CFDE","#AFCEDD","#ADCDDD","#ACCCDC","#AACBDC","#A9CADB","#A7C9DA","#A5C8D9","#A3C7D9","#A1C6D8","#A0C5D8","#9EC4D7","#9DC4D6","#9BC3D5","#9AC2D5","#98C1D4","#97C0D4","#95BFD3","#94BED2","#92BDD1","#90BCD1","#8EBBD0","#8DBAD0","#8BB9CF","#8AB8CE","#88B6CD","#86B5CC","#85B4CC","#83B3CB","#81B2CA","#7FB1C9","#7EB0C9","#7CAFC8","#7BAEC8","#79ADC7","#78ACC6","#76ABC5","#75AAC5","#73A9C4","#72A8C4","#70A7C3","#6EA6C2","#6CA5C1","#6AA4C1","#69A3C0","#67A2C0","#66A1BF","#64A0BE","#639FBD","#619EBD","#5F9DBC","#5D9CBB","#5B9BBA","#5A9ABA","#5999B9","#5798B9","#5597B8","#5496B7","#5295B6","#5194B6","#4F93B5","#4E92B4","#4C91B3","#4B90B3","#498EB2","#488DB2","#468BB1","#458BB0","#438AAF","#4289AF","#4087AE","#3E86AC","#3D85AC","#3B84AB","#3A83AB","#3882AA","#3781A9","#3580A8","#347FA8","#327EA7","#317DA6","#2F7CA5","#2E7BA5","#2C7AA4","#2B79A4","#2A78A3","#2977A2","#2776A1","#2575A1","#2474A0","#2373A0","#22729F","#20719E","#1F709D","#1E6F9D","#1D6E9C","#1C6D9C","#1B6C9B","#196B9A","#186A99","#176999","#166898","#156798","#146697","#136697","#126596","#116496","#106395","#106294","#0F6193","#0E6093","#0C5E92","#0C5E92","#0B5D91","#0B5D91","#0A5C90","#085A8F","#08598F","#07588E","#07578D","#06568C","#06568C","#05558B","#06548B","#05538A","#05528A","#045189","#055189","#045088","#044F88","#034E87","#034D87","#044C86","#044C86","#034B85","#034A85","#024984","#024984","#034883","#034783","#024682","#024582","#024481","#024481","#034380","#034280","#02417F","#02417F","#03407E","#033F7E","#023E7D","#023E7D","#033D7C","#033C7C","#023B7B","#023A7B","#01397A","#01397A","#023879","#023779","#013678","#013577","#023477","#013376","#013376","#023275","#023175","#013074","#013074","#022F73","#022E73","#012D72","#012D72","#022C71","#022B71","#012A70","#012A70","#02296F","#02286F","#01276E","#01276E","#02266D","#02256D","#02246C","#02236C","#01226B","#01226B","#02216A","#02206A","#011F69","#021F69","#011E68","#011D68","#021C67","#021C67","#011B66","#011A66","#001965","#001865","#011764","#011764","#001663","#001563","#011462","#011462","#001361","#001260"],"inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"scene":{"zaxis":{"title":"cormat"}},"xaxis":{"domain":[0,1],"automargin":true,"tickmode":"array","tickvals":[0,1,2,3,4],"ticktext":["event04_actual_angle","event02_expect_angle","event01_cue_onset","event04_actual_RT","event02_expect_RT"],"gridcolor":"transparent","zerolinecolor":"transparent","title":"","zeroline":false,"showgrid":false},"yaxis":{"domain":[0,1],"automargin":true,"tickmode":"array","tickvals":[0,1,2,3,4],"ticktext":["event04_actual_angle","event02_expect_angle","event01_cue_onset","event04_actual_RT","event02_expect_RT"],"gridcolor":"transparent","zerolinecolor":"transparent","title":"","autorange":"reversed","zeroline":false,"showgrid":false},"hovermode":"closest","showlegend":false,"legend":{"yanchor":"top","y":0.5},"plot_bgcolor":"transparent","paper_bgcolor":"transparent"},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false,"displayModeBar":false},"data":[{"colorbar":{"title":"cormat","ticklen":2,"len":0.5,"lenmode":"fraction","y":1,"yanchor":"top"},"colorscale":[["0","rgba(89,0,7,1)"],["0.0416666666666667","rgba(107,13,6,1)"],["0.0833333333333333","rgba(126,29,5,1)"],["0.125","rgba(147,46,5,1)"],["0.166666666666667","rgba(169,70,18,1)"],["0.208333333333333","rgba(186,94,42,1)"],["0.25","rgba(194,113,66,1)"],["0.291666666666667","rgba(203,132,91,1)"],["0.333333333333333","rgba(210,150,116,1)"],["0.375","rgba(219,171,142,1)"],["0.416666666666667","rgba(228,191,170,1)"],["0.458333333333333","rgba(237,213,199,1)"],["0.5","rgba(235,229,225,1)"],["0.541666666666667","rgba(212,227,232,1)"],["0.583333333333333","rgba(179,209,223,1)"],["0.625","rgba(146,189,209,1)"],["0.666666666666667","rgba(113,167,195,1)"],["0.708333333333333","rgba(79,147,181,1)"],["0.75","rgba(47,124,165,1)"],["0.791666666666667","rgba(21,103,152,1)"],["0.833333333333333","rgba(6,84,139,1)"],["0.875","rgba(3,67,128,1)"],["0.916666666666667","rgba(1,51,118,1)"],["0.958333333333333","rgba(1,34,107,1)"],["1","rgba(0,18,96,1)"]],"showscale":true,"z":[[1,0.64286812027634033,-0.14504336112570634,-0.16347972254149309,-0.060141478448381316],[0.64286812027634033,1,-0.12246175653222982,-0.13459621502938438,-0.067315155713631405],[-0.14504336112570634,-0.12246175653222982,1,0.080517199615948179,0.056113525117006839],[-0.16347972254149309,-0.13459621502938438,0.080517199615948179,1,0.27736553205011194],[-0.060141478448381316,-0.067315155713631405,0.056113525117006839,0.27736553205011194,1]],"type":"heatmap","xaxis":"x","yaxis":"y","frame":null,"zmin":-1,"zmax":1}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script><div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ISIvars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span> <span class="st">"ISI01_duration"</span>, <span class="st">"ISI02_duration"</span>, <span class="st">"ISI03_duration"</span><span class="op">)</span></span>
<span><span class="va">ISIdata</span> <span class="op">&lt;-</span> <span class="va">data</span><span class="op">[</span><span class="va">ISIvars</span><span class="op">]</span></span>
<span><span class="co"># numdata  &lt;- unlist(lapply(data, is.numeric), use.names = FALSE)</span></span>
<span><span class="va">ISIdata_naomit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html">na.omit</a></span><span class="op">(</span><span class="va">ISIdata</span><span class="op">)</span></span>
<span><span class="va">ISIcor_matrix</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span><span class="va">ISIdata_naomit</span><span class="op">)</span></span>
<span><span class="fu">corr_heat</span><span class="op">(</span><span class="va">ISIcor_matrix</span><span class="op">)</span></span></code></pre></div>
<pre><code>## No FA options specified, using psych package defaults.</code></pre>
<div class="plotly html-widget html-fill-item" id="htmlwidget-83052348d4cb9bdb7992" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-83052348d4cb9bdb7992">{"x":{"visdat":{"22304cd4b43e":["function () ","plotlyVisDat"]},"cur_data":"22304cd4b43e","attrs":{"22304cd4b43e":{"z":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"heatmap","colors":["#590007","#590007","#5B0107","#5C0108","#5D0207","#5D0207","#5E0308","#5F0308","#600407","#610507","#620606","#620606","#630707","#640807","#650906","#660906","#670A07","#670B07","#680C06","#690C06","#6A0D06","#6B0D06","#6C0E07","#6C0F07","#6D1006","#6E1006","#6F1107","#701207","#711306","#721306","#731405","#731405","#741506","#751606","#761705","#771705","#781806","#791906","#7A1A05","#7B1A06","#7C1B06","#7D1C06","#7E1D05","#7E1D06","#7F1E06","#801E06","#822006","#832106","#842105","#852206","#862206","#872406","#882506","#892606","#8A2605","#8B2706","#8C2806","#8D2905","#8E2A05","#8F2B06","#902C06","#912D05","#932E05","#942F06","#953006","#963107","#973206","#983307","#993407","#9A3508","#9B3608","#9C3709","#9E3809","#9F390A","#A03B0A","#A13C0B","#A23D0C","#A33E0D","#A43F0E","#A5410F","#A6420F","#A74310","#A84411","#A94612","#AA4713","#AB4914","#AC4915","#AE4A16","#AE4B17","#AF4D19","#AF4E1A","#B1501C","#B2511D","#B2521E","#B3531F","#B4531F","#B55521","#B55622","#B65824","#B65925","#B75A26","#B75B27","#B85C28","#B95D29","#BA5E2A","#BA5F2C","#BB602D","#BB612E","#BC622F","#BC6330","#BD6431","#BD6432","#BE6533","#BD6635","#BE6736","#BE6837","#BF6938","#BF6A39","#C06B3A","#C06C3B","#C16D3C","#C16D3E","#C26E3F","#C16F40","#C27041","#C27142","#C37243","#C37344","#C47446","#C47447","#C57548","#C57649","#C6774A","#C5784B","#C67A4D","#C67A4E","#C77B50","#C87C51","#C87C51","#C97E53","#C87F54","#C98056","#C98157","#CA8258","#CA8259","#CB835A","#CB845B","#CC855D","#CB865E","#CC875F","#CC8860","#CD8961","#CD8A63","#CE8B64","#CE8B65","#CF8C66","#CE8D67","#CF8E68","#CF8F6A","#D0906B","#D0916C","#D1926D","#D1936F","#D29470","#D29471","#D39572","#D29673","#D39775","#D39876","#D49977","#D49A78","#D59B7A","#D59C7B","#D69D7C","#D59E7D","#D69F7F","#D69F80","#D7A081","#D7A182","#D8A284","#D8A385","#D9A486","#DAA688","#DAA789","#DBA88B","#DAA98C","#DBAA8D","#DBAB8E","#DCAC90","#DCAD91","#DDAE93","#DDAF94","#DEB095","#DEB196","#DFB298","#DEB399","#DFB49A","#DFB59B","#E0B69D","#E0B79F","#E1B8A0","#E1B9A1","#E2BAA2","#E2BBA4","#E3BCA5","#E3BDA7","#E4BEA8","#E3BEA9","#E4BFAA","#E4C0AC","#E5C1AE","#E5C3AF","#E6C4B0","#E6C5B1","#E7C6B2","#E7C7B4","#E8C8B6","#E8C9B7","#E9CAB8","#E8CBB9","#E9CCBB","#E9CDBC","#EACEBE","#EACFBF","#EBD0C1","#EBD0C2","#EBD1C3","#EBD3C5","#ECD4C6","#EDD5C8","#ECD6C9","#EDD7CB","#EDD8CC","#EED9CD","#EEDACE","#EDDBD0","#EDDCD1","#EEDDD3","#EEDDD4","#EEDED5","#EEDFD6","#EDE0D8","#EDE0D9","#EEE1DA","#EEE2DB","#EDE3DC","#EDE3DD","#ECE4DE","#ECE4DF","#EBE5E0","#EBE5E1","#EAE6E2","#EAE5E3","#E9E6E4","#E8E6E4","#E7E7E5","#E7E7E6","#E6E6E7","#E5E6E7","#E3E7E7","#E2E7E7","#E1E6E8","#E0E6E8","#DFE5E9","#DEE6E9","#DCE5E8","#DBE5E8","#D9E4E9","#D8E4E9","#D6E3E8","#D5E3E8","#D3E2E9","#D2E1E9","#D0E0E8","#CEDFE7","#CDDFE7","#CBDEE7","#CADDE7","#C8DCE6","#C7DBE6","#C5DAE5","#C4DAE5","#C2D9E4","#C1D8E4","#BFD7E3","#BED6E3","#BCD5E2","#BBD5E2","#B9D4E1","#B7D3E1","#B5D2E0","#B3D1DF","#B2D0DE","#B0CFDE","#AFCEDD","#ADCDDD","#ACCCDC","#AACBDC","#A9CADB","#A7C9DA","#A5C8D9","#A3C7D9","#A1C6D8","#A0C5D8","#9EC4D7","#9DC4D6","#9BC3D5","#9AC2D5","#98C1D4","#97C0D4","#95BFD3","#94BED2","#92BDD1","#90BCD1","#8EBBD0","#8DBAD0","#8BB9CF","#8AB8CE","#88B6CD","#86B5CC","#85B4CC","#83B3CB","#81B2CA","#7FB1C9","#7EB0C9","#7CAFC8","#7BAEC8","#79ADC7","#78ACC6","#76ABC5","#75AAC5","#73A9C4","#72A8C4","#70A7C3","#6EA6C2","#6CA5C1","#6AA4C1","#69A3C0","#67A2C0","#66A1BF","#64A0BE","#639FBD","#619EBD","#5F9DBC","#5D9CBB","#5B9BBA","#5A9ABA","#5999B9","#5798B9","#5597B8","#5496B7","#5295B6","#5194B6","#4F93B5","#4E92B4","#4C91B3","#4B90B3","#498EB2","#488DB2","#468BB1","#458BB0","#438AAF","#4289AF","#4087AE","#3E86AC","#3D85AC","#3B84AB","#3A83AB","#3882AA","#3781A9","#3580A8","#347FA8","#327EA7","#317DA6","#2F7CA5","#2E7BA5","#2C7AA4","#2B79A4","#2A78A3","#2977A2","#2776A1","#2575A1","#2474A0","#2373A0","#22729F","#20719E","#1F709D","#1E6F9D","#1D6E9C","#1C6D9C","#1B6C9B","#196B9A","#186A99","#176999","#166898","#156798","#146697","#136697","#126596","#116496","#106395","#106294","#0F6193","#0E6093","#0C5E92","#0C5E92","#0B5D91","#0B5D91","#0A5C90","#085A8F","#08598F","#07588E","#07578D","#06568C","#06568C","#05558B","#06548B","#05538A","#05528A","#045189","#055189","#045088","#044F88","#034E87","#034D87","#044C86","#044C86","#034B85","#034A85","#024984","#024984","#034883","#034783","#024682","#024582","#024481","#024481","#034380","#034280","#02417F","#02417F","#03407E","#033F7E","#023E7D","#023E7D","#033D7C","#033C7C","#023B7B","#023A7B","#01397A","#01397A","#023879","#023779","#013678","#013577","#023477","#013376","#013376","#023275","#023175","#013074","#013074","#022F73","#022E73","#012D72","#012D72","#022C71","#022B71","#012A70","#012A70","#02296F","#02286F","#01276E","#01276E","#02266D","#02256D","#02246C","#02236C","#01226B","#01226B","#02216A","#02206A","#011F69","#021F69","#011E68","#011D68","#021C67","#021C67","#011B66","#011A66","#001965","#001865","#011764","#011764","#001663","#001563","#011462","#011462","#001361","#001260"],"inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"scene":{"zaxis":{"title":"cormat"}},"xaxis":{"domain":[0,1],"automargin":true,"tickmode":"array","tickvals":[0,1,2],"ticktext":["ISI02_duration","ISI01_duration","ISI03_duration"],"gridcolor":"transparent","zerolinecolor":"transparent","title":"","zeroline":false,"showgrid":false},"yaxis":{"domain":[0,1],"automargin":true,"tickmode":"array","tickvals":[0,1,2],"ticktext":["ISI02_duration","ISI01_duration","ISI03_duration"],"gridcolor":"transparent","zerolinecolor":"transparent","title":"","autorange":"reversed","zeroline":false,"showgrid":false},"hovermode":"closest","showlegend":false,"legend":{"yanchor":"top","y":0.5},"plot_bgcolor":"transparent","paper_bgcolor":"transparent"},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false,"displayModeBar":false},"data":[{"colorbar":{"title":"cormat","ticklen":2,"len":0.5,"lenmode":"fraction","y":1,"yanchor":"top"},"colorscale":[["0","rgba(89,0,7,1)"],["0.0416666666666667","rgba(107,13,6,1)"],["0.0833333333333333","rgba(126,29,5,1)"],["0.125","rgba(147,46,5,1)"],["0.166666666666667","rgba(169,70,18,1)"],["0.208333333333333","rgba(186,94,42,1)"],["0.25","rgba(194,113,66,1)"],["0.291666666666667","rgba(203,132,91,1)"],["0.333333333333333","rgba(210,150,116,1)"],["0.375","rgba(219,171,142,1)"],["0.416666666666667","rgba(228,191,170,1)"],["0.458333333333333","rgba(237,213,199,1)"],["0.5","rgba(235,229,225,1)"],["0.541666666666667","rgba(212,227,232,1)"],["0.583333333333333","rgba(179,209,223,1)"],["0.625","rgba(146,189,209,1)"],["0.666666666666667","rgba(113,167,195,1)"],["0.708333333333333","rgba(79,147,181,1)"],["0.75","rgba(47,124,165,1)"],["0.791666666666667","rgba(21,103,152,1)"],["0.833333333333333","rgba(6,84,139,1)"],["0.875","rgba(3,67,128,1)"],["0.916666666666667","rgba(1,51,118,1)"],["0.958333333333333","rgba(1,34,107,1)"],["1","rgba(0,18,96,1)"]],"showscale":true,"z":[[1,0.1049823877106395,0.06860303616842478],[0.1049823877106395,1,-0.055944339777556466],[0.06860303616842478,-0.055944339777556466,1]],"type":"heatmap","xaxis":"x","yaxis":"y","frame":null,"zmin":-1,"zmax":1}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script><div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">car</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/car/man/vif.html">vif</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">event04_actual_angle</span> <span class="op">~</span>  <span class="va">event02_expect_angle</span> <span class="op">+</span> <span class="va">event02_expect_RT</span> <span class="op">+</span> <span class="va">event04_actual_RT</span>, dat <span class="op">=</span> <span class="va">data_naomit</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code>## event02_expect_angle    event02_expect_RT    event04_actual_RT 
##             1.019462             1.084419             1.099422</code></pre>
</div>
</div>
<div id="plot-1---one-run-average-across-participants" class="section level2" number="6.2">
<h2>
<span class="header-section-number">6.2</span> plot 1 - one run, average across participants<a class="anchor" aria-label="anchor" href="#plot-1---one-run-average-across-participants"><i class="fas fa-link"></i></a>
</h2>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># subject # run # param_cue # param_stim # rating_type # rating_value</span></span>
<span></span>
<span><span class="va">data_trial</span><span class="op">=</span> <span class="va">data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">arrange</span><span class="op">(</span><span class="va">src_subject_id</span>, <span class="va">session_id</span>, <span class="va">param_run_num</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">src_subject_id</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>trial_index <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep_len</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">12</span>, length.out <span class="op">=</span> <span class="fu">n</span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data_long</span> <span class="op">=</span> <span class="va">data_trial</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">pivot_longer</span><span class="op">(</span>cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'event02_expect_angle'</span>, <span class="st">'event04_actual_angle'</span><span class="op">)</span>,</span>
<span>               names_to <span class="op">=</span> <span class="st">"rating_type"</span>,</span>
<span>               values_to <span class="op">=</span> <span class="st">"rating_value"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># # PLOT</span></span>
<span>    <span class="va">data_long</span><span class="op">$</span><span class="va">cue_name</span><span class="op">[</span><span class="va">data_long</span><span class="op">$</span><span class="va">param_cue_type</span> <span class="op">==</span> <span class="st">"high_cue"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"high cue"</span></span></code></pre></div>
<pre><code>## Warning: Unknown or uninitialised column: `cue_name`.</code></pre>
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>    <span class="va">data_long</span><span class="op">$</span><span class="va">cue_name</span><span class="op">[</span><span class="va">data_long</span><span class="op">$</span><span class="va">param_cue_type</span> <span class="op">==</span> <span class="st">"low_cue"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"low cue"</span></span>
<span></span>
<span>    <span class="va">data_long</span><span class="op">$</span><span class="va">stim_name</span><span class="op">[</span><span class="va">data_long</span><span class="op">$</span><span class="va">param_stimulus_type</span> <span class="op">==</span> <span class="st">"high_stim"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"high"</span></span></code></pre></div>
<pre><code>## Warning: Unknown or uninitialised column: `stim_name`.</code></pre>
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>    <span class="va">data_long</span><span class="op">$</span><span class="va">stim_name</span><span class="op">[</span><span class="va">data_long</span><span class="op">$</span><span class="va">param_stimulus_type</span> <span class="op">==</span> <span class="st">"med_stim"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"med"</span></span>
<span>    <span class="va">data_long</span><span class="op">$</span><span class="va">stim_name</span><span class="op">[</span><span class="va">data_long</span><span class="op">$</span><span class="va">param_stimulus_type</span> <span class="op">==</span> <span class="st">"low_stim"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"low"</span></span>
<span></span>
<span>    <span class="va">data_long</span><span class="op">$</span><span class="va">stim_ordered</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span></span>
<span>        <span class="va">data_long</span><span class="op">$</span><span class="va">stim_name</span>,</span>
<span>        levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"low"</span>, <span class="st">"med"</span>, <span class="st">"high"</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>    <span class="va">data_long</span><span class="op">$</span><span class="va">cue_ordered</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span></span>
<span>        <span class="va">data_long</span><span class="op">$</span><span class="va">cue_name</span>,</span>
<span>        levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"low cue"</span>, <span class="st">"high cue"</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>    <span class="va">subject</span> <span class="op">&lt;-</span> <span class="st">"src_subject_id"</span></span>
<span>    <span class="va">model_iv1</span> <span class="op">&lt;-</span> <span class="st">"stim_ordered"</span></span>
<span>    <span class="va">model_iv2</span> <span class="op">&lt;-</span> <span class="st">"cue_ordered"</span></span>
<span>    <span class="va">rating</span> <span class="op">&lt;-</span> <span class="st">"rating_type"</span></span>
<span>    <span class="va">dv</span> <span class="op">&lt;-</span> <span class="st">"rating_value"</span></span>
<span>    <span class="va">trialorder_subjectwise</span> <span class="op">&lt;-</span> <span class="fu">meanSummary</span><span class="op">(</span></span>
<span>        <span class="va">data_long</span>,</span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">subject</span>, <span class="va">model_iv2</span>, <span class="va">rating</span>, <span class="st">"trial_index"</span><span class="op">)</span>, <span class="va">dv</span></span>
<span>    <span class="op">)</span></span>
<span></span>
<span>    <span class="va">subjectwise_naomit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html">na.omit</a></span><span class="op">(</span><span class="va">trialorder_subjectwise</span><span class="op">)</span></span>
<span></span>
<span>    <span class="va">trialorder_groupwise</span> <span class="op">&lt;-</span> <span class="fu">summarySEwithin</span><span class="op">(</span></span>
<span>        data <span class="op">=</span> <span class="va">subjectwise_naomit</span>,</span>
<span>        measurevar <span class="op">=</span> <span class="st">"mean_per_sub"</span>,</span>
<span>        withinvars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"cue_ordered"</span>, <span class="st">"rating_type"</span>,  <span class="st">"trial_index"</span><span class="op">)</span>, idvar <span class="op">=</span> <span class="va">subject</span></span>
<span>    <span class="op">)</span></span></code></pre></div>
<pre><code>## Automatically converting the following non-factors to factors: rating_type, trial_index</code></pre>
<div class="sourceCode" id="cb60"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">trialorder_subjectwise</span><span class="op">$</span><span class="va">rating_type_key</span> <span class="op">&lt;-</span> <span class="fu">mapvalues</span><span class="op">(</span><span class="va">trialorder_subjectwise</span><span class="op">$</span><span class="va">rating_type</span>,</span>
<span>                                                from <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"event02_expect_angle"</span>, <span class="st">"event04_actual_angle"</span><span class="op">)</span>,</span>
<span>                                                to <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"expect"</span>, <span class="st">"actual"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">trialorder_groupwise</span><span class="op">$</span><span class="va">rating_type_key</span> <span class="op">&lt;-</span> <span class="fu">mapvalues</span><span class="op">(</span><span class="va">trialorder_groupwise</span><span class="op">$</span><span class="va">rating_type</span>,</span>
<span>                                                from <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"event02_expect_angle"</span>, <span class="st">"event04_actual_angle"</span><span class="op">)</span>,</span>
<span>                                                to <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"expect"</span>, <span class="st">"actual"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">actual_trialorder_groupwise</span> <span class="op">&lt;-</span> <span class="va">trialorder_groupwise</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">trialorder_groupwise</span><span class="op">$</span><span class="va">rating_type_key</span> <span class="op">==</span> <span class="st">"actual"</span><span class="op">)</span>,<span class="op">]</span></span>
<span><span class="va">expect_trialorder_groupwise</span> <span class="op">&lt;-</span><span class="va">trialorder_groupwise</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">trialorder_groupwise</span><span class="op">$</span><span class="va">rating_type_key</span> <span class="op">==</span> <span class="st">"expect"</span><span class="op">)</span>,<span class="op">]</span></span>
<span><span class="va">actual_trialorder_subjectwise</span> <span class="op">&lt;-</span> <span class="va">trialorder_subjectwise</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">trialorder_subjectwise</span><span class="op">$</span><span class="va">rating_type_key</span> <span class="op">==</span> <span class="st">"actual"</span><span class="op">)</span>,<span class="op">]</span></span>
<span><span class="va">expect_trialorder_subjectwise</span> <span class="op">&lt;-</span><span class="va">trialorder_subjectwise</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">trialorder_subjectwise</span><span class="op">$</span><span class="va">rating_type_key</span> <span class="op">==</span> <span class="st">"expect"</span><span class="op">)</span>,<span class="op">]</span></span></code></pre></div>
<p>ggplot</p>
<div class="sourceCode" id="cb61"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># * dataset: trialorder_groupwise</span></span>
<span><span class="co"># * x-axis: trial_index (sorted)</span></span>
<span><span class="co"># * y-axis: rating</span></span>
<span><span class="co"># * group: cue_ordered, rating_type</span></span>
<span><span class="co"># * DV: mean_per_sub_norm_mean</span></span>
<span><span class="co"># * error bar: se</span></span>
<span></span>
<span><span class="va">iv1</span> <span class="op">=</span> <span class="st">"trial_index"</span></span>
<span><span class="va">iv2</span> <span class="op">=</span> <span class="st">"cue_ordered"</span></span>
<span><span class="va">data</span> <span class="op">=</span></span>
<span><span class="va">g</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">trialorder_groupwise</span>,</span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">trial_index</span>,</span>
<span>      y <span class="op">=</span> <span class="va">mean_per_sub_norm_mean</span>,</span>
<span>      color <span class="op">=</span> <span class="va">cue_ordered</span>,</span>
<span>      group <span class="op">=</span> <span class="va">rating_type_key</span></span>
<span>      <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">trialorder_groupwise</span>,</span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span></span>
<span>      shape <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">rating_type_key</span><span class="op">)</span>,</span>
<span>      x <span class="op">=</span><span class="va">trial_index</span>,</span>
<span>      y <span class="op">=</span> <span class="va">mean_per_sub_norm_mean</span>,</span>
<span>      group <span class="op">=</span> <span class="va">rating_type_key</span>,</span>
<span>      <span class="co">#color = cue_ordered</span></span>
<span>      <span class="op">)</span>,</span>
<span>    <span class="co">#position = position_jitter(width = .05),</span></span>
<span>    size <span class="op">=</span> <span class="fl">3</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_shape_manual</a></span><span class="op">(</span>values<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">16</span>, <span class="fl">21</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span></span>
<span>  <span class="co"># geom_point(</span></span>
<span>  <span class="co">#   data = trialorder_subjectwise,</span></span>
<span>  <span class="co">#   aes(</span></span>
<span>  <span class="co">#     x = as.numeric(trial_index) - .15,</span></span>
<span>  <span class="co">#     y = mean_per_sub,</span></span>
<span>  <span class="co">#     color = cue_ordered</span></span>
<span>  <span class="co">#     ),</span></span>
<span>  <span class="co">#   position = position_jitter(width = .05),</span></span>
<span>  <span class="co">#   size = 1, alpha = 0.8, shape = 20</span></span>
<span>  <span class="co">#   ) +</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_linerange.html">geom_errorbar</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">trialorder_groupwise</span>,</span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span></span>
<span>      x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">trial_index</span><span class="op">)</span>,</span>
<span>      y <span class="op">=</span> <span class="va">mean_per_sub_norm_mean</span>,</span>
<span>      group <span class="op">=</span> <span class="va">rating_type_key</span>,</span>
<span>      colour <span class="op">=</span> <span class="va">cue_ordered</span>,</span>
<span>      ymin <span class="op">=</span> <span class="va">mean_per_sub_norm_mean</span> <span class="op">-</span> <span class="va">se</span>,</span>
<span>      ymax <span class="op">=</span> <span class="va">mean_per_sub_norm_mean</span> <span class="op">+</span> <span class="va">se</span></span>
<span>      <span class="op">)</span>, width <span class="op">=</span> <span class="fl">.01</span>, size <span class="op">=</span> <span class="fl">0.5</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"high cue"</span> <span class="op">=</span> <span class="st">"red"</span>,</span>
<span>                                <span class="st">"low cue"</span> <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">"no. of trials"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">"rating"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html">ylim</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">100</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>    axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>,</span>
<span>    axis.text.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>,</span>
<span>    axis.title.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">15</span><span class="op">)</span>,</span>
<span>    axis.title.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">15</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code>## Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.
## ℹ Please use `linewidth` instead.
## This warning is displayed once every 8 hours.
## Call `lifecycle::last_lifecycle_warnings()` to see where this warning was
## generated.</code></pre>
<div class="sourceCode" id="cb63"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">g</span></span></code></pre></div>
<div class="inline-figure"><img src="06_iv-cue-trial_dv-expect-actual_jepma_files/figure-html/unnamed-chunk-7-1.png" width="672"></div>
</div>
<div id="plot-2---average-across-participant-but-spread-all-6-runs-in-one-x-axis" class="section level2" number="6.3">
<h2>
<span class="header-section-number">6.3</span> plot 2 - average across participant, but spread all 6 runs in one x axis<a class="anchor" aria-label="anchor" href="#plot-2---average-across-participant-but-spread-all-6-runs-in-one-x-axis"><i class="fas fa-link"></i></a>
</h2>
<p>load data and combine participant data</p>
<div class="sourceCode" id="cb64"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">main_dir</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/basename.html">dirname</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/basename.html">dirname</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html">getwd</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">datadir</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">main_dir</span>, <span class="st">'data'</span>, <span class="st">'beh'</span>, <span class="st">'beh02_preproc'</span><span class="op">)</span></span>
<span><span class="co"># parameters _____________________________________ # nolint</span></span>
<span><span class="va">subject_varkey</span> <span class="op">&lt;-</span> <span class="st">"src_subject_id"</span></span>
<span><span class="va">iv</span> <span class="op">&lt;-</span> <span class="st">"param_cue_type"</span></span>
<span><span class="va">dv</span> <span class="op">&lt;-</span> <span class="st">"event03_RT"</span></span>
<span><span class="va">dv_keyword</span> <span class="op">&lt;-</span> <span class="st">"RT"</span></span>
<span><span class="va">xlab</span> <span class="op">&lt;-</span> <span class="st">""</span></span>
<span><span class="va">taskname</span> <span class="op">&lt;-</span> <span class="st">"pain"</span></span>
<span></span>
<span><span class="va">ylab</span> <span class="op">&lt;-</span> <span class="st">"ratings (degree)"</span></span>
<span><span class="va">subject</span> <span class="op">&lt;-</span> <span class="st">"subject"</span></span>
<span><span class="va">exclude</span> <span class="op">&lt;-</span> <span class="st">"sub-0999|sub-0001|sub-0002|sub-0003|sub-0004|sub-0005|sub-0006|sub-0007|sub-0008|sub-0009|sub-0010|sub-0011"</span></span>
<span></span>
<span><span class="co"># load data _____________________________________</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu">df_load_beh</span><span class="op">(</span><span class="va">datadir</span>, taskname <span class="op">=</span> <span class="va">taskname</span>, subject_varkey <span class="op">=</span> <span class="va">subject_varkey</span>, iv <span class="op">=</span> <span class="va">iv</span>, exclude <span class="op">=</span> <span class="va">exclude</span><span class="op">)</span></span></code></pre></div>
<div id="p2-check-number-of-trials-per-participant" class="section level3 unlisted unnumbered">
<h3>p2 :: check number of trials per participant<a class="anchor" aria-label="anchor" href="#p2-check-number-of-trials-per-participant"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb65"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data_p2</span><span class="op">=</span> <span class="va">data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">arrange</span><span class="op">(</span><span class="va">src_subject_id</span> <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">src_subject_id</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>trial_index <span class="op">=</span> <span class="fu">row_number</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># df_clean &lt;- data_p2[complete.cases(data_p2$event02_expect_angle), ]</span></span>
<span><span class="va">df_clean</span> <span class="op">&lt;-</span> <span class="va">data_p2</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/stats/complete.cases.html">complete.cases</a></span><span class="op">(</span><span class="va">data_p2</span><span class="op">$</span><span class="va">event04_actual_angle</span><span class="op">)</span>, <span class="op">]</span></span></code></pre></div>
<div id="check-if-every-participant-has-maximum-of-72-trials.-anything-beyond-that-is-erroneous" class="section level4" number="6.3.0.1">
<h4>
<span class="header-section-number">6.3.0.1</span> check if every participant has maximum of 72 trials. Anything beyond that is erroneous<a class="anchor" aria-label="anchor" href="#check-if-every-participant-has-maximum-of-72-trials.-anything-beyond-that-is-erroneous"><i class="fas fa-link"></i></a>
</h4>
<div class="sourceCode" id="cb66"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Assuming participant IDs are in a column named "participant_id"</span></span>
<span><span class="co"># and row numbers are in a column named "row_number"</span></span>
<span><span class="co"># Replace "your_data" with the name of your dataset</span></span>
<span></span>
<span><span class="co"># Calculate the maximum row number for each participant</span></span>
<span><span class="va">max_rows</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aggregate.html">aggregate</a></span><span class="op">(</span><span class="va">trial_index</span> <span class="op">~</span> <span class="va">src_subject_id</span>, <span class="va">data_p2</span>, <span class="va">max</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Check if any participant's maximum row number is not 72</span></span>
<span><span class="va">max_rows</span><span class="op">[</span><span class="va">max_rows</span><span class="op">$</span><span class="va">trial_index</span> <span class="op">&gt;</span> <span class="fl">72</span>,<span class="op">]</span><span class="op">$</span><span class="va">src_subject_id</span></span></code></pre></div>
<pre><code>## [1] 98</code></pre>
</div>
</div>
<div id="p2-identify-erroneous-participant" class="section level3 unlisted unnumbered">
<h3>p2 :: identify erroneous participant<a class="anchor" aria-label="anchor" href="#p2-identify-erroneous-participant"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb68"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># participants who have more than 72 trials will be flagged</span></span>
<span><span class="co"># excluded for now</span></span>
<span><span class="co"># TODO: resolve subject 98</span></span>
<span><span class="va">count_trial</span> <span class="op">&lt;-</span> <span class="va">df_clean</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu">count</span><span class="op">(</span><span class="st">"src_subject_id"</span><span class="op">)</span></span>
<span><span class="va">count_trial</span><span class="op">[</span><span class="va">count_trial</span><span class="op">$</span><span class="va">freq</span> <span class="op">&gt;</span> <span class="fl">72</span>,<span class="op">]</span></span></code></pre></div>
<pre><code>## [1] src_subject_id freq          
## &lt;0 rows&gt; (or 0-length row.names)</code></pre>
<div class="sourceCode" id="cb70"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">count_trial</span><span class="op">[</span><span class="va">count_trial</span><span class="op">$</span><span class="va">freq</span> <span class="op">&gt;</span> <span class="fl">60</span>,<span class="op">]</span><span class="op">$</span><span class="va">src_subject_id</span></span></code></pre></div>
<pre><code>##  [1]  18  29  31  33  34  36  37  38  39  43  44  46  50  51  52  53  55  57  58
## [20]  60  61  62  65  73  74  78  80  86  87  88  90  91  93  94  95  99 100 101
## [39] 105 106 109 111 115 116 122 124 126 127 128 130 132 133</code></pre>
</div>
<div id="p2-convert-to-long-form" class="section level3 unlisted unnumbered">
<h3>p2 :: convert to long form<a class="anchor" aria-label="anchor" href="#p2-convert-to-long-form"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb72"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df_clean</span> <span class="op">&lt;-</span> <span class="va">df_clean</span><span class="op">[</span><span class="va">df_clean</span><span class="op">$</span><span class="va">src_subject_id</span> <span class="op">!=</span> <span class="fl">98</span>, <span class="op">]</span></span>
<span><span class="va">data_p2_long</span> <span class="op">=</span> <span class="va">df_clean</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">pivot_longer</span><span class="op">(</span>cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'event02_expect_angle'</span>, <span class="st">'event04_actual_angle'</span><span class="op">)</span>,</span>
<span>               names_to <span class="op">=</span> <span class="st">"rating_type"</span>,</span>
<span>               values_to <span class="op">=</span> <span class="st">"rating_value"</span><span class="op">)</span></span></code></pre></div>
</div>
<div id="p2-plot-data" class="section level3 unlisted unnumbered">
<h3>p2 :: plot data<a class="anchor" aria-label="anchor" href="#p2-plot-data"><i class="fas fa-link"></i></a>
</h3>
<p>I’m plotting all of the trials per participant. In this case, there is no trialwise variability, because we’re plotting all 72 trials.
Averaging across participants will be the only source of variability, reflected in the error bars</p>
<div class="sourceCode" id="cb73"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># PLOT</span></span>
<span>  <span class="co"># I'm plotting</span></span>
<span>    <span class="va">data_p2_long</span><span class="op">$</span><span class="va">cue_name</span><span class="op">[</span><span class="va">data_p2_long</span><span class="op">$</span><span class="va">param_cue_type</span> <span class="op">==</span> <span class="st">"high_cue"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"high cue"</span></span></code></pre></div>
<pre><code>## Warning: Unknown or uninitialised column: `cue_name`.</code></pre>
<div class="sourceCode" id="cb75"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>    <span class="va">data_p2_long</span><span class="op">$</span><span class="va">cue_name</span><span class="op">[</span><span class="va">data_p2_long</span><span class="op">$</span><span class="va">param_cue_type</span> <span class="op">==</span> <span class="st">"low_cue"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"low cue"</span></span>
<span></span>
<span>    <span class="va">data_p2_long</span><span class="op">$</span><span class="va">stim_name</span><span class="op">[</span><span class="va">data_p2_long</span><span class="op">$</span><span class="va">param_stimulus_type</span> <span class="op">==</span> <span class="st">"high_stim"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"high"</span></span></code></pre></div>
<pre><code>## Warning: Unknown or uninitialised column: `stim_name`.</code></pre>
<div class="sourceCode" id="cb77"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>    <span class="va">data_p2_long</span><span class="op">$</span><span class="va">stim_name</span><span class="op">[</span><span class="va">data_p2_long</span><span class="op">$</span><span class="va">param_stimulus_type</span> <span class="op">==</span> <span class="st">"med_stim"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"med"</span></span>
<span>    <span class="va">data_p2_long</span><span class="op">$</span><span class="va">stim_name</span><span class="op">[</span><span class="va">data_p2_long</span><span class="op">$</span><span class="va">param_stimulus_type</span> <span class="op">==</span> <span class="st">"low_stim"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"low"</span></span>
<span></span>
<span>    <span class="va">data_p2_long</span><span class="op">$</span><span class="va">stim_ordered</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span></span>
<span>        <span class="va">data_p2_long</span><span class="op">$</span><span class="va">stim_name</span>,</span>
<span>        levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"low"</span>, <span class="st">"med"</span>, <span class="st">"high"</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>    <span class="va">data_p2_long</span><span class="op">$</span><span class="va">cue_ordered</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span></span>
<span>        <span class="va">data_p2_long</span><span class="op">$</span><span class="va">cue_name</span>,</span>
<span>        levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"low cue"</span>, <span class="st">"high cue"</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>    <span class="va">model_iv1</span> <span class="op">&lt;-</span> <span class="st">"stim_ordered"</span></span>
<span>    <span class="va">model_iv2</span> <span class="op">&lt;-</span> <span class="st">"cue_ordered"</span></span>
<span>    <span class="va">rating</span> <span class="op">&lt;-</span> <span class="st">"rating_type"</span></span>
<span>    <span class="va">dv</span> <span class="op">&lt;-</span> <span class="st">"rating_value"</span></span>
<span></span>
<span>    <span class="va">trialorder_subjectwise_p2</span> <span class="op">&lt;-</span> <span class="fu">meanSummary</span><span class="op">(</span></span>
<span>        <span class="va">data_p2_long</span>,</span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span> <span class="va">model_iv2</span>, <span class="va">rating</span>, <span class="st">"trial_index"</span><span class="op">)</span>, <span class="va">dv</span></span>
<span>    <span class="op">)</span></span>
<span></span>
<span>    <span class="va">subjectwise_naomit_p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html">na.omit</a></span><span class="op">(</span><span class="va">trialorder_subjectwise_p2</span><span class="op">)</span></span>
<span>    <span class="va">trialorder_groupwise_p2</span> <span class="op">&lt;-</span> <span class="fu">summarySEwithin</span><span class="op">(</span></span>
<span>        data <span class="op">=</span> <span class="va">subjectwise_naomit_p2</span>,</span>
<span>        measurevar <span class="op">=</span> <span class="st">"mean_per_sub"</span>,</span>
<span>        withinvars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"cue_ordered"</span>, <span class="st">"rating_type"</span>, <span class="st">"trial_index"</span><span class="op">)</span>, idvar <span class="op">=</span> <span class="va">subject</span></span>
<span>    <span class="op">)</span></span></code></pre></div>
<pre><code>## Automatically converting the following non-factors to factors: rating_type, trial_index</code></pre>
<pre><code>## Warning in stats::qt(conf.interval/2 + 0.5, datac$N - 1): NaNs produced</code></pre>
<pre><code>## Warning in stats::qt(conf.interval/2 + 0.5, datac$N - 1): NaNs produced</code></pre>
<div class="sourceCode" id="cb81"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">trialorder_groupwise_p2</span><span class="op">$</span><span class="va">rating_type_key</span> <span class="op">&lt;-</span> <span class="fu">mapvalues</span><span class="op">(</span><span class="va">trialorder_groupwise_p2</span><span class="op">$</span><span class="va">rating_type</span>,</span>
<span>                                                from <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"event02_expect_angle"</span>, <span class="st">"event04_actual_angle"</span><span class="op">)</span>,</span>
<span>                                                to <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"expect"</span>, <span class="st">"actual"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>ggplot</p>
<div class="inline-figure"><img src="06_iv-cue-trial_dv-expect-actual_jepma_files/figure-html/unnamed-chunk-11-1.png" width="672"></div>
</div>
</div>
<div id="plot-data-version-2" class="section level2" number="6.4">
<h2>
<span class="header-section-number">6.4</span> plot data version 2<a class="anchor" aria-label="anchor" href="#plot-data-version-2"><i class="fas fa-link"></i></a>
</h2>
<pre><code>## Warning: Removed 1 rows containing missing values (`geom_point()`).</code></pre>
<div class="inline-figure"><img src="06_iv-cue-trial_dv-expect-actual_jepma_files/figure-html/unnamed-chunk-12-1.png" width="672"></div>
</div>
<div id="subset-of-participants" class="section level2" number="6.5">
<h2>
<span class="header-section-number">6.5</span> subset of participants<a class="anchor" aria-label="anchor" href="#subset-of-participants"><i class="fas fa-link"></i></a>
</h2>
<pre><code>## # A tibble: 5,851 × 60
## # Groups:   src_subject_id [110]
##    src_subject_id session_id param_task_name param_run_num
##             &lt;int&gt;      &lt;int&gt; &lt;chr&gt;                   &lt;int&gt;
##  1              2          1 pain                        1
##  2              2          1 pain                        1
##  3              2          1 pain                        1
##  4              2          1 pain                        1
##  5              2          1 pain                        1
##  6              2          1 pain                        1
##  7              2          1 pain                        1
##  8              2          1 pain                        1
##  9              2          1 pain                        1
## 10              2          1 pain                        1
## # ℹ 5,841 more rows
## # ℹ 56 more variables: param_counterbalance_ver &lt;int&gt;,
## #   param_counterbalance_block_num &lt;int&gt;, param_cue_type &lt;chr&gt;,
## #   param_stimulus_type &lt;chr&gt;, param_cond_type &lt;int&gt;,
## #   param_trigger_onset &lt;dbl&gt;, param_start_biopac &lt;dbl&gt;, ITI_onset &lt;dbl&gt;,
## #   ITI_biopac &lt;dbl&gt;, ITI_duration &lt;dbl&gt;, event01_cue_onset &lt;dbl&gt;,
## #   event01_cue_biopac &lt;dbl&gt;, event01_cue_type &lt;chr&gt;, …</code></pre>
<pre><code>## Warning: Unknown or uninitialised column: `cue_name`.</code></pre>
<pre><code>## Warning: Unknown or uninitialised column: `stim_name`.</code></pre>
<pre><code>## Automatically converting the following non-factors to factors: rating_type, trial_index</code></pre>
<pre><code>## Warning in stats::qt(conf.interval/2 + 0.5, datac$N - 1): NaNs produced</code></pre>
<pre><code>## Warning in stats::qt(conf.interval/2 + 0.5, datac$N - 1): NaNs produced</code></pre>
<pre><code>## Warning: Removed 1 rows containing missing values (`geom_point()`).</code></pre>
<div class="inline-figure"><img src="06_iv-cue-trial_dv-expect-actual_jepma_files/figure-html/unnamed-chunk-13-1.png" width="672"></div>
</div>
<div id="vicarious-3" class="section level2" number="6.6">
<h2>
<span class="header-section-number">6.6</span> vicarious<a class="anchor" aria-label="anchor" href="#vicarious-3"><i class="fas fa-link"></i></a>
</h2>
<pre><code>## # A tibble: 5,851 × 60
## # Groups:   src_subject_id [110]
##    src_subject_id session_id param_task_name param_run_num
##             &lt;int&gt;      &lt;int&gt; &lt;chr&gt;                   &lt;int&gt;
##  1              2          1 pain                        1
##  2              2          1 pain                        1
##  3              2          1 pain                        1
##  4              2          1 pain                        1
##  5              2          1 pain                        1
##  6              2          1 pain                        1
##  7              2          1 pain                        1
##  8              2          1 pain                        1
##  9              2          1 pain                        1
## 10              2          1 pain                        1
## # ℹ 5,841 more rows
## # ℹ 56 more variables: param_counterbalance_ver &lt;int&gt;,
## #   param_counterbalance_block_num &lt;int&gt;, param_cue_type &lt;chr&gt;,
## #   param_stimulus_type &lt;chr&gt;, param_cond_type &lt;int&gt;,
## #   param_trigger_onset &lt;dbl&gt;, param_start_biopac &lt;dbl&gt;, ITI_onset &lt;dbl&gt;,
## #   ITI_biopac &lt;dbl&gt;, ITI_duration &lt;dbl&gt;, event01_cue_onset &lt;dbl&gt;,
## #   event01_cue_biopac &lt;dbl&gt;, event01_cue_type &lt;chr&gt;, …</code></pre>
<pre><code>## Warning: Unknown or uninitialised column: `cue_name`.</code></pre>
<pre><code>## Warning: Unknown or uninitialised column: `stim_name`.</code></pre>
<pre><code>## Automatically converting the following non-factors to factors: rating_type, trial_index</code></pre>
<pre><code>## Warning in stats::qt(conf.interval/2 + 0.5, datac$N - 1): NaNs produced</code></pre>
<pre><code>## Warning in stats::qt(conf.interval/2 + 0.5, datac$N - 1): NaNs produced</code></pre>
<pre><code>## Warning: Removed 1 rows containing missing values (`geom_point()`).</code></pre>
<div class="inline-figure"><img src="06_iv-cue-trial_dv-expect-actual_jepma_files/figure-html/unnamed-chunk-14-1.png" width="672"></div>
</div>
<div id="cognitive-3" class="section level2" number="6.7">
<h2>
<span class="header-section-number">6.7</span> cognitive<a class="anchor" aria-label="anchor" href="#cognitive-3"><i class="fas fa-link"></i></a>
</h2>
<pre><code>## # A tibble: 5,851 × 60
## # Groups:   src_subject_id [110]
##    src_subject_id session_id param_task_name param_run_num
##             &lt;int&gt;      &lt;int&gt; &lt;chr&gt;                   &lt;int&gt;
##  1              2          1 pain                        1
##  2              2          1 pain                        1
##  3              2          1 pain                        1
##  4              2          1 pain                        1
##  5              2          1 pain                        1
##  6              2          1 pain                        1
##  7              2          1 pain                        1
##  8              2          1 pain                        1
##  9              2          1 pain                        1
## 10              2          1 pain                        1
## # ℹ 5,841 more rows
## # ℹ 56 more variables: param_counterbalance_ver &lt;int&gt;,
## #   param_counterbalance_block_num &lt;int&gt;, param_cue_type &lt;chr&gt;,
## #   param_stimulus_type &lt;chr&gt;, param_cond_type &lt;int&gt;,
## #   param_trigger_onset &lt;dbl&gt;, param_start_biopac &lt;dbl&gt;, ITI_onset &lt;dbl&gt;,
## #   ITI_biopac &lt;dbl&gt;, ITI_duration &lt;dbl&gt;, event01_cue_onset &lt;dbl&gt;,
## #   event01_cue_biopac &lt;dbl&gt;, event01_cue_type &lt;chr&gt;, …</code></pre>
<pre><code>## Warning: Unknown or uninitialised column: `cue_name`.</code></pre>
<pre><code>## Warning: Unknown or uninitialised column: `stim_name`.</code></pre>
<pre><code>## Automatically converting the following non-factors to factors: rating_type, trial_index</code></pre>
<pre><code>## Warning in stats::qt(conf.interval/2 + 0.5, datac$N - 1): NaNs produced</code></pre>
<pre><code>## Warning in stats::qt(conf.interval/2 + 0.5, datac$N - 1): NaNs produced</code></pre>
<pre><code>## Warning: Removed 1 rows containing missing values (`geom_point()`).</code></pre>
<div class="inline-figure"><img src="06_iv-cue-trial_dv-expect-actual_jepma_files/figure-html/unnamed-chunk-15-1.png" width="672"></div>
</div>
<div id="within-subject-vicarious" class="section level2" number="6.8">
<h2>
<span class="header-section-number">6.8</span> within subject vicarious<a class="anchor" aria-label="anchor" href="#within-subject-vicarious"><i class="fas fa-link"></i></a>
</h2>
<pre><code>## Warning: Unknown or uninitialised column: `cue_name`.</code></pre>
<pre><code>## Warning: Unknown or uninitialised column: `stim_name`.</code></pre>
<pre><code>## Automatically converting the following non-factors to factors: trial_index, rating_type</code></pre>
<pre><code>## Warning in stats::qt(conf.interval/2 + 0.5, datac$N - 1): NaNs produced</code></pre>
<pre><code>## Warning in stats::qt(conf.interval/2 + 0.5, datac$N - 1): NaNs produced</code></pre>
<pre><code>## Warning in geom_point(data = trialorder_groupwise_p2, aes(shape =
## as.character(rating_type), : Ignoring unknown aesthetics: linetype</code></pre>
<pre><code>## `geom_smooth()` using formula = 'y ~ x'</code></pre>
<div class="inline-figure"><img src="06_iv-cue-trial_dv-expect-actual_jepma_files/figure-html/unnamed-chunk-16-1.png" width="672"></div>
</div>
<div id="tor-request-only-outcome-ratings.-3-tasks" class="section level2" number="6.9">
<h2>
<span class="header-section-number">6.9</span> Tor request – only outcome ratings. 3 tasks<a class="anchor" aria-label="anchor" href="#tor-request-only-outcome-ratings.-3-tasks"><i class="fas fa-link"></i></a>
</h2>
<div id="pain-3" class="section level3" number="6.9.1">
<h3>
<span class="header-section-number">6.9.1</span> pain<a class="anchor" aria-label="anchor" href="#pain-3"><i class="fas fa-link"></i></a>
</h3>
<pre><code>## Warning: Unknown or uninitialised column: `cue_name`.</code></pre>
<pre><code>## Warning: Unknown or uninitialised column: `stim_name`.</code></pre>
<pre><code>## Automatically converting the following non-factors to factors: trial_index</code></pre>
<pre><code>## Warning in stats::qt(conf.interval/2 + 0.5, datac$N - 1): NaNs produced</code></pre>
<pre><code>## Warning in stats::qt(conf.interval/2 + 0.5, datac$N - 1): NaNs produced</code></pre>
<pre><code>## `geom_smooth()` using formula = 'y ~ x'</code></pre>
<div class="inline-figure"><img src="06_iv-cue-trial_dv-expect-actual_jepma_files/figure-html/unnamed-chunk-17-1.png" width="672"></div>
</div>
<div id="vicarious-4" class="section level3" number="6.9.2">
<h3>
<span class="header-section-number">6.9.2</span> vicarious<a class="anchor" aria-label="anchor" href="#vicarious-4"><i class="fas fa-link"></i></a>
</h3>
<pre><code>## Warning: Unknown or uninitialised column: `cue_name`.</code></pre>
<pre><code>## Warning: Unknown or uninitialised column: `stim_name`.</code></pre>
<pre><code>## Automatically converting the following non-factors to factors: trial_index</code></pre>
<pre><code>## Warning in stats::qt(conf.interval/2 + 0.5, datac$N - 1): NaNs produced</code></pre>
<pre><code>## Warning in stats::qt(conf.interval/2 + 0.5, datac$N - 1): NaNs produced</code></pre>
<pre><code>## `geom_smooth()` using formula = 'y ~ x'</code></pre>
<div class="inline-figure"><img src="06_iv-cue-trial_dv-expect-actual_jepma_files/figure-html/unnamed-chunk-18-1.png" width="672"></div>
</div>
<div id="cognitive-4" class="section level3" number="6.9.3">
<h3>
<span class="header-section-number">6.9.3</span> cognitive<a class="anchor" aria-label="anchor" href="#cognitive-4"><i class="fas fa-link"></i></a>
</h3>
<pre><code>## Warning: Unknown or uninitialised column: `cue_name`.</code></pre>
<pre><code>## Warning: Unknown or uninitialised column: `stim_name`.</code></pre>
<pre><code>## Automatically converting the following non-factors to factors: trial_index</code></pre>
<pre><code>## Warning in stats::qt(conf.interval/2 + 0.5, datac$N - 1): NaNs produced</code></pre>
<pre><code>## Warning in stats::qt(conf.interval/2 + 0.5, datac$N - 1): NaNs produced</code></pre>
<pre><code>## `geom_smooth()` using formula = 'y ~ x'</code></pre>
<div class="inline-figure"><img src="06_iv-cue-trial_dv-expect-actual_jepma_files/figure-html/unnamed-chunk-19-1.png" width="672"></div>
</div>
</div>
<div id="tor-request-only-expect-ratings.-3-tasks" class="section level2" number="6.10">
<h2>
<span class="header-section-number">6.10</span> Tor request – only expect ratings. 3 tasks<a class="anchor" aria-label="anchor" href="#tor-request-only-expect-ratings.-3-tasks"><i class="fas fa-link"></i></a>
</h2>
<div id="pain-4" class="section level3" number="6.10.1">
<h3>
<span class="header-section-number">6.10.1</span> pain<a class="anchor" aria-label="anchor" href="#pain-4"><i class="fas fa-link"></i></a>
</h3>
<pre><code>## Linear mixed model fit by REML. t-tests use Satterthwaite's method [
## lmerModLmerTest]
## Formula: 
## event04_actual_angle ~ trial_index * param_cue_type + (param_cue_type |  
##     src_subject_id)
##    Data: df_clean
## 
## REML criterion at convergence: 51815.3
## 
## Scaled residuals: 
##     Min      1Q  Median      3Q     Max 
## -4.1391 -0.6157  0.0088  0.6196  4.0913 
## 
## Random effects:
##  Groups         Name                  Variance Std.Dev. Corr 
##  src_subject_id (Intercept)           860.95   29.342        
##                 param_cue_typelow_cue  41.77    6.463   -0.11
##  Residual                             582.58   24.137        
## Number of obs: 5571, groups:  src_subject_id, 110
## 
## Fixed effects:
##                                     Estimate Std. Error         df t value
## (Intercept)                         74.58379    2.94621  125.10816  25.315
## trial_index                         -0.14818    0.02397 5358.25599  -6.183
## param_cue_typelow_cue              -10.07630    1.42124  568.67767  -7.090
## trial_index:param_cue_typelow_cue    0.05386    0.03307 4679.39277   1.629
##                                   Pr(&gt;|t|)    
## (Intercept)                        &lt; 2e-16 ***
## trial_index                       6.76e-10 ***
## param_cue_typelow_cue             4.00e-12 ***
## trial_index:param_cue_typelow_cue    0.103    
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Correlation of Fixed Effects:
##             (Intr) trl_nd prm___
## trial_index -0.258              
## prm_c_typl_ -0.241  0.524       
## trl_ndx:___  0.184 -0.688 -0.765</code></pre>
<pre><code>## Type III Analysis of Variance Table with Satterthwaite's method
##                             Sum Sq Mean Sq NumDF  DenDF F value    Pr(&gt;F)    
## trial_index                28321.1 28321.1     1 5407.0 48.6134 3.490e-12 ***
## param_cue_type             29283.6 29283.6     1  568.7 50.2655 3.999e-12 ***
## trial_index:param_cue_type  1545.4  1545.4     1 4679.4  2.6527    0.1034    
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
<pre><code>## Warning: Unknown or uninitialised column: `cue_name`.</code></pre>
<pre><code>## Warning: Unknown or uninitialised column: `stim_name`.</code></pre>
<pre><code>## Automatically converting the following non-factors to factors: trial_index</code></pre>
<pre><code>## Warning in stats::qt(conf.interval/2 + 0.5, datac$N - 1): NaNs produced</code></pre>
<pre><code>## Warning in stats::qt(conf.interval/2 + 0.5, datac$N - 1): NaNs produced</code></pre>
<pre><code>## `geom_smooth()` using formula = 'y ~ x'</code></pre>
<div class="inline-figure"><img src="06_iv-cue-trial_dv-expect-actual_jepma_files/figure-html/unnamed-chunk-20-1.png" width="672"></div>
</div>
<div id="vicarious-5" class="section level3" number="6.10.2">
<h3>
<span class="header-section-number">6.10.2</span> vicarious<a class="anchor" aria-label="anchor" href="#vicarious-5"><i class="fas fa-link"></i></a>
</h3>
<pre><code>## Linear mixed model fit by REML. t-tests use Satterthwaite's method [
## lmerModLmerTest]
## Formula: 
## event04_actual_angle ~ trial_index * param_cue_type + (param_cue_type |  
##     src_subject_id)
##    Data: df_clean
## 
## REML criterion at convergence: 54872.6
## 
## Scaled residuals: 
##     Min      1Q  Median      3Q     Max 
## -2.8647 -0.6683 -0.2164  0.4658  5.5008 
## 
## Random effects:
##  Groups         Name                  Variance Std.Dev. Corr 
##  src_subject_id (Intercept)           132.485  11.510        
##                 param_cue_typelow_cue   4.966   2.229   -0.89
##  Residual                             578.849  24.059        
## Number of obs: 5936, groups:  src_subject_id, 110
## 
## Fixed effects:
##                                     Estimate Std. Error         df t value
## (Intercept)                         26.04180    1.42259  222.10012  18.306
## trial_index                          0.14033    0.02205 5791.42518   6.363
## param_cue_typelow_cue              -10.93655    1.27427 1283.22709  -8.583
## trial_index:param_cue_typelow_cue    0.08509    0.03037 5513.06146   2.802
##                                   Pr(&gt;|t|)    
## (Intercept)                        &lt; 2e-16 ***
## trial_index                       2.13e-10 ***
## param_cue_typelow_cue              &lt; 2e-16 ***
## trial_index:param_cue_typelow_cue  0.00509 ** 
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Correlation of Fixed Effects:
##             (Intr) trl_nd prm___
## trial_index -0.543              
## prm_c_typl_ -0.556  0.594       
## trl_ndx:___  0.387 -0.697 -0.854</code></pre>
<pre><code>## Type III Analysis of Variance Table with Satterthwaite's method
##                            Sum Sq Mean Sq NumDF  DenDF  F value    Pr(&gt;F)    
## trial_index                 77430   77430     1 5869.4 133.7658 &lt; 2.2e-16 ***
## param_cue_type              42638   42638     1 1283.2  73.6606 &lt; 2.2e-16 ***
## trial_index:param_cue_type   4546    4546     1 5513.1   7.8532  0.005091 ** 
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
<pre><code>## Warning: Unknown or uninitialised column: `cue_name`.</code></pre>
<pre><code>## Warning: Unknown or uninitialised column: `stim_name`.</code></pre>
<pre><code>## Automatically converting the following non-factors to factors: trial_index</code></pre>
<pre><code>## Warning in stats::qt(conf.interval/2 + 0.5, datac$N - 1): NaNs produced</code></pre>
<pre><code>## Warning in stats::qt(conf.interval/2 + 0.5, datac$N - 1): NaNs produced</code></pre>
<pre><code>## `geom_smooth()` using formula = 'y ~ x'</code></pre>
<div class="inline-figure"><img src="06_iv-cue-trial_dv-expect-actual_jepma_files/figure-html/unnamed-chunk-21-1.png" width="672"></div>
</div>
<div id="cognitive-5" class="section level3" number="6.10.3">
<h3>
<span class="header-section-number">6.10.3</span> cognitive<a class="anchor" aria-label="anchor" href="#cognitive-5"><i class="fas fa-link"></i></a>
</h3>
<pre><code>## Linear mixed model fit by REML. t-tests use Satterthwaite's method [
## lmerModLmerTest]
## Formula: 
## event04_actual_angle ~ trial_index * param_cue_type + (param_cue_type |  
##     src_subject_id)
##    Data: df_clean
## 
## REML criterion at convergence: 52049.3
## 
## Scaled residuals: 
##     Min      1Q  Median      3Q     Max 
## -4.1640 -0.6201 -0.1508  0.4678  6.3870 
## 
## Random effects:
##  Groups         Name                  Variance Std.Dev. Corr 
##  src_subject_id (Intercept)           197.53   14.054        
##                 param_cue_typelow_cue  26.61    5.158   -0.54
##  Residual                             369.48   19.222        
## Number of obs: 5901, groups:  src_subject_id, 110
## 
## Fixed effects:
##                                     Estimate Std. Error         df t value
## (Intercept)                         34.74794    1.52822  156.81597  22.737
## trial_index                         -0.06251    0.01795 5781.38971  -3.482
## param_cue_typelow_cue              -10.41305    1.13179  632.34807  -9.201
## trial_index:param_cue_typelow_cue    0.06544    0.02468 5538.06618   2.651
##                                   Pr(&gt;|t|)    
## (Intercept)                        &lt; 2e-16 ***
## trial_index                       0.000502 ***
## param_cue_typelow_cue              &lt; 2e-16 ***
## trial_index:param_cue_typelow_cue 0.008037 ** 
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Correlation of Fixed Effects:
##             (Intr) trl_nd prm___
## trial_index -0.411              
## prm_c_typl_ -0.514  0.547       
## trl_ndx:___  0.296 -0.705 -0.776</code></pre>
<pre><code>## Type III Analysis of Variance Table with Satterthwaite's method
##                             Sum Sq Mean Sq NumDF  DenDF F value    Pr(&gt;F)    
## trial_index                 2020.5  2020.5     1 5783.0  5.4686  0.019395 *  
## param_cue_type             31276.3 31276.3     1  632.3 84.6500 &lt; 2.2e-16 ***
## trial_index:param_cue_type  2597.6  2597.6     1 5538.1  7.0304  0.008037 ** 
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
<pre><code>## Warning: Unknown or uninitialised column: `cue_name`.</code></pre>
<pre><code>## Warning: Unknown or uninitialised column: `stim_name`.</code></pre>
<pre><code>## Automatically converting the following non-factors to factors: trial_index</code></pre>
<pre><code>## Warning in stats::qt(conf.interval/2 + 0.5, datac$N - 1): NaNs produced</code></pre>
<pre><code>## Warning in stats::qt(conf.interval/2 + 0.5, datac$N - 1): NaNs produced</code></pre>
<pre><code>## `geom_smooth()` using formula = 'y ~ x'</code></pre>
<div class="inline-figure"><img src="06_iv-cue-trial_dv-expect-actual_jepma_files/figure-html/unnamed-chunk-22-1.png" width="672"></div>
</div>
</div>
<div id="lmer" class="section level2" number="6.11">
<h2>
<span class="header-section-number">6.11</span> lmer<a class="anchor" aria-label="anchor" href="#lmer"><i class="fas fa-link"></i></a>
</h2>
<pre><code>## Linear mixed model fit by REML. t-tests use Satterthwaite's method [
## lmerModLmerTest]
## Formula: 
## event04_actual_angle ~ trial_index * param_cue_type + (param_cue_type |  
##     src_subject_id)
##    Data: df_clean
## 
## REML criterion at convergence: 52049.3
## 
## Scaled residuals: 
##     Min      1Q  Median      3Q     Max 
## -4.1640 -0.6201 -0.1508  0.4678  6.3870 
## 
## Random effects:
##  Groups         Name                  Variance Std.Dev. Corr 
##  src_subject_id (Intercept)           197.53   14.054        
##                 param_cue_typelow_cue  26.61    5.158   -0.54
##  Residual                             369.48   19.222        
## Number of obs: 5901, groups:  src_subject_id, 110
## 
## Fixed effects:
##                                     Estimate Std. Error         df t value
## (Intercept)                         34.74794    1.52822  156.81597  22.737
## trial_index                         -0.06251    0.01795 5781.38971  -3.482
## param_cue_typelow_cue              -10.41305    1.13179  632.34807  -9.201
## trial_index:param_cue_typelow_cue    0.06544    0.02468 5538.06618   2.651
##                                   Pr(&gt;|t|)    
## (Intercept)                        &lt; 2e-16 ***
## trial_index                       0.000502 ***
## param_cue_typelow_cue              &lt; 2e-16 ***
## trial_index:param_cue_typelow_cue 0.008037 ** 
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Correlation of Fixed Effects:
##             (Intr) trl_nd prm___
## trial_index -0.411              
## prm_c_typl_ -0.514  0.547       
## trl_ndx:___  0.296 -0.705 -0.776</code></pre>
<pre><code>## Type III Analysis of Variance Table with Satterthwaite's method
##                             Sum Sq Mean Sq NumDF  DenDF F value    Pr(&gt;F)    
## trial_index                 2020.5  2020.5     1 5783.0  5.4686  0.019395 *  
## param_cue_type             31276.3 31276.3     1  632.3 84.6500 &lt; 2.2e-16 ***
## trial_index:param_cue_type  2597.6  2597.6     1 5538.1  7.0304  0.008037 ** 
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
<div id="lmer-histogram" class="section level3" number="6.11.1">
<h3>
<span class="header-section-number">6.11.1</span> lmer histogram<a class="anchor" aria-label="anchor" href="#lmer-histogram"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb155"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">random_slopes</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="06_iv-cue-trial_dv-expect-actual_jepma_files/figure-html/unnamed-chunk-24-1.png" width="672"></div>
<div class="sourceCode" id="cb156"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>sub <span class="op">=</span> <span class="va">group_ids</span>, cue_randomslope <span class="op">=</span> <span class="va">random_slopes</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/write.table.html">write.csv</a></span><span class="op">(</span><span class="va">df</span>, <span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">main_dir</span>,<span class="st">"data"</span>,<span class="st">"RL"</span>, <span class="st">"cue_trial_ranef_{taskname}.csv"</span><span class="op">)</span>, row.names <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co"># TODO: create a json file that also keeps track of which participants are include hree, using what model</span></span>
<span><span class="co"># comment</span></span></code></pre></div>
</div>
</div>
<div id="do-current-expectation-ratings-predict-outcome-ratings" class="section level2" number="6.12">
<h2>
<span class="header-section-number">6.12</span> Do current expectation ratings predict outcome ratings?<a class="anchor" aria-label="anchor" href="#do-current-expectation-ratings-predict-outcome-ratings"><i class="fas fa-link"></i></a>
</h2>
<div id="additional-analyse-01182023" class="section level3 unlisted unnumbered">
<h3>Additional analyse 01/18/2023<a class="anchor" aria-label="anchor" href="#additional-analyse-01182023"><i class="fas fa-link"></i></a>
</h3>
<ul>
<li>see if current expectation ratings predict outcome ratings</li>
<li>see if prior stimulus experience (N-1) predicts current expectation ratings</li>
<li>see if current expectation ratings are explained as a function of prior outcome rating and current expectation rating</li>
</ul>
<p>when loading the dataset, I need to add in trial index per dataframe.
Then, for the shift the rating?</p>
<div class="sourceCode" id="cb157"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data_a3</span> <span class="op">&lt;-</span> <span class="va">data_p2</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">src_subject_id</span>, <span class="va">session_id</span>, <span class="va">param_run_num</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>trial_index <span class="op">=</span> <span class="fu">row_number</span><span class="op">(</span><span class="va">param_run_num</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">data_a3lag</span> <span class="op">&lt;-</span></span>
<span>    <span class="va">data_a3</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">src_subject_id</span>, <span class="va">session_id</span>, <span class="va">param_run_num</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>lag.04outcomeangle <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/lead-lag.html">lag</a></span><span class="op">(</span><span class="va">event04_actual_angle</span>, n <span class="op">=</span> <span class="fl">1</span>, default <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">data_a3lag_omit</span> <span class="op">&lt;-</span> <span class="va">data_a3lag</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/stats/complete.cases.html">complete.cases</a></span><span class="op">(</span><span class="va">data_a3lag</span><span class="op">$</span><span class="va">lag.04outcomeangle</span><span class="op">)</span>,<span class="op">]</span></span></code></pre></div>
<div class="sourceCode" id="cb158"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>    <span class="va">trialorder_subjectwise_lagoutcome</span> <span class="op">&lt;-</span> <span class="fu">meanSummary</span><span class="op">(</span></span>
<span>        <span class="va">data_a3lag_omit</span>,</span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"src_subject_id"</span>, <span class="st">"session_id"</span>, <span class="st">"param_run_num"</span><span class="op">)</span>, <span class="st">"lag.04outcomeangle"</span> <span class="op">)</span></span>
<span>    <span class="va">trialorder_subjectwise_lagoutcome</span> <span class="op">&lt;-</span> <span class="fu">meanSummary</span><span class="op">(</span></span>
<span>        <span class="va">data_a3lag_omit</span>,</span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"src_subject_id"</span>, <span class="st">"session_id"</span>, <span class="st">"param_run_num"</span><span class="op">)</span>, <span class="st">"lag.04outcomeangle"</span> <span class="op">)</span></span>
<span></span>
<span>    <span class="co"># subjectwise_naomit &lt;- na.omit(trialorder_subjectwise)</span></span>
<span>    <span class="co"># trialorder_groupwise &lt;- summarySEwithin(</span></span>
<span>    <span class="co">#     data = subjectwise_naomit,</span></span>
<span>    <span class="co">#     measurevar = "mean_per_sub",</span></span>
<span>    <span class="co">#     withinvars = c("cue_ordered", "rating_type",  "trial_index"), idvar = subject</span></span>
<span>    <span class="co"># )</span></span></code></pre></div>
<div class="sourceCode" id="cb159"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model.lagoutcome</span> <span class="op">=</span> <span class="fu">lmer</span><span class="op">(</span><span class="va">event02_expect_angle</span> <span class="op">~</span> <span class="va">lag.04outcomeangle</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">|</span> <span class="va">src_subject_id</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">session_id</span><span class="op">)</span> , data <span class="op">=</span> <span class="va">data_a3lag_omit</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">model.lagoutcome</span><span class="op">)</span></span></code></pre></div>
<pre><code>## Linear mixed model fit by REML. t-tests use Satterthwaite's method [
## lmerModLmerTest]
## Formula: event02_expect_angle ~ lag.04outcomeangle + (1 | src_subject_id) +  
##     (1 | session_id)
##    Data: data_a3lag_omit
## 
## REML criterion at convergence: 49728.1
## 
## Scaled residuals: 
##     Min      1Q  Median      3Q     Max 
## -2.8551 -0.7402 -0.1322  0.6351  6.3909 
## 
## Random effects:
##  Groups         Name        Variance Std.Dev.
##  src_subject_id (Intercept) 121.4858 11.0221 
##  session_id     (Intercept)   0.2696  0.5192 
##  Residual                   531.1376 23.0464 
## Number of obs: 5427, groups:  src_subject_id, 110; session_id, 3
## 
## Fixed effects:
##                     Estimate Std. Error        df t value Pr(&gt;|t|)    
## (Intercept)        2.873e+01  1.230e+00 6.852e+01   23.36   &lt;2e-16 ***
## lag.04outcomeangle 1.780e-01  1.562e-02 5.374e+03   11.40   &lt;2e-16 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Correlation of Fixed Effects:
##             (Intr)
## lg.04tcmngl -0.365</code></pre>
<div class="sourceCode" id="cb161"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">meanSummary_2continuous</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">DATA</span>, <span class="va">GROUP</span>, <span class="va">DV1</span>, <span class="va">DV2</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">z</span> <span class="op">&lt;-</span> <span class="fu">ddply</span><span class="op">(</span><span class="va">DATA</span>, <span class="va">GROUP</span>, .fun <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">xx</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>            DV1_mean_per_sub <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">xx</span><span class="op">[</span>, <span class="va">DV1</span><span class="op">]</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>            DV1_sd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">xx</span><span class="op">[</span>, <span class="va">DV1</span><span class="op">]</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>            DV2_mean_per_sub <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">xx</span><span class="op">[</span>, <span class="va">DV2</span><span class="op">]</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>            DV2_sd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">xx</span><span class="op">[</span>, <span class="va">DV1</span><span class="op">]</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>        <span class="op">)</span></span>
<span>    <span class="op">}</span><span class="op">)</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">z</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<div class="sourceCode" id="cb162"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">subjectwise_2dv</span> <span class="op">=</span> <span class="fu">meanSummary_2continuous</span><span class="op">(</span><span class="va">data_a3lag_omit</span>,</span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"src_subject_id"</span>, <span class="st">"trial_index"</span><span class="op">)</span>,</span>
<span>        <span class="st">"lag.04outcomeangle"</span>, <span class="st">"event02_expect_angle"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb163"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">subjectwise_naomit_2dv</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html">na.omit</a></span><span class="op">(</span><span class="va">subjectwise_2dv</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb164"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">subjectwise_naomit_2dv</span>,</span>
<span>             <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">DV1_mean_per_sub</span>, y<span class="op">=</span><span class="va">DV2_mean_per_sub</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_abline</a></span><span class="op">(</span>intercept <span class="op">=</span> <span class="fl">0</span>, slope <span class="op">=</span> <span class="fl">1</span>, color<span class="op">=</span><span class="st">"green"</span>,</span>
<span>                 linetype<span class="op">=</span><span class="st">"dashed"</span>, size<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>aspect.ratio<span class="op">=</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">"n-1 outcome rating"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">"n expectation rating"</span><span class="op">)</span></span>
<span><span class="va">sp</span></span></code></pre></div>
<div class="inline-figure"><img src="06_iv-cue-trial_dv-expect-actual_jepma_files/figure-html/unnamed-chunk-32-1.png" width="672"></div>
<div class="sourceCode" id="cb165"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># plot(subjectwise_naomit_2dv$DV1_mean_per_sub, subjectwise_naomit_2dv$DV2_mean_per_sub) + lines(x = c(0,200), y = c(0,200))</span></span></code></pre></div>
<div class="sourceCode" id="cb166"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>    <span class="va">trialorder_groupwise</span> <span class="op">&lt;-</span> <span class="fu">summarySEwithin</span><span class="op">(</span></span>
<span>        data <span class="op">=</span> <span class="va">subjectwise_naomit_2dv</span>,</span>
<span>        measurevar <span class="op">=</span> <span class="st">"DV1_mean_per_sub"</span>,</span>
<span>        <span class="co"># betweenvars = "src_subject_id",</span></span>
<span>        withinvars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span> <span class="st">"trial_index"</span><span class="op">)</span>,</span>
<span>         idvar <span class="op">=</span> <span class="st">"src_subject_id"</span></span>
<span>    <span class="op">)</span></span></code></pre></div>
<pre><code>## Automatically converting the following non-factors to factors: src_subject_id</code></pre>
<div class="sourceCode" id="cb168"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>    <span class="va">trialorder_groupwise</span> <span class="op">&lt;-</span> <span class="fu">summarySEwithin</span><span class="op">(</span></span>
<span>        data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">subjectwise_naomit_2dv</span>, select <span class="op">=</span> <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">src_subject_id</span><span class="op">)</span><span class="op">)</span>,</span>
<span>        measurevar <span class="op">=</span> <span class="st">"DV1_mean_per_sub"</span>,</span>
<span>        <span class="co"># betweenvars = "src_subject_id",</span></span>
<span>        withinvars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span> <span class="st">"trial_index"</span><span class="op">)</span></span>
<span>         <span class="co">#idvar = "trial_index"</span></span>
<span>    <span class="op">)</span></span></code></pre></div>
<pre><code>## Automatically converting the following non-factors to factors: trial_index</code></pre>
<div class="sourceCode" id="cb170"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data_a3lag_omit</span><span class="op">$</span><span class="va">src_subject_id</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">data_a3lag_omit</span><span class="op">$</span><span class="va">src_subject_id</span><span class="op">)</span></span>
<span></span>
<span><span class="va">lag.raw</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">lag.04outcomeangle</span>, y<span class="op">=</span><span class="va">event02_expect_angle</span><span class="op">)</span>, data<span class="op">=</span><span class="va">data_a3lag_omit</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>method<span class="op">=</span><span class="st">'lm'</span>, se<span class="op">=</span><span class="cn">F</span>, size<span class="op">=</span><span class="fl">0.75</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">0.1</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_abline</a></span><span class="op">(</span>intercept <span class="op">=</span> <span class="fl">0</span>, slope <span class="op">=</span> <span class="fl">1</span>, color<span class="op">=</span><span class="st">"green"</span>,</span>
<span>                 linetype<span class="op">=</span><span class="st">"dashed"</span>, size<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">src_subject_id</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position<span class="op">=</span><span class="st">'none'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html">xlim</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">180</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html">ylim</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">180</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">"raw data from each participant: n-1 lagged outcome angle"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">"n current expectation rating"</span><span class="op">)</span></span>
<span><span class="va">lag.raw</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="va">taskname</span>, <span class="st">"- Is there a linear relationship between current expectation ratings and the previous outcome ratings?"</span><span class="op">)</span>,</span>
<span>       subtitle <span class="op">=</span> <span class="st">"Plotting the raw data - with all of the datapoints ignoring run differences"</span>,</span>
<span>       caption <span class="op">=</span> <span class="st">"Blue = fitted linear slope per participant; Green: 1:1 slope"</span><span class="op">)</span></span></code></pre></div>
<pre><code>## `geom_smooth()` using formula = 'y ~ x'</code></pre>
<pre><code>## Warning: Removed 276 rows containing non-finite values (`stat_smooth()`).</code></pre>
<pre><code>## Warning: Removed 276 rows containing missing values (`geom_point()`).</code></pre>
<div class="inline-figure"><img src="06_iv-cue-trial_dv-expect-actual_jepma_files/figure-html/unnamed-chunk-35-1.png" width="672"></div>
<div class="sourceCode" id="cb174"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">subjectwise_naomit_2dv</span><span class="op">$</span><span class="va">src_subject_id</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">subjectwise_naomit_2dv</span><span class="op">$</span><span class="va">src_subject_id</span><span class="op">)</span></span>
<span></span>
<span><span class="va">lag.avg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">DV1_mean_per_sub</span>, y<span class="op">=</span><span class="va">DV2_mean_per_sub</span><span class="op">)</span>, data<span class="op">=</span><span class="va">subjectwise_naomit_2dv</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>method<span class="op">=</span><span class="st">'lm'</span>, se<span class="op">=</span><span class="cn">F</span>, size<span class="op">=</span><span class="fl">0.75</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">0.1</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_abline</a></span><span class="op">(</span>intercept <span class="op">=</span> <span class="fl">0</span>, slope <span class="op">=</span> <span class="fl">1</span>, color<span class="op">=</span><span class="st">"green"</span>,</span>
<span>                 linetype<span class="op">=</span><span class="st">"dashed"</span>, size<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">src_subject_id</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position<span class="op">=</span><span class="st">'none'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html">xlim</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">180</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html">ylim</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">180</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">"raw data from each participant: n-1 lagged outcome angle"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">"n current expectation rating"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">lag.avg</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="va">taskname</span>, <span class="st">"- Is there a linear relationship between current expectation ratings and the previous outcome ratings?"</span><span class="op">)</span>,</span>
<span>       subtitle <span class="op">=</span> <span class="st">"Observation notes: 1) The relationship is more of an attenuated one, where the higher outcome ratings lead to a slightly lower expectation rating, and a low outcome leads to a higher expectation rating, when considering a 1:1 relationship. This pattern could be explained by regression to the mean type mechanism, where participants are accounting for the fact that their previous experience was extreme on either ends and that this current trial will be under/over estimated. It probably will make sense to also see the relationship between current expectation ratings influencing current outcome ratings. "</span>,</span>
<span>       caption <span class="op">=</span> <span class="st">"Blue = fitted linear slope per participant; Green: 1:1 slope"</span><span class="op">)</span></span></code></pre></div>
<pre><code>## `geom_smooth()` using formula = 'y ~ x'</code></pre>
<div class="inline-figure"><img src="06_iv-cue-trial_dv-expect-actual_jepma_files/figure-html/unnamed-chunk-36-1.png" width="672"></div>
<div class="sourceCode" id="cb176"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># https://gist.github.com/even4void/5074855</span></span></code></pre></div>
<div class="sourceCode" id="cb177"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">data_a3lag_omit</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">event02_expect_angle</span>,</span>
<span>                       x <span class="op">=</span> <span class="va">lag.04outcomeangle</span>,</span>
<span>                       colour <span class="op">=</span> <span class="va">subject</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">.3</span>, color <span class="op">=</span> <span class="st">'gray'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">.1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">'lm'</span>, formula<span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="va">x</span>, se <span class="op">=</span> <span class="cn">FALSE</span>, size <span class="op">=</span> <span class="fl">.3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code>## Warning: Removed 276 rows containing non-finite values (`stat_smooth()`).</code></pre>
<pre><code>## Warning: Removed 276 rows containing missing values (`geom_point()`).</code></pre>
<div class="inline-figure"><img src="06_iv-cue-trial_dv-expect-actual_jepma_files/figure-html/unnamed-chunk-38-1.png" width="672"></div>
</div>
</div>
<div id="additional-analysis" class="section level2" number="6.13">
<h2>
<span class="header-section-number">6.13</span> Additional analysis<a class="anchor" aria-label="anchor" href="#additional-analysis"><i class="fas fa-link"></i></a>
</h2>
<p>01/23/2023</p>
<div class="sourceCode" id="cb180"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model.lag_cue</span> <span class="op">=</span> <span class="fu">lmer</span><span class="op">(</span><span class="va">event02_expect_angle</span> <span class="op">~</span> <span class="va">lag.04outcomeangle</span><span class="op">*</span><span class="va">param_cue_type</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">|</span> <span class="va">src_subject_id</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">session_id</span><span class="op">)</span> , data <span class="op">=</span> <span class="va">data_a3lag_omit</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">model.lag_cue</span><span class="op">)</span></span></code></pre></div>
<pre><code>## Linear mixed model fit by REML. t-tests use Satterthwaite's method [
## lmerModLmerTest]
## Formula: event02_expect_angle ~ lag.04outcomeangle * param_cue_type +  
##     (1 | src_subject_id) + (1 | session_id)
##    Data: data_a3lag_omit
## 
## REML criterion at convergence: 46175.7
## 
## Scaled residuals: 
##     Min      1Q  Median      3Q     Max 
## -4.3458 -0.6383 -0.0833  0.5246  9.8300 
## 
## Random effects:
##  Groups         Name        Variance  Std.Dev.
##  src_subject_id (Intercept) 128.73691 11.3462 
##  session_id     (Intercept)   0.03408  0.1846 
##  Residual                   272.07427 16.4947 
## Number of obs: 5427, groups:  src_subject_id, 110; session_id, 3
## 
## Fixed effects:
##                                            Estimate Std. Error         df
## (Intercept)                                42.76857    1.21398  129.42606
## lag.04outcomeangle                          0.23730    0.01465 5394.92176
## param_cue_typelow_cue                     -27.33964    0.71898 5316.67781
## lag.04outcomeangle:param_cue_typelow_cue   -0.15072    0.01922 5309.65154
##                                          t value Pr(&gt;|t|)    
## (Intercept)                               35.230  &lt; 2e-16 ***
## lag.04outcomeangle                        16.197  &lt; 2e-16 ***
## param_cue_typelow_cue                    -38.026  &lt; 2e-16 ***
## lag.04outcomeangle:param_cue_typelow_cue  -7.842  5.3e-15 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Correlation of Fixed Effects:
##             (Intr) lg.04t prm___
## lg.04tcmngl -0.350              
## prm_c_typl_ -0.293  0.500       
## lg.04tc:___  0.227 -0.639 -0.781</code></pre>
<div class="sourceCode" id="cb182"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">meanSummary_2continuous</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">DATA</span>, <span class="va">GROUP</span>, <span class="va">DV1</span>, <span class="va">DV2</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">z</span> <span class="op">&lt;-</span> <span class="fu">ddply</span><span class="op">(</span><span class="va">DATA</span>, <span class="va">GROUP</span>, .fun <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">xx</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>            DV1_mean_per_sub <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">xx</span><span class="op">[</span>, <span class="va">DV1</span><span class="op">]</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>            DV1_sd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">xx</span><span class="op">[</span>, <span class="va">DV1</span><span class="op">]</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>            DV2_mean_per_sub <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">xx</span><span class="op">[</span>, <span class="va">DV2</span><span class="op">]</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>            DV2_sd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">xx</span><span class="op">[</span>, <span class="va">DV1</span><span class="op">]</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>        <span class="op">)</span></span>
<span>    <span class="op">}</span><span class="op">)</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">z</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<div class="sourceCode" id="cb183"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">subjectwise_cuetype</span> <span class="op">=</span> <span class="fu">meanSummary_2continuous</span><span class="op">(</span><span class="va">data_a3lag_omit</span>,</span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"src_subject_id"</span>, <span class="st">"trial_index"</span>, <span class="st">"param_cue_type"</span><span class="op">)</span>,</span>
<span>        <span class="st">"lag.04outcomeangle"</span>, <span class="st">"event02_expect_angle"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb184"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># subjectwise_cuetype_2dv &lt;- na.omit(subjectwise_cuetype)</span></span></code></pre></div>
<div class="sourceCode" id="cb185"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">subjectwise_cuetype</span><span class="op">$</span><span class="va">param_cue_type</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">subjectwise_cuetype</span><span class="op">$</span><span class="va">param_cue_type</span><span class="op">)</span></span>
<span><span class="va">sp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">subjectwise_cuetype</span>,</span>
<span>             <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">DV1_mean_per_sub</span>, y<span class="op">=</span><span class="va">DV2_mean_per_sub</span>,</span>
<span>             color <span class="op">=</span> <span class="va">param_cue_type</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_abline</a></span><span class="op">(</span>intercept <span class="op">=</span> <span class="fl">0</span>, slope <span class="op">=</span> <span class="fl">1</span>, color<span class="op">=</span><span class="st">"green"</span>,</span>
<span>                 linetype<span class="op">=</span><span class="st">"dashed"</span>, size<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">'lm'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>aspect.ratio<span class="op">=</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">"n-1 outcome rating"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">"n expectation rating"</span><span class="op">)</span></span>
<span><span class="va">sp</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="va">taskname</span>, <span class="st">"- Does the linear relationship between current expectation ratings and the previous outcome ratings differ as a function of cue?"</span><span class="op">)</span>,</span>
<span>       subtitle <span class="op">=</span> <span class="st">"Plotting the raw data - with all of the datapoints averaged across runs per 12 trials"</span>,</span>
<span>       caption <span class="op">=</span> <span class="st">"high cue vs low cue. The slope is significant, theree is not interaction; Green: 1:1 slope"</span><span class="op">)</span></span></code></pre></div>
<pre><code>## `geom_smooth()` using formula = 'y ~ x'</code></pre>
<pre><code>## Warning: Removed 49 rows containing non-finite values (`stat_smooth()`).</code></pre>
<pre><code>## Warning: Removed 49 rows containing missing values (`geom_point()`).</code></pre>
<div class="inline-figure"><img src="06_iv-cue-trial_dv-expect-actual_jepma_files/figure-html/unnamed-chunk-43-1.png" width="672"></div>
<div class="sourceCode" id="cb189"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># plot(subjectwise_naomit_2dv$DV1_mean_per_sub, subjectwise_naomit_2dv$DV2_mean_per_sub) + lines(x = c(0,200), y = c(0,200))</span></span></code></pre></div>

</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="beh-outcome-cueXstim.html"><span class="header-section-number">5</span> beh :: outcome ~ cue * stim</a></div>
<div class="next"><a href="scaling.html"><span class="header-section-number">7</span> within / between subject effect and Scaling</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#jepma"><span class="header-section-number">6</span> beh :: expect-outcome ~ cue * trial</a></li>
<li>
<a class="nav-link" href="#overview"><span class="header-section-number">6.1</span> Overview</a><ul class="nav navbar-nav"><li><a class="nav-link" href="#some-thoughts-todos">Some thoughts, TODOs</a></li></ul>
</li>
<li><a class="nav-link" href="#plot-1---one-run-average-across-participants"><span class="header-section-number">6.2</span> plot 1 - one run, average across participants</a></li>
<li>
<a class="nav-link" href="#plot-2---average-across-participant-but-spread-all-6-runs-in-one-x-axis"><span class="header-section-number">6.3</span> plot 2 - average across participant, but spread all 6 runs in one x axis</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#p2-check-number-of-trials-per-participant">p2 :: check number of trials per participant</a></li>
<li><a class="nav-link" href="#p2-identify-erroneous-participant">p2 :: identify erroneous participant</a></li>
<li><a class="nav-link" href="#p2-convert-to-long-form">p2 :: convert to long form</a></li>
<li><a class="nav-link" href="#p2-plot-data">p2 :: plot data</a></li>
</ul>
</li>
<li><a class="nav-link" href="#plot-data-version-2"><span class="header-section-number">6.4</span> plot data version 2</a></li>
<li><a class="nav-link" href="#subset-of-participants"><span class="header-section-number">6.5</span> subset of participants</a></li>
<li><a class="nav-link" href="#vicarious-3"><span class="header-section-number">6.6</span> vicarious</a></li>
<li><a class="nav-link" href="#cognitive-3"><span class="header-section-number">6.7</span> cognitive</a></li>
<li><a class="nav-link" href="#within-subject-vicarious"><span class="header-section-number">6.8</span> within subject vicarious</a></li>
<li>
<a class="nav-link" href="#tor-request-only-outcome-ratings.-3-tasks"><span class="header-section-number">6.9</span> Tor request – only outcome ratings. 3 tasks</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#pain-3"><span class="header-section-number">6.9.1</span> pain</a></li>
<li><a class="nav-link" href="#vicarious-4"><span class="header-section-number">6.9.2</span> vicarious</a></li>
<li><a class="nav-link" href="#cognitive-4"><span class="header-section-number">6.9.3</span> cognitive</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#tor-request-only-expect-ratings.-3-tasks"><span class="header-section-number">6.10</span> Tor request – only expect ratings. 3 tasks</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#pain-4"><span class="header-section-number">6.10.1</span> pain</a></li>
<li><a class="nav-link" href="#vicarious-5"><span class="header-section-number">6.10.2</span> vicarious</a></li>
<li><a class="nav-link" href="#cognitive-5"><span class="header-section-number">6.10.3</span> cognitive</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#lmer"><span class="header-section-number">6.11</span> lmer</a><ul class="nav navbar-nav"><li><a class="nav-link" href="#lmer-histogram"><span class="header-section-number">6.11.1</span> lmer histogram</a></li></ul>
</li>
<li>
<a class="nav-link" href="#do-current-expectation-ratings-predict-outcome-ratings"><span class="header-section-number">6.12</span> Do current expectation ratings predict outcome ratings?</a><ul class="nav navbar-nav"><li><a class="nav-link" href="#additional-analyse-01182023">Additional analyse 01/18/2023</a></li></ul>
</li>
<li><a class="nav-link" href="#additional-analysis"><span class="header-section-number">6.13</span> Additional analysis</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/jungheejung/cue_expectancy/blob/master/06_iv-cue-trial_dv-expect-actual_jepma.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/jungheejung/cue_expectancy/edit/master/06_iv-cue-trial_dv-expect-actual_jepma.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Your Document Title</strong>" was written by Your Name. It was last built on 16 January, 2024.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer>
</body>
</html>
