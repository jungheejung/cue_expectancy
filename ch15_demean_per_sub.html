<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 8 [ beh ] outcome_demean ~ cue * stim * expectrating * n-1outcomerating | 52_ROI TTL1</title>
  <meta name="description" content="This is a logbook of all the mixed model analyses in one setting." />
  <meta name="generator" content="bookdown 0.37 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 8 [ beh ] outcome_demean ~ cue * stim * expectrating * n-1outcomerating | 52_ROI TTL1" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="This is a logbook of all the mixed model analyses in one setting." />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 8 [ beh ] outcome_demean ~ cue * stim * expectrating * n-1outcomerating | 52_ROI TTL1" />
  
  <meta name="twitter:description" content="This is a logbook of all the mixed model analyses in one setting." />
  

<meta name="author" content="Heejung Jung" />


<meta name="date" content="2023-08-14" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="ch06_Jepma.html"/>
<link rel="next" href="ch17_mediation.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/codefolding-lua-1.1/codefolding-lua.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.10.3/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-2.11.1/plotly-latest.min.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> About</a></li>
<li class="part"><span><b>Behavioral</b></span></li>
<li class="chapter" data-level="" data-path="action-intro.html"><a href="action-intro.html"><i class="fa fa-check"></i>Behavioral Rating analysis</a></li>
<li class="chapter" data-level="2" data-path="ch2_expect.html"><a href="ch2_expect.html"><i class="fa fa-check"></i><b>2</b> [beh] expectation ~ cue</a>
<ul>
<li class="chapter" data-level="2.1" data-path="ch2_expect.html"><a href="ch2_expect.html#pain"><i class="fa fa-check"></i><b>2.1</b> Pain</a></li>
<li class="chapter" data-level="2.2" data-path="ch2_expect.html"><a href="ch2_expect.html#vicarious"><i class="fa fa-check"></i><b>2.2</b> Vicarious</a></li>
<li class="chapter" data-level="2.3" data-path="ch2_expect.html"><a href="ch2_expect.html#cognitive"><i class="fa fa-check"></i><b>2.3</b> Cognitive</a></li>
<li class="chapter" data-level="2.4" data-path="ch2_expect.html"><a href="ch2_expect.html#individual-difference-analysis"><i class="fa fa-check"></i><b>2.4</b> Individual difference analysis</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="ch03_cue.html"><a href="ch03_cue.html"><i class="fa fa-check"></i><b>3</b> [beh] outcome ~ cue</a>
<ul>
<li class="chapter" data-level="3.1" data-path="ch03_cue.html"><a href="ch03_cue.html#pain-1"><i class="fa fa-check"></i><b>3.1</b> Pain</a></li>
<li class="chapter" data-level="3.2" data-path="ch03_cue.html"><a href="ch03_cue.html#vicarious-1"><i class="fa fa-check"></i><b>3.2</b> Vicarious</a></li>
<li class="chapter" data-level="3.3" data-path="ch03_cue.html"><a href="ch03_cue.html#cognitive-1"><i class="fa fa-check"></i><b>3.3</b> Cognitive</a></li>
<li class="chapter" data-level="3.4" data-path="ch03_cue.html"><a href="ch03_cue.html#individual-differences-analysis-random-cue-effects"><i class="fa fa-check"></i><b>3.4</b> Individual differences analysis: random cue effects</a></li>
<li class="chapter" data-level="3.5" data-path="ch03_cue.html"><a href="ch03_cue.html#individual-differences-analysis-2-random-intercept-random-slopes-of-cue-effect"><i class="fa fa-check"></i><b>3.5</b> Individual differences analysis 2: random intercept + random slopes of cue effect</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="ch04_outcome-stim.html"><a href="ch04_outcome-stim.html"><i class="fa fa-check"></i><b>4</b> [beh] outcome ~ stimulus_intensity</a>
<ul>
<li class="chapter" data-level="4.1" data-path="ch04_outcome-stim.html"><a href="ch04_outcome-stim.html#pain-2"><i class="fa fa-check"></i><b>4.1</b> Pain</a></li>
<li class="chapter" data-level="4.2" data-path="ch04_outcome-stim.html"><a href="ch04_outcome-stim.html#vicarious-2"><i class="fa fa-check"></i><b>4.2</b> Vicarious</a></li>
<li class="chapter" data-level="4.3" data-path="ch04_outcome-stim.html"><a href="ch04_outcome-stim.html#cognitive-2"><i class="fa fa-check"></i><b>4.3</b> Cognitive</a></li>
<li class="chapter" data-level="4.4" data-path="ch04_outcome-stim.html"><a href="ch04_outcome-stim.html#for-loop"><i class="fa fa-check"></i><b>4.4</b> for loop</a></li>
<li class="chapter" data-level="4.5" data-path="ch04_outcome-stim.html"><a href="ch04_outcome-stim.html#lineplot"><i class="fa fa-check"></i><b>4.5</b> Lineplot</a></li>
<li class="chapter" data-level="4.6" data-path="ch04_outcome-stim.html"><a href="ch04_outcome-stim.html#individual-differences-in-outcome-rating-cue-effect"><i class="fa fa-check"></i><b>4.6</b> individual differences in outcome rating cue effect</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="ch05_outcome-cueXstim.html"><a href="ch05_outcome-cueXstim.html"><i class="fa fa-check"></i><b>5</b> [beh] outcome_rating ~ cue * stim</a>
<ul>
<li class="chapter" data-level="5.1" data-path="ch05_outcome-cueXstim.html"><a href="ch05_outcome-cueXstim.html#model-03-iv-cuecontrast-dv-outcome"><i class="fa fa-check"></i><b>5.1</b> model 03 iv-cuecontrast dv-outcome</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="ch05_outcome-cueXstim.html"><a href="ch05_outcome-cueXstim.html#model-03-3-2.-individual-difference"><i class="fa fa-check"></i><b>5.1.1</b> model 03 3-2. individual difference</a></li>
<li class="chapter" data-level="5.1.2" data-path="ch05_outcome-cueXstim.html"><a href="ch05_outcome-cueXstim.html#model-04-iv-cue-stim-dv-outcome"><i class="fa fa-check"></i><b>5.1.2</b> model 04 iv-cue-stim dv-outcome</a></li>
<li class="chapter" data-level="5.1.3" data-path="ch05_outcome-cueXstim.html"><a href="ch05_outcome-cueXstim.html#nov-17-lmer"><i class="fa fa-check"></i><b>5.1.3</b> Nov 17 lmer</a></li>
<li class="chapter" data-level="5.1.4" data-path="ch05_outcome-cueXstim.html"><a href="ch05_outcome-cueXstim.html#model-04-4-2-individual-differences-in-cue-effects"><i class="fa fa-check"></i><b>5.1.4</b> model 04 4-2 individual differences in cue effects</a></li>
<li class="chapter" data-level="5.1.5" data-path="ch05_outcome-cueXstim.html"><a href="ch05_outcome-cueXstim.html#model-04-4-3-scatter-plot"><i class="fa fa-check"></i><b>5.1.5</b> model 04 4-3 scatter plot</a></li>
<li class="chapter" data-level="5.1.6" data-path="ch05_outcome-cueXstim.html"><a href="ch05_outcome-cueXstim.html#model-04-4-4-lineplot"><i class="fa fa-check"></i><b>5.1.6</b> model 04 4-4 lineplot</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="clinical-trials.html"><a href="clinical-trials.html"><i class="fa fa-check"></i><b>6</b> Clinical trials</a>
<ul>
<li class="chapter" data-level="6.1" data-path="clinical-trials.html"><a href="clinical-trials.html#cue-contrast-average-across-intensity"><i class="fa fa-check"></i><b>6.1</b> cue contrast average across intensity</a></li>
<li class="chapter" data-level="6.2" data-path="clinical-trials.html"><a href="clinical-trials.html#cue-contrast-average-across-expectation"><i class="fa fa-check"></i><b>6.2</b> cue contrast average across expectation</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="ch06_Jepma.html"><a href="ch06_Jepma.html"><i class="fa fa-check"></i><b>7</b> expect-actual ~ cue * trial</a>
<ul>
<li class="chapter" data-level="7.1" data-path="ch06_Jepma.html"><a href="ch06_Jepma.html#overview"><i class="fa fa-check"></i><b>7.1</b> Overview</a></li>
<li class="chapter" data-level="7.2" data-path="ch06_Jepma.html"><a href="ch06_Jepma.html#plot-1---one-run-average-across-participants"><i class="fa fa-check"></i><b>7.2</b> plot 1 - one run, average across participants</a></li>
<li class="chapter" data-level="7.3" data-path="ch06_Jepma.html"><a href="ch06_Jepma.html#plot-2---average-across-participant-but-spread-all-6-runs-in-one-x-axis"><i class="fa fa-check"></i><b>7.3</b> plot 2 - average across participant, but spread all 6 runs in one x axis</a></li>
<li class="chapter" data-level="7.4" data-path="ch06_Jepma.html"><a href="ch06_Jepma.html#vicarious-3"><i class="fa fa-check"></i><b>7.4</b> vicarious</a></li>
<li class="chapter" data-level="7.5" data-path="ch06_Jepma.html"><a href="ch06_Jepma.html#cognitive-3"><i class="fa fa-check"></i><b>7.5</b> cognitive</a></li>
<li class="chapter" data-level="7.6" data-path="ch06_Jepma.html"><a href="ch06_Jepma.html#within-subject-vicarious"><i class="fa fa-check"></i><b>7.6</b> within subject vicarious</a></li>
<li class="chapter" data-level="7.7" data-path="ch06_Jepma.html"><a href="ch06_Jepma.html#tor-request-only-outcome-ratings.-3-tasks"><i class="fa fa-check"></i><b>7.7</b> Tor request – only outcome ratings. 3 tasks</a>
<ul>
<li class="chapter" data-level="7.7.1" data-path="ch06_Jepma.html"><a href="ch06_Jepma.html#pain-3"><i class="fa fa-check"></i><b>7.7.1</b> pain</a></li>
<li class="chapter" data-level="7.7.2" data-path="ch06_Jepma.html"><a href="ch06_Jepma.html#vicarious-4"><i class="fa fa-check"></i><b>7.7.2</b> vicarious</a></li>
<li class="chapter" data-level="7.7.3" data-path="ch06_Jepma.html"><a href="ch06_Jepma.html#cognitive-4"><i class="fa fa-check"></i><b>7.7.3</b> cognitive</a></li>
</ul></li>
<li class="chapter" data-level="7.8" data-path="ch06_Jepma.html"><a href="ch06_Jepma.html#tor-request-only-expect-ratings.-3-tasks"><i class="fa fa-check"></i><b>7.8</b> Tor request – only expect ratings. 3 tasks</a>
<ul>
<li class="chapter" data-level="7.8.1" data-path="ch06_Jepma.html"><a href="ch06_Jepma.html#pain-4"><i class="fa fa-check"></i><b>7.8.1</b> pain</a></li>
<li class="chapter" data-level="7.8.2" data-path="ch06_Jepma.html"><a href="ch06_Jepma.html#vicarious-5"><i class="fa fa-check"></i><b>7.8.2</b> vicarious</a></li>
<li class="chapter" data-level="7.8.3" data-path="ch06_Jepma.html"><a href="ch06_Jepma.html#cognitive-5"><i class="fa fa-check"></i><b>7.8.3</b> cognitive</a></li>
</ul></li>
<li class="chapter" data-level="7.9" data-path="ch06_Jepma.html"><a href="ch06_Jepma.html#lmer"><i class="fa fa-check"></i><b>7.9</b> lmer</a>
<ul>
<li class="chapter" data-level="7.9.1" data-path="ch06_Jepma.html"><a href="ch06_Jepma.html#lmer-histogram"><i class="fa fa-check"></i><b>7.9.1</b> lmer histogram</a></li>
</ul></li>
<li class="chapter" data-level="7.10" data-path="ch06_Jepma.html"><a href="ch06_Jepma.html#do-current-expectation-ratings-predict-outcome-ratings"><i class="fa fa-check"></i><b>7.10</b> Do current expectation ratings predict outcome ratings?</a></li>
<li class="chapter" data-level="7.11" data-path="ch06_Jepma.html"><a href="ch06_Jepma.html#additional-analysis"><i class="fa fa-check"></i><b>7.11</b> Additional analysis</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="ch15_demean_per_sub.html"><a href="ch15_demean_per_sub.html"><i class="fa fa-check"></i><b>8</b> [ beh ] outcome_demean ~ cue * stim * expectrating * n-1outcomerating</a>
<ul>
<li class="chapter" data-level="8.1" data-path="ch15_demean_per_sub.html"><a href="ch15_demean_per_sub.html#linear-model-0508"><i class="fa fa-check"></i><b>8.1</b> linear model 0508</a></li>
<li class="chapter" data-level="8.2" data-path="ch15_demean_per_sub.html"><a href="ch15_demean_per_sub.html#linear-model"><i class="fa fa-check"></i><b>8.2</b> linear model</a></li>
<li class="chapter" data-level="8.3" data-path="ch15_demean_per_sub.html"><a href="ch15_demean_per_sub.html#q.-are-those-overestimating-for-high-cues-also-underestimators-for-low-cues"><i class="fa fa-check"></i><b>8.3</b> Q. Are those overestimating for high cues also underestimators for low cues?</a></li>
<li class="chapter" data-level="8.4" data-path="ch15_demean_per_sub.html"><a href="ch15_demean_per_sub.html#todo-can-you-test-if-the-slopes-are-the-same-that-might-tell-us-something-about-whether-expectancies-translate-into-outcomes-with-the-same-efficacy-across-all-three-tasks."><i class="fa fa-check"></i><b>8.4</b> TODO: Can you test if the slopes are the same? That might tell us something about whether, expectancies translate into outcomes with the same efficacy across all three tasks.</a></li>
<li class="chapter" data-level="8.5" data-path="ch15_demean_per_sub.html"><a href="ch15_demean_per_sub.html#pain-run-collapsed-across-stimulus-intensity"><i class="fa fa-check"></i><b>8.5</b> pain run, collapsed across stimulus intensity</a></li>
<li class="chapter" data-level="8.6" data-path="ch15_demean_per_sub.html"><a href="ch15_demean_per_sub.html#vicarious-6"><i class="fa fa-check"></i><b>8.6</b> vicarious</a></li>
<li class="chapter" data-level="8.7" data-path="ch15_demean_per_sub.html"><a href="ch15_demean_per_sub.html#cognitive-6"><i class="fa fa-check"></i><b>8.7</b> cognitive</a></li>
<li class="chapter" data-level="8.8" data-path="ch15_demean_per_sub.html"><a href="ch15_demean_per_sub.html#linear-model-0508-1"><i class="fa fa-check"></i><b>8.8</b> linear model 0508</a></li>
<li class="chapter" data-level="8.9" data-path="ch15_demean_per_sub.html"><a href="ch15_demean_per_sub.html#across-tasks-pvc-is-the-slope-for-highvslow-cue-the-sametor-question"><i class="fa fa-check"></i><b>8.9</b> across tasks (PVC), is the slope for (highvslow cue) the same?Tor question</a></li>
<li class="chapter" data-level="8.10" data-path="ch15_demean_per_sub.html"><a href="ch15_demean_per_sub.html#alireza-congruent-incongruent-pe"><i class="fa fa-check"></i><b>8.10</b> Alireza congruent incongruent (PE)</a>
<ul>
<li class="chapter" data-level="8.10.1" data-path="ch15_demean_per_sub.html"><a href="ch15_demean_per_sub.html#archive-this-cell"><i class="fa fa-check"></i><b>8.10.1</b> archive this cell</a></li>
</ul></li>
<li class="chapter" data-level="8.11" data-path="ch15_demean_per_sub.html"><a href="ch15_demean_per_sub.html#alireza-congruent-incongruent-incorrect"><i class="fa fa-check"></i><b>8.11</b> Alireza congruent incongruent (incorrect)</a>
<ul>
<li class="chapter" data-level="8.11.1" data-path="ch15_demean_per_sub.html"><a href="ch15_demean_per_sub.html#archive-this-cell-1"><i class="fa fa-check"></i><b>8.11.1</b> archive this cell</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="ch17_mediation.html"><a href="ch17_mediation.html"><i class="fa fa-check"></i><b>9</b> [beh] Mediation outcome ~ cue * stim * expectrating * n-1outcomerating</a>
<ul>
<li class="chapter" data-level="9.1" data-path="ch17_mediation.html"><a href="ch17_mediation.html#mediation"><i class="fa fa-check"></i><b>9.1</b> mediation</a></li>
<li class="chapter" data-level="9.2" data-path="ch17_mediation.html"><a href="ch17_mediation.html#mediation-2"><i class="fa fa-check"></i><b>9.2</b> mediation 2</a></li>
<li class="chapter" data-level="9.3" data-path="ch17_mediation.html"><a href="ch17_mediation.html#mediation-3-test-same-model-using-mediation-from-mbess"><i class="fa fa-check"></i><b>9.3</b> mediation 3: Test same model using mediation() from MBESS</a></li>
<li class="chapter" data-level="9.4" data-path="ch17_mediation.html"><a href="ch17_mediation.html#mediation-4-test-library-mediation"><i class="fa fa-check"></i><b>9.4</b> mediation 4: Test library mediation</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="ch18_simulation.html"><a href="ch18_simulation.html"><i class="fa fa-check"></i><b>10</b> [beh] RL simulation</a>
<ul>
<li class="chapter" data-level="10.1" data-path="ch18_simulation.html"><a href="ch18_simulation.html#function"><i class="fa fa-check"></i><b>10.1</b> function</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="ch18_simulation_aryan.html"><a href="ch18_simulation_aryan.html"><i class="fa fa-check"></i><b>11</b> [beh] RL simulation Aryan</a>
<ul>
<li class="chapter" data-level="11.1" data-path="ch18_simulation_aryan.html"><a href="ch18_simulation_aryan.html#plot-the-relationship-between-expectation-and-outcome-rating-using-model-4-simulations-jepma"><i class="fa fa-check"></i><b>11.1</b> Plot the relationship between expectation and outcome rating using model 4 simulations (Jepma)</a></li>
<li class="chapter" data-level="11.2" data-path="ch18_simulation_aryan.html"><a href="ch18_simulation_aryan.html#plot-the-relationship-between-expectation-and-outcome-rating-using-model-2-simulations-jepma"><i class="fa fa-check"></i><b>11.2</b> Plot the relationship between expectation and outcome rating using model 2 simulations (Jepma)</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="ch18_simulation_aryan.html"><a href="ch18_simulation_aryan.html#model-fits-from-model-2.-expectation-ratings-jepma-model"><i class="fa fa-check"></i><b>11.2.1</b> model fits from model 2. expectation ratings (Jepma model)</a></li>
<li class="chapter" data-level="11.2.2" data-path="ch18_simulation_aryan.html"><a href="ch18_simulation_aryan.html#model-fits-from-model-2.-outcome-ratings-jepma-model"><i class="fa fa-check"></i><b>11.2.2</b> model fits from model 2. outcome ratings (Jepma model)</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="ch18_simulation_aryan.html"><a href="ch18_simulation_aryan.html#correlation-betweeen-alpha_incongruent-and-cue-trial-slope-randome-effects-of-cue"><i class="fa fa-check"></i><b>11.3</b> correlation betweeen alpha_incongruent and cue trial slope (randome effects of cue)</a></li>
<li class="chapter" data-level="11.4" data-path="ch18_simulation_aryan.html"><a href="ch18_simulation_aryan.html#correlation-betweeen-alpha_incongruent-and-nps"><i class="fa fa-check"></i><b>11.4</b> correlation betweeen alpha_incongruent and NPS</a></li>
<li class="chapter" data-level="11.5" data-path="ch18_simulation_aryan.html"><a href="ch18_simulation_aryan.html#correlation-bettween-nps-and-pe"><i class="fa fa-check"></i><b>11.5</b> correlation bettween NPS and PE</a>
<ul>
<li class="chapter" data-level="11.5.1" data-path="ch18_simulation_aryan.html"><a href="ch18_simulation_aryan.html#test-similarity-between-nps-positive-values-and-pe-11062023"><i class="fa fa-check"></i><b>11.5.1</b> test similarity between NPS positive values and PE (11/06/2023)</a></li>
<li class="chapter" data-level="11.5.2" data-path="ch18_simulation_aryan.html"><a href="ch18_simulation_aryan.html#test-relationship-between-pe-and-cue-type-and-stimintensity-06162023"><i class="fa fa-check"></i><b>11.5.2</b> test relationship between PE and cue type and stimintensity (06/16/2023)</a></li>
<li class="chapter" data-level="11.5.3" data-path="ch18_simulation_aryan.html"><a href="ch18_simulation_aryan.html#plot-the-relationship-between-pe-and-nps-as-a-function-of-cue"><i class="fa fa-check"></i><b>11.5.3</b> plot the relationship between PE and NPS as a function of cue</a></li>
<li class="chapter" data-level="11.5.4" data-path="ch18_simulation_aryan.html"><a href="ch18_simulation_aryan.html#plot-the-relationship-between-pe-and-nps-as-a-function-of-cue-and-stimulus-intensity"><i class="fa fa-check"></i><b>11.5.4</b> plot the relationship between PE and NPS as a function of cue and stimulus intensity</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="ch20_npssimulation.html"><a href="ch20_npssimulation.html"><i class="fa fa-check"></i><b>12</b> [model] NPSsimulation</a>
<ul>
<li class="chapter" data-level="12.0.1" data-path="ch20_npssimulation.html"><a href="ch20_npssimulation.html#function-1"><i class="fa fa-check"></i><b>12.0.1</b> Function</a></li>
<li class="chapter" data-level="12.0.2" data-path="ch20_npssimulation.html"><a href="ch20_npssimulation.html#nps-data"><i class="fa fa-check"></i><b>12.0.2</b> NPS data</a></li>
<li class="chapter" data-level="12.0.3" data-path="ch20_npssimulation.html"><a href="ch20_npssimulation.html#behavioral-data"><i class="fa fa-check"></i><b>12.0.3</b> behavioral data</a></li>
<li class="chapter" data-level="12.0.4" data-path="ch20_npssimulation.html"><a href="ch20_npssimulation.html#get-pain-relationship-controlling-for-cue-cuetype-expect"><i class="fa fa-check"></i><b>12.0.4</b> get pain relationship, controlling for cue, cuetype, expect</a></li>
<li class="chapter" data-level="12.1" data-path="ch20_npssimulation.html"><a href="ch20_npssimulation.html#simulation"><i class="fa fa-check"></i><b>12.1</b> simulation **</a></li>
</ul></li>
<li class="part"><span><b>fMRI timeseries</b></span></li>
<li class="chapter" data-level="" data-path="fmri_time.html"><a href="fmri_time.html"><i class="fa fa-check"></i>fMRI timeseries</a></li>
<li class="chapter" data-level="13" data-path="ch51_fir_glasserTPJttl2.html"><a href="ch51_fir_glasserTPJttl2.html"><i class="fa fa-check"></i><b>13</b> [fMRI] FIR ~ task</a>
<ul>
<li class="chapter" data-level="13.1" data-path="ch51_fir_glasserTPJttl2.html"><a href="ch51_fir_glasserTPJttl2.html#parameters-todo-ignore"><i class="fa fa-check"></i><b>13.1</b> parameters {TODO: ignore}</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="taskwise-stim-effect.html"><a href="taskwise-stim-effect.html"><i class="fa fa-check"></i><b>14</b> taskwise stim effect</a>
<ul>
<li class="chapter" data-level="14.0.1" data-path="taskwise-stim-effect.html"><a href="taskwise-stim-effect.html#pca-subjectwise"><i class="fa fa-check"></i><b>14.0.1</b> PCA subjectwise</a></li>
<li class="chapter" data-level="14.0.2" data-path="taskwise-stim-effect.html"><a href="taskwise-stim-effect.html#pca-groupwise"><i class="fa fa-check"></i><b>14.0.2</b> PCA groupwise</a></li>
<li class="chapter" data-level="14.1" data-path="taskwise-stim-effect.html"><a href="taskwise-stim-effect.html#dep-epoch-stim-high-cue-vs-low-cue"><i class="fa fa-check"></i><b>14.1</b> DEP: epoch: stim, high cue vs low cue</a></li>
<li class="chapter" data-level="14.2" data-path="taskwise-stim-effect.html"><a href="taskwise-stim-effect.html#taskwise-cue-effect"><i class="fa fa-check"></i><b>14.2</b> taskwise cue effect</a></li>
<li class="chapter" data-level="14.3" data-path="taskwise-stim-effect.html"><a href="taskwise-stim-effect.html#epoch-stim-rating"><i class="fa fa-check"></i><b>14.3</b> epoch: stim, rating</a></li>
<li class="chapter" data-level="14.4" data-path="taskwise-stim-effect.html"><a href="taskwise-stim-effect.html#epoch-6-cond"><i class="fa fa-check"></i><b>14.4</b> epoch: 6 cond</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="taskwise-6-cond-effect.html"><a href="taskwise-6-cond-effect.html"><i class="fa fa-check"></i><b>15</b> taskwise 6 cond effect</a></li>
<li class="chapter" data-level="16" data-path="ch52_timeseries.html"><a href="ch52_timeseries.html"><i class="fa fa-check"></i><b>16</b> [fMRI] FIR ~ task TTL1</a>
<ul>
<li class="chapter" data-level="16.1" data-path="ch52_timeseries.html"><a href="ch52_timeseries.html#references"><i class="fa fa-check"></i><b>16.1</b> references</a></li>
<li class="chapter" data-level="16.2" data-path="ch52_timeseries.html"><a href="ch52_timeseries.html#taskwise-stim-effect-1"><i class="fa fa-check"></i><b>16.2</b> taskwise stim effect</a>
<ul>
<li class="chapter" data-level="16.2.1" data-path="ch52_timeseries.html"><a href="ch52_timeseries.html#pca-subjectwise-1"><i class="fa fa-check"></i><b>16.2.1</b> PCA subjectwise</a></li>
<li class="chapter" data-level="16.2.2" data-path="ch52_timeseries.html"><a href="ch52_timeseries.html#pca-groupwise-1"><i class="fa fa-check"></i><b>16.2.2</b> PCA groupwise</a></li>
</ul></li>
<li class="chapter" data-level="16.3" data-path="ch52_timeseries.html"><a href="ch52_timeseries.html#taskwise-cue-effect-1"><i class="fa fa-check"></i><b>16.3</b> taskwise cue effect</a>
<ul>
<li class="chapter" data-level="16.3.1" data-path="ch52_timeseries.html"><a href="ch52_timeseries.html#epoch-stim-rating-1"><i class="fa fa-check"></i><b>16.3.1</b> epoch: stim, rating</a></li>
</ul></li>
<li class="chapter" data-level="16.4" data-path="ch52_timeseries.html"><a href="ch52_timeseries.html#main-sandbox-6-condition-in-three-panels.-per-task.-per-roi"><i class="fa fa-check"></i><b>16.4</b> MAIN SANDBOX: 6 condition in three panels. per task. per ROI</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">52_ROI TTL1</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="ch15_demean_per_sub" class="section level1 hasAnchor" number="8">
<h1><span class="header-section-number">Chapter 8</span> [ beh ] outcome_demean ~ cue * stim * expectrating * n-1outcomerating<a href="ch15_demean_per_sub.html#ch15_demean_per_sub" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="what-is-the-purpose-of-this-notebook-4" class="section level2 unlisted unnumbered hasAnchor">
<h2>What is the purpose of this notebook?<a href="ch15_demean_per_sub.html#what-is-the-purpose-of-this-notebook-4" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Here, I model the outcome ratings as a function of cue, stimulus intensity, expectation ratings, N-1 outcome rating.
* As opposed to notebook 14, I demean the ratings within participants
* In other words, calculate the average within subjects and subtract ratings
* Main model: <code>lmer(outcome_rating ~ cue * stim * expectation rating + N-1 outcomerating)</code>
* Main question: What constitutes a reported outcome rating?
* Sub questions:
- If there is a linear relationship between expectation rating and outcome rating, does this differ as a function of cue?
- How does a N-1 outcome rating affect current expectation ratings?
- Later, is this effect different across tasks or are they similar?</p>
<ul>
<li>IV:
stim (high / med / low)
cue (high / low)
expectation rating (continuous)
N-1 outcome rating (continuous)</li>
<li>DV: outcome rating</li>
</ul>
<div id="some-thoughts-todos-1" class="section level3 unlisted unnumbered hasAnchor">
<h3>Some thoughts, TODOs<a href="ch15_demean_per_sub.html#some-thoughts-todos-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>Standardized coefficients</li>
<li>Slope difference? Intercept difference? ( cue and expectation rating)</li>
<li>Correct for the range (within participant)
hypothesis:</li>
</ul>
<ol style="list-style-type: decimal">
<li>Larger expectation leads to prediction error</li>
<li>Individual differences in ratings</li>
<li>Outcome experience, based on behavioral experience
What are the brain maps associated with each component.</li>
</ol>
<p>load data and combine participant data</p>
<pre><code>##  event02_expect_RT event04_actual_RT event02_expect_angle event04_actual_angle
##  Min.   :0.6504    Min.   :0.0168    Min.   :  0.00       Min.   :  0.00      
##  1st Qu.:1.6341    1st Qu.:1.9197    1st Qu.: 30.18       1st Qu.: 38.80      
##  Median :2.0517    Median :2.3510    Median : 58.56       Median : 60.77      
##  Mean   :2.1397    Mean   :2.4005    Mean   : 62.94       Mean   : 66.33      
##  3rd Qu.:2.5678    3rd Qu.:2.8512    3rd Qu.: 90.00       3rd Qu.: 88.38      
##  Max.   :3.9912    Max.   :3.9930    Max.   :180.00       Max.   :180.00      
##  NA&#39;s   :661       NA&#39;s   :638       NA&#39;s   :661          NA&#39;s   :641</code></pre>
<div class="plotly html-widget html-fill-item" id="htmlwidget-6238b3a33958aa5a2227" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-6238b3a33958aa5a2227">{"x":{"visdat":{"2b255cb7159c":["function () ","plotlyVisDat"]},"cur_data":"2b255cb7159c","attrs":{"2b255cb7159c":{"z":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"heatmap","colors":["#590007","#590007","#5B0107","#5C0108","#5D0207","#5D0207","#5E0308","#5F0308","#600407","#610507","#620606","#620606","#630707","#640807","#650906","#660906","#670A07","#670B07","#680C06","#690C06","#6A0D06","#6B0D06","#6C0E07","#6C0F07","#6D1006","#6E1006","#6F1107","#701207","#711306","#721306","#731405","#731405","#741506","#751606","#761705","#771705","#781806","#791906","#7A1A05","#7B1A06","#7C1B06","#7D1C06","#7E1D05","#7E1D06","#7F1E06","#801E06","#822006","#832106","#842105","#852206","#862206","#872406","#882506","#892606","#8A2605","#8B2706","#8C2806","#8D2905","#8E2A05","#8F2B06","#902C06","#912D05","#932E05","#942F06","#953006","#963107","#973206","#983307","#993407","#9A3508","#9B3608","#9C3709","#9E3809","#9F390A","#A03B0A","#A13C0B","#A23D0C","#A33E0D","#A43F0E","#A5410F","#A6420F","#A74310","#A84411","#A94612","#AA4713","#AB4914","#AC4915","#AE4A16","#AE4B17","#AF4D19","#AF4E1A","#B1501C","#B2511D","#B2521E","#B3531F","#B4531F","#B55521","#B55622","#B65824","#B65925","#B75A26","#B75B27","#B85C28","#B95D29","#BA5E2A","#BA5F2C","#BB602D","#BB612E","#BC622F","#BC6330","#BD6431","#BD6432","#BE6533","#BD6635","#BE6736","#BE6837","#BF6938","#BF6A39","#C06B3A","#C06C3B","#C16D3C","#C16D3E","#C26E3F","#C16F40","#C27041","#C27142","#C37243","#C37344","#C47446","#C47447","#C57548","#C57649","#C6774A","#C5784B","#C67A4D","#C67A4E","#C77B50","#C87C51","#C87C51","#C97E53","#C87F54","#C98056","#C98157","#CA8258","#CA8259","#CB835A","#CB845B","#CC855D","#CB865E","#CC875F","#CC8860","#CD8961","#CD8A63","#CE8B64","#CE8B65","#CF8C66","#CE8D67","#CF8E68","#CF8F6A","#D0906B","#D0916C","#D1926D","#D1936F","#D29470","#D29471","#D39572","#D29673","#D39775","#D39876","#D49977","#D49A78","#D59B7A","#D59C7B","#D69D7C","#D59E7D","#D69F7F","#D69F80","#D7A081","#D7A182","#D8A284","#D8A385","#D9A486","#DAA688","#DAA789","#DBA88B","#DAA98C","#DBAA8D","#DBAB8E","#DCAC90","#DCAD91","#DDAE93","#DDAF94","#DEB095","#DEB196","#DFB298","#DEB399","#DFB49A","#DFB59B","#E0B69D","#E0B79F","#E1B8A0","#E1B9A1","#E2BAA2","#E2BBA4","#E3BCA5","#E3BDA7","#E4BEA8","#E3BEA9","#E4BFAA","#E4C0AC","#E5C1AE","#E5C3AF","#E6C4B0","#E6C5B1","#E7C6B2","#E7C7B4","#E8C8B6","#E8C9B7","#E9CAB8","#E8CBB9","#E9CCBB","#E9CDBC","#EACEBE","#EACFBF","#EBD0C1","#EBD0C2","#EBD1C3","#EBD3C5","#ECD4C6","#EDD5C8","#ECD6C9","#EDD7CB","#EDD8CC","#EED9CD","#EEDACE","#EDDBD0","#EDDCD1","#EEDDD3","#EEDDD4","#EEDED5","#EEDFD6","#EDE0D8","#EDE0D9","#EEE1DA","#EEE2DB","#EDE3DC","#EDE3DD","#ECE4DE","#ECE4DF","#EBE5E0","#EBE5E1","#EAE6E2","#EAE5E3","#E9E6E4","#E8E6E4","#E7E7E5","#E7E7E6","#E6E6E7","#E5E6E7","#E3E7E7","#E2E7E7","#E1E6E8","#E0E6E8","#DFE5E9","#DEE6E9","#DCE5E8","#DBE5E8","#D9E4E9","#D8E4E9","#D6E3E8","#D5E3E8","#D3E2E9","#D2E1E9","#D0E0E8","#CEDFE7","#CDDFE7","#CBDEE7","#CADDE7","#C8DCE6","#C7DBE6","#C5DAE5","#C4DAE5","#C2D9E4","#C1D8E4","#BFD7E3","#BED6E3","#BCD5E2","#BBD5E2","#B9D4E1","#B7D3E1","#B5D2E0","#B3D1DF","#B2D0DE","#B0CFDE","#AFCEDD","#ADCDDD","#ACCCDC","#AACBDC","#A9CADB","#A7C9DA","#A5C8D9","#A3C7D9","#A1C6D8","#A0C5D8","#9EC4D7","#9DC4D6","#9BC3D5","#9AC2D5","#98C1D4","#97C0D4","#95BFD3","#94BED2","#92BDD1","#90BCD1","#8EBBD0","#8DBAD0","#8BB9CF","#8AB8CE","#88B6CD","#86B5CC","#85B4CC","#83B3CB","#81B2CA","#7FB1C9","#7EB0C9","#7CAFC8","#7BAEC8","#79ADC7","#78ACC6","#76ABC5","#75AAC5","#73A9C4","#72A8C4","#70A7C3","#6EA6C2","#6CA5C1","#6AA4C1","#69A3C0","#67A2C0","#66A1BF","#64A0BE","#639FBD","#619EBD","#5F9DBC","#5D9CBB","#5B9BBA","#5A9ABA","#5999B9","#5798B9","#5597B8","#5496B7","#5295B6","#5194B6","#4F93B5","#4E92B4","#4C91B3","#4B90B3","#498EB2","#488DB2","#468BB1","#458BB0","#438AAF","#4289AF","#4087AE","#3E86AC","#3D85AC","#3B84AB","#3A83AB","#3882AA","#3781A9","#3580A8","#347FA8","#327EA7","#317DA6","#2F7CA5","#2E7BA5","#2C7AA4","#2B79A4","#2A78A3","#2977A2","#2776A1","#2575A1","#2474A0","#2373A0","#22729F","#20719E","#1F709D","#1E6F9D","#1D6E9C","#1C6D9C","#1B6C9B","#196B9A","#186A99","#176999","#166898","#156798","#146697","#136697","#126596","#116496","#106395","#106294","#0F6193","#0E6093","#0C5E92","#0C5E92","#0B5D91","#0B5D91","#0A5C90","#085A8F","#08598F","#07588E","#07578D","#06568C","#06568C","#05558B","#06548B","#05538A","#05528A","#045189","#055189","#045088","#044F88","#034E87","#034D87","#044C86","#044C86","#034B85","#034A85","#024984","#024984","#034883","#034783","#024682","#024582","#024481","#024481","#034380","#034280","#02417F","#02417F","#03407E","#033F7E","#023E7D","#023E7D","#033D7C","#033C7C","#023B7B","#023A7B","#01397A","#01397A","#023879","#023779","#013678","#013577","#023477","#013376","#013376","#023275","#023175","#013074","#013074","#022F73","#022E73","#012D72","#012D72","#022C71","#022B71","#012A70","#012A70","#02296F","#02286F","#01276E","#01276E","#02266D","#02256D","#02246C","#02236C","#01226B","#01226B","#02216A","#02206A","#011F69","#021F69","#011E68","#011D68","#021C67","#021C67","#011B66","#011A66","#001965","#001865","#011764","#011764","#001663","#001563","#011462","#011462","#001361","#001260"],"inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"scene":{"zaxis":{"title":"cormat"}},"xaxis":{"domain":[0,1],"automargin":true,"tickmode":"array","tickvals":[0,1,2,3,4],"ticktext":["event04_actual_angle","event02_expect_angle","event01_cue_onset","event04_actual_RT","event02_expect_RT"],"gridcolor":"transparent","zerolinecolor":"transparent","title":"","zeroline":false,"showgrid":false},"yaxis":{"domain":[0,1],"automargin":true,"tickmode":"array","tickvals":[0,1,2,3,4],"ticktext":["event04_actual_angle","event02_expect_angle","event01_cue_onset","event04_actual_RT","event02_expect_RT"],"gridcolor":"transparent","zerolinecolor":"transparent","title":"","autorange":"reversed","zeroline":false,"showgrid":false},"hovermode":"closest","showlegend":false,"legend":{"yanchor":"top","y":0.5},"plot_bgcolor":"transparent","paper_bgcolor":"transparent"},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false,"displayModeBar":false},"data":[{"colorbar":{"title":"cormat","ticklen":2,"len":0.5,"lenmode":"fraction","y":1,"yanchor":"top"},"colorscale":[["0","rgba(89,0,7,1)"],["0.0416666666666667","rgba(107,13,6,1)"],["0.0833333333333333","rgba(126,29,5,1)"],["0.125","rgba(147,46,5,1)"],["0.166666666666667","rgba(169,70,18,1)"],["0.208333333333333","rgba(186,94,42,1)"],["0.25","rgba(194,113,66,1)"],["0.291666666666667","rgba(203,132,91,1)"],["0.333333333333333","rgba(210,150,116,1)"],["0.375","rgba(219,171,142,1)"],["0.416666666666667","rgba(228,191,170,1)"],["0.458333333333333","rgba(237,213,199,1)"],["0.5","rgba(235,229,225,1)"],["0.541666666666667","rgba(212,227,232,1)"],["0.583333333333333","rgba(179,209,223,1)"],["0.625","rgba(146,189,209,1)"],["0.666666666666667","rgba(113,167,195,1)"],["0.708333333333333","rgba(79,147,181,1)"],["0.75","rgba(47,124,165,1)"],["0.791666666666667","rgba(21,103,152,1)"],["0.833333333333333","rgba(6,84,139,1)"],["0.875","rgba(3,67,128,1)"],["0.916666666666667","rgba(1,51,118,1)"],["0.958333333333333","rgba(1,34,107,1)"],["1","rgba(0,18,96,1)"]],"showscale":true,"z":[[1,0.64286812027634033,-0.14504336112570634,-0.16347972254149309,-0.060141478448381316],[0.64286812027634033,1,-0.12246175653222982,-0.13459621502938438,-0.067315155713631405],[-0.14504336112570634,-0.12246175653222982,1,0.080517199615948179,0.056113525117006839],[-0.16347972254149309,-0.13459621502938438,0.080517199615948179,1,0.27736553205011194],[-0.060141478448381316,-0.067315155713631405,0.056113525117006839,0.27736553205011194,1]],"type":"heatmap","xaxis":"x","yaxis":"y","frame":null,"zmin":-1,"zmax":1}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<div class="plotly html-widget html-fill-item" id="htmlwidget-4a1e3e65f289ead1c6c9" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-4a1e3e65f289ead1c6c9">{"x":{"visdat":{"2b251fdabf59":["function () ","plotlyVisDat"]},"cur_data":"2b251fdabf59","attrs":{"2b251fdabf59":{"z":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"heatmap","colors":["#590007","#590007","#5B0107","#5C0108","#5D0207","#5D0207","#5E0308","#5F0308","#600407","#610507","#620606","#620606","#630707","#640807","#650906","#660906","#670A07","#670B07","#680C06","#690C06","#6A0D06","#6B0D06","#6C0E07","#6C0F07","#6D1006","#6E1006","#6F1107","#701207","#711306","#721306","#731405","#731405","#741506","#751606","#761705","#771705","#781806","#791906","#7A1A05","#7B1A06","#7C1B06","#7D1C06","#7E1D05","#7E1D06","#7F1E06","#801E06","#822006","#832106","#842105","#852206","#862206","#872406","#882506","#892606","#8A2605","#8B2706","#8C2806","#8D2905","#8E2A05","#8F2B06","#902C06","#912D05","#932E05","#942F06","#953006","#963107","#973206","#983307","#993407","#9A3508","#9B3608","#9C3709","#9E3809","#9F390A","#A03B0A","#A13C0B","#A23D0C","#A33E0D","#A43F0E","#A5410F","#A6420F","#A74310","#A84411","#A94612","#AA4713","#AB4914","#AC4915","#AE4A16","#AE4B17","#AF4D19","#AF4E1A","#B1501C","#B2511D","#B2521E","#B3531F","#B4531F","#B55521","#B55622","#B65824","#B65925","#B75A26","#B75B27","#B85C28","#B95D29","#BA5E2A","#BA5F2C","#BB602D","#BB612E","#BC622F","#BC6330","#BD6431","#BD6432","#BE6533","#BD6635","#BE6736","#BE6837","#BF6938","#BF6A39","#C06B3A","#C06C3B","#C16D3C","#C16D3E","#C26E3F","#C16F40","#C27041","#C27142","#C37243","#C37344","#C47446","#C47447","#C57548","#C57649","#C6774A","#C5784B","#C67A4D","#C67A4E","#C77B50","#C87C51","#C87C51","#C97E53","#C87F54","#C98056","#C98157","#CA8258","#CA8259","#CB835A","#CB845B","#CC855D","#CB865E","#CC875F","#CC8860","#CD8961","#CD8A63","#CE8B64","#CE8B65","#CF8C66","#CE8D67","#CF8E68","#CF8F6A","#D0906B","#D0916C","#D1926D","#D1936F","#D29470","#D29471","#D39572","#D29673","#D39775","#D39876","#D49977","#D49A78","#D59B7A","#D59C7B","#D69D7C","#D59E7D","#D69F7F","#D69F80","#D7A081","#D7A182","#D8A284","#D8A385","#D9A486","#DAA688","#DAA789","#DBA88B","#DAA98C","#DBAA8D","#DBAB8E","#DCAC90","#DCAD91","#DDAE93","#DDAF94","#DEB095","#DEB196","#DFB298","#DEB399","#DFB49A","#DFB59B","#E0B69D","#E0B79F","#E1B8A0","#E1B9A1","#E2BAA2","#E2BBA4","#E3BCA5","#E3BDA7","#E4BEA8","#E3BEA9","#E4BFAA","#E4C0AC","#E5C1AE","#E5C3AF","#E6C4B0","#E6C5B1","#E7C6B2","#E7C7B4","#E8C8B6","#E8C9B7","#E9CAB8","#E8CBB9","#E9CCBB","#E9CDBC","#EACEBE","#EACFBF","#EBD0C1","#EBD0C2","#EBD1C3","#EBD3C5","#ECD4C6","#EDD5C8","#ECD6C9","#EDD7CB","#EDD8CC","#EED9CD","#EEDACE","#EDDBD0","#EDDCD1","#EEDDD3","#EEDDD4","#EEDED5","#EEDFD6","#EDE0D8","#EDE0D9","#EEE1DA","#EEE2DB","#EDE3DC","#EDE3DD","#ECE4DE","#ECE4DF","#EBE5E0","#EBE5E1","#EAE6E2","#EAE5E3","#E9E6E4","#E8E6E4","#E7E7E5","#E7E7E6","#E6E6E7","#E5E6E7","#E3E7E7","#E2E7E7","#E1E6E8","#E0E6E8","#DFE5E9","#DEE6E9","#DCE5E8","#DBE5E8","#D9E4E9","#D8E4E9","#D6E3E8","#D5E3E8","#D3E2E9","#D2E1E9","#D0E0E8","#CEDFE7","#CDDFE7","#CBDEE7","#CADDE7","#C8DCE6","#C7DBE6","#C5DAE5","#C4DAE5","#C2D9E4","#C1D8E4","#BFD7E3","#BED6E3","#BCD5E2","#BBD5E2","#B9D4E1","#B7D3E1","#B5D2E0","#B3D1DF","#B2D0DE","#B0CFDE","#AFCEDD","#ADCDDD","#ACCCDC","#AACBDC","#A9CADB","#A7C9DA","#A5C8D9","#A3C7D9","#A1C6D8","#A0C5D8","#9EC4D7","#9DC4D6","#9BC3D5","#9AC2D5","#98C1D4","#97C0D4","#95BFD3","#94BED2","#92BDD1","#90BCD1","#8EBBD0","#8DBAD0","#8BB9CF","#8AB8CE","#88B6CD","#86B5CC","#85B4CC","#83B3CB","#81B2CA","#7FB1C9","#7EB0C9","#7CAFC8","#7BAEC8","#79ADC7","#78ACC6","#76ABC5","#75AAC5","#73A9C4","#72A8C4","#70A7C3","#6EA6C2","#6CA5C1","#6AA4C1","#69A3C0","#67A2C0","#66A1BF","#64A0BE","#639FBD","#619EBD","#5F9DBC","#5D9CBB","#5B9BBA","#5A9ABA","#5999B9","#5798B9","#5597B8","#5496B7","#5295B6","#5194B6","#4F93B5","#4E92B4","#4C91B3","#4B90B3","#498EB2","#488DB2","#468BB1","#458BB0","#438AAF","#4289AF","#4087AE","#3E86AC","#3D85AC","#3B84AB","#3A83AB","#3882AA","#3781A9","#3580A8","#347FA8","#327EA7","#317DA6","#2F7CA5","#2E7BA5","#2C7AA4","#2B79A4","#2A78A3","#2977A2","#2776A1","#2575A1","#2474A0","#2373A0","#22729F","#20719E","#1F709D","#1E6F9D","#1D6E9C","#1C6D9C","#1B6C9B","#196B9A","#186A99","#176999","#166898","#156798","#146697","#136697","#126596","#116496","#106395","#106294","#0F6193","#0E6093","#0C5E92","#0C5E92","#0B5D91","#0B5D91","#0A5C90","#085A8F","#08598F","#07588E","#07578D","#06568C","#06568C","#05558B","#06548B","#05538A","#05528A","#045189","#055189","#045088","#044F88","#034E87","#034D87","#044C86","#044C86","#034B85","#034A85","#024984","#024984","#034883","#034783","#024682","#024582","#024481","#024481","#034380","#034280","#02417F","#02417F","#03407E","#033F7E","#023E7D","#023E7D","#033D7C","#033C7C","#023B7B","#023A7B","#01397A","#01397A","#023879","#023779","#013678","#013577","#023477","#013376","#013376","#023275","#023175","#013074","#013074","#022F73","#022E73","#012D72","#012D72","#022C71","#022B71","#012A70","#012A70","#02296F","#02286F","#01276E","#01276E","#02266D","#02256D","#02246C","#02236C","#01226B","#01226B","#02216A","#02206A","#011F69","#021F69","#011E68","#011D68","#021C67","#021C67","#011B66","#011A66","#001965","#001865","#011764","#011764","#001663","#001563","#011462","#011462","#001361","#001260"],"inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"scene":{"zaxis":{"title":"cormat"}},"xaxis":{"domain":[0,1],"automargin":true,"tickmode":"array","tickvals":[0,1,2],"ticktext":["ISI02_duration","ISI01_duration","ISI03_duration"],"gridcolor":"transparent","zerolinecolor":"transparent","title":"","zeroline":false,"showgrid":false},"yaxis":{"domain":[0,1],"automargin":true,"tickmode":"array","tickvals":[0,1,2],"ticktext":["ISI02_duration","ISI01_duration","ISI03_duration"],"gridcolor":"transparent","zerolinecolor":"transparent","title":"","autorange":"reversed","zeroline":false,"showgrid":false},"hovermode":"closest","showlegend":false,"legend":{"yanchor":"top","y":0.5},"plot_bgcolor":"transparent","paper_bgcolor":"transparent"},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false,"displayModeBar":false},"data":[{"colorbar":{"title":"cormat","ticklen":2,"len":0.5,"lenmode":"fraction","y":1,"yanchor":"top"},"colorscale":[["0","rgba(89,0,7,1)"],["0.0416666666666667","rgba(107,13,6,1)"],["0.0833333333333333","rgba(126,29,5,1)"],["0.125","rgba(147,46,5,1)"],["0.166666666666667","rgba(169,70,18,1)"],["0.208333333333333","rgba(186,94,42,1)"],["0.25","rgba(194,113,66,1)"],["0.291666666666667","rgba(203,132,91,1)"],["0.333333333333333","rgba(210,150,116,1)"],["0.375","rgba(219,171,142,1)"],["0.416666666666667","rgba(228,191,170,1)"],["0.458333333333333","rgba(237,213,199,1)"],["0.5","rgba(235,229,225,1)"],["0.541666666666667","rgba(212,227,232,1)"],["0.583333333333333","rgba(179,209,223,1)"],["0.625","rgba(146,189,209,1)"],["0.666666666666667","rgba(113,167,195,1)"],["0.708333333333333","rgba(79,147,181,1)"],["0.75","rgba(47,124,165,1)"],["0.791666666666667","rgba(21,103,152,1)"],["0.833333333333333","rgba(6,84,139,1)"],["0.875","rgba(3,67,128,1)"],["0.916666666666667","rgba(1,51,118,1)"],["0.958333333333333","rgba(1,34,107,1)"],["1","rgba(0,18,96,1)"]],"showscale":true,"z":[[1,0.1049823877106395,0.06860303616842478],[0.1049823877106395,1,-0.055944339777556466],[0.06860303616842478,-0.055944339777556466,1]],"type":"heatmap","xaxis":"x","yaxis":"y","frame":null,"zmin":-1,"zmax":1}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
<div id="groupby-subject-and-average" class="section level3 hasAnchor" number="8.0.1">
<h3><span class="header-section-number">8.0.1</span> groupby subject and average<a href="ch15_demean_per_sub.html#groupby-subject-and-average" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
</div>
<div id="linear-model-0508" class="section level2 hasAnchor" number="8.1">
<h2><span class="header-section-number">8.1</span> linear model 0508<a href="ch15_demean_per_sub.html#linear-model-0508" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb182"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb182-1"><a href="ch15_demean_per_sub.html#cb182-1" aria-hidden="true" tabindex="-1"></a><span class="co"># model.factorize_demean = lmer(demean_outcome~ CUE_high_gt_low*stim_factor*demean_expect +EXPECT_cmc+ lag.demean_outcome+(1|src_subject_id), data = pvc)</span></span>
<span id="cb182-2"><a href="ch15_demean_per_sub.html#cb182-2" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(model.factorize_demean)</span></span>
<span id="cb182-3"><a href="ch15_demean_per_sub.html#cb182-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb182-4"><a href="ch15_demean_per_sub.html#cb182-4" aria-hidden="true" tabindex="-1"></a>model.factorize_demean <span class="ot">=</span> <span class="fu">lmer</span>(demean_outcome<span class="sc">~</span> CUE_high_gt_low<span class="sc">*</span>stim_con_linear<span class="sc">*</span>demean_expect <span class="sc">+</span> </span>
<span id="cb182-5"><a href="ch15_demean_per_sub.html#cb182-5" aria-hidden="true" tabindex="-1"></a>                                CUE_high_gt_low<span class="sc">*</span>stim_con_quad<span class="sc">*</span>demean_expect <span class="sc">+</span></span>
<span id="cb182-6"><a href="ch15_demean_per_sub.html#cb182-6" aria-hidden="true" tabindex="-1"></a>                                EXPECT_cmc <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>src_subject_id), <span class="at">data =</span> pvc)</span></code></pre></div>
</details>
<pre><code>## fixed-effect model matrix is rank deficient so dropping 1 column / coefficient</code></pre>
<pre><code>## boundary (singular) fit: see help(&#39;isSingular&#39;)</code></pre>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb185"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb185-1"><a href="ch15_demean_per_sub.html#cb185-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model.factorize_demean)</span></code></pre></div>
</details>
<pre><code>## Linear mixed model fit by REML. t-tests use Satterthwaite&#39;s method [
## lmerModLmerTest]
## Formula: demean_outcome ~ CUE_high_gt_low * stim_con_linear * demean_expect +  
##     CUE_high_gt_low * stim_con_quad * demean_expect + EXPECT_cmc +  
##     (1 | src_subject_id)
##    Data: pvc
## 
## REML criterion at convergence: 43246.4
## 
## Scaled residuals: 
##     Min      1Q  Median      3Q     Max 
## -5.3122 -0.5823 -0.0037  0.5936  5.1434 
## 
## Random effects:
##  Groups         Name        Variance Std.Dev.
##  src_subject_id (Intercept)   0.0     0.00   
##  Residual                   370.8    19.26   
## Number of obs: 4939, groups:  src_subject_id, 110
## 
## Fixed effects:
##                                                 Estimate Std. Error         df
## (Intercept)                                   -7.897e-01  3.461e-01  4.927e+03
## CUE_high_gt_low                               -3.686e+00  6.922e-01  4.927e+03
## stim_con_linear                                3.010e+01  8.554e-01  4.927e+03
## demean_expect                                  3.306e-01  1.219e-02  4.927e+03
## stim_con_quad                                  2.020e+00  7.350e-01  4.927e+03
## CUE_high_gt_low:stim_con_linear                1.066e+00  1.711e+00  4.927e+03
## CUE_high_gt_low:demean_expect                 -4.084e-02  2.438e-02  4.927e+03
## stim_con_linear:demean_expect                  1.195e-02  2.993e-02  4.927e+03
## CUE_high_gt_low:stim_con_quad                 -3.891e+00  1.470e+00  4.927e+03
## demean_expect:stim_con_quad                    3.232e-03  2.606e-02  4.927e+03
## CUE_high_gt_low:stim_con_linear:demean_expect  2.105e-01  5.986e-02  4.927e+03
## CUE_high_gt_low:demean_expect:stim_con_quad   -3.814e-02  5.212e-02  4.927e+03
##                                               t value Pr(&gt;|t|)    
## (Intercept)                                    -2.281 0.022563 *  
## CUE_high_gt_low                                -5.324 1.06e-07 ***
## stim_con_linear                                35.190  &lt; 2e-16 ***
## demean_expect                                  27.118  &lt; 2e-16 ***
## stim_con_quad                                   2.748 0.006013 ** 
## CUE_high_gt_low:stim_con_linear                 0.623 0.533311    
## CUE_high_gt_low:demean_expect                  -1.675 0.094003 .  
## stim_con_linear:demean_expect                   0.399 0.689707    
## CUE_high_gt_low:stim_con_quad                  -2.647 0.008141 ** 
## demean_expect:stim_con_quad                     0.124 0.901304    
## CUE_high_gt_low:stim_con_linear:demean_expect   3.516 0.000442 ***
## CUE_high_gt_low:demean_expect:stim_con_quad    -0.732 0.464328    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Correlation of Fixed Effects:
##                        (Intr) CUE_h__ stm_cn_l dmn_xp stm_cn_q
## CUE_hgh_gt_             0.092                                 
## stim_cn_lnr            -0.030 -0.028                          
## demean_xpct            -0.100 -0.609   0.016                  
## stim_con_qd            -0.026 -0.028   0.022    0.015         
## CUE_hgh_gt_lw:stm_cn_l -0.028 -0.030   0.110    0.023  0.020  
## CUE_hgh__:_            -0.609 -0.100   0.023    0.102  0.019  
## stm_cn_ln:_             0.016  0.024  -0.109   -0.040 -0.012  
## CUE_hgh_gt_lw:stm_cn_q -0.028 -0.026   0.020    0.019  0.074  
## dmn_xpct:__             0.014  0.018  -0.011   -0.007 -0.091  
## CUE___:__:_             0.024  0.016  -0.615   -0.001 -0.017  
## CUE___:_:__             0.018  0.014  -0.017    0.001 -0.603  
##                        CUE_hgh_gt_lw:stm_cn_l CUE_h__:_ st__:_
## CUE_hgh_gt_                                                   
## stim_cn_lnr                                                   
## demean_xpct                                                   
## stim_con_qd                                                   
## CUE_hgh_gt_lw:stm_cn_l                                        
## CUE_hgh__:_             0.016                                 
## stm_cn_ln:_            -0.615                 -0.001          
## CUE_hgh_gt_lw:stm_cn_q  0.022                  0.015    -0.017
## dmn_xpct:__            -0.017                  0.001     0.028
## CUE___:__:_            -0.109                 -0.040     0.101
## CUE___:_:__            -0.011                 -0.007     0.001
##                        CUE_hgh_gt_lw:stm_cn_q dm_:__ CUE___:__:
## CUE_hgh_gt_                                                    
## stim_cn_lnr                                                    
## demean_xpct                                                    
## stim_con_qd                                                    
## CUE_hgh_gt_lw:stm_cn_l                                         
## CUE_hgh__:_                                                    
## stm_cn_ln:_                                                    
## CUE_hgh_gt_lw:stm_cn_q                                         
## dmn_xpct:__            -0.603                                  
## CUE___:__:_            -0.012                  0.001           
## CUE___:_:__            -0.091                  0.104  0.028    
## fit warnings:
## fixed-effect model matrix is rank deficient so dropping 1 column / coefficient
## optimizer (nloptwrap) convergence code: 0 (OK)
## boundary (singular) fit: see help(&#39;isSingular&#39;)</code></pre>
</div>
<div id="linear-model" class="section level2 hasAnchor" number="8.2">
<h2><span class="header-section-number">8.2</span> linear model<a href="ch15_demean_per_sub.html#linear-model" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<pre><code>## Linear mixed model fit by REML. t-tests use Satterthwaite&#39;s method [
## lmerModLmerTest]
## Formula: demean_outcome ~ CUE_high_gt_low * stim_factor * demean_expect +  
##     lag.demean_outcome + (1 | src_subject_id)
##    Data: pvc
## 
## REML criterion at convergence: 42884.2
## 
## Scaled residuals: 
##     Min      1Q  Median      3Q     Max 
## -5.6746 -0.5825  0.0064  0.5976  5.5568 
## 
## Random effects:
##  Groups         Name        Variance Std.Dev.
##  src_subject_id (Intercept)   0.0     0.00   
##  Residual                   344.1    18.55   
## Number of obs: 4939, groups:  src_subject_id, 110
## 
## Fixed effects:
##                                                     Estimate Std. Error
## (Intercept)                                        1.359e+01  5.718e-01
## CUE_high_gt_low                                    2.734e-01  1.149e+00
## stim_factorlow_stim                               -3.049e+01  8.242e-01
## stim_factormed_stim                               -1.279e+01  8.054e-01
## demean_expect                                      2.713e-01  2.015e-02
## lag.demean_outcome                                 2.177e-01  1.111e-02
## CUE_high_gt_low:stim_factorlow_stim               -4.737e-01  1.648e+00
## CUE_high_gt_low:stim_factormed_stim               -5.026e+00  1.611e+00
## CUE_high_gt_low:demean_expect                      1.048e-01  3.980e-02
## stim_factorlow_stim:demean_expect                 -1.928e-02  2.883e-02
## stim_factormed_stim:demean_expect                 -1.078e-03  2.838e-02
## CUE_high_gt_low:stim_factorlow_stim:demean_expect -2.491e-01  5.770e-02
## CUE_high_gt_low:stim_factormed_stim:demean_expect -1.639e-01  5.677e-02
##                                                           df t value Pr(&gt;|t|)
## (Intercept)                                        4.926e+03  23.761  &lt; 2e-16
## CUE_high_gt_low                                    4.926e+03   0.238  0.81188
## stim_factorlow_stim                                4.926e+03 -36.993  &lt; 2e-16
## stim_factormed_stim                                4.926e+03 -15.879  &lt; 2e-16
## demean_expect                                      4.926e+03  13.461  &lt; 2e-16
## lag.demean_outcome                                 4.926e+03  19.585  &lt; 2e-16
## CUE_high_gt_low:stim_factorlow_stim                4.926e+03  -0.287  0.77384
## CUE_high_gt_low:stim_factormed_stim                4.926e+03  -3.120  0.00182
## CUE_high_gt_low:demean_expect                      4.926e+03   2.633  0.00849
## stim_factorlow_stim:demean_expect                  4.926e+03  -0.669  0.50373
## stim_factormed_stim:demean_expect                  4.926e+03  -0.038  0.96969
## CUE_high_gt_low:stim_factorlow_stim:demean_expect  4.926e+03  -4.317 1.61e-05
## CUE_high_gt_low:stim_factormed_stim:demean_expect  4.926e+03  -2.888  0.00390
##                                                      
## (Intercept)                                       ***
## CUE_high_gt_low                                      
## stim_factorlow_stim                               ***
## stim_factormed_stim                               ***
## demean_expect                                     ***
## lag.demean_outcome                                ***
## CUE_high_gt_low:stim_factorlow_stim                  
## CUE_high_gt_low:stim_factormed_stim               ** 
## CUE_high_gt_low:demean_expect                     ** 
## stim_factorlow_stim:demean_expect                    
## stim_factormed_stim:demean_expect                    
## CUE_high_gt_low:stim_factorlow_stim:demean_expect ***
## CUE_high_gt_low:stim_factormed_stim:demean_expect ** 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## optimizer (nloptwrap) convergence code: 0 (OK)
## boundary (singular) fit: see help(&#39;isSingular&#39;)</code></pre>
</div>
<div id="q.-are-those-overestimating-for-high-cues-also-underestimators-for-low-cues" class="section level2 hasAnchor" number="8.3">
<h2><span class="header-section-number">8.3</span> Q. Are those overestimating for high cues also underestimators for low cues?<a href="ch15_demean_per_sub.html#q.-are-those-overestimating-for-high-cues-also-underestimators-for-low-cues" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>y axis: outcome rating
x axis: high cue</p>
<p>distance from 1:1 line
Using ODR, we can test whether different cues lead to different distances from the identity line</p>
<pre><code>## boundary (singular) fit: see help(&#39;isSingular&#39;)</code></pre>
<pre><code>## Linear mixed model fit by REML. t-tests use Satterthwaite&#39;s method [
## lmerModLmerTest]
## Formula: 
## as.formula(reformulate(c(iv, sprintf(&quot;(%s|%s)&quot;, iv, subject_keyword)),  
##     response = dv))
##    Data: df
## 
## REML criterion at convergence: 42138.3
## 
## Scaled residuals: 
##     Min      1Q  Median      3Q     Max 
## -3.0513 -0.6728 -0.1352  0.5460  6.0466 
## 
## Random effects:
##  Groups         Name        Variance Std.Dev. Corr
##  src_subject_id (Intercept)  66.398   8.148       
##                 cue_namelow   2.915   1.707   1.00
##  Residual                   280.906  16.760       
## Number of obs: 4939, groups:  src_subject_id, 110
## 
## Fixed effects:
##             Estimate Std. Error       df t value Pr(&gt;|t|)    
## (Intercept)  23.1557     0.8577 108.8675  26.998   &lt;2e-16 ***
## cue_namelow   0.7289     0.5052 478.1364   1.443     0.15    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Correlation of Fixed Effects:
##             (Intr)
## cue_namelow 0.032 
## optimizer (nloptwrap) convergence code: 0 (OK)
## boundary (singular) fit: see help(&#39;isSingular&#39;)</code></pre>
</div>
<div id="todo-can-you-test-if-the-slopes-are-the-same-that-might-tell-us-something-about-whether-expectancies-translate-into-outcomes-with-the-same-efficacy-across-all-three-tasks." class="section level2 hasAnchor" number="8.4">
<h2><span class="header-section-number">8.4</span> TODO: Can you test if the slopes are the same? That might tell us something about whether, expectancies translate into outcomes with the same efficacy across all three tasks.<a href="ch15_demean_per_sub.html#todo-can-you-test-if-the-slopes-are-the-same-that-might-tell-us-something-about-whether-expectancies-translate-into-outcomes-with-the-same-efficacy-across-all-three-tasks." class="anchor-section" aria-label="Anchor link to header"></a></h2>
<pre><code>## Linear mixed model fit by REML. t-tests use Satterthwaite&#39;s method [
## lmerModLmerTest]
## Formula: 
## as.formula(reformulate(c(iv, sprintf(&quot;(%s|%s)&quot;, iv, subject_keyword)),  
##     response = dv))
##    Data: df
## 
## REML criterion at convergence: 42138.3
## 
## Scaled residuals: 
##     Min      1Q  Median      3Q     Max 
## -3.0513 -0.6728 -0.1352  0.5460  6.0466 
## 
## Random effects:
##  Groups         Name        Variance Std.Dev. Corr
##  src_subject_id (Intercept)  66.398   8.148       
##                 cue_namelow   2.915   1.707   1.00
##  Residual                   280.906  16.760       
## Number of obs: 4939, groups:  src_subject_id, 110
## 
## Fixed effects:
##             Estimate Std. Error       df t value Pr(&gt;|t|)    
## (Intercept)  23.1557     0.8577 108.8675  26.998   &lt;2e-16 ***
## cue_namelow   0.7289     0.5052 478.1364   1.443     0.15    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Correlation of Fixed Effects:
##             (Intr)
## cue_namelow 0.032 
## optimizer (nloptwrap) convergence code: 0 (OK)
## boundary (singular) fit: see help(&#39;isSingular&#39;)</code></pre>
<pre><code>## Warning in geom_line(data = subjectwise, aes(group = .data[[subject]], x =
## as.numeric(as.factor(.data[[iv]])) - : Ignoring unknown aesthetics: fill</code></pre>
<pre><code>## Warning: Removed 1 rows containing non-finite values (`stat_half_ydensity()`).</code></pre>
<pre><code>## Warning: Removed 1 rows containing non-finite values (`stat_boxplot()`).</code></pre>
<pre><code>## Warning: Removed 1 row containing missing values (`geom_line()`).</code></pre>
<pre><code>## Warning: Removed 1 rows containing missing values (`geom_point()`).</code></pre>
<pre><code>## Warning: Removed 1 rows containing non-finite values (`stat_half_ydensity()`).</code></pre>
<pre><code>## Warning: Removed 1 rows containing non-finite values (`stat_boxplot()`).</code></pre>
<pre><code>## Warning: Removed 1 row containing missing values (`geom_line()`).</code></pre>
<pre><code>## Warning: Removed 1 rows containing missing values (`geom_point()`).</code></pre>
<p><img src="15_iv-cue-stim-outcome-expect_dv-outcome_demean_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
</div>
<div id="pain-run-collapsed-across-stimulus-intensity" class="section level2 hasAnchor" number="8.5">
<h2><span class="header-section-number">8.5</span> pain run, collapsed across stimulus intensity<a href="ch15_demean_per_sub.html#pain-run-collapsed-across-stimulus-intensity" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><img src="15_iv-cue-stim-outcome-expect_dv-outcome_demean_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<p><img src="15_iv-cue-stim-outcome-expect_dv-outcome_demean_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
</div>
<div id="vicarious-6" class="section level2 hasAnchor" number="8.6">
<h2><span class="header-section-number">8.6</span> vicarious<a href="ch15_demean_per_sub.html#vicarious-6" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><img src="15_iv-cue-stim-outcome-expect_dv-outcome_demean_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb200"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb200-1"><a href="ch15_demean_per_sub.html#cb200-1" aria-hidden="true" tabindex="-1"></a>model.factorize_demean <span class="ot">=</span> <span class="fu">lmer</span>(demean_outcome<span class="sc">~</span> CUE_high_gt_low<span class="sc">*</span>stim_con_linear<span class="sc">*</span>demean_expect <span class="sc">+</span> </span>
<span id="cb200-2"><a href="ch15_demean_per_sub.html#cb200-2" aria-hidden="true" tabindex="-1"></a>                                CUE_high_gt_low<span class="sc">*</span>stim_con_quad<span class="sc">*</span>demean_expect <span class="sc">+</span></span>
<span id="cb200-3"><a href="ch15_demean_per_sub.html#cb200-3" aria-hidden="true" tabindex="-1"></a>                                EXPECT_cmc <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>src_subject_id), <span class="at">data =</span> pvc)</span></code></pre></div>
</details>
<pre><code>## fixed-effect model matrix is rank deficient so dropping 1 column / coefficient</code></pre>
<pre><code>## boundary (singular) fit: see help(&#39;isSingular&#39;)</code></pre>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb203"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb203-1"><a href="ch15_demean_per_sub.html#cb203-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model.factorize_demean)</span></code></pre></div>
</details>
<pre><code>## Linear mixed model fit by REML. t-tests use Satterthwaite&#39;s method [
## lmerModLmerTest]
## Formula: demean_outcome ~ CUE_high_gt_low * stim_con_linear * demean_expect +  
##     CUE_high_gt_low * stim_con_quad * demean_expect + EXPECT_cmc +  
##     (1 | src_subject_id)
##    Data: pvc
## 
## REML criterion at convergence: 45954.8
## 
## Scaled residuals: 
##    Min     1Q Median     3Q    Max 
## -3.475 -0.602 -0.138  0.446  5.630 
## 
## Random effects:
##  Groups         Name        Variance Std.Dev.
##  src_subject_id (Intercept)   0.0     0.00   
##  Residual                   469.7    21.67   
## Number of obs: 5111, groups:  src_subject_id, 110
## 
## Fixed effects:
##                                                 Estimate Std. Error         df
## (Intercept)                                      0.21603    0.44918 5099.00000
## CUE_high_gt_low                                  1.24687    0.89837 5099.00000
## stim_con_linear                                 23.90084    1.10386 5099.00000
## demean_expect                                    0.19711    0.01918 5099.00000
## stim_con_quad                                   -4.72799    0.95934 5099.00000
## CUE_high_gt_low:stim_con_linear                  6.38339    2.20771 5099.00000
## CUE_high_gt_low:demean_expect                   -0.02451    0.03835 5099.00000
## stim_con_linear:demean_expect                    0.03147    0.04753 5099.00000
## CUE_high_gt_low:stim_con_quad                   -3.13553    1.91869 5099.00000
## demean_expect:stim_con_quad                      0.01270    0.04060 5099.00000
## CUE_high_gt_low:stim_con_linear:demean_expect    0.37387    0.09506 5099.00000
## CUE_high_gt_low:demean_expect:stim_con_quad     -0.07222    0.08120 5099.00000
##                                               t value Pr(&gt;|t|)    
## (Intercept)                                     0.481  0.63058    
## CUE_high_gt_low                                 1.388  0.16522    
## stim_con_linear                                21.652  &lt; 2e-16 ***
## demean_expect                                  10.278  &lt; 2e-16 ***
## stim_con_quad                                  -4.928 8.55e-07 ***
## CUE_high_gt_low:stim_con_linear                 2.891  0.00385 ** 
## CUE_high_gt_low:demean_expect                  -0.639  0.52280    
## stim_con_linear:demean_expect                   0.662  0.50793    
## CUE_high_gt_low:stim_con_quad                  -1.634  0.10228    
## demean_expect:stim_con_quad                     0.313  0.75449    
## CUE_high_gt_low:stim_con_linear:demean_expect   3.933 8.50e-05 ***
## CUE_high_gt_low:demean_expect:stim_con_quad    -0.889  0.37386    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Correlation of Fixed Effects:
##                        (Intr) CUE_h__ stm_cn_l dmn_xp stm_cn_q
## CUE_hgh_gt_            -0.193                                 
## stim_cn_lnr             0.007 -0.063                          
## demean_xpct             0.258 -0.736   0.052                  
## stim_con_qd            -0.009  0.026  -0.005   -0.009         
## CUE_hgh_gt_lw:stm_cn_l -0.063  0.007  -0.210   -0.015  0.045  
## CUE_hgh__:_            -0.736  0.258  -0.015   -0.336  0.019  
## stm_cn_ln:_             0.052 -0.015   0.261    0.019 -0.037  
## CUE_hgh_gt_lw:stm_cn_q  0.026 -0.009   0.045    0.019 -0.176  
## dmn_xpct:__            -0.010  0.019  -0.037   -0.034  0.255  
## CUE___:__:_            -0.015  0.052  -0.738   -0.023  0.011  
## CUE___:_:__             0.019 -0.010   0.011   -0.034 -0.734  
##                        CUE_hgh_gt_lw:stm_cn_l CUE_h__:_ st__:_
## CUE_hgh_gt_                                                   
## stim_cn_lnr                                                   
## demean_xpct                                                   
## stim_con_qd                                                   
## CUE_hgh_gt_lw:stm_cn_l                                        
## CUE_hgh__:_             0.052                                 
## stm_cn_ln:_            -0.738                 -0.023          
## CUE_hgh_gt_lw:stm_cn_q -0.005                 -0.009     0.011
## dmn_xpct:__             0.011                 -0.034    -0.014
## CUE___:__:_             0.261                  0.019    -0.305
## CUE___:_:__            -0.037                 -0.034     0.017
##                        CUE_hgh_gt_lw:stm_cn_q dm_:__ CUE___:__:
## CUE_hgh_gt_                                                    
## stim_cn_lnr                                                    
## demean_xpct                                                    
## stim_con_qd                                                    
## CUE_hgh_gt_lw:stm_cn_l                                         
## CUE_hgh__:_                                                    
## stm_cn_ln:_                                                    
## CUE_hgh_gt_lw:stm_cn_q                                         
## dmn_xpct:__            -0.734                                  
## CUE___:__:_            -0.037                  0.017           
## CUE___:_:__             0.255                 -0.369 -0.014    
## fit warnings:
## fixed-effect model matrix is rank deficient so dropping 1 column / coefficient
## optimizer (nloptwrap) convergence code: 0 (OK)
## boundary (singular) fit: see help(&#39;isSingular&#39;)</code></pre>
<p><img src="15_iv-cue-stim-outcome-expect_dv-outcome_demean_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
<pre><code>## Linear mixed model fit by REML. t-tests use Satterthwaite&#39;s method [
## lmerModLmerTest]
## Formula: 
## as.formula(reformulate(c(iv, sprintf(&quot;(%s|%s)&quot;, iv, subject_keyword)),  
##     response = dv))
##    Data: df
## 
## REML criterion at convergence: 42592.7
## 
## Scaled residuals: 
##     Min      1Q  Median      3Q     Max 
## -2.8941 -0.6915 -0.1167  0.5386  5.2943 
## 
## Random effects:
##  Groups         Name        Variance  Std.Dev. Corr 
##  src_subject_id (Intercept) 4.520e+01  6.72295      
##                 cue_namelow 9.234e-03  0.09609 -1.00
##  Residual                   2.325e+02 15.24653      
## Number of obs: 5111, groups:  src_subject_id, 110
## 
## Fixed effects:
##              Estimate Std. Error        df t value Pr(&gt;|t|)    
## (Intercept)   20.3562     0.7177  111.0539  28.364   &lt;2e-16 ***
## cue_namelow   -0.2391     0.4276 4783.4156  -0.559    0.576    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Correlation of Fixed Effects:
##             (Intr)
## cue_namelow -0.319
## optimizer (nloptwrap) convergence code: 0 (OK)
## boundary (singular) fit: see help(&#39;isSingular&#39;)</code></pre>
<pre><code>## Warning in geom_line(data = subjectwise, aes(group = .data[[subject]], x =
## as.numeric(as.factor(.data[[iv]])) - : Ignoring unknown aesthetics: fill</code></pre>
<pre><code>## Warning: Removed 1 rows containing non-finite values (`stat_half_ydensity()`).</code></pre>
<pre><code>## Warning: Removed 1 rows containing non-finite values (`stat_boxplot()`).</code></pre>
<pre><code>## Warning: Removed 1 row containing missing values (`geom_line()`).</code></pre>
<pre><code>## Warning: Removed 1 rows containing missing values (`geom_point()`).</code></pre>
<pre><code>## Warning: Removed 1 rows containing non-finite values (`stat_half_ydensity()`).</code></pre>
<pre><code>## Warning: Removed 1 rows containing non-finite values (`stat_boxplot()`).</code></pre>
<pre><code>## Warning: Removed 1 row containing missing values (`geom_line()`).</code></pre>
<pre><code>## Warning: Removed 1 rows containing missing values (`geom_point()`).</code></pre>
<p><img src="15_iv-cue-stim-outcome-expect_dv-outcome_demean_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
</div>
<div id="cognitive-6" class="section level2 hasAnchor" number="8.7">
<h2><span class="header-section-number">8.7</span> cognitive<a href="ch15_demean_per_sub.html#cognitive-6" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="linear-model-0508-1" class="section level2 hasAnchor" number="8.8">
<h2><span class="header-section-number">8.8</span> linear model 0508<a href="ch15_demean_per_sub.html#linear-model-0508-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb215"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb215-1"><a href="ch15_demean_per_sub.html#cb215-1" aria-hidden="true" tabindex="-1"></a><span class="co"># model.factorize_demean = lmer(demean_outcome~ CUE_high_gt_low*stim_factor*demean_expect +EXPECT_cmc+ lag.demean_outcome+(1|src_subject_id), data = pvc)</span></span>
<span id="cb215-2"><a href="ch15_demean_per_sub.html#cb215-2" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(model.factorize_demean)</span></span>
<span id="cb215-3"><a href="ch15_demean_per_sub.html#cb215-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb215-4"><a href="ch15_demean_per_sub.html#cb215-4" aria-hidden="true" tabindex="-1"></a>model.factorize_demean <span class="ot">=</span> <span class="fu">lmer</span>(demean_outcome<span class="sc">~</span> CUE_high_gt_low<span class="sc">*</span>stim_con_linear<span class="sc">*</span>demean_expect <span class="sc">+</span> </span>
<span id="cb215-5"><a href="ch15_demean_per_sub.html#cb215-5" aria-hidden="true" tabindex="-1"></a>                                CUE_high_gt_low<span class="sc">*</span>stim_con_quad<span class="sc">*</span>demean_expect <span class="sc">+</span></span>
<span id="cb215-6"><a href="ch15_demean_per_sub.html#cb215-6" aria-hidden="true" tabindex="-1"></a>                                EXPECT_cmc <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>src_subject_id), <span class="at">data =</span> pvc)</span></code></pre></div>
</details>
<pre><code>## fixed-effect model matrix is rank deficient so dropping 1 column / coefficient</code></pre>
<pre><code>## boundary (singular) fit: see help(&#39;isSingular&#39;)</code></pre>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb218"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb218-1"><a href="ch15_demean_per_sub.html#cb218-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model.factorize_demean)</span></code></pre></div>
</details>
<pre><code>## Linear mixed model fit by REML. t-tests use Satterthwaite&#39;s method [
## lmerModLmerTest]
## Formula: demean_outcome ~ CUE_high_gt_low * stim_con_linear * demean_expect +  
##     CUE_high_gt_low * stim_con_quad * demean_expect + EXPECT_cmc +  
##     (1 | src_subject_id)
##    Data: pvc
## 
## REML criterion at convergence: 43807.3
## 
## Scaled residuals: 
##     Min      1Q  Median      3Q     Max 
## -4.1272 -0.6113 -0.1388  0.4529  7.1545 
## 
## Random effects:
##  Groups         Name        Variance Std.Dev.
##  src_subject_id (Intercept)   0.0     0.00   
##  Residual                   347.4    18.64   
## Number of obs: 5041, groups:  src_subject_id, 110
## 
## Fixed effects:
##                                                 Estimate Std. Error         df
## (Intercept)                                    6.017e-02  3.729e-01  5.029e+03
## CUE_high_gt_low                               -1.515e-02  7.458e-01  5.029e+03
## stim_con_linear                                8.066e+00  8.920e-01  5.029e+03
## demean_expect                                  2.374e-01  1.662e-02  5.029e+03
## stim_con_quad                                  3.181e+00  8.174e-01  5.029e+03
## CUE_high_gt_low:stim_con_linear                2.562e+00  1.784e+00  5.029e+03
## CUE_high_gt_low:demean_expect                 -1.247e-02  3.324e-02  5.029e+03
## stim_con_linear:demean_expect                  1.995e-02  3.894e-02  5.029e+03
## CUE_high_gt_low:stim_con_quad                 -2.304e+00  1.635e+00  5.029e+03
## demean_expect:stim_con_quad                    1.089e-03  3.710e-02  5.029e+03
## CUE_high_gt_low:stim_con_linear:demean_expect  1.105e-01  7.788e-02  5.029e+03
## CUE_high_gt_low:demean_expect:stim_con_quad   -9.891e-03  7.419e-02  5.029e+03
##                                               t value Pr(&gt;|t|)    
## (Intercept)                                     0.161 0.871825    
## CUE_high_gt_low                                -0.020 0.983797    
## stim_con_linear                                 9.044  &lt; 2e-16 ***
## demean_expect                                  14.286  &lt; 2e-16 ***
## stim_con_quad                                   3.892 0.000101 ***
## CUE_high_gt_low:stim_con_linear                 1.436 0.151056    
## CUE_high_gt_low:demean_expect                  -0.375 0.707610    
## stim_con_linear:demean_expect                   0.512 0.608536    
## CUE_high_gt_low:stim_con_quad                  -1.410 0.158728    
## demean_expect:stim_con_quad                     0.029 0.976584    
## CUE_high_gt_low:stim_con_linear:demean_expect   1.419 0.156016    
## CUE_high_gt_low:demean_expect:stim_con_quad    -0.133 0.893945    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Correlation of Fixed Effects:
##                        (Intr) CUE_h__ stm_cn_l dmn_xp stm_cn_q
## CUE_hgh_gt_            -0.165                                 
## stim_cn_lnr            -0.006 -0.029                          
## demean_xpct             0.225 -0.709   0.015                  
## stim_con_qd             0.064 -0.036   0.004    0.050         
## CUE_hgh_gt_lw:stm_cn_l -0.029 -0.006  -0.146   -0.005  0.020  
## CUE_hgh__:_            -0.709  0.225  -0.005   -0.307 -0.079  
## stm_cn_ln:_             0.015 -0.005   0.202    0.006 -0.011  
## CUE_hgh_gt_lw:stm_cn_q -0.036  0.064   0.020   -0.079 -0.183  
## dmn_xpct:__             0.049 -0.077  -0.010    0.115  0.245  
## CUE___:__:_            -0.005  0.015  -0.698    0.014  0.003  
## CUE___:_:__            -0.077  0.049   0.003   -0.078 -0.719  
##                        CUE_hgh_gt_lw:stm_cn_l CUE_h__:_ st__:_
## CUE_hgh_gt_                                                   
## stim_cn_lnr                                                   
## demean_xpct                                                   
## stim_con_qd                                                   
## CUE_hgh_gt_lw:stm_cn_l                                        
## CUE_hgh__:_             0.015                                 
## stm_cn_ln:_            -0.698                  0.014          
## CUE_hgh_gt_lw:stm_cn_q  0.004                  0.050     0.003
## dmn_xpct:__             0.003                 -0.078    -0.004
## CUE___:__:_             0.202                  0.006    -0.273
## CUE___:_:__            -0.010                  0.115    -0.009
##                        CUE_hgh_gt_lw:stm_cn_q dm_:__ CUE___:__:
## CUE_hgh_gt_                                                    
## stim_cn_lnr                                                    
## demean_xpct                                                    
## stim_con_qd                                                    
## CUE_hgh_gt_lw:stm_cn_l                                         
## CUE_hgh__:_                                                    
## stm_cn_ln:_                                                    
## CUE_hgh_gt_lw:stm_cn_q                                         
## dmn_xpct:__            -0.719                                  
## CUE___:__:_            -0.011                 -0.009           
## CUE___:_:__             0.245                 -0.336 -0.004    
## fit warnings:
## fixed-effect model matrix is rank deficient so dropping 1 column / coefficient
## optimizer (nloptwrap) convergence code: 0 (OK)
## boundary (singular) fit: see help(&#39;isSingular&#39;)</code></pre>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb220"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb220-1"><a href="ch15_demean_per_sub.html#cb220-1" aria-hidden="true" tabindex="-1"></a><span class="co"># model.factorize_C= lmer(demean_outcome~ CUE_high_gt_low*stim_factor*demean_expect +EXPECT_cmc+ (1|src_subject_id), data = pvc)</span></span>
<span id="cb220-2"><a href="ch15_demean_per_sub.html#cb220-2" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(model.factorize_demean)</span></span></code></pre></div>
</details>
<p><img src="15_iv-cue-stim-outcome-expect_dv-outcome_demean_files/figure-html/unnamed-chunk-19-1.png" width="672" /></p>
<p><img src="15_iv-cue-stim-outcome-expect_dv-outcome_demean_files/figure-html/unnamed-chunk-20-1.png" width="672" /></p>
<pre><code>## Linear mixed model fit by REML. t-tests use Satterthwaite&#39;s method [
## lmerModLmerTest]
## Formula: 
## as.formula(reformulate(c(iv, sprintf(&quot;(%s|%s)&quot;, iv, subject_keyword)),  
##     response = dv))
##    Data: df
## 
## REML criterion at convergence: 40996.5
## 
## Scaled residuals: 
##     Min      1Q  Median      3Q     Max 
## -2.4634 -0.6567 -0.1325  0.5028  6.6541 
## 
## Random effects:
##  Groups         Name        Variance  Std.Dev. Corr 
##  src_subject_id (Intercept)  43.94315  6.6290       
##                 cue_namelow   0.03079  0.1755  -1.00
##  Residual                   189.43985 13.7637       
## Number of obs: 5041, groups:  src_subject_id, 110
## 
## Fixed effects:
##              Estimate Std. Error        df t value Pr(&gt;|t|)    
## (Intercept)   18.8604     0.6959  107.7330  27.101   &lt;2e-16 ***
## cue_namelow   -0.5008     0.3891 4141.2072  -1.287    0.198    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Correlation of Fixed Effects:
##             (Intr)
## cue_namelow -0.319
## optimizer (nloptwrap) convergence code: 0 (OK)
## boundary (singular) fit: see help(&#39;isSingular&#39;)</code></pre>
<pre><code>## Warning in geom_line(data = subjectwise, aes(group = .data[[subject]], x =
## as.numeric(as.factor(.data[[iv]])) - : Ignoring unknown aesthetics: fill</code></pre>
<p><img src="15_iv-cue-stim-outcome-expect_dv-outcome_demean_files/figure-html/unnamed-chunk-21-1.png" width="672" /></p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb223"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb223-1"><a href="ch15_demean_per_sub.html#cb223-1" aria-hidden="true" tabindex="-1"></a><span class="co"># library(plotly)</span></span>
<span id="cb223-2"><a href="ch15_demean_per_sub.html#cb223-2" aria-hidden="true" tabindex="-1"></a><span class="co"># plot_ly(x=subjectwise_naomit_2dv$param_cue_type, y=subjectwise_naomit_2dv$DV1_mean_per_sub, z=subjectwise_naomit_2dv$DV2_mean_per_sub, type=&quot;scatter3d&quot;, mode=&quot;markers&quot;, color=subjectwise_naomit_2dv$param_cue_type)</span></span></code></pre></div>
</details>
</div>
<div id="across-tasks-pvc-is-the-slope-for-highvslow-cue-the-sametor-question" class="section level2 hasAnchor" number="8.9">
<h2><span class="header-section-number">8.9</span> across tasks (PVC), is the slope for (highvslow cue) the same?Tor question<a href="ch15_demean_per_sub.html#across-tasks-pvc-is-the-slope-for-highvslow-cue-the-sametor-question" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>Adding “participant” as random effects leads to a singular boundary issue. The reason is because there is no random effects variance across participants.</li>
</ul>
<ol style="list-style-type: decimal">
<li>If I add task as a random effect, in other words, allowing for differences across tasks, I get the following results:</li>
</ol>
<ul>
<li>expectancy-outcome relationship differs across tasks, taskname_lin:demean_expect, t(14130) = 4.317, p &lt; .001</li>
<li>expectancy-outcome relationship differs across cue and tasks, “taskname_lin:CUE_high_gt_low:demean_expect”, t(14130) = 5.758, p &lt; .001
taskname_lin:CUE_high_gt_low -3.790e+00 1.448e+00 1.413e+04 -2.618 0.00886 **
++ taskname_lin:demean_expect 9.854e-02 2.283e-02 1.413e+04 4.317 1.59e-05 <strong><em>
CUE_high_gt_low:demean_expect -9.077e-02 1.987e-02 1.413e+04 -4.569 4.95e-06 </em></strong>
CUE_high_gt_low:taskname_quad 5.352e+00 1.334e+00 1.413e+04 4.012 6.04e-05 <strong><em>
demean_expect:taskname_quad -1.596e-01 2.253e-02 1.413e+04 -7.084 1.47e-12 </em></strong>
taskname_lin:CUE_high_gt_low:demean_expect 2.629e-01 4.565e-02 1.413e+04 5.758 8.67e-09 **<em>
CUE_high_gt_low:demean_expect:taskname_quad -1.021e-01 4.505e-02 1.413e+04 -2.266 0.02348 </em></li>
</ul>
<ol start="2" style="list-style-type: decimal">
<li>If I add sub as random effect and ignore singular. Plus, if I remove the cue contrast…</li>
</ol>
<ul>
<li>expectancy-outcome relationship differs across tasks, factor(param_task_name):demean_expect, F(2, 14136) = 54.765, p &lt; .001</li>
</ul>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb224"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb224-1"><a href="ch15_demean_per_sub.html#cb224-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">load_task_social_df</span>(datadir, <span class="at">taskname =</span> <span class="st">&#39;pain&#39;</span>, <span class="at">subject_varkey =</span> subject_varkey, <span class="at">iv =</span> iv, <span class="at">exclude =</span> exclude)</span>
<span id="cb224-2"><a href="ch15_demean_per_sub.html#cb224-2" aria-hidden="true" tabindex="-1"></a>v <span class="ot">&lt;-</span> <span class="fu">load_task_social_df</span>(datadir, <span class="at">taskname =</span> <span class="st">&#39;vicarious&#39;</span>, <span class="at">subject_varkey =</span> subject_varkey, <span class="at">iv =</span> iv, <span class="at">exclude =</span> exclude)</span>
<span id="cb224-3"><a href="ch15_demean_per_sub.html#cb224-3" aria-hidden="true" tabindex="-1"></a>c <span class="ot">&lt;-</span> <span class="fu">load_task_social_df</span>(datadir, <span class="at">taskname =</span> <span class="st">&#39;cognitive&#39;</span>, <span class="at">subject_varkey =</span> subject_varkey, <span class="at">iv =</span> iv, <span class="at">exclude =</span> exclude)</span>
<span id="cb224-4"><a href="ch15_demean_per_sub.html#cb224-4" aria-hidden="true" tabindex="-1"></a>p_sub <span class="ot">&lt;-</span> p[, <span class="fu">c</span>(<span class="st">&quot;param_task_name&quot;</span>, <span class="st">&quot;param_cue_type&quot;</span>, <span class="st">&quot;src_subject_id&quot;</span>,<span class="st">&quot;session_id&quot;</span>, <span class="st">&quot;param_run_num&quot;</span>, <span class="st">&quot;param_stimulus_type&quot;</span>, <span class="st">&quot;event04_actual_angle&quot;</span>, <span class="st">&quot;event02_expect_angle&quot;</span>)]</span>
<span id="cb224-5"><a href="ch15_demean_per_sub.html#cb224-5" aria-hidden="true" tabindex="-1"></a>v_sub <span class="ot">&lt;-</span> v[, <span class="fu">c</span>(<span class="st">&quot;param_task_name&quot;</span>, <span class="st">&quot;param_cue_type&quot;</span>, <span class="st">&quot;src_subject_id&quot;</span>,<span class="st">&quot;session_id&quot;</span>, <span class="st">&quot;param_run_num&quot;</span>, <span class="st">&quot;param_stimulus_type&quot;</span>, <span class="st">&quot;event04_actual_angle&quot;</span>, <span class="st">&quot;event02_expect_angle&quot;</span>)]</span>
<span id="cb224-6"><a href="ch15_demean_per_sub.html#cb224-6" aria-hidden="true" tabindex="-1"></a>c_sub <span class="ot">&lt;-</span> c[, <span class="fu">c</span>(<span class="st">&quot;param_task_name&quot;</span>, <span class="st">&quot;param_cue_type&quot;</span>, <span class="st">&quot;src_subject_id&quot;</span>, <span class="st">&quot;session_id&quot;</span>, <span class="st">&quot;param_run_num&quot;</span>,<span class="st">&quot;param_stimulus_type&quot;</span>, <span class="st">&quot;event04_actual_angle&quot;</span>, <span class="st">&quot;event02_expect_angle&quot;</span>)]</span>
<span id="cb224-7"><a href="ch15_demean_per_sub.html#cb224-7" aria-hidden="true" tabindex="-1"></a>pvc_sub <span class="ot">&lt;-</span> <span class="fu">do.call</span>(<span class="st">&quot;rbind&quot;</span>, <span class="fu">list</span>(p_sub, v_sub, c_sub))</span></code></pre></div>
</details>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb225"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb225-1"><a href="ch15_demean_per_sub.html#cb225-1" aria-hidden="true" tabindex="-1"></a>maindata <span class="ot">&lt;-</span> pvc_sub <span class="sc">%&gt;%</span></span>
<span id="cb225-2"><a href="ch15_demean_per_sub.html#cb225-2" aria-hidden="true" tabindex="-1"></a><span class="fu">group_by</span>(src_subject_id) <span class="sc">%&gt;%</span></span>
<span id="cb225-3"><a href="ch15_demean_per_sub.html#cb225-3" aria-hidden="true" tabindex="-1"></a><span class="fu">mutate</span>(<span class="at">event04_actual_angle =</span> <span class="fu">as.numeric</span>(event04_actual_angle)) <span class="sc">%&gt;%</span></span>
<span id="cb225-4"><a href="ch15_demean_per_sub.html#cb225-4" aria-hidden="true" tabindex="-1"></a><span class="fu">mutate</span>(<span class="at">event02_expect_angle =</span> <span class="fu">as.numeric</span>(event02_expect_angle)) <span class="sc">%&gt;%</span></span>
<span id="cb225-5"><a href="ch15_demean_per_sub.html#cb225-5" aria-hidden="true" tabindex="-1"></a><span class="fu">mutate</span>(<span class="at">avg_outcome =</span> <span class="fu">mean</span>(event04_actual_angle, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb225-6"><a href="ch15_demean_per_sub.html#cb225-6" aria-hidden="true" tabindex="-1"></a><span class="fu">mutate</span>(<span class="at">demean_outcome =</span> event04_actual_angle <span class="sc">-</span> avg_outcome) <span class="sc">%&gt;%</span></span>
<span id="cb225-7"><a href="ch15_demean_per_sub.html#cb225-7" aria-hidden="true" tabindex="-1"></a><span class="fu">mutate</span>(<span class="at">avg_expect =</span> <span class="fu">mean</span>(event02_expect_angle, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb225-8"><a href="ch15_demean_per_sub.html#cb225-8" aria-hidden="true" tabindex="-1"></a><span class="fu">mutate</span>(<span class="at">demean_expect =</span> event02_expect_angle <span class="sc">-</span> avg_expect)</span>
<span id="cb225-9"><a href="ch15_demean_per_sub.html#cb225-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb225-10"><a href="ch15_demean_per_sub.html#cb225-10" aria-hidden="true" tabindex="-1"></a>data_p2<span class="ot">=</span> maindata <span class="sc">%&gt;%</span></span>
<span id="cb225-11"><a href="ch15_demean_per_sub.html#cb225-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(src_subject_id ) <span class="sc">%&gt;%</span></span>
<span id="cb225-12"><a href="ch15_demean_per_sub.html#cb225-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(src_subject_id) <span class="sc">%&gt;%</span></span>
<span id="cb225-13"><a href="ch15_demean_per_sub.html#cb225-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">trial_index =</span> <span class="fu">row_number</span>())</span>
<span id="cb225-14"><a href="ch15_demean_per_sub.html#cb225-14" aria-hidden="true" tabindex="-1"></a>data_a3 <span class="ot">&lt;-</span> data_p2 <span class="sc">%&gt;%</span> </span>
<span id="cb225-15"><a href="ch15_demean_per_sub.html#cb225-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(src_subject_id, session_id, param_run_num) <span class="sc">%&gt;%</span> </span>
<span id="cb225-16"><a href="ch15_demean_per_sub.html#cb225-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">trial_index =</span> <span class="fu">row_number</span>(param_run_num))</span>
<span id="cb225-17"><a href="ch15_demean_per_sub.html#cb225-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb225-18"><a href="ch15_demean_per_sub.html#cb225-18" aria-hidden="true" tabindex="-1"></a>data_a3lag <span class="ot">&lt;-</span> </span>
<span id="cb225-19"><a href="ch15_demean_per_sub.html#cb225-19" aria-hidden="true" tabindex="-1"></a>    data_a3 <span class="sc">%&gt;%</span></span>
<span id="cb225-20"><a href="ch15_demean_per_sub.html#cb225-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(src_subject_id, session_id, param_run_num) <span class="sc">%&gt;%</span></span>
<span id="cb225-21"><a href="ch15_demean_per_sub.html#cb225-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">lag.demean_outcome =</span> dplyr<span class="sc">::</span><span class="fu">lag</span>(demean_outcome, <span class="at">n =</span> <span class="dv">1</span>, <span class="at">default =</span> <span class="cn">NA</span>))</span>
<span id="cb225-22"><a href="ch15_demean_per_sub.html#cb225-22" aria-hidden="true" tabindex="-1"></a>data_a3lag_omit <span class="ot">&lt;-</span> data_a3lag[<span class="fu">complete.cases</span>(data_a3lag<span class="sc">$</span>lag.demean_outcome),]</span>
<span id="cb225-23"><a href="ch15_demean_per_sub.html#cb225-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb225-24"><a href="ch15_demean_per_sub.html#cb225-24" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> data_a3lag_omit</span>
<span id="cb225-25"><a href="ch15_demean_per_sub.html#cb225-25" aria-hidden="true" tabindex="-1"></a>pvc_sub <span class="ot">&lt;-</span> <span class="fu">simple_contrasts_beh</span>(df)</span></code></pre></div>
</details>
<pre><code>## Warning: Unknown or uninitialised column: `stim_con_linear`.</code></pre>
<pre><code>## Warning: Unknown or uninitialised column: `stim_con_quad`.</code></pre>
<pre><code>## Warning: Unknown or uninitialised column: `CUE_high_gt_low`.</code></pre>
<pre><code>## Warning: Unknown or uninitialised column: `cue_name`.</code></pre>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb230"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb230-1"><a href="ch15_demean_per_sub.html#cb230-1" aria-hidden="true" tabindex="-1"></a><span class="co"># contrast code 1 linear</span></span>
<span id="cb230-2"><a href="ch15_demean_per_sub.html#cb230-2" aria-hidden="true" tabindex="-1"></a>pvc_sub<span class="sc">$</span>taskname_lin[pvc_sub<span class="sc">$</span>param_task_name <span class="sc">==</span> <span class="st">&quot;pain&quot;</span>] <span class="ot">&lt;-</span>  <span class="fl">0.5</span></span></code></pre></div>
</details>
<pre><code>## Warning: Unknown or uninitialised column: `taskname_lin`.</code></pre>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb232"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb232-1"><a href="ch15_demean_per_sub.html#cb232-1" aria-hidden="true" tabindex="-1"></a>pvc_sub<span class="sc">$</span>taskname_lin[pvc_sub<span class="sc">$</span>param_task_name <span class="sc">==</span> <span class="st">&quot;vicarious&quot;</span>] <span class="ot">&lt;-</span>  <span class="dv">0</span></span>
<span id="cb232-2"><a href="ch15_demean_per_sub.html#cb232-2" aria-hidden="true" tabindex="-1"></a>pvc_sub<span class="sc">$</span>taskname_lin[pvc_sub<span class="sc">$</span>param_task_name <span class="sc">==</span> <span class="st">&quot;cognitive&quot;</span>] <span class="ot">&lt;-</span>  <span class="sc">-</span><span class="fl">0.5</span></span>
<span id="cb232-3"><a href="ch15_demean_per_sub.html#cb232-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb232-4"><a href="ch15_demean_per_sub.html#cb232-4" aria-hidden="true" tabindex="-1"></a><span class="co"># contrast code 2 quadratic</span></span>
<span id="cb232-5"><a href="ch15_demean_per_sub.html#cb232-5" aria-hidden="true" tabindex="-1"></a>pvc_sub<span class="sc">$</span>taskname_quad[pvc_sub<span class="sc">$</span>param_task_name <span class="sc">==</span> <span class="st">&quot;pain&quot;</span>] <span class="ot">&lt;-</span>  <span class="sc">-</span><span class="fl">0.33</span></span></code></pre></div>
</details>
<pre><code>## Warning: Unknown or uninitialised column: `taskname_quad`.</code></pre>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb234"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb234-1"><a href="ch15_demean_per_sub.html#cb234-1" aria-hidden="true" tabindex="-1"></a>pvc_sub<span class="sc">$</span>taskname_quad[pvc_sub<span class="sc">$</span>param_task_name <span class="sc">==</span> <span class="st">&quot;vicarious&quot;</span>] <span class="ot">&lt;-</span>  <span class="fl">0.66</span></span>
<span id="cb234-2"><a href="ch15_demean_per_sub.html#cb234-2" aria-hidden="true" tabindex="-1"></a>pvc_sub<span class="sc">$</span>taskname_quad[pvc_sub<span class="sc">$</span>param_task_name <span class="sc">==</span> <span class="st">&quot;cognitive&quot;</span>] <span class="ot">&lt;-</span>  <span class="sc">-</span><span class="fl">0.33</span></span>
<span id="cb234-3"><a href="ch15_demean_per_sub.html#cb234-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb234-4"><a href="ch15_demean_per_sub.html#cb234-4" aria-hidden="true" tabindex="-1"></a>pvc_sub<span class="sc">$</span>sub <span class="ot">=</span> <span class="fu">factor</span>(pvc_sub<span class="sc">$</span>src_subject_id)</span>
<span id="cb234-5"><a href="ch15_demean_per_sub.html#cb234-5" aria-hidden="true" tabindex="-1"></a><span class="co"># model_test = lm(pvc_sub$demean_outcome~ pvc_sub$demean_expect)</span></span>
<span id="cb234-6"><a href="ch15_demean_per_sub.html#cb234-6" aria-hidden="true" tabindex="-1"></a>model_task <span class="ot">=</span> <span class="fu">lmer</span>(demean_outcome<span class="sc">~</span> taskname_lin<span class="sc">*</span>CUE_high_gt_low<span class="sc">*</span>demean_expect <span class="sc">+</span> taskname_quad<span class="sc">*</span>CUE_high_gt_low<span class="sc">*</span>demean_expect <span class="sc">+</span>  (<span class="dv">1</span> <span class="sc">|</span> sub), <span class="at">data =</span> pvc_sub)</span>
<span id="cb234-7"><a href="ch15_demean_per_sub.html#cb234-7" aria-hidden="true" tabindex="-1"></a>model_wotask <span class="ot">=</span> <span class="fu">lmer</span>(demean_outcome<span class="sc">~</span> CUE_high_gt_low<span class="sc">*</span>demean_expect <span class="sc">+</span>(<span class="dv">1</span> <span class="sc">|</span> sub), <span class="at">data =</span> pvc_sub)</span></code></pre></div>
</details>
<pre><code>## boundary (singular) fit: see help(&#39;isSingular&#39;)</code></pre>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb236"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb236-1"><a href="ch15_demean_per_sub.html#cb236-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_task)</span></code></pre></div>
</details>
<pre><code>## Linear mixed model fit by REML. t-tests use Satterthwaite&#39;s method [
## lmerModLmerTest]
## Formula: demean_outcome ~ taskname_lin * CUE_high_gt_low * demean_expect +  
##     taskname_quad * CUE_high_gt_low * demean_expect + (1 | sub)
##    Data: pvc_sub
## 
## REML criterion at convergence: 139399.8
## 
## Scaled residuals: 
##     Min      1Q  Median      3Q     Max 
## -4.5727 -0.6342 -0.1226  0.5514  5.3674 
## 
## Random effects:
##  Groups   Name        Variance Std.Dev.
##  sub      (Intercept)   0.1232  0.351  
##  Residual             600.5633 24.506  
## Number of obs: 15091, groups:  sub, 111
## 
## Fixed effects:
##                                               Estimate Std. Error         df
## (Intercept)                                 -3.019e-01  2.951e-01  2.477e+02
## taskname_lin                                 1.801e+01  6.935e-01  1.447e+04
## CUE_high_gt_low                             -9.551e+00  5.853e-01  1.369e+04
## demean_expect                                4.696e-01  9.457e-03  1.156e+04
## taskname_quad                               -1.082e+01  6.465e-01  1.482e+04
## taskname_lin:CUE_high_gt_low                -4.377e+00  1.388e+00  7.418e+03
## taskname_lin:demean_expect                   1.007e-01  2.163e-02  1.758e+03
## CUE_high_gt_low:demean_expect               -8.861e-02  1.894e-02  4.064e+03
## CUE_high_gt_low:taskname_quad                5.276e+00  1.294e+00  1.247e+04
## demean_expect:taskname_quad                 -1.730e-01  2.157e-02  8.290e+03
## taskname_lin:CUE_high_gt_low:demean_expect   2.685e-01  4.314e-02  1.405e+04
## CUE_high_gt_low:demean_expect:taskname_quad -1.063e-01  4.310e-02  1.484e+04
##                                             t value Pr(&gt;|t|)    
## (Intercept)                                  -1.023  0.30723    
## taskname_lin                                 25.973  &lt; 2e-16 ***
## CUE_high_gt_low                             -16.319  &lt; 2e-16 ***
## demean_expect                                49.657  &lt; 2e-16 ***
## taskname_quad                               -16.741  &lt; 2e-16 ***
## taskname_lin:CUE_high_gt_low                 -3.153  0.00162 ** 
## taskname_lin:demean_expect                    4.655 3.48e-06 ***
## CUE_high_gt_low:demean_expect                -4.679 2.98e-06 ***
## CUE_high_gt_low:taskname_quad                 4.078 4.56e-05 ***
## demean_expect:taskname_quad                  -8.022 1.18e-15 ***
## taskname_lin:CUE_high_gt_low:demean_expect    6.224 4.98e-10 ***
## CUE_high_gt_low:demean_expect:taskname_quad  -2.466  0.01368 *  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Correlation of Fixed Effects:
##                  (Intr) tsknm_l CUE_h__ dmn_xp tsknm_q ts_:CUE___ tsk_:_
## taskname_ln       0.005                                                 
## CUE_hgh_gt_      -0.188  0.369                                          
## demean_xpct       0.224 -0.360  -0.620                                  
## taskname_qd       0.087 -0.004  -0.299   0.280                          
## tsk_:CUE___       0.368  0.032   0.004   0.141 -0.253                   
## tsknm_ln:d_      -0.374  0.022   0.146  -0.281  0.256  -0.574           
## CUE_hgh_gt_lw:d_ -0.616  0.140   0.225  -0.197 -0.142  -0.362      0.151
## CUE_hgh_gt_lw:t_ -0.298 -0.253   0.088  -0.143 -0.382  -0.005     -0.097
## dmn_xpct:t_       0.271  0.240  -0.139   0.177  0.391  -0.091      0.183
## t_:CUE___:_       0.145 -0.572  -0.375   0.150 -0.099   0.023     -0.120
## CUE_h__:_:_      -0.137 -0.093   0.272  -0.123 -0.659   0.239     -0.099
##                  CUE_hgh_gt_lw:d_ CUE_hgh_gt_lw:t_ dmn_:_ t_:CUE___:
## taskname_ln                                                         
## CUE_hgh_gt_                                                         
## demean_xpct                                                         
## taskname_qd                                                         
## tsk_:CUE___                                                         
## tsknm_ln:d_                                                         
## CUE_hgh_gt_lw:d_                                                    
## CUE_hgh_gt_lw:t_  0.281                                             
## dmn_xpct:t_      -0.123           -0.660                            
## t_:CUE___:_      -0.280            0.256           -0.099           
## CUE_h__:_:_       0.176            0.391           -0.255  0.185</code></pre>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb238"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb238-1"><a href="ch15_demean_per_sub.html#cb238-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(model_task)</span></code></pre></div>
</details>
<pre><code>## Type III Analysis of Variance Table with Satterthwaite&#39;s method
##                                              Sum Sq Mean Sq NumDF   DenDF
## taskname_lin                                 405142  405142     1 14470.1
## CUE_high_gt_low                              159941  159941     1 13687.7
## demean_expect                               1480894 1480894     1 11560.3
## taskname_quad                                168310  168310     1 14820.0
## taskname_lin:CUE_high_gt_low                   5970    5970     1  7418.2
## taskname_lin:demean_expect                    13016   13016     1  1757.8
## CUE_high_gt_low:demean_expect                 13146   13146     1  4063.7
## CUE_high_gt_low:taskname_quad                  9989    9989     1 12473.3
## demean_expect:taskname_quad                   38647   38647     1  8289.7
## taskname_lin:CUE_high_gt_low:demean_expect    23266   23266     1 14053.9
## CUE_high_gt_low:demean_expect:taskname_quad    3652    3652     1 14843.7
##                                               F value    Pr(&gt;F)    
## taskname_lin                                 674.6035 &lt; 2.2e-16 ***
## CUE_high_gt_low                              266.3187 &lt; 2.2e-16 ***
## demean_expect                               2465.8423 &lt; 2.2e-16 ***
## taskname_quad                                280.2539 &lt; 2.2e-16 ***
## taskname_lin:CUE_high_gt_low                   9.9409  0.001623 ** 
## taskname_lin:demean_expect                    21.6722 3.477e-06 ***
## CUE_high_gt_low:demean_expect                 21.8899 2.981e-06 ***
## CUE_high_gt_low:taskname_quad                 16.6325 4.565e-05 ***
## demean_expect:taskname_quad                   64.3519 1.183e-15 ***
## taskname_lin:CUE_high_gt_low:demean_expect    38.7401 4.979e-10 ***
## CUE_high_gt_low:demean_expect:taskname_quad    6.0802  0.013681 *  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb240"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb240-1"><a href="ch15_demean_per_sub.html#cb240-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(model_wotask, model_task)</span></code></pre></div>
</details>
<pre><code>## refitting model(s) with ML (instead of REML)</code></pre>
<pre><code>## Data: pvc_sub
## Models:
## model_wotask: demean_outcome ~ CUE_high_gt_low * demean_expect + (1 | sub)
## model_task: demean_outcome ~ taskname_lin * CUE_high_gt_low * demean_expect + taskname_quad * CUE_high_gt_low * demean_expect + (1 | sub)
##              npar    AIC    BIC logLik deviance  Chisq Df Pr(&gt;Chisq)    
## model_wotask    6 141394 141440 -70691   141382                         
## model_task     14 139396 139502 -69684   139368 2014.4  8  &lt; 2.2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb243"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb243-1"><a href="ch15_demean_per_sub.html#cb243-1" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(model_test)</span></span></code></pre></div>
</details>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb244"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb244-1"><a href="ch15_demean_per_sub.html#cb244-1" aria-hidden="true" tabindex="-1"></a>model_task1 <span class="ot">=</span> <span class="fu">lmer</span>(demean_outcome<span class="sc">~</span> <span class="fu">factor</span>(param_task_name)<span class="sc">*</span>demean_expect  <span class="sc">+</span>  (<span class="dv">1</span> <span class="sc">|</span> sub), <span class="at">data =</span> pvc_sub)</span>
<span id="cb244-2"><a href="ch15_demean_per_sub.html#cb244-2" aria-hidden="true" tabindex="-1"></a>model_wotask1 <span class="ot">=</span> <span class="fu">lmer</span>(demean_outcome<span class="sc">~</span> demean_expect<span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> sub), <span class="at">data =</span> pvc_sub)</span></code></pre></div>
</details>
<pre><code>## boundary (singular) fit: see help(&#39;isSingular&#39;)</code></pre>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb246"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb246-1"><a href="ch15_demean_per_sub.html#cb246-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_task1)</span></code></pre></div>
</details>
<pre><code>## Linear mixed model fit by REML. t-tests use Satterthwaite&#39;s method [
## lmerModLmerTest]
## Formula: demean_outcome ~ factor(param_task_name) * demean_expect + (1 |  
##     sub)
##    Data: pvc_sub
## 
## REML criterion at convergence: 139725.4
## 
## Scaled residuals: 
##     Min      1Q  Median      3Q     Max 
## -4.2535 -0.6307 -0.1171  0.5506  5.2255 
## 
## Random effects:
##  Groups   Name        Variance  Std.Dev.
##  sub      (Intercept)   0.03748  0.1936 
##  Residual             613.93050 24.7776 
## Number of obs: 15091, groups:  sub, 111
## 
## Fixed effects:
##                                                  Estimate Std. Error         df
## (Intercept)                                    -8.081e+00  3.662e-01  8.076e+02
## factor(param_task_name)pain                     2.304e+01  5.519e-01  1.465e+04
## factor(param_task_name)vicarious               -1.434e+00  5.227e-01  1.508e+04
## demean_expect                                   3.702e-01  1.369e-02  9.687e+03
## factor(param_task_name)pain:demean_expect       1.136e-01  1.724e-02  3.523e+03
## factor(param_task_name)vicarious:demean_expect -8.418e-02  1.912e-02  1.410e+04
##                                                t value Pr(&gt;|t|)    
## (Intercept)                                    -22.067  &lt; 2e-16 ***
## factor(param_task_name)pain                     41.742  &lt; 2e-16 ***
## factor(param_task_name)vicarious                -2.744  0.00607 ** 
## demean_expect                                   27.033  &lt; 2e-16 ***
## factor(param_task_name)pain:demean_expect        6.589 5.07e-11 ***
## factor(param_task_name)vicarious:demean_expect  -4.403 1.08e-05 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Correlation of Fixed Effects:
##                     (Intr) fctr(prm_tsk_nm)p fctr(prm_tsk_nm)v dmn_xp
## fctr(prm_tsk_nm)p   -0.662                                           
## fctr(prm_tsk_nm)v   -0.699  0.464                                    
## demean_xpct          0.298 -0.198            -0.209                  
## fctr(prm_tsk_nm)p:_ -0.237 -0.080             0.166            -0.794
## fctr(prm_tsk_nm)v:_ -0.214  0.142             0.336            -0.716
##                     fctr(prm_tsk_nm)p:_
## fctr(prm_tsk_nm)p                      
## fctr(prm_tsk_nm)v                      
## demean_xpct                            
## fctr(prm_tsk_nm)p:_                    
## fctr(prm_tsk_nm)v:_  0.569</code></pre>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb248"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb248-1"><a href="ch15_demean_per_sub.html#cb248-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(model_task1)</span></code></pre></div>
</details>
<pre><code>## Type III Analysis of Variance Table with Satterthwaite&#39;s method
##                                        Sum Sq Mean Sq NumDF   DenDF  F value
## factor(param_task_name)               1451299  725650     2 14837.1 1181.974
## demean_expect                         1679513 1679513     1 14954.2 2735.674
## factor(param_task_name):demean_expect   86935   43467     2  5101.8   70.802
##                                          Pr(&gt;F)    
## factor(param_task_name)               &lt; 2.2e-16 ***
## demean_expect                         &lt; 2.2e-16 ***
## factor(param_task_name):demean_expect &lt; 2.2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb250"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb250-1"><a href="ch15_demean_per_sub.html#cb250-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(model_wotask1)</span></code></pre></div>
</details>
<pre><code>## Type III Analysis of Variance Table with Satterthwaite&#39;s method
##                Sum Sq Mean Sq NumDF DenDF F value    Pr(&gt;F)    
## demean_expect 4785248 4785248     1 15089  6564.5 &lt; 2.2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb252"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb252-1"><a href="ch15_demean_per_sub.html#cb252-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(model_wotask1, model_task1)</span></code></pre></div>
</details>
<pre><code>## refitting model(s) with ML (instead of REML)</code></pre>
<pre><code>## Data: pvc_sub
## Models:
## model_wotask1: demean_outcome ~ demean_expect + (1 | sub)
## model_task1: demean_outcome ~ factor(param_task_name) * demean_expect + (1 | sub)
##               npar    AIC    BIC logLik deviance  Chisq Df Pr(&gt;Chisq)    
## model_wotask1    4 142306 142337 -71149   142298                         
## model_task1      8 139720 139781 -69852   139704 2594.7  4  &lt; 2.2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb255"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb255-1"><a href="ch15_demean_per_sub.html#cb255-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(emmeans)</span>
<span id="cb255-2"><a href="ch15_demean_per_sub.html#cb255-2" aria-hidden="true" tabindex="-1"></a><span class="co"># emm1 = emmeans(model_task, specs = pairwise ~ stimintensity:task)</span></span>
<span id="cb255-3"><a href="ch15_demean_per_sub.html#cb255-3" aria-hidden="true" tabindex="-1"></a><span class="co"># emm1</span></span></code></pre></div>
</details>
</div>
<div id="alireza-congruent-incongruent-pe" class="section level2 hasAnchor" number="8.10">
<h2><span class="header-section-number">8.10</span> Alireza congruent incongruent (PE)<a href="ch15_demean_per_sub.html#alireza-congruent-incongruent-pe" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>categorize based on congruent, incongruent</li>
<li>split dataframe</li>
</ul>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb256"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb256-1"><a href="ch15_demean_per_sub.html#cb256-1" aria-hidden="true" tabindex="-1"></a><span class="co"># %% -------------------------------------------------------------------------</span></span>
<span id="cb256-2"><a href="ch15_demean_per_sub.html#cb256-2" aria-hidden="true" tabindex="-1"></a><span class="co">#  load pain data</span></span>
<span id="cb256-3"><a href="ch15_demean_per_sub.html#cb256-3" aria-hidden="true" tabindex="-1"></a><span class="co"># ----------------------------------------------------------------------------</span></span>
<span id="cb256-4"><a href="ch15_demean_per_sub.html#cb256-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb256-5"><a href="ch15_demean_per_sub.html#cb256-5" aria-hidden="true" tabindex="-1"></a>main_dir <span class="ot">=</span> <span class="fu">dirname</span>(<span class="fu">dirname</span>(<span class="fu">getwd</span>()))</span>
<span id="cb256-6"><a href="ch15_demean_per_sub.html#cb256-6" aria-hidden="true" tabindex="-1"></a>datadir <span class="ot">=</span> <span class="fu">file.path</span>(main_dir, <span class="st">&#39;data&#39;</span>, <span class="st">&#39;beh&#39;</span>, <span class="st">&#39;beh02_preproc&#39;</span>)</span>
<span id="cb256-7"><a href="ch15_demean_per_sub.html#cb256-7" aria-hidden="true" tabindex="-1"></a>subject_varkey <span class="ot">&lt;-</span> <span class="st">&quot;src_subject_id&quot;</span></span>
<span id="cb256-8"><a href="ch15_demean_per_sub.html#cb256-8" aria-hidden="true" tabindex="-1"></a>iv <span class="ot">&lt;-</span> <span class="st">&quot;param_cue_type&quot;</span></span>
<span id="cb256-9"><a href="ch15_demean_per_sub.html#cb256-9" aria-hidden="true" tabindex="-1"></a>xlab <span class="ot">&lt;-</span> <span class="st">&quot;&quot;</span></span>
<span id="cb256-10"><a href="ch15_demean_per_sub.html#cb256-10" aria-hidden="true" tabindex="-1"></a>taskname <span class="ot">&lt;-</span> <span class="st">&quot;pain&quot;</span></span>
<span id="cb256-11"><a href="ch15_demean_per_sub.html#cb256-11" aria-hidden="true" tabindex="-1"></a>ylab <span class="ot">&lt;-</span> <span class="st">&quot;ratings (degree)&quot;</span></span>
<span id="cb256-12"><a href="ch15_demean_per_sub.html#cb256-12" aria-hidden="true" tabindex="-1"></a>subject <span class="ot">&lt;-</span> <span class="st">&quot;subject&quot;</span></span>
<span id="cb256-13"><a href="ch15_demean_per_sub.html#cb256-13" aria-hidden="true" tabindex="-1"></a>exclude <span class="ot">&lt;-</span> <span class="st">&quot;sub-0001|sub-0003|sub-0004|sub-0005|sub-0025|sub-0999&quot;</span></span>
<span id="cb256-14"><a href="ch15_demean_per_sub.html#cb256-14" aria-hidden="true" tabindex="-1"></a>data <span class="ot">=</span> <span class="fu">data.frame</span>()</span>
<span id="cb256-15"><a href="ch15_demean_per_sub.html#cb256-15" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">load_task_social_df</span>(datadir, <span class="at">taskname =</span> taskname, <span class="at">subject_varkey =</span> subject_varkey, <span class="at">iv =</span> iv, <span class="at">exclude =</span> exclude)</span>
<span id="cb256-16"><a href="ch15_demean_per_sub.html#cb256-16" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>event03_RT <span class="ot">&lt;-</span> data<span class="sc">$</span>event03_stimulusC_reseponseonset <span class="sc">-</span> data<span class="sc">$</span>event03_stimulus_displayonset</span>
<span id="cb256-17"><a href="ch15_demean_per_sub.html#cb256-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb256-18"><a href="ch15_demean_per_sub.html#cb256-18" aria-hidden="true" tabindex="-1"></a><span class="fu">dir.create</span>(analysis_dir, <span class="at">showWarnings =</span> <span class="cn">FALSE</span>, <span class="at">recursive =</span> <span class="cn">TRUE</span>)</span>
<span id="cb256-19"><a href="ch15_demean_per_sub.html#cb256-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb256-20"><a href="ch15_demean_per_sub.html#cb256-20" aria-hidden="true" tabindex="-1"></a>maindata <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb256-21"><a href="ch15_demean_per_sub.html#cb256-21" aria-hidden="true" tabindex="-1"></a><span class="fu">group_by</span>(src_subject_id) <span class="sc">%&gt;%</span></span>
<span id="cb256-22"><a href="ch15_demean_per_sub.html#cb256-22" aria-hidden="true" tabindex="-1"></a><span class="fu">mutate</span>(<span class="at">event04_actual_angle =</span> <span class="fu">as.numeric</span>(event04_actual_angle)) <span class="sc">%&gt;%</span></span>
<span id="cb256-23"><a href="ch15_demean_per_sub.html#cb256-23" aria-hidden="true" tabindex="-1"></a><span class="fu">mutate</span>(<span class="at">event02_expect_angle =</span> <span class="fu">as.numeric</span>(event02_expect_angle)) <span class="sc">%&gt;%</span></span>
<span id="cb256-24"><a href="ch15_demean_per_sub.html#cb256-24" aria-hidden="true" tabindex="-1"></a><span class="fu">mutate</span>(<span class="at">avg_outcome =</span> <span class="fu">mean</span>(event04_actual_angle, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb256-25"><a href="ch15_demean_per_sub.html#cb256-25" aria-hidden="true" tabindex="-1"></a><span class="fu">mutate</span>(<span class="at">demean_outcome =</span> event04_actual_angle <span class="sc">-</span> avg_outcome) <span class="sc">%&gt;%</span></span>
<span id="cb256-26"><a href="ch15_demean_per_sub.html#cb256-26" aria-hidden="true" tabindex="-1"></a><span class="fu">mutate</span>(<span class="at">avg_expect =</span> <span class="fu">mean</span>(event02_expect_angle, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb256-27"><a href="ch15_demean_per_sub.html#cb256-27" aria-hidden="true" tabindex="-1"></a><span class="fu">mutate</span>(<span class="at">demean_expect =</span> event02_expect_angle <span class="sc">-</span> avg_expect)</span>
<span id="cb256-28"><a href="ch15_demean_per_sub.html#cb256-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb256-29"><a href="ch15_demean_per_sub.html#cb256-29" aria-hidden="true" tabindex="-1"></a><span class="co"># %% -------------------------------------------------------------------------</span></span>
<span id="cb256-30"><a href="ch15_demean_per_sub.html#cb256-30" aria-hidden="true" tabindex="-1"></a><span class="co">#  0. argparse</span></span>
<span id="cb256-31"><a href="ch15_demean_per_sub.html#cb256-31" aria-hidden="true" tabindex="-1"></a><span class="co"># ----------------------------------------------------------------------------</span></span>
<span id="cb256-32"><a href="ch15_demean_per_sub.html#cb256-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb256-33"><a href="ch15_demean_per_sub.html#cb256-33" aria-hidden="true" tabindex="-1"></a>data_p2<span class="ot">=</span> maindata <span class="sc">%&gt;%</span></span>
<span id="cb256-34"><a href="ch15_demean_per_sub.html#cb256-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(src_subject_id ) <span class="sc">%&gt;%</span></span>
<span id="cb256-35"><a href="ch15_demean_per_sub.html#cb256-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(src_subject_id) <span class="sc">%&gt;%</span></span>
<span id="cb256-36"><a href="ch15_demean_per_sub.html#cb256-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">trial_index =</span> <span class="fu">row_number</span>())</span>
<span id="cb256-37"><a href="ch15_demean_per_sub.html#cb256-37" aria-hidden="true" tabindex="-1"></a>data_a3 <span class="ot">&lt;-</span> data_p2 <span class="sc">%&gt;%</span> </span>
<span id="cb256-38"><a href="ch15_demean_per_sub.html#cb256-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(src_subject_id, session_id, param_run_num) <span class="sc">%&gt;%</span> </span>
<span id="cb256-39"><a href="ch15_demean_per_sub.html#cb256-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">trial_index =</span> <span class="fu">row_number</span>(param_run_num))</span>
<span id="cb256-40"><a href="ch15_demean_per_sub.html#cb256-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb256-41"><a href="ch15_demean_per_sub.html#cb256-41" aria-hidden="true" tabindex="-1"></a>data_a3lag <span class="ot">&lt;-</span> </span>
<span id="cb256-42"><a href="ch15_demean_per_sub.html#cb256-42" aria-hidden="true" tabindex="-1"></a>    data_a3 <span class="sc">%&gt;%</span></span>
<span id="cb256-43"><a href="ch15_demean_per_sub.html#cb256-43" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(src_subject_id, session_id, param_run_num) <span class="sc">%&gt;%</span></span>
<span id="cb256-44"><a href="ch15_demean_per_sub.html#cb256-44" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">lag.demean_outcome =</span> dplyr<span class="sc">::</span><span class="fu">lag</span>(demean_outcome, <span class="at">n =</span> <span class="dv">1</span>, <span class="at">default =</span> <span class="cn">NA</span>))</span>
<span id="cb256-45"><a href="ch15_demean_per_sub.html#cb256-45" aria-hidden="true" tabindex="-1"></a>data_a3lag <span class="ot">&lt;-</span> data_a3lag <span class="sc">%&gt;%</span></span>
<span id="cb256-46"><a href="ch15_demean_per_sub.html#cb256-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">EXPECT_cmc =</span> avg_expect <span class="sc">-</span> <span class="fu">mean</span>(avg_expect)) </span>
<span id="cb256-47"><a href="ch15_demean_per_sub.html#cb256-47" aria-hidden="true" tabindex="-1"></a>data_a3lag_omit <span class="ot">&lt;-</span> data_a3lag[<span class="fu">complete.cases</span>(data_a3lag<span class="sc">$</span>lag.demean_outcome),]</span>
<span id="cb256-48"><a href="ch15_demean_per_sub.html#cb256-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb256-49"><a href="ch15_demean_per_sub.html#cb256-49" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> data_a3lag_omit</span>
<span id="cb256-50"><a href="ch15_demean_per_sub.html#cb256-50" aria-hidden="true" tabindex="-1"></a>pvc <span class="ot">&lt;-</span> <span class="fu">simple_contrasts_beh</span>(df)</span></code></pre></div>
</details>
<pre><code>## Warning: Unknown or uninitialised column: `stim_con_linear`.</code></pre>
<pre><code>## Warning: Unknown or uninitialised column: `stim_con_quad`.</code></pre>
<pre><code>## Warning: Unknown or uninitialised column: `CUE_high_gt_low`.</code></pre>
<pre><code>## Warning: Unknown or uninitialised column: `cue_name`.</code></pre>
<div id="archive-this-cell" class="section level3 hasAnchor" number="8.10.1">
<h3><span class="header-section-number">8.10.1</span> archive this cell<a href="ch15_demean_per_sub.html#archive-this-cell" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb261"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb261-1"><a href="ch15_demean_per_sub.html#cb261-1" aria-hidden="true" tabindex="-1"></a><span class="co"># previous_congruency &lt;- is_congruent(param_cue_type[previous_index], param_stimulus_type[previous_index])</span></span>
<span id="cb261-2"><a href="ch15_demean_per_sub.html#cb261-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb261-3"><a href="ch15_demean_per_sub.html#cb261-3" aria-hidden="true" tabindex="-1"></a>is_congruent <span class="ot">&lt;-</span> <span class="cf">function</span>(cue, stim) {</span>
<span id="cb261-4"><a href="ch15_demean_per_sub.html#cb261-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (cue <span class="sc">==</span> <span class="st">&quot;low_cue&quot;</span> <span class="sc">&amp;&amp;</span> stim <span class="sc">==</span> <span class="st">&quot;low_stim&quot;</span>) {</span>
<span id="cb261-5"><a href="ch15_demean_per_sub.html#cb261-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="st">&quot;congruent&quot;</span>)</span>
<span id="cb261-6"><a href="ch15_demean_per_sub.html#cb261-6" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (cue <span class="sc">==</span> <span class="st">&quot;low_cue&quot;</span> <span class="sc">&amp;&amp;</span> stim <span class="sc">==</span> <span class="st">&quot;high_stim&quot;</span>) {</span>
<span id="cb261-7"><a href="ch15_demean_per_sub.html#cb261-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="st">&quot;incongruent&quot;</span>)</span>
<span id="cb261-8"><a href="ch15_demean_per_sub.html#cb261-8" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (cue <span class="sc">==</span> <span class="st">&quot;high_cue&quot;</span> <span class="sc">&amp;&amp;</span> stim <span class="sc">==</span> <span class="st">&quot;low_stim&quot;</span>) {</span>
<span id="cb261-9"><a href="ch15_demean_per_sub.html#cb261-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="st">&quot;incongruent&quot;</span>)</span>
<span id="cb261-10"><a href="ch15_demean_per_sub.html#cb261-10" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (cue <span class="sc">==</span> <span class="st">&quot;high_cue&quot;</span> <span class="sc">&amp;&amp;</span> stim <span class="sc">==</span> <span class="st">&quot;high_stim&quot;</span>) {</span>
<span id="cb261-11"><a href="ch15_demean_per_sub.html#cb261-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="st">&quot;congruent&quot;</span>)</span>
<span id="cb261-12"><a href="ch15_demean_per_sub.html#cb261-12" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (cue <span class="sc">==</span> <span class="st">&quot;high_cue&quot;</span> <span class="sc">&amp;&amp;</span> stim <span class="sc">==</span> <span class="st">&quot;med_stim&quot;</span>) {</span>
<span id="cb261-13"><a href="ch15_demean_per_sub.html#cb261-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="st">&quot;congruent&quot;</span>)</span>
<span id="cb261-14"><a href="ch15_demean_per_sub.html#cb261-14" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (cue <span class="sc">==</span> <span class="st">&quot;low_cue&quot;</span> <span class="sc">&amp;&amp;</span> stim <span class="sc">==</span> <span class="st">&quot;med_stim&quot;</span>) {</span>
<span id="cb261-15"><a href="ch15_demean_per_sub.html#cb261-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="st">&quot;incongruent&quot;</span>)</span>
<span id="cb261-16"><a href="ch15_demean_per_sub.html#cb261-16" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb261-17"><a href="ch15_demean_per_sub.html#cb261-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="cn">NA</span>)  <span class="co"># Handle other cases</span></span>
<span id="cb261-18"><a href="ch15_demean_per_sub.html#cb261-18" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb261-19"><a href="ch15_demean_per_sub.html#cb261-19" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</details>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb262"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb262-1"><a href="ch15_demean_per_sub.html#cb262-1" aria-hidden="true" tabindex="-1"></a>pvc.pain <span class="ot">&lt;-</span> pvc[pvc<span class="sc">$</span>param_task_name <span class="sc">==</span> <span class="st">&quot;pain&quot;</span>,]</span>
<span id="cb262-2"><a href="ch15_demean_per_sub.html#cb262-2" aria-hidden="true" tabindex="-1"></a>pvc.pain<span class="sc">$</span>pe <span class="ot">&lt;-</span> pvc.pain<span class="sc">$</span>demean_outcome <span class="sc">-</span> pvc.pain<span class="sc">$</span>demean_expect</span>
<span id="cb262-3"><a href="ch15_demean_per_sub.html#cb262-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb262-4"><a href="ch15_demean_per_sub.html#cb262-4" aria-hidden="true" tabindex="-1"></a><span class="co"># define congruency patterns</span></span>
<span id="cb262-5"><a href="ch15_demean_per_sub.html#cb262-5" aria-hidden="true" tabindex="-1"></a>pvc.pain<span class="sc">$</span>congruency[(pvc.pain<span class="sc">$</span>param_cue_type <span class="sc">==</span> <span class="st">&quot;low_cue&quot;</span>) <span class="sc">&amp;</span> (pvc.pain<span class="sc">$</span>pe <span class="sc">&lt;</span> <span class="dv">0</span>)] <span class="ot">&lt;-</span> <span class="st">&quot;congruent&quot;</span></span></code></pre></div>
</details>
<pre><code>## Warning: Unknown or uninitialised column: `congruency`.</code></pre>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb264"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb264-1"><a href="ch15_demean_per_sub.html#cb264-1" aria-hidden="true" tabindex="-1"></a>pvc.pain<span class="sc">$</span>congruency[(pvc.pain<span class="sc">$</span>param_cue_type <span class="sc">==</span> <span class="st">&quot;high_cue&quot;</span>) <span class="sc">&amp;</span> (pvc.pain<span class="sc">$</span>pe <span class="sc">&gt;</span> <span class="dv">0</span>)] <span class="ot">&lt;-</span> <span class="st">&quot;congruent&quot;</span></span>
<span id="cb264-2"><a href="ch15_demean_per_sub.html#cb264-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-3"><a href="ch15_demean_per_sub.html#cb264-3" aria-hidden="true" tabindex="-1"></a>pvc.pain<span class="sc">$</span>congruency[(pvc.pain<span class="sc">$</span>param_cue_type <span class="sc">==</span> <span class="st">&quot;low_cue&quot;</span>) <span class="sc">&amp;</span> (pvc.pain<span class="sc">$</span>pe <span class="sc">&gt;</span> <span class="dv">0</span>)] <span class="ot">&lt;-</span> <span class="st">&quot;incongruent&quot;</span></span>
<span id="cb264-4"><a href="ch15_demean_per_sub.html#cb264-4" aria-hidden="true" tabindex="-1"></a>pvc.pain<span class="sc">$</span>congruency[(pvc.pain<span class="sc">$</span>param_cue_type <span class="sc">==</span> <span class="st">&quot;high_cue&quot;</span>) <span class="sc">&amp;</span> (pvc.pain<span class="sc">$</span>pe <span class="sc">&lt;</span> <span class="dv">0</span>)] <span class="ot">&lt;-</span> <span class="st">&quot;incongruent&quot;</span></span>
<span id="cb264-5"><a href="ch15_demean_per_sub.html#cb264-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-6"><a href="ch15_demean_per_sub.html#cb264-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-7"><a href="ch15_demean_per_sub.html#cb264-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb264-8"><a href="ch15_demean_per_sub.html#cb264-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-9"><a href="ch15_demean_per_sub.html#cb264-9" aria-hidden="true" tabindex="-1"></a><span class="co"># definition: current cue level (high, low). </span></span>
<span id="cb264-10"><a href="ch15_demean_per_sub.html#cb264-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Find N-1 trial where cue level matches current trial</span></span>
<span id="cb264-11"><a href="ch15_demean_per_sub.html#cb264-11" aria-hidden="true" tabindex="-1"></a><span class="co"># populate that as &quot;congruency_vector&quot;</span></span>
<span id="cb264-12"><a href="ch15_demean_per_sub.html#cb264-12" aria-hidden="true" tabindex="-1"></a>pvc.pain <span class="ot">&lt;-</span> pvc.pain <span class="sc">%&gt;%</span></span>
<span id="cb264-13"><a href="ch15_demean_per_sub.html#cb264-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># group by subject, session, run</span></span>
<span id="cb264-14"><a href="ch15_demean_per_sub.html#cb264-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(src_subject_id, session_id, param_run_num) <span class="sc">%&gt;%</span></span>
<span id="cb264-15"><a href="ch15_demean_per_sub.html#cb264-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb264-16"><a href="ch15_demean_per_sub.html#cb264-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">congruency_status =</span> {</span>
<span id="cb264-17"><a href="ch15_demean_per_sub.html#cb264-17" aria-hidden="true" tabindex="-1"></a>      congruency_vector <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">&quot;character&quot;</span>, <span class="fu">n</span>())</span>
<span id="cb264-18"><a href="ch15_demean_per_sub.html#cb264-18" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb264-19"><a href="ch15_demean_per_sub.html#cb264-19" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>()) {</span>
<span id="cb264-20"><a href="ch15_demean_per_sub.html#cb264-20" aria-hidden="true" tabindex="-1"></a>        <span class="co"># get the current cue. find the trial indices with the same cue level as current trial `matching_indices`</span></span>
<span id="cb264-21"><a href="ch15_demean_per_sub.html#cb264-21" aria-hidden="true" tabindex="-1"></a>        current_cue <span class="ot">&lt;-</span> param_cue_type[i]</span>
<span id="cb264-22"><a href="ch15_demean_per_sub.html#cb264-22" aria-hidden="true" tabindex="-1"></a>        <span class="co"># identifying all existing trials that matches the current cue level</span></span>
<span id="cb264-23"><a href="ch15_demean_per_sub.html#cb264-23" aria-hidden="true" tabindex="-1"></a>        matching_indices <span class="ot">&lt;-</span> <span class="fu">which</span>(param_cue_type[<span class="dv">1</span><span class="sc">:</span>(i <span class="sc">-</span> <span class="dv">1</span>)] <span class="sc">==</span> current_cue)</span>
<span id="cb264-24"><a href="ch15_demean_per_sub.html#cb264-24" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (<span class="fu">length</span>(matching_indices) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb264-25"><a href="ch15_demean_per_sub.html#cb264-25" aria-hidden="true" tabindex="-1"></a>          <span class="co"># from matching_indices, grab the largest number. </span></span>
<span id="cb264-26"><a href="ch15_demean_per_sub.html#cb264-26" aria-hidden="true" tabindex="-1"></a>          <span class="co"># this maximum number would be the most recent N-1 cue trial, based on matching_indices</span></span>
<span id="cb264-27"><a href="ch15_demean_per_sub.html#cb264-27" aria-hidden="true" tabindex="-1"></a>          previous_index <span class="ot">&lt;-</span> <span class="fu">max</span>(matching_indices)</span>
<span id="cb264-28"><a href="ch15_demean_per_sub.html#cb264-28" aria-hidden="true" tabindex="-1"></a>          <span class="co"># populate congruency_vector with previous N-1 trial&#39;s congruency value. (</span><span class="al">NOTE</span><span class="co">: must match current cue level)</span></span>
<span id="cb264-29"><a href="ch15_demean_per_sub.html#cb264-29" aria-hidden="true" tabindex="-1"></a>          congruency_vector[i] <span class="ot">&lt;-</span> congruency[previous_index] </span>
<span id="cb264-30"><a href="ch15_demean_per_sub.html#cb264-30" aria-hidden="true" tabindex="-1"></a>        } <span class="cf">else</span> {</span>
<span id="cb264-31"><a href="ch15_demean_per_sub.html#cb264-31" aria-hidden="true" tabindex="-1"></a>          congruency_vector[i] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb264-32"><a href="ch15_demean_per_sub.html#cb264-32" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb264-33"><a href="ch15_demean_per_sub.html#cb264-33" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb264-34"><a href="ch15_demean_per_sub.html#cb264-34" aria-hidden="true" tabindex="-1"></a>      congruency_vector</span>
<span id="cb264-35"><a href="ch15_demean_per_sub.html#cb264-35" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb264-36"><a href="ch15_demean_per_sub.html#cb264-36" aria-hidden="true" tabindex="-1"></a>  ) </span>
<span id="cb264-37"><a href="ch15_demean_per_sub.html#cb264-37" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ungroup() %&gt;%</span></span>
<span id="cb264-38"><a href="ch15_demean_per_sub.html#cb264-38" aria-hidden="true" tabindex="-1"></a>  <span class="co"># mutate(</span></span>
<span id="cb264-39"><a href="ch15_demean_per_sub.html#cb264-39" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   congruency_status = ifelse(is.na(congruency_status), pvc$congruency, congruency_status)</span></span>
<span id="cb264-40"><a href="ch15_demean_per_sub.html#cb264-40" aria-hidden="true" tabindex="-1"></a>  <span class="co"># )</span></span></code></pre></div>
</details>
<p><img src="15_iv-cue-stim-outcome-expect_dv-outcome_demean_files/figure-html/unnamed-chunk-31-1.png" width="672" /></p>
<p><img src="15_iv-cue-stim-outcome-expect_dv-outcome_demean_files/figure-html/unnamed-chunk-32-1.png" width="672" /></p>
</div>
</div>
<div id="alireza-congruent-incongruent-incorrect" class="section level2 hasAnchor" number="8.11">
<h2><span class="header-section-number">8.11</span> Alireza congruent incongruent (incorrect)<a href="ch15_demean_per_sub.html#alireza-congruent-incongruent-incorrect" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>categorize based on congruent, incongruent</li>
<li>split dataframe</li>
</ul>
<div id="archive-this-cell-1" class="section level3 hasAnchor" number="8.11.1">
<h3><span class="header-section-number">8.11.1</span> archive this cell<a href="ch15_demean_per_sub.html#archive-this-cell-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb265"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb265-1"><a href="ch15_demean_per_sub.html#cb265-1" aria-hidden="true" tabindex="-1"></a><span class="co"># previous_congruency &lt;- is_congruent(param_cue_type[previous_index], param_stimulus_type[previous_index])</span></span>
<span id="cb265-2"><a href="ch15_demean_per_sub.html#cb265-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb265-3"><a href="ch15_demean_per_sub.html#cb265-3" aria-hidden="true" tabindex="-1"></a>is_congruent <span class="ot">&lt;-</span> <span class="cf">function</span>(cue, stim) {</span>
<span id="cb265-4"><a href="ch15_demean_per_sub.html#cb265-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (cue <span class="sc">==</span> <span class="st">&quot;low_cue&quot;</span> <span class="sc">&amp;&amp;</span> stim <span class="sc">==</span> <span class="st">&quot;low_stim&quot;</span>) {</span>
<span id="cb265-5"><a href="ch15_demean_per_sub.html#cb265-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="st">&quot;congruent&quot;</span>)</span>
<span id="cb265-6"><a href="ch15_demean_per_sub.html#cb265-6" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (cue <span class="sc">==</span> <span class="st">&quot;low_cue&quot;</span> <span class="sc">&amp;&amp;</span> stim <span class="sc">==</span> <span class="st">&quot;high_stim&quot;</span>) {</span>
<span id="cb265-7"><a href="ch15_demean_per_sub.html#cb265-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="st">&quot;incongruent&quot;</span>)</span>
<span id="cb265-8"><a href="ch15_demean_per_sub.html#cb265-8" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (cue <span class="sc">==</span> <span class="st">&quot;high_cue&quot;</span> <span class="sc">&amp;&amp;</span> stim <span class="sc">==</span> <span class="st">&quot;low_stim&quot;</span>) {</span>
<span id="cb265-9"><a href="ch15_demean_per_sub.html#cb265-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="st">&quot;incongruent&quot;</span>)</span>
<span id="cb265-10"><a href="ch15_demean_per_sub.html#cb265-10" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (cue <span class="sc">==</span> <span class="st">&quot;high_cue&quot;</span> <span class="sc">&amp;&amp;</span> stim <span class="sc">==</span> <span class="st">&quot;high_stim&quot;</span>) {</span>
<span id="cb265-11"><a href="ch15_demean_per_sub.html#cb265-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="st">&quot;congruent&quot;</span>)</span>
<span id="cb265-12"><a href="ch15_demean_per_sub.html#cb265-12" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (cue <span class="sc">==</span> <span class="st">&quot;high_cue&quot;</span> <span class="sc">&amp;&amp;</span> stim <span class="sc">==</span> <span class="st">&quot;med_stim&quot;</span>) {</span>
<span id="cb265-13"><a href="ch15_demean_per_sub.html#cb265-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="st">&quot;congruent&quot;</span>)</span>
<span id="cb265-14"><a href="ch15_demean_per_sub.html#cb265-14" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (cue <span class="sc">==</span> <span class="st">&quot;low_cue&quot;</span> <span class="sc">&amp;&amp;</span> stim <span class="sc">==</span> <span class="st">&quot;med_stim&quot;</span>) {</span>
<span id="cb265-15"><a href="ch15_demean_per_sub.html#cb265-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="st">&quot;incongruent&quot;</span>)</span>
<span id="cb265-16"><a href="ch15_demean_per_sub.html#cb265-16" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb265-17"><a href="ch15_demean_per_sub.html#cb265-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="cn">NA</span>)  <span class="co"># Handle other cases</span></span>
<span id="cb265-18"><a href="ch15_demean_per_sub.html#cb265-18" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb265-19"><a href="ch15_demean_per_sub.html#cb265-19" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</details>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb266"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb266-1"><a href="ch15_demean_per_sub.html#cb266-1" aria-hidden="true" tabindex="-1"></a>pvc <span class="ot">&lt;-</span> pvc[pvc<span class="sc">$</span>param_task_name <span class="sc">==</span> <span class="st">&quot;pain&quot;</span>,]</span>
<span id="cb266-2"><a href="ch15_demean_per_sub.html#cb266-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb266-3"><a href="ch15_demean_per_sub.html#cb266-3" aria-hidden="true" tabindex="-1"></a><span class="co"># define congruency patterns</span></span>
<span id="cb266-4"><a href="ch15_demean_per_sub.html#cb266-4" aria-hidden="true" tabindex="-1"></a>pvc.pain<span class="sc">$</span>congruency2[(pvc.pain<span class="sc">$</span>param_cue_type <span class="sc">==</span> <span class="st">&quot;low_cue&quot;</span>) <span class="sc">&amp;</span> (pvc.pain<span class="sc">$</span>param_stimulus_type <span class="sc">==</span> <span class="st">&quot;low_stim&quot;</span>)] <span class="ot">&lt;-</span> <span class="st">&quot;congruent&quot;</span></span></code></pre></div>
</details>
<pre><code>## Warning: Unknown or uninitialised column: `congruency2`.</code></pre>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb268"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb268-1"><a href="ch15_demean_per_sub.html#cb268-1" aria-hidden="true" tabindex="-1"></a>pvc.pain<span class="sc">$</span>congruency2[(pvc.pain<span class="sc">$</span>param_cue_type <span class="sc">==</span> <span class="st">&quot;high_cue&quot;</span>) <span class="sc">&amp;</span> (pvc.pain<span class="sc">$</span>param_stimulus_type <span class="sc">==</span> <span class="st">&quot;low_stim&quot;</span>)] <span class="ot">&lt;-</span> <span class="st">&quot;incongruent&quot;</span></span>
<span id="cb268-2"><a href="ch15_demean_per_sub.html#cb268-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb268-3"><a href="ch15_demean_per_sub.html#cb268-3" aria-hidden="true" tabindex="-1"></a>pvc.pain<span class="sc">$</span>congruency2[(pvc.pain<span class="sc">$</span>param_cue_type <span class="sc">==</span> <span class="st">&quot;low_cue&quot;</span>) <span class="sc">&amp;</span> (pvc.pain<span class="sc">$</span>param_stimulus_type <span class="sc">==</span> <span class="st">&quot;med_stim&quot;</span>)] <span class="ot">&lt;-</span> <span class="st">&quot;incongruent&quot;</span></span>
<span id="cb268-4"><a href="ch15_demean_per_sub.html#cb268-4" aria-hidden="true" tabindex="-1"></a>pvc.pain<span class="sc">$</span>congruency2[(pvc.pain<span class="sc">$</span>param_cue_type <span class="sc">==</span> <span class="st">&quot;high_cue&quot;</span>) <span class="sc">&amp;</span> (pvc.pain<span class="sc">$</span>param_stimulus_type <span class="sc">==</span> <span class="st">&quot;med_stim&quot;</span>)] <span class="ot">&lt;-</span> <span class="st">&quot;congruent&quot;</span></span>
<span id="cb268-5"><a href="ch15_demean_per_sub.html#cb268-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb268-6"><a href="ch15_demean_per_sub.html#cb268-6" aria-hidden="true" tabindex="-1"></a>pvc.pain<span class="sc">$</span>congruency2[(pvc.pain<span class="sc">$</span>param_cue_type <span class="sc">==</span> <span class="st">&quot;low_cue&quot;</span>) <span class="sc">&amp;</span> (pvc.pain<span class="sc">$</span>param_stimulus_type <span class="sc">==</span> <span class="st">&quot;high_stim&quot;</span>)] <span class="ot">&lt;-</span> <span class="st">&quot;incongruent&quot;</span></span>
<span id="cb268-7"><a href="ch15_demean_per_sub.html#cb268-7" aria-hidden="true" tabindex="-1"></a>pvc.pain<span class="sc">$</span>congruency2[(pvc.pain<span class="sc">$</span>param_cue_type <span class="sc">==</span> <span class="st">&quot;high_cue&quot;</span>) <span class="sc">&amp;</span> (pvc.pain<span class="sc">$</span>param_stimulus_type <span class="sc">==</span> <span class="st">&quot;high_stim&quot;</span>)] <span class="ot">&lt;-</span> <span class="st">&quot;congruent&quot;</span></span>
<span id="cb268-8"><a href="ch15_demean_per_sub.html#cb268-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb268-9"><a href="ch15_demean_per_sub.html#cb268-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb268-10"><a href="ch15_demean_per_sub.html#cb268-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb268-11"><a href="ch15_demean_per_sub.html#cb268-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb268-12"><a href="ch15_demean_per_sub.html#cb268-12" aria-hidden="true" tabindex="-1"></a><span class="co"># definition: current cue level (high, low). </span></span>
<span id="cb268-13"><a href="ch15_demean_per_sub.html#cb268-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Find N-1 trial where cue level matches current trial</span></span>
<span id="cb268-14"><a href="ch15_demean_per_sub.html#cb268-14" aria-hidden="true" tabindex="-1"></a><span class="co"># populate that as &quot;congruency_vector&quot;</span></span>
<span id="cb268-15"><a href="ch15_demean_per_sub.html#cb268-15" aria-hidden="true" tabindex="-1"></a>pvc.pain <span class="ot">&lt;-</span> pvc.pain <span class="sc">%&gt;%</span></span>
<span id="cb268-16"><a href="ch15_demean_per_sub.html#cb268-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># group by subject, session, run</span></span>
<span id="cb268-17"><a href="ch15_demean_per_sub.html#cb268-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(src_subject_id, session_id, param_run_num) <span class="sc">%&gt;%</span></span>
<span id="cb268-18"><a href="ch15_demean_per_sub.html#cb268-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb268-19"><a href="ch15_demean_per_sub.html#cb268-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">congruency_status2 =</span> {</span>
<span id="cb268-20"><a href="ch15_demean_per_sub.html#cb268-20" aria-hidden="true" tabindex="-1"></a>      congruency_vector <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">&quot;character&quot;</span>, <span class="fu">n</span>())</span>
<span id="cb268-21"><a href="ch15_demean_per_sub.html#cb268-21" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb268-22"><a href="ch15_demean_per_sub.html#cb268-22" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>()) {</span>
<span id="cb268-23"><a href="ch15_demean_per_sub.html#cb268-23" aria-hidden="true" tabindex="-1"></a>        <span class="co"># get the current cue. find the trial indices with the same cue level as current trial `matching_indices`</span></span>
<span id="cb268-24"><a href="ch15_demean_per_sub.html#cb268-24" aria-hidden="true" tabindex="-1"></a>        current_cue <span class="ot">&lt;-</span> param_cue_type[i]</span>
<span id="cb268-25"><a href="ch15_demean_per_sub.html#cb268-25" aria-hidden="true" tabindex="-1"></a>        <span class="co"># identifying all existing trials that matches the current cue level</span></span>
<span id="cb268-26"><a href="ch15_demean_per_sub.html#cb268-26" aria-hidden="true" tabindex="-1"></a>        matching_indices <span class="ot">&lt;-</span> <span class="fu">which</span>(param_cue_type[<span class="dv">1</span><span class="sc">:</span>(i <span class="sc">-</span> <span class="dv">1</span>)] <span class="sc">==</span> current_cue)</span>
<span id="cb268-27"><a href="ch15_demean_per_sub.html#cb268-27" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (<span class="fu">length</span>(matching_indices) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb268-28"><a href="ch15_demean_per_sub.html#cb268-28" aria-hidden="true" tabindex="-1"></a>          <span class="co"># from matching_indices, grab the largest number. </span></span>
<span id="cb268-29"><a href="ch15_demean_per_sub.html#cb268-29" aria-hidden="true" tabindex="-1"></a>          <span class="co"># this maximum number would be the most recent N-1 cue trial, based on matching_indices</span></span>
<span id="cb268-30"><a href="ch15_demean_per_sub.html#cb268-30" aria-hidden="true" tabindex="-1"></a>          previous_index <span class="ot">&lt;-</span> <span class="fu">max</span>(matching_indices)</span>
<span id="cb268-31"><a href="ch15_demean_per_sub.html#cb268-31" aria-hidden="true" tabindex="-1"></a>          <span class="co"># populate congruency_vector with previous N-1 trial&#39;s congruency value. (</span><span class="al">NOTE</span><span class="co">: must match current cue level)</span></span>
<span id="cb268-32"><a href="ch15_demean_per_sub.html#cb268-32" aria-hidden="true" tabindex="-1"></a>          congruency_vector[i] <span class="ot">&lt;-</span> congruency2[previous_index] </span>
<span id="cb268-33"><a href="ch15_demean_per_sub.html#cb268-33" aria-hidden="true" tabindex="-1"></a>        } <span class="cf">else</span> {</span>
<span id="cb268-34"><a href="ch15_demean_per_sub.html#cb268-34" aria-hidden="true" tabindex="-1"></a>          congruency_vector[i] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb268-35"><a href="ch15_demean_per_sub.html#cb268-35" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb268-36"><a href="ch15_demean_per_sub.html#cb268-36" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb268-37"><a href="ch15_demean_per_sub.html#cb268-37" aria-hidden="true" tabindex="-1"></a>      congruency_vector</span>
<span id="cb268-38"><a href="ch15_demean_per_sub.html#cb268-38" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb268-39"><a href="ch15_demean_per_sub.html#cb268-39" aria-hidden="true" tabindex="-1"></a>  ) </span>
<span id="cb268-40"><a href="ch15_demean_per_sub.html#cb268-40" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ungroup() %&gt;%</span></span>
<span id="cb268-41"><a href="ch15_demean_per_sub.html#cb268-41" aria-hidden="true" tabindex="-1"></a>  <span class="co"># mutate(</span></span>
<span id="cb268-42"><a href="ch15_demean_per_sub.html#cb268-42" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   congruency_status2 = ifelse(is.na(congruency_status2), pvc$congruency2, congruency_status2)</span></span>
<span id="cb268-43"><a href="ch15_demean_per_sub.html#cb268-43" aria-hidden="true" tabindex="-1"></a>  <span class="co"># )</span></span></code></pre></div>
</details>
<p><img src="15_iv-cue-stim-outcome-expect_dv-outcome_demean_files/figure-html/unnamed-chunk-35-1.png" width="672" /></p>
<p><img src="15_iv-cue-stim-outcome-expect_dv-outcome_demean_files/figure-html/unnamed-chunk-36-1.png" width="672" /></p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="ch06_Jepma.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="ch17_mediation.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": null,
"history": {
"link": "https://github.com/jungheejung/cue_expectancy/commits/main/15_iv-cue-stim-outcome-expect_dv-outcome_demean.Rmd",
"text": "Chapter edit history"
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "lunr",
"options": null
},
"toc": {
"collapse": "section",
"scroll_highlight": true
},
"toolbar": {
"position": "fixed"
},
"info": true
});
});
</script>

</body>

</html>
